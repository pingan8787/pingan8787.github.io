<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/page/8/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-157-【算法】每周一练之数据结构与算法（LinkedList）" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/04/22/157-%E3%80%90%E7%AE%97%E6%B3%95%E3%80%91%E6%AF%8F%E5%91%A8%E4%B8%80%E7%BB%83%E4%B9%8B%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%EF%BC%88LinkedList%EF%BC%89/" class="article-date">
  <time class="dt-published" datetime="2019-04-22T14:30:31.000Z" itemprop="datePublished">2019-04-22</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/04/22/157-%E3%80%90%E7%AE%97%E6%B3%95%E3%80%91%E6%AF%8F%E5%91%A8%E4%B8%80%E7%BB%83%E4%B9%8B%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%EF%BC%88LinkedList%EF%BC%89/">157-【算法】每周一练之数据结构与算法（LinkedList）</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <hr>
<table>
<thead>
<tr>
<th>Author</th>
<th>王平安</th>
</tr>
</thead>
<tbody><tr>
<td>E-mail</td>
<td><a href="mailto:&#x70;&#x69;&#x6e;&#103;&#97;&#x6e;&#56;&#x37;&#x38;&#x37;&#x40;&#x71;&#113;&#46;&#99;&#x6f;&#109;">&#x70;&#x69;&#x6e;&#103;&#97;&#x6e;&#56;&#x37;&#x38;&#x37;&#x40;&#x71;&#113;&#46;&#99;&#x6f;&#109;</a></td>
</tr>
<tr>
<td>博  客</td>
<td><a target="_blank" rel="noopener" href="http://www.pingan8787.com/">www.pingan8787.com</a></td>
</tr>
<tr>
<td>微  信</td>
<td>pingan8787</td>
</tr>
<tr>
<td>每日文章推荐</td>
<td><a target="_blank" rel="noopener" href="https://github.com/pingan8787/Leo_Reading/issues">https://github.com/pingan8787/Leo_Reading/issues</a></td>
</tr>
<tr>
<td>微信公众号</td>
<td>前端自习课</td>
</tr>
</tbody></table>
<p><img src="http://images.pingan8787.com/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E5%B0%81%E9%9D%A2.png" alt="封面"></p>
<p>这是第三周的练习题，原本应该先发第二周的，因为周末的时候，我的母亲大人来看望她的宝贝儿子，哈哈，我得带她看看厦门这座美丽的城市呀。    </p>
<p>这两天我抓紧整理下第二周的题目和答案，下面我把之前的也列出来：     </p>
<ul>
<li>1.<a target="_blank" rel="noopener" href="https://juejin.im/post/5cb2df0c5188251aca7340a0">每周一练 之 数据结构与算法（Stack）</a>   </li>
</ul>
<blockquote>
<p>欢迎关注我的 <a target="_blank" rel="noopener" href="https://github.com/pingan8787">个人主页</a> &amp;&amp;  <a target="_blank" rel="noopener" href="http://www.pingan8787.com/">个人博客</a> &amp;&amp; <a target="_blank" rel="noopener" href="http://js.pingan8787.com/">个人知识库</a> &amp;&amp; 微信公众号“前端自习课”</p>
</blockquote>
<p><strong>本周练习内容：数据结构与算法 —— LinkedList</strong>   </p>
<p>这些都是数据结构与算法，一部分方法是团队其他成员实现的，一部分我自己做的，有什么其他实现方法或错误，欢迎各位大佬指点，感谢。   </p>
<h2 id="一、链表是什么？与数组有什么区别？生活中有什么案例？"><a href="#一、链表是什么？与数组有什么区别？生活中有什么案例？" class="headerlink" title="一、链表是什么？与数组有什么区别？生活中有什么案例？"></a>一、链表是什么？与数组有什么区别？生活中有什么案例？</h2><hr>
<p>解析：<br>概念参考阅读 <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E9%93%BE%E8%A1%A8">链表 —— 维基百科</a>  </p>
<p><strong>1.概念：</strong>   </p>
<p>链表（Linked list）是一种上一个元素的引用指向下一个元素的存储结构，链表通过指针来连接元素与元素；   </p>
<p>链表是线性表的一种，所谓的线性表包含顺序线性表和链表，顺序线性表是用数组实现的，在内存中有顺序排列，通过改变数组大小实现。而链表不是用顺序实现的，用指针实现，在内存中不连续。意思就是说，链表就是<strong>将一系列不连续的内存联系起来</strong>，将那种碎片内存进行合理的利用，解决空间的问题。     </p>
<p>所以，链表允许插入和删除表上任意位置上的节点，但是不允许随即存取。链表有很多种不同的类型：<strong>单向链表</strong>、<strong>双向链表</strong>及<strong>循环链表</strong>。   </p>
<p><strong>2.与数组的区别：</strong>   </p>
<ul>
<li><p>相同：<br>两种结构均<strong>可实现数据的顺序存储</strong>，构造出来的模型呈<strong>线性结构</strong>。   </p>
</li>
<li><p>不同：<br>链表是<strong>链式的存储结构</strong>；数组是<strong>顺序的存储结构</strong>。<br>链表通过<strong>指针</strong>来连接元素与元素，数组则是把所有元素按<strong>次序</strong>依次存储。 </p>
</li>
</ul>
<p>链表的插入删除元素相对数组较为简单，不需要移动元素，且较为容易实现长度扩充，但是寻找某个元素较为困难。   </p>
<p>数组寻找某个元素较为简单，但插入与删除比较复杂，由于最大长度需要再编程一开始时指定，故当达到最大长度时，扩充长度不如链表方便。   </p>
<p><strong>数组和链表一些操作的时间复杂度对比：</strong><br>数组：   </p>
<ul>
<li>查找复杂度：O(1)   </li>
<li>添加/删除复杂度：O(n)   </li>
</ul>
<p>链表：   </p>
<ul>
<li>查找复杂度：O(n)  </li>
<li>添加/删除复杂度：O(1)   </li>
</ul>
<p><strong>3.生活中的案例：</strong><br>火车，是由一些列车厢连接起来；<br>寻宝游戏，每个线索都是下一个线索地点的指针。   </p>
<h2 id="二、请事先一个链表，并实现以下方法"><a href="#二、请事先一个链表，并实现以下方法" class="headerlink" title="二、请事先一个链表，并实现以下方法"></a>二、请事先一个链表，并实现以下方法</h2><ul>
<li><code>append(element)</code>：向列表尾部添加一个新的元素。   </li>
<li><code>insert(position, element)</code>：向列表指定位置插入一个新的元素。   </li>
<li><code>remove(element)</code>：从列表中移除并返回特定元素（若有多个相同元素则取第一次出现的情况）。   </li>
<li><code>indexOf(element)</code>：返回元素在列表的索引（若有多个相同元素则取第一次出现的情况），如果列表中没有该元素则返回 <code>-1</code>。</li>
<li><code>removeAt(position)</code>：从列表中，移除并返回特定位置的一项。   </li>
<li><code>isEmpty()</code>：如果列表不含任何元素，返回 <code>true</code>，否则返回 <code>false</code>。  </li>
<li><code>size()</code>：返回列表中元素个数，与数组的 <code>length</code> 属性类似。</li>
<li><code>toString()</code>：由于列表项使用 <code>Node</code> 类，需要重写继承自 JavaScript 对象默认的 <code>toString()</code> 方法，让其只输出元素的值。   </li>
<li><em>提示：Web 端优先使用 ES6 以上的语法实现。</em>*   </li>
</ul>
<hr>
<p>解析：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="title">constructor</span>(<span class="params">element</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.element = element</span><br><span class="line">        <span class="built_in">this</span>.next = <span class="literal">null</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LinkedList</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.length = <span class="number">0</span></span><br><span class="line">        <span class="built_in">this</span>.head = <span class="literal">null</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 添加元素（末尾添加）</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param <span class="type">&#123;*&#125;</span> </span>element 添加的元素</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="title">append</span>(<span class="params">element</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> node = <span class="keyword">new</span> Node(element)</span><br><span class="line">        <span class="keyword">if</span>(!<span class="built_in">this</span>.head)&#123;</span><br><span class="line">            <span class="built_in">this</span>.head = node</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">let</span> current = <span class="built_in">this</span>.head</span><br><span class="line">            <span class="comment">// 查找最后一项</span></span><br><span class="line">            <span class="keyword">while</span>(current.next)&#123;</span><br><span class="line">                current = current.next</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 将最后一下的next赋值为node，实现追加元素</span></span><br><span class="line">            current.next = node</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">this</span>.length ++</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 添加元素（指定位置）</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param <span class="type">&#123;Number&#125;</span> </span>position 添加的位置</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param <span class="type">&#123;*&#125;</span> </span>element  添加的元素</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="title">insert</span>(<span class="params">position, element</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(position &gt;= <span class="number">0</span> &amp;&amp; position &lt;= <span class="built_in">this</span>.length)&#123;</span><br><span class="line">            <span class="keyword">let</span> node = <span class="keyword">new</span> Node(element),</span><br><span class="line">                index = <span class="number">0</span>,</span><br><span class="line">                previous = <span class="literal">null</span></span><br><span class="line">            <span class="keyword">if</span>(position === <span class="number">0</span>)&#123;</span><br><span class="line">                node.next = <span class="built_in">this</span>.head</span><br><span class="line">                <span class="built_in">this</span>.head = node</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">let</span> current = <span class="built_in">this</span>.head</span><br><span class="line">                <span class="keyword">while</span>(index++ &lt; position)&#123;</span><br><span class="line">                    previous = current</span><br><span class="line">                    current = current.next</span><br><span class="line">                &#125;</span><br><span class="line">                previous.next = node</span><br><span class="line">                node.next = current</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">this</span>.length ++</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 删除元素</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param <span class="type">&#123;*&#125;</span> </span>element 删除的元素</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return <span class="type">&#123;*&#125;</span>  </span>被删除的元素</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="title">remove</span>(<span class="params">element</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> current = <span class="built_in">this</span>.head,</span><br><span class="line">            previous = <span class="literal">null</span></span><br><span class="line">        <span class="keyword">if</span>(element === <span class="built_in">this</span>.head.element)&#123;</span><br><span class="line">            <span class="built_in">this</span>.head = current.next</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">while</span>(current.next &amp;&amp; current.element !== element)&#123;</span><br><span class="line">                previous = current</span><br><span class="line">                current = current.next</span><br><span class="line">            &#125;</span><br><span class="line">            previous.next = current.next</span><br><span class="line">            <span class="built_in">this</span>.length --</span><br><span class="line">            <span class="keyword">return</span> current.element</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 删除元素（指定位置）</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param <span class="type">&#123;Number&#125;</span> </span>position 删除元素的位置</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return <span class="type">&#123;*&#125;</span>  </span>被删除的元素</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="title">removeAt</span>(<span class="params">position</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(position &gt;= <span class="number">0</span> &amp;&amp; position &lt;= <span class="built_in">this</span>.length)&#123;</span><br><span class="line">            <span class="keyword">let</span> current = <span class="built_in">this</span>.head,</span><br><span class="line">                index = <span class="number">0</span>,</span><br><span class="line">                previous = <span class="literal">null</span></span><br><span class="line">            <span class="keyword">if</span>(position === <span class="number">0</span>)&#123; <span class="comment">// 删除第一项</span></span><br><span class="line">                <span class="built_in">this</span>.head = current.next</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">while</span>(index++ &lt; position)&#123;</span><br><span class="line">                    previous = current</span><br><span class="line">                    current = current.next</span><br><span class="line">                &#125;</span><br><span class="line">                previous.next = current.next</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">this</span>.length --</span><br><span class="line">            <span class="keyword">return</span> current.element</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查找指定元素的位置</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param <span class="type">&#123;*&#125;</span> </span>element 查找的元素</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return <span class="type">&#123;Number&#125;</span> </span>查找的元素的下标</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="title">indexOf</span>(<span class="params">element</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> current = <span class="built_in">this</span>.head, </span><br><span class="line">            index = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span>(current.next &amp;&amp; current.element !== element)&#123;</span><br><span class="line">            current = current.next</span><br><span class="line">            index ++</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> index === <span class="number">0</span> ? -<span class="number">1</span> : index</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 链表是否为空</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return <span class="type">&#123;Boolean&#125;</span></span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="title">isEmpty</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.length === <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 链表的长度</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return <span class="type">&#123;Number&#125;</span></span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="title">size</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.length</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 将链表转成字符串</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return <span class="type">&#123;String&#125;</span></span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="title">toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> current = <span class="built_in">this</span>.head,</span><br><span class="line">            arr = <span class="keyword">new</span> <span class="built_in">Array</span>()</span><br><span class="line">        <span class="keyword">while</span>(current.next)&#123;</span><br><span class="line">            arr.push(current.element)</span><br><span class="line">            current = current.next</span><br><span class="line">        &#125;</span><br><span class="line">        arr.push(current.element)</span><br><span class="line">        <span class="keyword">return</span> arr.toString()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> leo = <span class="keyword">new</span> LinkedList()</span><br><span class="line">leo.append(<span class="number">3</span>)</span><br><span class="line">leo.append(<span class="number">6</span>)</span><br><span class="line">leo.append(<span class="number">9</span>)</span><br><span class="line"><span class="built_in">console</span>.log(leo.length)</span><br><span class="line"><span class="built_in">console</span>.log(leo.head)</span><br><span class="line">leo.remove(<span class="number">6</span>)</span><br><span class="line"><span class="built_in">console</span>.log(leo.length)</span><br><span class="line"><span class="built_in">console</span>.log(leo.head)</span><br><span class="line"><span class="built_in">console</span>.log(leo.toString())</span><br></pre></td></tr></table></figure>

<h2 id="三、实现反转链表"><a href="#三、实现反转链表" class="headerlink" title="三、实现反转链表"></a>三、实现反转链表</h2><p>用链表的方式，输出一个反转后的单链表。    </p>
<p>示例:   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">输入: <span class="number">1</span>-&gt;<span class="number">2</span>-&gt;<span class="number">3</span>-&gt;<span class="number">4</span>-&gt;<span class="number">5</span>-&gt;NULL</span><br><span class="line">输出: <span class="number">5</span>-&gt;<span class="number">4</span>-&gt;<span class="number">3</span>-&gt;<span class="number">2</span>-&gt;<span class="number">1</span>-&gt;NULL</span><br><span class="line"><span class="comment">// input</span></span><br><span class="line"><span class="keyword">let</span> head = &#123;</span><br><span class="line">    <span class="string">&#x27;val&#x27;</span>: <span class="number">1</span>,<span class="string">&#x27;next&#x27;</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;val&#x27;</span>: <span class="number">2</span>,<span class="string">&#x27;next&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;val&#x27;</span>: <span class="number">3</span>,<span class="string">&#x27;next&#x27;</span>: &#123;</span><br><span class="line">                <span class="string">&#x27;val&#x27;</span>: <span class="number">4</span>,<span class="string">&#x27;next&#x27;</span>: &#123;</span><br><span class="line">                    <span class="string">&#x27;val&#x27;</span>: <span class="number">5</span>,</span><br><span class="line">                    <span class="string">&#x27;next&#x27;</span>: <span class="literal">null</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">reverseList(head)</span><br><span class="line"></span><br><span class="line"><span class="comment">// output</span></span><br><span class="line">head = &#123;</span><br><span class="line">    <span class="string">&#x27;val&#x27;</span>: <span class="number">5</span>,<span class="string">&#x27;next&#x27;</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;val&#x27;</span>: <span class="number">4</span>,<span class="string">&#x27;next&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;val&#x27;</span>: <span class="number">3</span>,<span class="string">&#x27;next&#x27;</span>: &#123;</span><br><span class="line">                <span class="string">&#x27;val&#x27;</span>: <span class="number">2</span>,<span class="string">&#x27;next&#x27;</span>: &#123;</span><br><span class="line">                    <span class="string">&#x27;val&#x27;</span>: <span class="number">1</span>,</span><br><span class="line">                    <span class="string">&#x27;next&#x27;</span>: <span class="literal">null</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><strong>解题思路1.使用迭代：</strong><br>在遍历列表时，将当前节点的 <code>next</code> 指针改为<strong>指向前一个元素</strong>。由于节点没有引用其上一个节点，因此必须<strong>先存储其前一个元素</strong>。在更改引用之前，还需要另一个指针来存储下一个节点。<strong>不要忘记在最后返回新的头引用</strong>！</p>
<p><strong>解题思路2.使用递归：</strong><br>通过递归修改 <code>head.next.next</code> 和 <code>head.next</code> 指针来实现。   </p>
<hr>
<p>解析：<br>题目出自：<a target="_blank" rel="noopener" href="https://leetcode-cn.com/problems/reverse-linked-list/">Leetcode 206. 反转链表</a></p>
<p>介绍两种常用方法：</p>
<p><strong>1.使用迭代：</strong><br>在遍历列表时，将当前节点的 <code>next</code> 指针改为<strong>指向前一个元素</strong>。由于节点没有引用其上一个节点，因此必须<strong>先存储其前一个元素</strong>。在更改引用之前，还需要另一个指针来存储下一个节点。<strong>不要忘记在最后返回新的头引用</strong>！</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"> * function ListNode(val) &#123;</span></span><br><span class="line"><span class="comment"> *     this.val = val;</span></span><br><span class="line"><span class="comment"> *     this.next = null;</span></span><br><span class="line"><span class="comment"> * &#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;ListNode&#125;</span> <span class="variable">head</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;ListNode&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">let</span> reverseList = <span class="function"><span class="keyword">function</span>(<span class="params">head</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> pre = <span class="literal">null</span>, curr = head</span><br><span class="line">    <span class="keyword">while</span> (curr) &#123;</span><br><span class="line">        next = curr.next</span><br><span class="line">        curr.next = pre</span><br><span class="line">        pre = curr</span><br><span class="line">        curr = next</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> pre</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><strong>复杂度分析</strong>    </p>
<p><strong>时间复杂度</strong>：<code>O(n)</code>。 假设 <code>n</code> 是列表的长度，时间复杂度是 <code>O(n)</code>。<br><strong>空间复杂度</strong>：<code>O(1)</code>。    </p>
<p><strong>2.使用递归：</strong>  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"> * function ListNode(val) &#123;</span></span><br><span class="line"><span class="comment"> *     this.val = val;</span></span><br><span class="line"><span class="comment"> *     this.next = null;</span></span><br><span class="line"><span class="comment"> * &#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;ListNode&#125;</span> <span class="variable">head</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;ListNode&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">let</span> reverseList = <span class="function"><span class="keyword">function</span>(<span class="params">head</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(head == <span class="literal">null</span> || head.next == <span class="literal">null</span>) <span class="keyword">return</span> head</span><br><span class="line">    <span class="keyword">let</span> pre = reverseList(head.next)</span><br><span class="line">    head.next.next = head</span><br><span class="line">    head.next = <span class="literal">null</span></span><br><span class="line">    <span class="keyword">return</span> pre</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><strong>复杂度分析</strong></p>
<p><strong>时间复杂度</strong>：<code>O(n)</code>。 假设 <code>n</code> 是列表的长度，那么时间复杂度为 <code>O(n)</code>。<br><strong>空间复杂度</strong>：<code>O(n)</code>。 由于使用递归，将会使用隐式栈空间。递归深度可能会达到 <code>n</code> 层。    </p>
<h2 id="四、判断链表是否有环"><a href="#四、判断链表是否有环" class="headerlink" title="四、判断链表是否有环"></a>四、判断链表是否有环</h2><p>设计一个函数 <code>hasCycle</code>，接收一个链表作为参数，判断链表中是否有环。<br>为了表示给定链表中的环，我们使用整数 <code>pos</code> 来表示<strong>链表尾</strong>连接到<strong>链表中的位置</strong>（索引从 <code>0</code> 开始）。 如果 <code>pos</code> 是 <code>-1</code>，则在该链表中没有环。    </p>
<p><img src="http://images.pingan8787.com/linkedlist-cycle.png" alt="linkedlist-cycle"></p>
<p>需要注意的是，不可能存在多个环，最多只有一个。  </p>
<p><strong>示例 1：</strong>   </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入：head = [3,2,0,-4], pos = 1</span><br><span class="line">输出：true</span><br><span class="line">解释：链表中有一个环，其尾部连接到第二个节点。</span><br></pre></td></tr></table></figure>
<p><img src="http://images.pingan8787.com/20190702add1.png" alt="示例 1"></p>
<p><strong>示例 2：</strong>   </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入：head = [1,2], pos = 0</span><br><span class="line">输出：true</span><br><span class="line">解释：链表中有一个环，其尾部连接到第一个节点。</span><br></pre></td></tr></table></figure>
<p><img src="http://images.pingan8787.com/20190702add2.png" alt="示例 2"></p>
<p><strong>示例 3：</strong>   </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入：head = [1], pos = -1</span><br><span class="line">输出：false</span><br><span class="line">解释：链表中没有环。</span><br></pre></td></tr></table></figure>
<p><img src="http://images.pingan8787.com/20190702add3.png" alt="示例 3"></p>
<p><strong>解题思路1.判断是否有 null：</strong><br>一直遍历下去，如果遍历到 <code>null</code> 则表示没有环，否则有环，但是考虑到性能问题，最好给定一段时间作为限制，超过时间就不要继续遍历。   </p>
<p><strong>解题思路2.标记法：</strong><br>也是要遍历每个节点，并在遍历的节点添加标记，如果后面遍历过程中，遇到有这个标记的节点，即表示有环，反之没有环。   </p>
<p><strong>解题思路3.使用双指针（龟兔赛跑式）：</strong><br>设置2个指针，一个 <code>快指针</code> 每次走 2 步，<code>慢指针</code> 每次走 1 步，如果没有环的情况，最后这两个指针不会相遇，如果有环，会相遇。   </p>
<hr>
<p>解析：<br>题目出自：<a target="_blank" rel="noopener" href="https://leetcode-cn.com/problems/linked-list-cycle/">Leetcode 141. 环形链表</a></p>
<p><strong>1.断是否有 null</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"> * function ListNode(val) &#123;</span></span><br><span class="line"><span class="comment"> *     this.val = val;</span></span><br><span class="line"><span class="comment"> *     this.next = null;</span></span><br><span class="line"><span class="comment"> * &#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;ListNode&#125;</span> <span class="variable">head</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;boolean&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">let</span> hasCycle = <span class="function"><span class="keyword">function</span>(<span class="params">head</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(head)&#123;</span><br><span class="line">        <span class="keyword">if</span>(head.value == <span class="literal">null</span>) <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">        head.value = <span class="literal">null</span></span><br><span class="line">        head = head.next</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>2.标记法</strong>   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"> * function ListNode(val) &#123;</span></span><br><span class="line"><span class="comment"> *     this.val = val;</span></span><br><span class="line"><span class="comment"> *     this.next = null;</span></span><br><span class="line"><span class="comment"> * &#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;ListNode&#125;</span> <span class="variable">head</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;boolean&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">let</span> hasCycle = <span class="function"><span class="keyword">function</span>(<span class="params">head</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> node = head</span><br><span class="line">    <span class="keyword">while</span>(node)&#123;</span><br><span class="line">        <span class="keyword">if</span>(node.isVisit)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            node.isVisit = <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">        node = node.next</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><strong>3.使用双指针</strong>   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"> * function ListNode(val) &#123;</span></span><br><span class="line"><span class="comment"> *     this.val = val;</span></span><br><span class="line"><span class="comment"> *     this.next = null;</span></span><br><span class="line"><span class="comment"> * &#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;ListNode&#125;</span> <span class="variable">head</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;boolean&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">let</span> hasCycle = <span class="function"><span class="keyword">function</span>(<span class="params">head</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(head == <span class="literal">null</span> || head.next == <span class="literal">null</span>) <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    <span class="keyword">let</span> slow = head, fast = head.next</span><br><span class="line">    <span class="keyword">while</span>(slow != fast)&#123;</span><br><span class="line">        <span class="keyword">if</span>(fast == <span class="literal">null</span> || fast.next == <span class="literal">null</span>) <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">        slow = slow.next  <span class="comment">// 慢指针每次走1步</span></span><br><span class="line">        fast = fast.next.next <span class="comment">// 快指针每次走1补</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>


<h2 id="五、实现两两交换链表中的节点"><a href="#五、实现两两交换链表中的节点" class="headerlink" title="五、实现两两交换链表中的节点"></a>五、实现两两交换链表中的节点</h2><p>给定一个链表，两两交换其中相邻的节点，并返回交换后的链表。   </p>
<p><strong>你不能只是单纯的改变节点内部的值</strong>，而是需要实际的进行节点交换。    </p>
<p><strong>示例:</strong>   </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">给定 1-&gt;2-&gt;3-&gt;4, 你应该返回 2-&gt;1-&gt;4-&gt;3.</span><br><span class="line">给定 1-&gt;2-&gt;3-&gt;4-&gt;5, 你应该返回 2-&gt;1-&gt;4-&gt;3-&gt;5.</span><br></pre></td></tr></table></figure>

<p><strong>解题思路1.使用迭代：</strong><br>和<strong>反转链表</strong>类似，关键在于有三个指针，分别指向前后和当前节点，而不同在于两两交换后，移动节点的步长为2，需要注意。   </p>
<p><strong>解题思路2.使用递归：</strong><br>这里也可以使用递归，也可以参考<strong>反转链表</strong>的问题，终止条件是递归到链表为空，或者只剩下一个元素没得交换了，才终止。   </p>
<hr>
<p>解析：<br>题目出自：<a target="_blank" rel="noopener" href="https://leetcode-cn.com/problems/swap-nodes-in-pairs/">Leetcode 24. 两两交换链表中的节点</a></p>
<p>介绍两种常用方法：</p>
<p><strong>1.使用迭代：</strong>   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"> * function ListNode(val) &#123;</span></span><br><span class="line"><span class="comment"> *     this.val = val;</span></span><br><span class="line"><span class="comment"> *     this.next = null;</span></span><br><span class="line"><span class="comment"> * &#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;ListNode&#125;</span> <span class="variable">head</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;ListNode&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">let</span> swapPairs = <span class="function"><span class="keyword">function</span> (<span class="params">head</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!head) <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">    <span class="keyword">let</span> arr = []</span><br><span class="line">    <span class="keyword">while</span>(head)&#123;</span><br><span class="line">        <span class="keyword">let</span> next = head.next</span><br><span class="line">        head.next = <span class="literal">null</span></span><br><span class="line">        arr.push(head)</span><br><span class="line">        head = next</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.length; i += <span class="number">2</span>)&#123;</span><br><span class="line">        <span class="keyword">let</span> [a, b] = [arr[i], arr[i + <span class="number">1</span>]]</span><br><span class="line">        <span class="keyword">if</span>(!b) <span class="keyword">continue</span></span><br><span class="line">        [arr[i], arr[i + <span class="number">1</span>]] = [b, a]</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.length - <span class="number">1</span>; i ++)&#123;</span><br><span class="line">        arr[i].next = arr[i + <span class="number">1</span>]</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> arr[<span class="number">0</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>2.使用递归：</strong>   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"> * function ListNode(val) &#123;</span></span><br><span class="line"><span class="comment"> *     this.val = val;</span></span><br><span class="line"><span class="comment"> *     this.next = null;</span></span><br><span class="line"><span class="comment"> * &#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;ListNode&#125;</span> <span class="variable">head</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;ListNode&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> swapPairs = <span class="function"><span class="keyword">function</span> (<span class="params">head</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(head == <span class="literal">null</span> || head.next ==<span class="literal">null</span>) <span class="keyword">return</span> head</span><br><span class="line">    <span class="keyword">let</span> next = head.next</span><br><span class="line">    head.next = swapPairs(next.next)</span><br><span class="line">    next.next = head</span><br><span class="line">    <span class="keyword">return</span> next</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/04/22/157-%E3%80%90%E7%AE%97%E6%B3%95%E3%80%91%E6%AF%8F%E5%91%A8%E4%B8%80%E7%BB%83%E4%B9%8B%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%EF%BC%88LinkedList%EF%BC%89/" data-id="ckts3ejy300ly4d9kdfs71rud" data-title="157-【算法】每周一练之数据结构与算法（LinkedList）" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/" rel="tag">JavaScript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" rel="tag">前端开发</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8E%9F%E5%88%9B/" rel="tag">原创</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-156-【算法】每周一练之数据结构与算法（Stack）" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/04/14/156-%E3%80%90%E7%AE%97%E6%B3%95%E3%80%91%E6%AF%8F%E5%91%A8%E4%B8%80%E7%BB%83%E4%B9%8B%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%EF%BC%88Stack%EF%BC%89/" class="article-date">
  <time class="dt-published" datetime="2019-04-14T07:28:30.000Z" itemprop="datePublished">2019-04-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/04/14/156-%E3%80%90%E7%AE%97%E6%B3%95%E3%80%91%E6%AF%8F%E5%91%A8%E4%B8%80%E7%BB%83%E4%B9%8B%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%EF%BC%88Stack%EF%BC%89/">156-【算法】每周一练之数据结构与算法（Stack）</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <hr>
<table>
<thead>
<tr>
<th>Author</th>
<th>王平安</th>
</tr>
</thead>
<tbody><tr>
<td>E-mail</td>
<td><a href="mailto:&#x70;&#105;&#x6e;&#103;&#x61;&#x6e;&#56;&#55;&#x38;&#55;&#x40;&#113;&#113;&#x2e;&#x63;&#x6f;&#109;">&#x70;&#105;&#x6e;&#103;&#x61;&#x6e;&#56;&#55;&#x38;&#55;&#x40;&#113;&#113;&#x2e;&#x63;&#x6f;&#109;</a></td>
</tr>
<tr>
<td>博  客</td>
<td><a target="_blank" rel="noopener" href="http://www.pingan8787.com/">www.pingan8787.com</a></td>
</tr>
<tr>
<td>微  信</td>
<td>pingan8787</td>
</tr>
<tr>
<td>每日文章推荐</td>
<td><a target="_blank" rel="noopener" href="https://github.com/pingan8787/Leo_Reading/issues">https://github.com/pingan8787/Leo_Reading/issues</a></td>
</tr>
<tr>
<td>微信公众号</td>
<td>前端自习课</td>
</tr>
</tbody></table>
<p><img src="http://images.pingan8787.com/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E5%B0%81%E9%9D%A2.png" alt="封面"></p>
<p>最近公司内部在开始做前端技术的技术分享，每周一个主题的 <strong>每周一练</strong>，以<strong>基础知识</strong>为主，感觉挺棒的，跟着团队的大佬们学习和复习一些知识，新人也可以多学习一些知识，也把团队内部学习氛围营造起来。   </p>
<p>我接下来会开始把每周一练的题目和知识整理一下，便于思考和巩固，就像今天这篇开始。    </p>
<p>学习的道路，很漫长，要坚持，希望大家都能掌握自己喜欢的技术，和自己需要的技术。   </p>
<blockquote>
<p>欢迎查看我的 <a target="_blank" rel="noopener" href="https://github.com/pingan8787">个人主页</a> &amp;&amp;  <a target="_blank" rel="noopener" href="http://www.pingan8787.com/">个人博客</a> &amp;&amp; <a target="_blank" rel="noopener" href="http://js.pingan8787.com/">个人知识库</a> &amp;&amp; 微信公众号“前端自习课”</p>
</blockquote>
<p><strong>本周练习内容：数据结构与算法 —— Stack</strong>   </p>
<p>这些都是数据结构与算法，一部分方法是团队其他成员实现的，一部分我自己做的，有什么其他实现方法或错误，欢迎各位大佬指点，感谢。   </p>
<h2 id="一、栈有什么特点，生活中有什么例子"><a href="#一、栈有什么特点，生活中有什么例子" class="headerlink" title="一、栈有什么特点，生活中有什么例子?"></a>一、栈有什么特点，生活中有什么例子?</h2><ul>
<li>栈( stack )又称<strong>堆栈</strong>，是一种后进先出的<strong>有序集合</strong>，其中一端为栈顶，另一端为栈底，添加元素（称为压栈/入栈或进栈）时，将新元素压入栈顶，删除元素（称为出栈或退栈）时，将栈底元素删除并返回被删除元素。</li>
<li>特点：<strong>先进后出，后进先出</strong>。</li>
<li>例子：一叠书、一叠盘子。</li>
</ul>
<p><img src="http://images.pingan8787.com/20190702add.png" alt="栈"></p>
<h2 id="二、实现一个栈，并实现下面方法"><a href="#二、实现一个栈，并实现下面方法" class="headerlink" title="二、实现一个栈，并实现下面方法"></a>二、实现一个栈，并实现下面方法</h2><ul>
<li><code>push(element)</code>：添加一个新元素到栈顶。  </li>
<li><code>pop()</code>：移除栈顶的元素，同时返回被移除的元素。  </li>
<li><code>peek()</code>：返回栈顶的元素，不对栈做任何修改 (这个方法不会移除栈顶的元素，仅仅返回它)。  </li>
<li><code>isEmpty()</code>：如果栈没有任何元素就返回 <code>true</code>，否则返回 <code>false</code>。  </li>
<li><code>clear()</code>：移除栈里面的所有元素。  </li>
<li><code>size()</code>：返回栈里的元素个数。这个方法与数组的 <code>length</code> 属性类似。  </li>
</ul>
<p><strong>方法1：ES6实现</strong>   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Stack</span> </span>&#123;</span><br><span class="line">    <span class="title">constructor</span> (<span class="params"></span>)&#123;</span><br><span class="line">        <span class="built_in">this</span>.items = []</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="title">push</span>(<span class="params"> element </span>)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.items.push(element)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="title">pop</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.items.pop()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="title">peek</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.items[<span class="built_in">this</span>.items.length - <span class="number">1</span>]</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="title">isEmpty</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.items.length === <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="title">clear</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.items = []</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="title">size</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.items.length</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面实现的方式虽然简单，但是内部 <code>items</code> 属性是公共的，为了满足面向对象变成私有性的原则，我们应该让 <code>items</code> 作为私有属性，因此我们可以使用 ES6 中 <code>Symbol</code> 或 <code>WeakMap</code> 来实现：    </p>
<p><strong>方法2：使用 ES6 的 Symbol 基本数据类型实现</strong><br>知识点复习：<a target="_blank" rel="noopener" href="http://es6.ruanyifeng.com/#docs/symbol">ES6 中的 Symbol 介绍</a>    </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> _items = <span class="built_in">Symbol</span>()</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Stack</span> </span>&#123;</span><br><span class="line">    <span class="title">constructor</span> (<span class="params"></span>)&#123;</span><br><span class="line">        <span class="built_in">this</span>[_items] = []</span><br><span class="line">    &#125;</span><br><span class="line">    push (element)&#123;</span><br><span class="line">        <span class="built_in">this</span>[_items].push(element)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 剩下方法和第一种实现的差不多，这里省略</span></span><br><span class="line">    <span class="comment">// 只要把前面方法中的 this.items 更改为 this[_items]</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>方法3：使用 ES6 的 WeakMap 实现</strong><br>知识点复习：<a target="_blank" rel="noopener" href="http://es6.ruanyifeng.com/#docs/set-map#WeakMap">ES6 中的 WeakMap 介绍</a>    </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> items = <span class="keyword">new</span> <span class="built_in">WeakMap</span>()</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Stack</span> </span>&#123;</span><br><span class="line">    <span class="title">constructor</span> (<span class="params"></span>)&#123;</span><br><span class="line">        items.set(<span class="built_in">this</span>, [])</span><br><span class="line">    &#125;</span><br><span class="line">    push (element)&#123;</span><br><span class="line">        <span class="keyword">let</span> item = items.get(<span class="built_in">this</span>)</span><br><span class="line">        item.push(element)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 剩下方法和第一种实现的差不多，这里省略</span></span><br><span class="line">    <span class="comment">// 只要把前面方法中的获取 this.items 的方式，更改为 items.get(this) 获取</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="三、编写一个函数，实现十进制转二进制"><a href="#三、编写一个函数，实现十进制转二进制" class="headerlink" title="三、编写一个函数，实现十进制转二进制"></a>三、编写一个函数，实现十进制转二进制</h2><p>题目意思很简单，就是十进制转二进制，但是在实际工作开发中，我们更愿意实现的是任意进制转任意进制，不过呢，我们还是以解决问题为首要目标呀。   </p>
<p>当然，业务需求可以直接使用 <code>toString(2)</code> 方法，但是为了练习，咱还是不这么用咯。</p>
<p><strong>方法1：使用前面定义的 Stack 类</strong><br>这里使用前面题目中定义的 <code>Stack</code> 类。   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 十进制转换为二进制</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;Number&#125;</span> </span>bit </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bitset</span> (<span class="params">bit</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(bit == <span class="number">0</span>) <span class="keyword">return</span> <span class="string">&#x27;0&#x27;</span></span><br><span class="line">    <span class="keyword">if</span>(!<span class="regexp">/^[0-9]+.?[0-9]*$/</span>.test(bit))&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&#x27;请输入正确的数值！&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> stack = <span class="keyword">new</span> Stack(), result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">while</span> (bit &gt; <span class="number">0</span>)&#123;</span><br><span class="line">        stack.push(bit % <span class="number">2</span>)</span><br><span class="line">        bit = <span class="built_in">Math</span>.floor(bit / <span class="number">2</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (!stack.isEmpty())&#123;</span><br><span class="line">        result += stack.pop().toString()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>方法2：简单实现</strong><br>下面这个方法，其实不太好，因为没有怎么用到这次要练习的<strong>栈</strong>方法，哈哈。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 十进制转换为二进制</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;Number&#125;</span> </span>bit </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bitset</span> (<span class="params">bit</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(bit == <span class="number">0</span>) <span class="keyword">return</span> <span class="string">&#x27;0&#x27;</span></span><br><span class="line">    <span class="keyword">if</span>(!<span class="regexp">/^[0-9]+.?[0-9]*$/</span>.test(bit))&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&#x27;请输入正确的数值！&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> arr = []</span><br><span class="line">    <span class="keyword">while</span>(bit &gt; <span class="number">0</span>)&#123;</span><br><span class="line">        arr.push(bit % <span class="number">2</span>)</span><br><span class="line">        bit = <span class="built_in">Math</span>.floor(bit / <span class="number">2</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> arr.reverse().join(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>另外可以参考：<a target="_blank" rel="noopener" href="https://zh.wikihow.com/%E4%BB%8E%E5%8D%81%E8%BF%9B%E5%88%B6%E8%BD%AC%E6%8D%A2%E4%B8%BA%E4%BA%8C%E8%BF%9B%E5%88%B6">wikiHow - 从十进制转换为二进制</a>。    </p>
<h2 id="四、编写一个函数，实现检验圆括号顺序的有效性"><a href="#四、编写一个函数，实现检验圆括号顺序的有效性" class="headerlink" title="四、编写一个函数，实现检验圆括号顺序的有效性"></a>四、编写一个函数，实现检验圆括号顺序的有效性</h2><p>主要目的就是：该函数接收一个<strong>圆括号字符串</strong>，判断里面的括号顺序是否有效，如果有效则返回 <code>true</code> 反之 <code>false</code>。<br>如：   </p>
<ul>
<li><code>(</code>   -&gt; <code>false</code></li>
<li><code>()</code>  -&gt; <code>true</code></li>
<li><code>(()</code> -&gt; <code>false</code></li>
<li><code>())</code> -&gt; <code>false</code></li>
<li><code>())</code> -&gt; <code>false</code></li>
<li><code>(((()()))())</code> -&gt; <code>true</code></li>
</ul>
<p>这个题目实现的主要方法是：遍历字符串，先排除错误情况，然后将 <code>(</code> 入栈保存，将 <code>)</code> 入栈匹配前一个元素是否是 <code>(</code> ，如果是，则 <code>pop()</code> 前一个元素 <code>(</code>，如果不是，则 <code>push()</code> 这个 <code>)</code> 入栈，最终查看栈是否为空，若是则检验成功，否则失败。   </p>
<p><strong>方法1：使用前面定义的 Stack 类</strong><br>这里使用前面题目中定义的 <code>Stack</code> 类。   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 检验圆括号顺序的有效性</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;String&#125;</span> </span>str </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">validParentheses</span> (<span class="params">str</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!str || str.length === <span class="number">0</span> || str[<span class="number">0</span>] === <span class="string">&#x27;)&#x27;</span>) <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> stack = <span class="keyword">new</span> Stack()</span><br><span class="line">    str.split(<span class="string">&#x27;&#x27;</span>).forEach(<span class="function"><span class="params">char</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> status = stack.peek() === <span class="string">&#x27;(&#x27;</span> &amp;&amp; char === <span class="string">&#x27;)&#x27;</span></span><br><span class="line">        status ? stack.pop() : stack.push(char)</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> stack.isEmpty()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p><strong>方法2：出入栈操作</strong>   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 检验圆括号顺序的有效性</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;String&#125;</span> </span>str </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">validParentheses</span> (<span class="params">str</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!str || str.length === <span class="number">0</span> || str[<span class="number">0</span>] === <span class="string">&#x27;)&#x27;</span>) <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> arr = []</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; str.length ; i++)&#123;</span><br><span class="line">        str[i] === <span class="string">&#x27;(&#x27;</span> ? arr.push(str[i]) : arr.pop()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> arr.length === <span class="number">0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="五、改造题二，添加一个-min-函数来获得栈中最小元素"><a href="#五、改造题二，添加一个-min-函数来获得栈中最小元素" class="headerlink" title="五、改造题二，添加一个 min 函数来获得栈中最小元素"></a>五、改造题二，添加一个 min 函数来获得栈中最小元素</h2><table>
<thead>
<tr>
<th>步骤</th>
<th>数据栈</th>
<th>辅助栈</th>
<th>最小值</th>
</tr>
</thead>
<tbody><tr>
<td>1.push 3</td>
<td>3</td>
<td>0</td>
<td>3</td>
</tr>
<tr>
<td>2.push 4</td>
<td>3, 4</td>
<td>0, 0</td>
<td>3</td>
</tr>
<tr>
<td>3.push 2</td>
<td>3, 4, 2</td>
<td>0, 0, 2</td>
<td>2</td>
</tr>
<tr>
<td>4.push 1</td>
<td>3, 4, 2 ,1</td>
<td>0, 0, 2, 3</td>
<td>1</td>
</tr>
<tr>
<td>5.pop</td>
<td>3, 4, 2</td>
<td>0, 0, 2</td>
<td>2</td>
</tr>
<tr>
<td>6.pop</td>
<td>3, 4</td>
<td>0, 0</td>
<td>3</td>
</tr>
<tr>
<td>7.push</td>
<td>3, 4 ,0</td>
<td>0, 0, 2</td>
<td>0</td>
</tr>
</tbody></table>
<p>使用示例如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> stack = <span class="keyword">new</span> Stack();</span><br><span class="line">stack.push(<span class="number">3</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;After push 3, Min item is&#x27;</span>, stack.min());</span><br><span class="line">stack.push(<span class="number">4</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;After push 4, Min item is&#x27;</span>, stack.min());</span><br><span class="line">stack.push(<span class="number">2</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;After push 2, Min item is&#x27;</span>, stack.min());</span><br><span class="line">stack.push(<span class="number">1</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;After push 1, Min item is&#x27;</span>, stack.min());</span><br><span class="line">stack.pop();</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;After pop, Min item is&#x27;</span>, stack.min());</span><br><span class="line">stack.pop();</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;After pop, Min item is&#x27;</span>, stack.min());</span><br><span class="line">stack.push(<span class="number">0</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;After push 0, Min item is&#x27;</span>, stack.min());</span><br></pre></td></tr></table></figure>

<p><strong>提示：利用辅助栈（Web 端可利用数组），每次对栈 push/pop 元素时，也同时更新辅助栈（存储最小元素的位置）</strong>   </p>
<p><strong>方法1：小操作</strong>   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Stack</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.items = [];</span><br><span class="line">    <span class="built_in">this</span>.minIndexStack = [];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">push</span>(<span class="params">element</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.items.push(element);</span><br><span class="line">    <span class="keyword">let</span> minLen = <span class="built_in">this</span>.minIndexStack.length;</span><br><span class="line">    <span class="keyword">let</span> minItemIndex = <span class="built_in">this</span>.minIndexStack[minLen - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">if</span>(minLen === <span class="number">0</span> || <span class="built_in">this</span>.items[minItemIndex] &gt; item) &#123;</span><br><span class="line">      <span class="built_in">this</span>.minIndexStack.push(<span class="built_in">this</span>.items.length - <span class="number">1</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="built_in">this</span>.minIndexStack.push(minItemIndex);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">pop</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.minIndexStack.pop();</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.items.pop();</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="title">min</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> len = <span class="built_in">this</span>.minIndexStack.length;</span><br><span class="line">    <span class="keyword">return</span> (len &gt; <span class="number">0</span> &amp;&amp; <span class="built_in">this</span>.items[<span class="built_in">this</span>.minIndexStack[len - <span class="number">1</span>]]) || <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">peek</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.items[<span class="built_in">this</span>.items.length - <span class="number">1</span>];</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 省略其它方法</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p><strong>方法2：与方法1中push实现的差异</strong>   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Stack</span> </span>&#123;</span><br><span class="line">    <span class="title">constructor</span> (<span class="params"></span>)&#123;</span><br><span class="line">        <span class="built_in">this</span>.items = [] <span class="comment">// 数据栈</span></span><br><span class="line">        <span class="built_in">this</span>.arr = []   <span class="comment">// 辅助栈</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="title">push</span>(<span class="params"> element </span>)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.items.push(element)</span><br><span class="line">        <span class="keyword">let</span> min = <span class="built_in">Math</span>.min(...this.items)</span><br><span class="line">        <span class="built_in">this</span>.arr.push( min === element ? <span class="built_in">this</span>.size() - <span class="number">1</span> : <span class="number">0</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="title">pop</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.arr.pop()</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.items.pop()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="title">peek</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.items[<span class="built_in">this</span>.items.length - <span class="number">1</span>]</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="title">isEmpty</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.items.length === <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="title">clear</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.items = []</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="title">size</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.items.length</span><br><span class="line">    &#125;</span><br><span class="line">    min ()&#123;</span><br><span class="line">        <span class="keyword">let</span> last = <span class="built_in">this</span>.arr[<span class="built_in">this</span>.arr.length - <span class="number">1</span>]</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.items[last]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="下周预告"><a href="#下周预告" class="headerlink" title="下周预告"></a>下周预告</h2><p>下周将练习<strong>队列（Queue）</strong> 的题目，开始翻起算法书籍学习咯。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/04/14/156-%E3%80%90%E7%AE%97%E6%B3%95%E3%80%91%E6%AF%8F%E5%91%A8%E4%B8%80%E7%BB%83%E4%B9%8B%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%EF%BC%88Stack%EF%BC%89/" data-id="ckts3ejtd003j4d9khfjahtr8" data-title="156-【算法】每周一练之数据结构与算法（Stack）" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/" rel="tag">JavaScript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" rel="tag">前端开发</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8E%9F%E5%88%9B/" rel="tag">原创</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-155-【正则表达式】《JavaScript正则表达式迷你书》知识点小抄本" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/03/16/155-%E3%80%90%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E3%80%91%E3%80%8AJavaScript%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%BF%B7%E4%BD%A0%E4%B9%A6%E3%80%8B%E7%9F%A5%E8%AF%86%E7%82%B9%E5%B0%8F%E6%8A%84%E6%9C%AC/" class="article-date">
  <time class="dt-published" datetime="2019-03-16T12:55:43.000Z" itemprop="datePublished">2019-03-16</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/03/16/155-%E3%80%90%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E3%80%91%E3%80%8AJavaScript%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%BF%B7%E4%BD%A0%E4%B9%A6%E3%80%8B%E7%9F%A5%E8%AF%86%E7%82%B9%E5%B0%8F%E6%8A%84%E6%9C%AC/">155-【正则表达式】《JavaScript正则表达式迷你书》知识点小抄本</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><img src="http://images.pingan8787.com/cutejavascript-reg.png" alt="reg"></p>
<h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>这周开始学习<strong>老姚</strong>大佬的<a target="_blank" rel="noopener" href="https://github.com/qdlaoyao/js-regex-mini-book">《JavaScript 正则表达式迷你书》</a> ， 然后习惯性的看完一遍后，整理一下知识点，便于以后自己重新复习。   </p>
<p>我个人觉得：自己整理下来的资料，对于知识重现，效果不错。   </p>
<p>感谢原书作者<strong>老姚</strong>，本文无意抄袭，只是作为自己知识点的整理，后续也会整理到自己的 JavaScript知识库——<a target="_blank" rel="noopener" href="http://js.pingan8787.com/">《Cute-JavaScript》</a> 网站中。 </p>
<p><strong>另外，请读者们注意，这篇文章是知识点的整理，方便复习，所以不会介绍太详细，因为毕竟原书写得非常棒，刚入门的朋友，我还是建议看下原书。</strong>   </p>
<p><strong>然后可以看看这篇文章，来回顾重要知识点。</strong>   </p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/qdlaoyao/js-regex-mini-book">《JavaScript 正则表达式迷你书》</a></li>
<li><a target="_blank" rel="noopener" href="http://js.pingan8787.com/">《Cute-JavaScript》</a></li>
</ul>
<h3 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h3><ul>
<li>一、正则表达式字符匹配</li>
<li>二、正则表达式位置匹配</li>
<li>三、正则表达式括号的使用</li>
<li>四、正则表达式回溯法原理</li>
<li>五、正则表达式的拆分</li>
<li>六、正则表达式的构建</li>
<li>七、正则表达式编程</li>
</ul>
<h3 id="文章推荐（补充中）"><a href="#文章推荐（补充中）" class="headerlink" title="文章推荐（补充中）"></a>文章推荐（补充中）</h3><ul>
<li><a target="_blank" rel="noopener" href="https://juejin.im/post/5965943ff265da6c30653879">老姚 —— JS正则表达式完整教程</a></li>
<li><a target="_blank" rel="noopener" href="https://juejin.im/entry/581efdb7da2f60005d00ed65">常见的正则表达式可视化描述</a></li>
</ul>
<h3 id="工具推荐"><a href="#工具推荐" class="headerlink" title="工具推荐"></a>工具推荐</h3><ul>
<li><a target="_blank" rel="noopener" href="https://jex.im/regulex/#!flags=&re=%5E(a%7Cb)*%3F%24">Regulex</a></li>
<li><a target="_blank" rel="noopener" href="https://rubular.com/r/xfQHocREGj">Rubular</a></li>
</ul>
<h2 id="一、正则表达式字符匹配"><a href="#一、正则表达式字符匹配" class="headerlink" title="一、正则表达式字符匹配"></a>一、正则表达式字符匹配</h2><p>原书这么一句话，特别棒：<strong>正则表达式是匹配模式，要么匹配字符，要么匹配位置</strong>，要记住。   </p>
<h3 id="1-两种模糊匹配"><a href="#1-两种模糊匹配" class="headerlink" title="1. 两种模糊匹配"></a>1. 两种模糊匹配</h3><p>正则表达式的强大在于它的<strong>模糊匹配</strong>，这里介绍两个方向上的“模糊”：横向模糊和纵向模糊。   </p>
<ul>
<li>横向模糊匹配</li>
</ul>
<p>即一个正则可匹配的字符串长度不固定，可以是多种情况。   </p>
<p>如 <code>/ab&#123;2,5&#125;c/</code> 表示匹配： 第一个字符是 <code>&quot;a&quot;</code> ，然后是 2 - 5 个字符 <code>&quot;b&quot;</code> ，最后是字符 <code>&quot;c&quot;</code> ：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> r = <span class="regexp">/ab&#123;2,5&#125;c/g</span>;</span><br><span class="line"><span class="keyword">let</span> s = <span class="string">&quot;abc abbc abbbc abbbbbbc&quot;</span>;</span><br><span class="line">s.match(r); <span class="comment">// [&quot;abbc&quot;, &quot;abbbc&quot;]</span></span><br></pre></td></tr></table></figure>

<ul>
<li>纵向模糊匹配</li>
</ul>
<p>即一个正则可匹配某个不确定的字符，可以有多种可能。   </p>
<p>如 <code>/[abc]/</code> 表示匹配 <code>&quot;a&quot;, &quot;b&quot;, &quot;c&quot;</code> 中任意一个。   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> r = <span class="regexp">/a[123]b/g</span>;</span><br><span class="line"><span class="keyword">let</span> s = <span class="string">&quot;a0b a1b a4b&quot;</span>;</span><br><span class="line">s.match(r); <span class="comment">// [&quot;a1b&quot;]</span></span><br></pre></td></tr></table></figure>

<h3 id="2-字符组"><a href="#2-字符组" class="headerlink" title="2. 字符组"></a>2. 字符组</h3><ul>
<li>范围表示法</li>
</ul>
<p>可以指定字符范围，比如 <code>[1234abcdUVWXYZ]</code> 就可以表示成 <code>[1-4a-dU-Z]</code> ，使用 <code>-</code> 来进行缩写。   </p>
<p>如果要匹配 <code>&quot;a&quot;, &quot;-&quot;, &quot;z&quot;</code> 中任意一个字符，可以这么写： <code>[-az]</code> 或 <code>[a\-z]</code> 或 <code>[az-]</code> 。   </p>
<ul>
<li>排除字符组</li>
</ul>
<p>即需要排除某些字符时使用，通过在字符组第一个使用 <code>^</code> 来表示取反，如 <code>[^abc]</code> 就表示匹配除了 <code>&quot;a&quot;, &quot;b&quot;, &quot;c&quot;</code> 的任意一个字符。   </p>
<ul>
<li>常见简写形式</li>
</ul>
<table>
<thead>
<tr>
<th align="center">字符组</th>
<th>具体含义</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code>\d</code></td>
<td>表示 <code>[0-9]</code>，表示一位数字。</td>
</tr>
<tr>
<td align="center"><code>\D</code></td>
<td>表示 <code>[^0-9]</code>，表示除数字外的任意字符。</td>
</tr>
<tr>
<td align="center"><code>\w</code></td>
<td>表示 <code>[0-9a-zA-Z_]</code>，表示数字、大小写字母和下划线。</td>
</tr>
<tr>
<td align="center"><code>\W</code></td>
<td>表示 <code>[^0-9a-zA-Z_]</code>，表示非单词字符。</td>
</tr>
<tr>
<td align="center"><code>\s</code></td>
<td>表示 <code>[\t\v\n\r\f]</code>，表示空白符，包含空格、水平制表符、垂直制表符、换行符、回车符、换页符。</td>
</tr>
<tr>
<td align="center"><code>\S</code></td>
<td>表示 <code>[^\t\v\n\r\f]</code>，表示非空白字符。</td>
</tr>
<tr>
<td align="center"><code>.</code></td>
<td>表示 <code>[^\n\r\u2028\u2029]</code> 。通配符，表示几乎任意字符。换行符、回车符、行分隔符和段分隔符除外。</td>
</tr>
</tbody></table>
<p>然后表示<strong>任意字符</strong>，就可以使用 <code>[\d\D]</code>、<code>[\w\W]</code>、<code>[\s\S]</code> 和 <code>[^]</code> 任意一个。   </p>
<h3 id="3-量词"><a href="#3-量词" class="headerlink" title="3. 量词"></a>3. 量词</h3><p>量词也称重复，常用简写如下：</p>
<table>
<thead>
<tr>
<th align="center">量词</th>
<th>具体含义</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code>&#123;m,&#125;</code></td>
<td>表示至少出现 m 次。</td>
</tr>
<tr>
<td align="center"><code>&#123;m&#125;</code></td>
<td>等价于 <code>&#123;m, m&#125;</code> ，表示出现 m 次。</td>
</tr>
<tr>
<td align="center"><code>?</code></td>
<td>等价于 <code>&#123;0, 1&#125;</code> ，表示出现或不出现。</td>
</tr>
<tr>
<td align="center"><code>+</code></td>
<td>等价于 <code>&#123;1, &#125;</code> ，表示至少出现1次。</td>
</tr>
<tr>
<td align="center"><code>*</code></td>
<td>等价于 <code>&#123;0, &#125;</code> ，表示出现任意次，也有可能不出现。</td>
</tr>
</tbody></table>
<ul>
<li>贪婪匹配和惰性匹配</li>
</ul>
<p>在正则 <code>/\d&#123;2,4&#125;/</code> ，表示数字连续出现 2 - 4 次，可以匹配到 2 位、 3 位、4 位连续数字。   </p>
<p>但是在 <strong>贪婪匹配</strong> 如 <code>/\d&#123;2,4&#125;/g</code> ，会<strong>尽可能多</strong>匹配，如超过 4 个，就只匹配 4 个，如有 3 个，就匹配 3 位。   </p>
<p>而在 <strong>惰性匹配</strong> 如 <code>/\d&#123;2,4&#125;?/g</code> ，会 <strong>尽可能少</strong> 匹配，如超过 2 个，就只匹配 2 个，不会继续匹配下去。  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> r1 = <span class="regexp">/\d&#123;2,4&#125;/g</span>;</span><br><span class="line"><span class="keyword">let</span> r2 = <span class="regexp">/\d&#123;2,4&#125;?/g</span>;</span><br><span class="line"><span class="keyword">let</span> s  = <span class="string">&quot;123 1234 12345&quot;</span>; </span><br><span class="line">s.match(r1); <span class="comment">// [&quot;123&quot;, &quot;1234&quot;, &quot;1234&quot;]</span></span><br><span class="line">s.match(r2); <span class="comment">// [&quot;12&quot;, &quot;12&quot;, &quot;34&quot;, &quot;12&quot;, &quot;34&quot;]</span></span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="center">惰性量词</th>
<th align="center">贪婪量词</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code>&#123;m,m&#125;?</code></td>
<td align="center"><code>&#123;m,m&#125;</code></td>
</tr>
<tr>
<td align="center"><code>&#123;m,&#125;?</code></td>
<td align="center"><code>&#123;m,&#125;</code></td>
</tr>
<tr>
<td align="center"><code>??</code></td>
<td align="center"><code>?</code></td>
</tr>
<tr>
<td align="center"><code>+?</code></td>
<td align="center"><code>+</code></td>
</tr>
<tr>
<td align="center"><code>*?</code></td>
<td align="center"><code>*</code></td>
</tr>
</tbody></table>
<h3 id="4-多选分支"><a href="#4-多选分支" class="headerlink" title="4. 多选分支"></a>4. 多选分支</h3><p>即提供多个子匹配模式任选一个，使用 <code>|</code>(管道符)分隔，由于分支结构也是惰性，即匹配上一个后，就不会继续匹配后续的。   </p>
<p>格式如：<code>(r1|r2|r3)</code>，我们就可以使用 <code>/leo|pingan/</code> 来匹配 <code>&quot;leo&quot;</code> 和 <code>&quot;pingan&quot;</code>。  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> r = <span class="regexp">/leo|pingan/g</span>;</span><br><span class="line"><span class="keyword">let</span> s = <span class="string">&quot;leo cool,pingan good.&quot;</span>;</span><br><span class="line">s.match(r);<span class="comment">// [&quot;leo&quot;, &quot;pingan&quot;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 多选分支的惰性表现</span></span><br><span class="line"><span class="keyword">let</span> r1 = <span class="regexp">/leo|leooo/g</span>;</span><br><span class="line"><span class="keyword">let</span> r2 = <span class="regexp">/leooo|leo/g</span>;</span><br><span class="line"><span class="keyword">let</span> s  = <span class="string">&quot;leooo&quot;</span>;</span><br><span class="line">s.match(r1);<span class="comment">// [&quot;leo&quot;]</span></span><br><span class="line">s.match(r2);<span class="comment">// [&quot;leooo&quot;]</span></span><br></pre></td></tr></table></figure>

<h3 id="5-案例分析"><a href="#5-案例分析" class="headerlink" title="5. 案例分析"></a>5. 案例分析</h3><p>匹配字符，无非就是字符组、量词和分支结构的组合使用。   </p>
<ul>
<li>十六进制颜色值匹配</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> r = <span class="regexp">/#[0-9a-fA-F]&#123;6&#125;|#[0-9a-fA-F]&#123;3&#125;/g</span>;</span><br><span class="line"><span class="keyword">let</span> s = <span class="string">&quot;#ffaacc #Ff00DD #fFF #01d #9Gd&quot;</span>;</span><br><span class="line">s.match(r); <span class="comment">// [&quot;#ffaacc&quot;, &quot;#Ff00DD&quot;, &quot;#fFF&quot;, &quot;#01d&quot;]</span></span><br></pre></td></tr></table></figure>

<ul>
<li>时间和日期匹配</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 时间 12:23 或 01:09</span></span><br><span class="line"><span class="keyword">let</span> r = <span class="regexp">/^([01][0-9]|[2][0-3]):[0-5][0-9]$/</span>;  </span><br><span class="line">r.test(<span class="string">&quot;23:25&quot;</span>); <span class="comment">// true</span></span><br><span class="line">r.test(<span class="string">&quot;03:05&quot;</span>); <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 时间 12:23 或 1:9</span></span><br><span class="line"><span class="keyword">let</span> r = <span class="regexp">/^(0?[0-9]|1[0-9]|[2][0-3]):(0?[0-9]|[1-5][0-9])$/</span>;  </span><br><span class="line">r.test(<span class="string">&quot;23:25&quot;</span>); <span class="comment">// true</span></span><br><span class="line">r.test(<span class="string">&quot;03:05&quot;</span>); <span class="comment">// true</span></span><br><span class="line">r.test(<span class="string">&quot;3:5&quot;</span>);   <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 日期 yyyy-mm-dd</span></span><br><span class="line"><span class="keyword">let</span> r = <span class="regexp">/^[0-9]&#123;4&#125;-(0[1-9]|[1][0-2])-(0[1-9]|[12][0-9]|3[01])$/</span>;</span><br><span class="line">r.test(<span class="string">&quot;2019-09-19&quot;</span>); <span class="comment">// true</span></span><br><span class="line">r.test(<span class="string">&quot;2019-09-32&quot;</span>); <span class="comment">// false</span></span><br></pre></td></tr></table></figure>

<ul>
<li>Windows操作系统文件路径匹配</li>
</ul>
<p>盘符使用 <code>[a-zA-Z]:\\</code> ，这里需要注意 <code>\</code> 字符需要转义，并且盘符不区分大小写；<br>文件名或文件夹名，不能包含特殊字符，使用 <code>[^\\:*&lt;&gt;|&quot;?\r\n/]</code> 表示合法字符；<br>并且至少有一个字符，还有可以出现任意次，就可以使用 <code>([^\\:*&lt;&gt;|&quot;?\r\n/]+\\)*</code> 匹配任意个 <code>文件夹\</code>；<br>还有路径最后一部分可以是 <code>文件夹</code> ，即没有 <code>\</code> 于是表示成 <code>([^\\:*&lt;&gt;|&quot;?\r\n/]+)?</code>。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> r = <span class="regexp">/^[a-zA-Z]:\\([^\\:*&lt;&gt;|&quot;?\r\n/]+\\)*([^\\:*&lt;&gt;|&quot;?\r\n/]+)?$/</span>;</span><br><span class="line">r.test(<span class="string">&quot;C:\\document\\leo\\a.png&quot;</span>); <span class="comment">// true</span></span><br><span class="line">r.test(<span class="string">&quot;C:\\document\\leo\\&quot;</span>);      <span class="comment">// true</span></span><br><span class="line">r.test(<span class="string">&quot;C:\\document&quot;</span>);             <span class="comment">// true</span></span><br><span class="line">r.test(<span class="string">&quot;C:\\&quot;</span>);                     <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<ul>
<li>id匹配</li>
</ul>
<p>如提取 <code>&lt;div id=&quot;leo&quot; class=&quot;good&quot;&gt;&lt;/id&gt;</code> 中的 <code>id=&quot;leo&quot;</code> ：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> r1 = <span class="regexp">/id=&quot;.*&quot;/</span>;    <span class="comment">// tips1</span></span><br><span class="line"><span class="keyword">let</span> r2 = <span class="regexp">/id=&quot;.*?&quot;/</span>;   <span class="comment">// tips2</span></span><br><span class="line"><span class="keyword">let</span> r3 = <span class="regexp">/id=&quot;[^&quot;]*&quot;/</span>; <span class="comment">// tips3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> s  = <span class="string">&#x27;&lt;div id=&quot;leo&quot; class=&quot;good&quot;&gt;&lt;/id&gt;&#x27;</span>;</span><br><span class="line">s.match(r1)[<span class="number">0</span>];  <span class="comment">// id=&quot;leo&quot; class=&quot;good&quot;</span></span><br><span class="line">s.match(r2)[<span class="number">0</span>];  <span class="comment">// id=&quot;leo&quot;</span></span><br><span class="line">s.match(r3)[<span class="number">0</span>];  <span class="comment">// id=&quot;leo&quot;</span></span><br></pre></td></tr></table></figure>
<p><strong>tips1</strong>：由于 <code>.</code> 匹配双引号，且 <code>*</code> 贪婪，就会持续匹配到最后一个双引号结束。<br><strong>tips2</strong>：使用惰性匹配，但效率低，有<strong>回溯</strong>问题。<br><strong>tips3</strong>：最终优化。   </p>
<h2 id="二、正则表达式位置匹配"><a href="#二、正则表达式位置匹配" class="headerlink" title="二、正则表达式位置匹配"></a>二、正则表达式位置匹配</h2><p>位置匹配，就是要匹配每个字符两边的位置。    </p>
<p>在 <code>ES5</code> 中有6个位置： <code>^</code>，<code>$</code>，<code>\b</code>，<code>\B</code>，<code>(?=p)</code> 和 <code>(?!p)</code>。  </p>
<p>另外把位置理解成空字符是非常有用的：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/^^hello$$/.test(<span class="string">&#x27;hello&#x27;</span>);  <span class="comment">// true</span></span><br><span class="line"><span class="regexp">/^^^hello$$/</span>.test(<span class="string">&#x27;hello&#x27;</span>); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<h3 id="1-和"><a href="#1-和" class="headerlink" title="1. ^ 和 $"></a>1. ^ 和 $</h3><p><code>^</code> 匹配开头，多行中匹配行开头。<br><code>$</code> 匹配结尾，多行中匹配行结尾。   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;hello&quot;</span>.replace(<span class="regexp">/^|$/g</span>, <span class="string">&quot;#&quot;</span>); <span class="comment">// &quot;#hello#&quot;</span></span><br><span class="line"><span class="string">&quot;hello\nleo\nhaha&quot;</span>.replace(<span class="regexp">/^|$/gm</span>, <span class="string">&quot;#&quot;</span>);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">#hello#</span></span><br><span class="line"><span class="comment">#leo#</span></span><br><span class="line"><span class="comment">#haha#</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<p>多行匹配模式使用 <code>m</code> 修饰符。  </p>
<h3 id="2-b-和-B"><a href="#2-b-和-B" class="headerlink" title="2. \b 和 \B"></a>2. <code>\b</code> 和 <code>\B</code></h3><p><code>\b</code> 匹配单词边界，即 <code>\w</code> 和 <code>\W</code> 之间的位置，包括 <code>\w</code> 和 <code>^</code> 之间的位置，和 <code>\w</code> 和 <code>$</code> 之间的位置。<br><code>\B</code> 和  <code>\b</code> 相反，即非单词边界，匹配中除去 <code>\b</code>，剩下的都是 <code>\B</code> 的。<br>也就是 <code>\w</code> 与 <code>\w</code>、 <code>\W</code> 与 <code>\W</code>、<code>^</code> 与 <code>\W</code>，<code>\W</code> 与 <code>$</code> 之间的位置。。   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;[HI] Leo_1.mp4&quot;</span>.replace(<span class="regexp">/\b/g</span>,<span class="string">&quot;#&quot;</span>);</span><br><span class="line"><span class="comment">// &quot;[#HI#] #Leo_1#.#mp4#&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;[HI] Leo_1.mp4&quot;</span>.replace(<span class="regexp">/\B/g</span>,<span class="string">&quot;#&quot;</span>);</span><br><span class="line"><span class="comment">// &quot;#[H#I]# L#e#o#_#1.m#p#4&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="3-p-和-p"><a href="#3-p-和-p" class="headerlink" title="3. (?=p) 和 (?!p)"></a>3. <code>(?=p)</code> 和 <code>(?!p)</code></h3><p><code>p</code> 为一个子模式，即 <code>(?=p)</code> 匹配前面是 <code>p</code> 的位置，而 <code>(?!p)</code> 则匹配前面不是 <code>p</code> 的位置。   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;hello&quot;</span>.replace(<span class="regexp">/(?=l)/g</span>, <span class="string">&quot;#&quot;</span>);</span><br><span class="line"><span class="comment">// &quot;he#l#lo&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;hello&quot;</span>.replace(<span class="regexp">/(?!l)/g</span>, <span class="string">&quot;#&quot;</span>);</span><br><span class="line"><span class="comment">// &quot;#h#ell#o#&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="4-相关案例"><a href="#4-相关案例" class="headerlink" title="4. 相关案例"></a>4. 相关案例</h3><ul>
<li>匹配数字千位分隔符</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 匹配最后一个逗号</span></span><br><span class="line"><span class="string">&quot;12345678&quot;</span>.replace(<span class="regexp">/(?=\d&#123;3&#125;$)/g</span>, <span class="string">&quot;,&quot;</span>); <span class="comment">// &quot;12345,678&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 匹配所有逗号</span></span><br><span class="line"><span class="string">&quot;12345678&quot;</span>.replace(<span class="regexp">/(?=(\d&#123;3&#125;)+$)/g</span>, <span class="string">&quot;,&quot;</span>); <span class="comment">// &quot;12,345,678&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 匹配其余</span></span><br><span class="line"><span class="string">&quot;123456789&quot;</span>.replace(<span class="regexp">/(?=(\d&#123;3&#125;)+$)/g</span>, <span class="string">&quot;,&quot;</span>); <span class="comment">// &quot;,123,456,789&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 修改</span></span><br><span class="line"><span class="string">&quot;123456789&quot;</span>.replace(<span class="regexp">/(?!^)(?=(\d&#123;3&#125;)+$)/g</span>, <span class="string">&quot;,&quot;</span>); <span class="comment">// &quot;12,345,678&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 其他形式</span></span><br><span class="line"><span class="string">&quot;12345678 123456789&quot;</span>.replace(<span class="regexp">/(?!\b)(?=(\d&#123;3&#125;)+\b)/g</span>, <span class="string">&quot;,&quot;</span>); </span><br><span class="line"><span class="comment">// (?!\b) 等于 \B ，要求当前是一个位置，但不是 \b 前面的位置</span></span><br><span class="line"><span class="comment">// &quot;12,345,678 123,456,789&quot;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>数据格式化</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> num = <span class="number">1888</span>;</span><br><span class="line">num.toFixed(<span class="number">2</span>).replace(<span class="regexp">/\B(?=(\d&#123;3&#125;)+\b)/g</span>, <span class="string">&quot;,&quot;</span>).replace(<span class="regexp">/^/</span>,<span class="string">&quot;$$ &quot;</span>);</span><br><span class="line"><span class="comment">// &quot;$ 1,888.00&quot;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>验证密码</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 密码长度 6-12 位数字或字母</span></span><br><span class="line"><span class="keyword">let</span> r = <span class="regexp">/^[0-9A-Za-z]&#123;6,12&#125;$/</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 必须包含一个字符（数字） + 密码长度 6-12 位数字或字母</span></span><br><span class="line"><span class="keyword">let</span> r = <span class="regexp">/(?=.*[0-9])^[0-9A-Za-z]&#123;6,12&#125;$/</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 必须包含两个个字符（数字和小写字符）  + 密码长度 6-12 位数字或字母</span></span><br><span class="line"><span class="keyword">let</span> r = <span class="regexp">/(?=.*[0-9])(?=.*[a-z])^[0-9A-Za-z]&#123;6,12&#125;$/</span>;</span><br><span class="line"></span><br><span class="line">r.test(<span class="string">&quot;aa1234566&quot;</span>); <span class="comment">// true</span></span><br><span class="line">r.test(<span class="string">&quot;1234566&quot;</span>);   <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 密码长度 6-12 位数字或字母 </span></span><br><span class="line"><span class="comment">// 即 不能全是数字 或 不能全是大写或小写字母</span></span><br><span class="line"><span class="keyword">let</span> r = <span class="regexp">/(?!^[0-9]&#123;6,12&#125;$)(?!^[a-z]&#123;6,12&#125;$)(?!^[A-Z]&#123;6,12&#125;$)^[0-9A-Za-z]&#123;6,12&#125;$/</span>;</span><br></pre></td></tr></table></figure>

<h2 id="三、正则表达式括号的使用"><a href="#三、正则表达式括号的使用" class="headerlink" title="三、正则表达式括号的使用"></a>三、正则表达式括号的使用</h2><p>简单理解：括号提供了分组，便于我们使用它。   </p>
<p>通常有两种引用情况：在<strong>JS代码中引入</strong>，和<strong>在正则表达式中引入</strong>。   </p>
<p>分组和分支结构，主要是强调括号内是一个整体，即提供子表达式。   </p>
<ul>
<li>分组如 <code>/(ab)+/g</code> 匹配连续出现的 <code>ab</code>  。  </li>
<li>分支结构如 <code>/(a|b)+/g</code> 匹配出现的 <code>a</code> 或 <code>b</code> 表达式。  </li>
</ul>
<h3 id="1-分组引用"><a href="#1-分组引用" class="headerlink" title="1.分组引用"></a>1.分组引用</h3><p>如在日期匹配的时候，就可以这么改造：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 原来</span></span><br><span class="line"><span class="keyword">let</span> r = <span class="regexp">/\d&#123;4&#125;-\d&#123;2&#125;-\d&#123;2&#125;/</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 现在</span></span><br><span class="line"><span class="keyword">let</span> r = <span class="regexp">/(\d&#123;4&#125;)-(\d&#123;2&#125;)-(\d&#123;2&#125;)/</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>提取数据</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;2019-03-14&quot;</span>.match(r);</span><br><span class="line">r.exec(<span class="string">&quot;2019-03-14&quot;</span>);</span><br><span class="line"><span class="comment">// [&quot;2019-03-14&quot;, &quot;2019&quot;, &quot;03&quot;, &quot;14&quot;, index: 0, input: &quot;2019-03-14&quot;]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">RegExp</span>.$1; <span class="comment">// &quot;2019&quot;</span></span><br><span class="line"><span class="built_in">RegExp</span>.$2; <span class="comment">// &quot;03&quot;</span></span><br><span class="line"><span class="built_in">RegExp</span>.$3; <span class="comment">// &quot;14&quot;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>替换</li>
</ul>
<p>将 <code>yyyy-mm-dd</code> 转成 <code>mm/dd/yyyy</code>。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;2019-03-14&quot;</span>.replace(r, <span class="string">&quot;$2/$3/$1&quot;</span>);</span><br><span class="line"><span class="comment">// 等价于</span></span><br><span class="line"><span class="string">&quot;2019-03-14&quot;</span>.replace(r, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">RegExp</span>.$2 + <span class="string">&#x27;/&#x27;</span> + <span class="built_in">RegExp</span>.$3 + <span class="string">&#x27;/&#x27;</span> + <span class="built_in">RegExp</span>.$1;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="2-反向引用"><a href="#2-反向引用" class="headerlink" title="2. 反向引用"></a>2. 反向引用</h3><p>使用 <code>\n</code> 表示第 <code>n</code> 个分组，比如 <code>\1</code> 表示第 <code>1</code> 个分组：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> r = <span class="regexp">/\d&#123;4&#125;(-|\/|\.)\d&#123;2&#125;\1\d&#123;2&#125;/</span>;</span><br><span class="line">r.test(<span class="string">&quot;2019-03-15&quot;</span>);</span><br><span class="line">r.test(<span class="string">&quot;2019/03/15&quot;</span>);</span><br><span class="line">r.test(<span class="string">&quot;2019.03.15&quot;</span>);</span><br><span class="line">r.test(<span class="string">&quot;2019-03/15&quot;</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>多个括号嵌套</li>
</ul>
<p>按照开括号的顺序：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> r = <span class="regexp">/^((\d)(\d(\d)))\1\2\3\4$/</span>;</span><br><span class="line"><span class="keyword">let</span> s = <span class="string">&quot;1231231233&quot;</span>;</span><br><span class="line">r.test(s);</span><br><span class="line"><span class="built_in">console</span>.log([<span class="built_in">RegExp</span>.$1,<span class="built_in">RegExp</span>.$2,<span class="built_in">RegExp</span>.$3,<span class="built_in">RegExp</span>.$4]);</span><br><span class="line"><span class="comment">// [&quot;123&quot;, &quot;1&quot;, &quot;23&quot;, &quot;3&quot;]</span></span><br></pre></td></tr></table></figure>

<ul>
<li>特殊情况</li>
</ul>
<p><code>\10</code> 表示的是第 10 个分组，若要匹配 <code>\</code> 和 <code>0</code> 时，使用 <code>(?:\1)0</code> 或 <code>\1(?:0)</code>。   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> r = <span class="regexp">/(1)(2)(3)(4)(5)(6)(7)(8)(9)(#) \10+/</span>;</span><br><span class="line"><span class="keyword">let</span> s = <span class="string">&quot;123456789# #####&quot;</span>;</span><br><span class="line">r.test(s);  <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<ul>
<li>当引用不存在的分组</li>
</ul>
<p>如匹配 <code>\2</code> 是前面不存在，则匹配 <code>\2</code> 本身，即对 <code>2</code> 的转义，不同浏览器可能不同：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> r = <span class="regexp">/\1\2\3\4/</span>;</span><br><span class="line">r.test(<span class="string">&quot;\1\2\3\4&quot;</span>);  <span class="comment">// true</span></span><br><span class="line"><span class="string">&quot;\1\2\3\4&quot;</span>.split(<span class="string">&#x27;&#x27;</span>);<span class="comment">// [&quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;]</span></span><br></pre></td></tr></table></figure>

<ul>
<li>分组后面有量词</li>
</ul>
<p>当分组后面有量词的话，则捕获的是最后一次的匹配：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;12345&quot;</span>.match(<span class="regexp">/(\d)+/</span>); <span class="comment">// [&quot;12345&quot;, &quot;5&quot;, index: 0, input: &quot;12345&quot;]</span></span><br><span class="line"></span><br><span class="line"><span class="regexp">/(\d)+ \1/</span>.test(<span class="string">&quot;12345 1&quot;</span>); <span class="comment">// false</span></span><br><span class="line"><span class="regexp">/(\d)+ \1/</span>.test(<span class="string">&quot;12345 5&quot;</span>); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<h3 id="3-相关案例"><a href="#3-相关案例" class="headerlink" title="3. 相关案例"></a>3. 相关案例</h3><p>这里只写出核心代码。 </p>
<ul>
<li>模拟字符串 <code>trim</code> 方法</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1 匹配首尾空白符，替换成空字符</span></span><br><span class="line"><span class="string">&quot;  aaa   &quot;</span>.replace(<span class="regexp">/^\s+|\s+$/g</span>, <span class="string">&quot;&quot;</span>);      <span class="comment">// &quot;aaa&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2 匹配整个字符串，再用引用提取对应数据</span></span><br><span class="line"><span class="string">&quot;  aaa   &quot;</span>.replace(<span class="regexp">/^\s*(.*?)\s*$/g</span>, <span class="string">&quot;$1&quot;</span>);<span class="comment">// &quot;aaa&quot;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>每个单词首字母大写</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;hi leo hi boy!&quot;</span>.toLowerCase().replace(</span><br><span class="line">    <span class="regexp">/(?:^|\s)\w/g</span>, </span><br><span class="line">    <span class="function"><span class="params">c</span> =&gt;</span> c.toUpperCase()</span><br><span class="line">);</span><br><span class="line"><span class="comment">// &quot;Hi Leo Hi Boy!&quot;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>驼峰化 和 中划线化</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;-leo-and-pingan&quot;</span>.replace(<span class="regexp">/[-_\s]+(.)?/g</span>,</span><br><span class="line">    <span class="function">(<span class="params">match, c</span>) =&gt;</span> c ? c.toUpperCase() : <span class="string">&#x27;&#x27;</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">// &quot;LeoAndPingan&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;LeoAndPingan&quot;</span>.replace(<span class="regexp">/([A-Z])/g</span>, <span class="string">&quot;-$1&quot;</span>).replace(</span><br><span class="line">    <span class="regexp">/[-_\s]+g/</span>,<span class="string">&quot;-&quot;</span></span><br><span class="line">).toLowerCase();</span><br><span class="line"><span class="comment">// &quot;-leo-and-pingan&quot;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>匹配成对HTML标签</li>
</ul>
<p>匹配成对标签 <code>&lt;h1&gt;leo&lt;\h1&gt;</code>，而不匹配不成对标签 <code>&lt;h1&gt;leo&lt;\h2&gt;</code>。 </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> r = <span class="regexp">/&lt;([^&gt;]+)&gt;[\d\D]*&lt;\/\1&gt;/</span>;</span><br><span class="line">r.test(<span class="string">&quot;&lt;h1&gt;leo leo leo&lt;/h1&gt;&quot;</span>);  <span class="comment">// true</span></span><br><span class="line">r.test(<span class="string">&quot;&lt;a&gt;leo leo leo&lt;/a&gt;&quot;</span>);    <span class="comment">// true</span></span><br><span class="line">r.test(<span class="string">&quot;&lt;h1&gt;leo leo leo&lt;/h2&gt;&quot;</span>);  <span class="comment">// false</span></span><br></pre></td></tr></table></figure>


<h2 id="四、正则表达式回溯法原理"><a href="#四、正则表达式回溯法原理" class="headerlink" title="四、正则表达式回溯法原理"></a>四、正则表达式回溯法原理</h2><p>概念理解起来比较容易。<br>比如用 <code>/ab&#123;1,3&#125;c/</code> 去匹配下面两个字符串。   </p>
<ul>
<li><p>当匹配 <code>abbbc</code>，按顺序匹配，到了第 3 个 <code>b</code> 后，直接匹配 <code>c</code>，这样就没有回溯。   </p>
</li>
<li><p>当匹配 <code>abbc</code>，按顺序匹配，到了第 2 个 <code>b</code> 后，由于规则是 <code>b&#123;1,3&#125;</code> ，则会继续往下匹配，然后发现下一位是 <code>c</code>，于是回退到前一个位置，重新匹配，这就是回溯。   </p>
</li>
</ul>
<p>另外像 <code>/&quot;.*&quot;/</code> 来匹配 <code>&quot;abc&quot;de</code> 的话，就会有三个回溯情况，为了减少不必要的回溯，我们可以把正则修改为 <code>/&quot;[^&quot;]*&quot;/</code>。</p>
<p><strong>介绍</strong>   </p>
<p>回溯法，也称试探法，本质上是深度优先探索算法，基本思路是：匹配过程中后退到之前某一步重新探索的过程。</p>
<h3 id="1-常见的回溯形式"><a href="#1-常见的回溯形式" class="headerlink" title="1. 常见的回溯形式"></a>1. 常见的回溯形式</h3><ul>
<li>贪婪量词</li>
</ul>
<p>多个贪婪量词挨着存在，并相互冲突时，会看匹配顺序，深度优先搜索：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;12345&quot;</span>.match(<span class="regexp">/(\d&#123;1,3&#125;)(\d&#123;1,3&#125;)/</span>);</span><br><span class="line"><span class="comment">//  [&quot;12345&quot;, &quot;123&quot;, &quot;45&quot;, index: 0, input: &quot;12345&quot;]</span></span><br></pre></td></tr></table></figure>

<ul>
<li>惰性量词</li>
</ul>
<p>有时候会因为回溯，导致实际惰性量词匹配到的不是最少的数量：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;12345&quot;</span>.match(<span class="regexp">/(\d&#123;1,3&#125;?)(\d&#123;1,3&#125;)/</span>);</span><br><span class="line"><span class="comment">// 没有回溯的情况 [&quot;1234&quot;, &quot;1&quot;, &quot;234&quot;, index: 0, input: &quot;12345&quot;]</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;12345&quot;</span>.match(<span class="regexp">/^\d&#123;1,3&#125;?\d&#123;1,3&#125;$/</span>);</span><br><span class="line"><span class="comment">// 有回溯的情况 [&quot;12345&quot;, index: 0, input: &quot;12345&quot;]</span></span><br></pre></td></tr></table></figure>

<ul>
<li>分支结构</li>
</ul>
<p>分支机构，如果一个分支整体不匹配，会继续尝试剩下分支，也可以看成一种回溯。   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;candy&quot;</span>.match(<span class="regexp">/can|candy/</span>); <span class="comment">// [&quot;can&quot;, index: 0, input: &quot;candy&quot;]</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;candy&quot;</span>.match(<span class="regexp">/^(?:can|candy)$/</span>); <span class="comment">// [&quot;candy&quot;, index: 0, input: &quot;candy&quot;]</span></span><br></pre></td></tr></table></figure>

<h3 id="2-本章小结"><a href="#2-本章小结" class="headerlink" title="2. 本章小结"></a>2. 本章小结</h3><p>简单总结：一个个尝试，直到，要么后退某一步整体匹配成功，要么最后试完发现整体不匹配。   </p>
<ul>
<li><p>贪婪量词：买衣服砍价，价格高了，便宜点，再便宜点。  </p>
</li>
<li><p>懒惰量词：卖衣服加价，价格低了，多给点，再多给点。</p>
</li>
<li><p>分支结构：货比三家，一家不行换一家，不行再换。</p>
</li>
</ul>
<h2 id="五、正则表达式的拆分"><a href="#五、正则表达式的拆分" class="headerlink" title="五、正则表达式的拆分"></a>五、正则表达式的拆分</h2><p>拆分正则代码块，是理解正则的关键。   </p>
<p>在 JavaScrip 正则表达式有以下结构：   </p>
<ul>
<li>字面量： 匹配一个具体字符，如 <code>a</code> 匹配字符 <code>a</code>。</li>
<li>字符组： 匹配一个有多种可能性的字符，如 <code>[0-9]</code> 匹配任意一个数字。  </li>
<li>量词： 匹配一个连续出现的字符，如 <code>a&#123;1,3&#125;</code> 匹配连续最多出现 3 次的<code>a</code>字符。  </li>
<li>锚： 匹配一个位置，如 <code>^</code> 匹配字符串的开头。  </li>
<li>分组： 匹配一个整体，如 <code>(ab)</code> 匹配 <code>ab</code> 两个字符连续出现。   </li>
<li>分支： 匹配一个或多个表达式，如 <code>ab|bc</code> 匹配 <code>ab</code> 或 <code>bc</code> 字符。   </li>
</ul>
<p>另外还有以下操作符：   </p>
<table>
<thead>
<tr>
<th align="center">优先级</th>
<th align="center">操作符描述</th>
<th>操作符</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="center">转义符</td>
<td><code>\</code></td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">括号和方括号</td>
<td><code>(...)</code>/<code>(?:...)</code>/<code>(?=...)</code>/<code>(?!...)</code>/<code>[...]</code></td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">量词限定符</td>
<td><code>&#123;m&#125;</code>/<code>&#123;m,n&#125;</code>/<code>&#123;m,&#125;</code>/<code>?</code>/<code>*</code>/<code>+</code></td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">位置和序列</td>
<td><code>^</code>/<code>$</code>/<code>\元字符</code>/<code>一般字符</code></td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">管道符</td>
<td>`</td>
</tr>
</tbody></table>
<p><strong>Tips</strong>：优先级从上到下，由高到低。  </p>
<h3 id="1-注意要点"><a href="#1-注意要点" class="headerlink" title="1. 注意要点"></a>1. 注意要点</h3><ul>
<li>匹配字符串整体</li>
</ul>
<p>不能写成 <code>/^abc|bcd$/</code> ，而是要写成 <code>/^(abc|bcd)$/</code>。</p>
<ul>
<li>量词连缀问题</li>
</ul>
<p>需要匹配：每个字符是 <code>a</code>/<code>b</code>/<code>c</code> 中其中一个，并且字符串长度是 3 的倍数：   </p>
<p>不能写成 <code>/^[abc]&#123;3&#125;+$/</code> ，而是要写成 <code>/([abc]&#123;3&#125;)+/</code>。  </p>
<ul>
<li>元字符转义问题</li>
</ul>
<p>元字符就是正则中的特殊字符，当匹配元字符就需要转义，如：    </p>
<p><code>^</code>、<code>$</code>、<code>.</code>、<code>*</code>、<code>+</code>、<code>?</code>、<code>|</code>、<code>\</code>、<code>/</code>、<code>(</code>、<code>)</code>、<code>[</code>、<code>]</code>、<code>&#123;</code>、<code>&#125;</code>、<code>=</code>、<code>!</code>、<code>:</code>、<code>-</code> 。   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// &quot;[abc]&quot;  =&gt; /\[abc\]/ 或者 /\[abc]/ </span></span><br><span class="line"><span class="comment">// &quot;&#123;1,3&#125;&quot;  =&gt; /\&#123;1\&#125;/ 或者 /\&#123;1&#125;/ 因为不构成字符组</span></span><br></pre></td></tr></table></figure>

<h3 id="2-案例分析"><a href="#2-案例分析" class="headerlink" title="2. 案例分析"></a>2. 案例分析</h3><ul>
<li>身份证号码</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/^(\d&#123;<span class="number">15</span>&#125;|\d&#123;<span class="number">17</span>&#125;)[\dxX]$/.test(<span class="string">&quot;390999199999999999&quot;</span>);<span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<ul>
<li>IPV4地址</li>
</ul>
<p>需要好好分析：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> r = <span class="regexp">/^((0&#123;0,2&#125;\d|0?\d&#123;2&#125;|1\d&#123;2&#125;|2[0-4]\d|25[0-5])\.)&#123;3&#125;(0&#123;0,2&#125;\d|0?\d&#123;2&#125;|1\d&#123;2&#125;|2[0-4]\d|25[0-5])$/</span></span><br></pre></td></tr></table></figure>


<h2 id="六、正则表达式的构建"><a href="#六、正则表达式的构建" class="headerlink" title="六、正则表达式的构建"></a>六、正则表达式的构建</h2><p>正则的构建需要考虑以下几点的平衡：  </p>
<ul>
<li>匹配预期的字符串</li>
<li>不匹配非预期的字符串</li>
<li>可读性和可维护性</li>
<li>效率</li>
</ul>
<p>我们还需要考虑这么几个问题：  </p>
<ul>
<li>是否需要使用正则  </li>
</ul>
<p>如能使用其他 API 简单快速解决问题就不需要使用正则：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;2019-03-16&quot;</span>.match(<span class="regexp">/^(\d&#123;4&#125;)-(\d&#123;2&#125;)-(\d&#123;2&#125;)/</span>); <span class="comment">// 间接获取 [&quot;2019&quot;, &quot;03&quot;, &quot;16&quot;]</span></span><br><span class="line"><span class="string">&quot;2019-03-16&quot;</span>.split(<span class="string">&quot;-&quot;</span>); <span class="comment">//  [&quot;2019&quot;, &quot;03&quot;, &quot;16&quot;]</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;?id=leo&quot;</span>.search(<span class="regexp">/\?/</span>); <span class="comment">// 0</span></span><br><span class="line"><span class="string">&quot;?id=leo&quot;</span>.indexOf(<span class="string">&quot;?&quot;</span>); <span class="comment">// 0</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;JavaScript&quot;</span>.match(<span class="regexp">/.&#123;4&#125;(.+)/</span>)[<span class="number">1</span>];  <span class="comment">// &quot;Script&quot;</span></span><br><span class="line"><span class="string">&quot;JavaScript&quot;</span>.substring(<span class="number">4</span>);          <span class="comment">// &quot;Script&quot;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>是否需要使用复杂正则</li>
</ul>
<p><code>/(?!^[0-9]&#123;6,12&#125;$)(?!^[a-z]&#123;6,12&#125;$)(?!^[A-Z]&#123;6,12&#125;$)^[0-9A-Za-z]&#123;6,12&#125;$/</code> </p>
<p>将这个正则拆分成多个小块，如下：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> regex1 = <span class="regexp">/^[0-9A-Za-z]&#123;6,12&#125;$/</span>;</span><br><span class="line"><span class="keyword">var</span> regex2 = <span class="regexp">/^[0-9]&#123;6,12&#125;$/</span>;</span><br><span class="line"><span class="keyword">var</span> regex3 = <span class="regexp">/^[A-Z]&#123;6,12&#125;$/</span>;</span><br><span class="line"><span class="keyword">var</span> regex4 = <span class="regexp">/^[a-z]&#123;6,12&#125;$/</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkPassword</span> (<span class="params">string</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!regex1.test(string)) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (regex2.test(string)) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (regex3.test(string)) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (regex4.test(string)) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-准确性"><a href="#1-准确性" class="headerlink" title="1. 准确性"></a>1. 准确性</h3><p>即需要匹配到预期目标，且不匹配非预期的目标。</p>
<ul>
<li>匹配固定电话</li>
</ul>
<p>如需要匹配下面固定电话号码，可以分别写出对应正则： </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">055188888888     =&gt; /^0\d&#123;2,3&#125;[1-9]\d&#123;6,7&#125;$/</span><br><span class="line">0551-88888888    =&gt; /^0\d&#123;2,3&#125;-[1-9]\d&#123;6,7&#125;$/</span><br><span class="line">(0551)88888888   =&gt; /^0\d&#123;2,3&#125;-[1-9]\d&#123;6,7&#125;$/</span><br></pre></td></tr></table></figure>

<p>然后合并：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> r = <span class="regexp">/^0\d&#123;2,3&#125;[1-9]\d&#123;6,7&#125;$|^0\d&#123;2,3&#125;-[1-9]\d&#123;6,7&#125;$|^\(0\d&#123;2,3&#125;\)[1-9]\d&#123;6,7&#125;$/</span></span><br></pre></td></tr></table></figure>

<p>然后提取公共部分：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> r = <span class="regexp">/^(0\d&#123;2,3&#125;|0\d&#123;2,3&#125;-|\(0\d&#123;2,3&#125;\))[1-9]\d&#123;6,7&#125;$/</span></span><br></pre></td></tr></table></figure>

<p>再优化：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> r = <span class="regexp">/^(0\d&#123;2,3&#125;-?|\(0\d&#123;2,3&#125;\))[1-9]\d&#123;6,7&#125;$/</span></span><br></pre></td></tr></table></figure>

<ul>
<li>匹配浮点数</li>
</ul>
<p>先确定，符号部分（<code>[+-]</code>）、整数部分（<code>\d+</code>）和小数部分（<code>\.\d+</code>）。   </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1.23、+1.23、-1.23  =&gt; /^[+-]?\d+\.\d+$/</span><br><span class="line">10、+10、-10        =&gt; /^[+-]?\d+$/</span><br><span class="line">.2、+.2、-.2        =&gt; /^[+-]?\.\d+$/</span><br></pre></td></tr></table></figure>

<p>整理后：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> r = <span class="regexp">/^[+-]?(\d+\.\d+|\d+|\.\d+)$/</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 考虑不匹配 +.2 或 -.2</span></span><br><span class="line"><span class="keyword">let</span> r = <span class="regexp">/^([+-])?(\d+\.\d+|\d+|\.\d+)$/</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 考虑不匹配 012 这类 0 开头的整数</span></span><br><span class="line"><span class="keyword">let</span> r = <span class="regexp">/^[+-]?(\d+)?(\.)?\d+$/</span>;</span><br></pre></td></tr></table></figure>

<h3 id="2-效率"><a href="#2-效率" class="headerlink" title="2. 效率"></a>2. 效率</h3><p>正则表达式运行过程：  </p>
<ol>
<li>编译  </li>
<li>设定起始位置  </li>
<li>尝试匹配  </li>
<li>若匹配失败则返回前一步重新匹配  </li>
<li>返回匹配成功失败的结果     </li>
</ol>
<p>我们常常优化对 <code>3 和 4</code> 步进行优化：   </p>
<ul>
<li>使用具体字符组替代通配符，消除回溯</li>
</ul>
<p>如 <code> /&quot;[^&quot;]*&quot;/</code> 代替 <code>/&quot;.*?&quot;/</code>。  </p>
<ul>
<li>使用非捕获型分组</li>
</ul>
<p>当不需要使用分组引用和反向引用时，此时可以使用非捕获分组。</p>
<p>如 <code>/^[-]?(?:\d\.\d+|\d+|\.\d+)$/</code> 代替 <code>/^[-]?(\d\.\d+|\d+|\.\d+)$/</code>。</p>
<ul>
<li>独立出确定字符</li>
</ul>
<p>加快判断是否匹配失败，进而加快移位的速度。</p>
<p>如 <code>/aa*/</code> 代替 <code>/a+/</code>。</p>
<ul>
<li>提取分支公共部分</li>
</ul>
<p>减少匹配过程中可消除的重复。</p>
<p>如 <code>/^(?:abc|def)/</code> 代替 <code>/^abc|^def/</code>。</p>
<ul>
<li>减少分支的数量，缩小它们的范围</li>
</ul>
<p>如 <code>/rea?d/</code> 代替 <code>/red|read/</code>。</p>
<h2 id="七、正则表达式编程"><a href="#七、正则表达式编程" class="headerlink" title="七、正则表达式编程"></a>七、正则表达式编程</h2><p>这里要掌握正则表达式怎么用，通常会有这么四个操作：  </p>
<ul>
<li>验证</li>
<li>切分</li>
<li>提取</li>
<li>替换</li>
</ul>
<h3 id="1-四种操作"><a href="#1-四种操作" class="headerlink" title="1. 四种操作"></a>1. 四种操作</h3><ul>
<li>验证</li>
</ul>
<p><strong>匹配</strong>本质上是<strong>查找</strong>，我们可以借助相关API操作：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 检查字符串是否包含数字</span></span><br><span class="line"><span class="keyword">let</span> r = <span class="regexp">/\d/</span>, s = <span class="string">&quot;abc123&quot;</span>;</span><br><span class="line">!!s.search(r); <span class="comment">// true</span></span><br><span class="line">r.test(s);     <span class="comment">// true</span></span><br><span class="line">!!s.match(r);  <span class="comment">// true</span></span><br><span class="line">!!r.exec(s);   <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<ul>
<li>切分</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;leo,pingan&quot;</span>.split(<span class="regexp">/,/</span>); <span class="comment">// [&quot;leo&quot;, &quot;pingan&quot;]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> r = <span class="regexp">/\D/</span>, s = <span class="string">&quot;2019-03-16&quot;</span>;</span><br><span class="line">s.split(r);   <span class="comment">// [&quot;2019&quot;, &quot;03&quot;, &quot;16&quot;]</span></span><br><span class="line">s.split(r);   <span class="comment">// [&quot;2019&quot;, &quot;03&quot;, &quot;16&quot;]</span></span><br><span class="line">s.split(r);   <span class="comment">// [&quot;2019&quot;, &quot;03&quot;, &quot;16&quot;]</span></span><br></pre></td></tr></table></figure>

<ul>
<li>提取</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 提取日期年月日</span></span><br><span class="line"><span class="keyword">let</span> r = <span class="regexp">/^(\d&#123;4&#125;)\D(\d&#123;2&#125;)\D(\d&#123;2&#125;)$/</span>;</span><br><span class="line"><span class="keyword">let</span> s = <span class="string">&quot;2019-03-16&quot;</span>;</span><br><span class="line"></span><br><span class="line">s.match(r); <span class="comment">// [&quot;2019-03-16&quot;, &quot;2019&quot;, &quot;03&quot;, &quot;16&quot;, index: 0, input: &quot;2019-03-16&quot;]</span></span><br><span class="line">r.exec(s);  <span class="comment">// [&quot;2019-03-16&quot;, &quot;2019&quot;, &quot;03&quot;, &quot;16&quot;, index: 0, input: &quot;2019-03-16&quot;]</span></span><br><span class="line">r.test(s);  <span class="comment">// RegExp.$1 =&gt; &quot;2019&quot; RegExp.$2 =&gt; &quot;03&quot; RegExp.$3 =&gt; &quot;16&quot;</span></span><br><span class="line">s.search(r);<span class="comment">// RegExp.$1 =&gt; &quot;2019&quot; RegExp.$2 =&gt; &quot;03&quot; RegExp.$3 =&gt; &quot;16&quot;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>替换</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// yyyy-mm-dd 替换成 yyyy/mm/dd</span></span><br><span class="line"><span class="string">&quot;2019-03-16&quot;</span>.replace(<span class="regexp">/-/g</span>, <span class="string">&quot;/&quot;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="2-相关API注意"><a href="#2-相关API注意" class="headerlink" title="2. 相关API注意"></a>2. 相关API注意</h3><ul>
<li><code>search</code> 和 <code>match</code> 参数问题</li>
</ul>
<p>这两个方法会把字符串转换成正则，所以要加转义</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> s = <span class="string">&quot;2019.03.16&quot;</span>;</span><br><span class="line">s.search(<span class="string">&#x27;.&#x27;</span>);    <span class="comment">// 0</span></span><br><span class="line">s.search(<span class="string">&#x27;\\.&#x27;</span>);  <span class="comment">// 4</span></span><br><span class="line">s.search(<span class="regexp">/\./</span>);  <span class="comment">// 4</span></span><br><span class="line">s.match(<span class="string">&#x27;.&#x27;</span>);     <span class="comment">// [&quot;2&quot;, index: 0, input: &quot;2019.03.16&quot;]</span></span><br><span class="line">s.match(<span class="string">&#x27;\\.&#x27;</span>);   <span class="comment">// [&quot;.&quot;, index: 4, input: &quot;2019.03.16&quot;]</span></span><br><span class="line">s.match(<span class="regexp">/\./</span>);   <span class="comment">// [&quot;.&quot;, index: 4, input: &quot;2019.03.16&quot;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 其他不用转义</span></span><br><span class="line">s.split(<span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">s.replace(<span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;/&#x27;</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li><code>match</code> 返回结果的格式问题</li>
</ul>
<p><code>match</code> 参数有 <code>g</code> 会返回所有匹配的内容，没有 <code>g</code> 则返回标准匹配格式：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> s = <span class="string">&quot;2019.03.16&quot;</span>;</span><br><span class="line">s.match(<span class="regexp">/\b(\d+)\b/</span>);  <span class="comment">// [&quot;2019&quot;, &quot;2019&quot;, index: 0, input: &quot;2019.03.16&quot;]</span></span><br><span class="line">s.match(<span class="regexp">/\b(\d+)\b/g</span>); <span class="comment">// [&quot;2019&quot;, &quot;03&quot;, &quot;16&quot;]</span></span><br></pre></td></tr></table></figure>

<ul>
<li><code>test</code> 整体匹配时需要使用 <code>^</code> 和 <code>$</code></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/<span class="number">123</span>/.test(<span class="string">&quot;a123b&quot;</span>);    <span class="comment">// true</span></span><br><span class="line"><span class="regexp">/^123$/</span>.test(<span class="string">&quot;a123b&quot;</span>);  <span class="comment">// false</span></span><br><span class="line"><span class="regexp">/^123$/</span>.test(<span class="string">&quot;123&quot;</span>);    <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<ul>
<li><code>split</code> 的注意点</li>
</ul>
<p><code>split</code> 第二个参数是 <strong>结果数组的最大长度</strong>：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;leo,pingan,pingan8787&quot;</span>.split(<span class="regexp">/,/</span>, <span class="number">2</span>); <span class="comment">// [&quot;leo&quot;, &quot;pingan&quot;]</span></span><br></pre></td></tr></table></figure>

<p>使用正则分组，会包含分隔符：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;leo,pingan,pingan8787&quot;</span>.split(<span class="regexp">/(,)/</span>); <span class="comment">// [&quot;leo&quot;, &quot;,&quot;, &quot;pingan&quot;, &quot;,&quot;, &quot;pingan8787&quot;]</span></span><br></pre></td></tr></table></figure>

<ul>
<li>修饰符</li>
</ul>
<table>
<thead>
<tr>
<th align="center">修饰符</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code>g</code></td>
<td>全局匹配，即找到所有匹配的，单词是<code> global</code>。</td>
</tr>
<tr>
<td align="center"><code>i</code></td>
<td>忽略字母大小写，单词是 <code>ingoreCase</code>。</td>
</tr>
<tr>
<td align="center"><code>m</code></td>
<td>多行匹配，只影响 <code>^</code> 和 <code>$</code>，二者变成行的概念，即行开头和行结尾。单词是 <code>multiline</code>。</td>
</tr>
</tbody></table>
<p><strong>文章到这结束，感谢阅读，也感谢老姚大佬的这本书</strong></p>
<table>
<thead>
<tr>
<th>Author</th>
<th>王平安</th>
</tr>
</thead>
<tbody><tr>
<td>E-mail</td>
<td><a href="mailto:&#x70;&#x69;&#x6e;&#103;&#97;&#x6e;&#x38;&#x37;&#x38;&#55;&#x40;&#113;&#113;&#46;&#x63;&#x6f;&#x6d;">&#x70;&#x69;&#x6e;&#103;&#97;&#x6e;&#x38;&#x37;&#x38;&#55;&#x40;&#113;&#113;&#46;&#x63;&#x6f;&#x6d;</a></td>
</tr>
<tr>
<td>博  客</td>
<td><a target="_blank" rel="noopener" href="http://www.pingan8787.com/">www.pingan8787.com</a></td>
</tr>
<tr>
<td>微  信</td>
<td>pingan8787</td>
</tr>
<tr>
<td>每日文章推荐</td>
<td><a target="_blank" rel="noopener" href="https://github.com/pingan8787/Leo_Reading/issues">https://github.com/pingan8787/Leo_Reading/issues</a></td>
</tr>
<tr>
<td>ES小册</td>
<td>js.pingan8787.com</td>
</tr>
</tbody></table>
<h2 id="微信公众号"><a href="#微信公众号" class="headerlink" title="微信公众号"></a>微信公众号</h2><p><img src="http://images.pingan8787.com/2019_07_12guild_page.png" alt="bg">  </p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/03/16/155-%E3%80%90%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E3%80%91%E3%80%8AJavaScript%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%BF%B7%E4%BD%A0%E4%B9%A6%E3%80%8B%E7%9F%A5%E8%AF%86%E7%82%B9%E5%B0%8F%E6%8A%84%E6%9C%AC/" data-id="ckts3ejy200lw4d9k5auid91m" data-title="155-【正则表达式】《JavaScript正则表达式迷你书》知识点小抄本" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/" rel="tag">JavaScript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" rel="tag">前端开发</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8E%9F%E5%88%9B/" rel="tag">原创</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" rel="tag">正则表达式</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-154-【CuteJavaScript】设计模式——观察者模式" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/03/03/154-%E3%80%90CuteJavaScript%E3%80%91%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E2%80%94%E2%80%94%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F/" class="article-date">
  <time class="dt-published" datetime="2019-03-03T13:59:15.000Z" itemprop="datePublished">2019-03-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/03/03/154-%E3%80%90CuteJavaScript%E3%80%91%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E2%80%94%E2%80%94%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F/">154-【CuteJavaScript】设计模式——观察者模式</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <hr>
<table>
<thead>
<tr>
<th>Author</th>
<th>王平安</th>
</tr>
</thead>
<tbody><tr>
<td>E-mail</td>
<td><a href="mailto:&#x70;&#105;&#110;&#103;&#x61;&#110;&#x38;&#x37;&#x38;&#x37;&#x40;&#113;&#x71;&#46;&#99;&#x6f;&#x6d;">&#x70;&#105;&#110;&#103;&#x61;&#110;&#x38;&#x37;&#x38;&#x37;&#x40;&#113;&#x71;&#46;&#99;&#x6f;&#x6d;</a></td>
</tr>
<tr>
<td>博  客</td>
<td><a target="_blank" rel="noopener" href="http://www.pingan8787.com/">www.pingan8787.com</a></td>
</tr>
<tr>
<td>微  信</td>
<td>pingan8787</td>
</tr>
<tr>
<td>每日文章推荐</td>
<td><a target="_blank" rel="noopener" href="https://github.com/pingan8787/Leo_Reading/issues">https://github.com/pingan8787/Leo_Reading/issues</a></td>
</tr>
<tr>
<td>微信公众号</td>
<td>前端自习课</td>
</tr>
</tbody></table>
<h2 id="九、观察者模式-Observer-Patterns"><a href="#九、观察者模式-Observer-Patterns" class="headerlink" title="九、观察者模式(Observer Patterns)"></a>九、观察者模式(Observer Patterns)</h2><h3 id="1-概念介绍"><a href="#1-概念介绍" class="headerlink" title="1.概念介绍"></a>1.概念介绍</h3><p><strong>观察者模式(Observer Patterns)</strong> 也称<strong>订阅/发布（subscriber/publisher）模式</strong>，这种模式下，一个对象订阅定一个对象的特定活动，并在状态改变后获得通知。<br>这里的订阅者称为观察者，而被观察者称为发布者，当一个事件发生，发布者会发布通知所有订阅者，并常常以事件对象形式传递消息。   </p>
<p>所有浏览器事件（鼠标悬停，按键等事件）都是该模式的例子。   </p>
<p>我们还可以这么理解：这就跟我们订阅微信公众号一样，当公众号（发布者）群发一条图文消息给所有粉丝（观察者），然后所有粉丝都会接受到这篇图文消息（事件），这篇图文消息的内容是发布者自定义的（自定义事件），粉丝阅读后可能就会买买买（执行事件）。</p>
<h3 id="2-观察者模式-VS-发布订阅模式"><a href="#2-观察者模式-VS-发布订阅模式" class="headerlink" title="2.观察者模式 VS 发布订阅模式"></a>2.观察者模式 VS 发布订阅模式</h3><h4 id="2-1观察者模式"><a href="#2-1观察者模式" class="headerlink" title="2.1观察者模式"></a>2.1观察者模式</h4><p>一种一对多的依赖关系，多个观察者对象同时监听一个主题对象。这个主题对象在状态上发生变化时，会通知所有观察者对象，使它们能够自动更新自己。    </p>
<p><img src="http://images.pingan8787.com/20190303_observer3.png" alt="观察者模式">   </p>
<h4 id="2-2发布订阅模式"><a href="#2-2发布订阅模式" class="headerlink" title="2.2发布订阅模式"></a>2.2发布订阅模式</h4><p>发布订阅模式理念和观察者模式相同，但是处理方式上不同。<br>在发布订阅模式中，发布者和订阅者不知道对方的存在，他们通过调度中心串联起来。<br>订阅者把自己想订阅的事件注册到调度中心，当该事件触发时候，发布者发布该事件到调度中心（并携带上下文），由调度中心统一调度订阅者注册到调度中心的处理代码。</p>
<p><img src="http://images.pingan8787.com/20190303_observer2.png" alt="装饰者模式1">  </p>
<h4 id="2-3两者异同点"><a href="#2-3两者异同点" class="headerlink" title="2.3两者异同点"></a>2.3两者异同点</h4><ul>
<li><p>观察者模式中，观察者知道发布者是谁，并发布者保持对观察者进行记录。而发布订阅模式中，发布者和订阅者不知道对方的存在。它们只是通过调度中心进行通信。</p>
</li>
<li><p>发布订阅模式中，组件是松散耦合的，正好和观察者模式相反。   </p>
</li>
<li><p>观察者模式大多是同步，如当事件触发，发布者就会去调用观察者的方法。而发布订阅模式大多是异步的（使用消息队列）。   </p>
</li>
<li><p>观察者模式需要在单个应用程序地址空间中实现，而发布-订阅更像交叉应用模式。</p>
</li>
</ul>
<p>尽管存在差异，但也有人说发布-订阅模式是观察者模式的变异，因为它们概念上相似。</p>
<h4 id="2-4两者优缺点"><a href="#2-4两者优缺点" class="headerlink" title="2.4两者优缺点"></a>2.4两者优缺点</h4><p><strong>相同优点：</strong>   </p>
<ul>
<li>都可以一对多</li>
<li>程序便于扩展</li>
</ul>
<p><strong>不同优点：</strong>  </p>
<ul>
<li>观察者模式：单向解耦，发布者不需要清楚订阅者何时何地订阅，只需要维护订阅队列，发送消息即可</li>
<li>发布订阅模式：双向解耦，发布者和订阅者都不用清楚对方，全部由订阅中心做处理</li>
</ul>
<p><strong>缺点：</strong> </p>
<ul>
<li>如果一个被观察者和多个观察者的话，会增加维护的难度，并且会消耗很多时间。</li>
<li>如果观察者和发布者之间有循环依赖，可能会导致循环调用引起系统奔溃。</li>
<li>观察者无法得知观察的目标对象是如何发生变化，只能知道目标对象发生了变化。 </li>
<li>发布订阅模式，中心任务过重，一旦崩溃，所有订阅者都会受到影响。</li>
</ul>
<h3 id="4-基本案例"><a href="#4-基本案例" class="headerlink" title="4.基本案例"></a>4.基本案例</h3><p>我们平常一直使用的给DOM节点绑定事件，也是观察者模式的案例：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.body.addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    alert(<span class="string">&#x27;ok&#x27;</span>);</span><br><span class="line">&#125;,<span class="literal">false</span>);</span><br><span class="line"><span class="built_in">document</span>.body.click();</span><br></pre></td></tr></table></figure>
<p>这里我们订阅了<code>document.body</code>的<code>click</code>事件，当<code>body</code>点击它就向订阅者发送消息，就会弹框<code>ok</code>。我们也可以添加很多的订阅。</p>
<h3 id="4-观察者模式-案例"><a href="#4-观察者模式-案例" class="headerlink" title="4.观察者模式 案例"></a>4.观察者模式 案例</h3><p>本案例来自 <a href="cangmean.me/2018/08/31/js-observer/#%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F">javascript 观察者模式和发布订阅模式</a>。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dom</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="comment">// 订阅事件的观察者</span></span><br><span class="line">        <span class="built_in">this</span>.events = &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 添加事件的观察者</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param <span class="type">&#123;String&#125;</span> </span>event  订阅的事件</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param <span class="type">&#123;Function&#125;</span> </span>callback 回调函数(观察者)</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function"><span class="title">addEventListener</span>(<span class="params">event, callback</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">this</span>.events[event]) &#123;</span><br><span class="line">            <span class="built_in">this</span>.events[event] = []</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">this</span>.events[event].push(callback)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="title">removeEventListener</span>(<span class="params">event, callback</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">this</span>.events[event]) &#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">const</span> callbackList = <span class="built_in">this</span>.events[event]</span><br><span class="line">        <span class="keyword">const</span> index = callbackList.indexOf(callback)</span><br><span class="line">            <span class="keyword">if</span> (index &gt; -<span class="number">1</span>) &#123;</span><br><span class="line">            callbackList.splice(index, <span class="number">1</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 触发事件</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param <span class="type">&#123;String&#125;</span> <span class="variable">event</span></span></span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function"><span class="title">fireEvent</span>(<span class="params">event</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">this</span>.events[event]) &#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">this</span>.events[event].forEach(<span class="function"><span class="params">callback</span> =&gt;</span> &#123;</span><br><span class="line">            callback()</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> handler = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;fire click&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> dom = <span class="keyword">new</span> Dom()</span><br><span class="line"></span><br><span class="line">dom.addEventListener(<span class="string">&#x27;click&#x27;</span>, handler)</span><br><span class="line">dom.addEventListener(<span class="string">&#x27;move&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;fire click2&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line">dom.fireEvent(<span class="string">&#x27;click&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="5-发布订阅模式-案例"><a href="#5-发布订阅模式-案例" class="headerlink" title="5.发布订阅模式 案例"></a>5.发布订阅模式 案例</h3><p>本案例来自 <a href="cangmean.me/2018/08/31/js-observer/#%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F">javascript 观察者模式和发布订阅模式</a>。   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EventChannel</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="comment">// 主题</span></span><br><span class="line">        <span class="built_in">this</span>.subjects = &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="title">hasSubject</span>(<span class="params">subject</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.subjects[subject] ? <span class="literal">true</span> : <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 订阅的主题</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param <span class="type">&#123;String&#125;</span> </span>subject 主题</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param <span class="type">&#123;Function&#125;</span> </span>callback 订阅者</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function"><span class="title">on</span>(<span class="params">subject, callback</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">this</span>.hasSubject(subject)) &#123;</span><br><span class="line">            <span class="built_in">this</span>.subjects[subject] = []</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">this</span>.subjects[subject].push(callback)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 取消订阅</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function"><span class="title">off</span>(<span class="params">subject, callback</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">this</span>.hasSubject(subject)) &#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">const</span> callbackList = <span class="built_in">this</span>.subjects[subject]</span><br><span class="line">        <span class="keyword">const</span> index = callbackList.indexOf(callback)</span><br><span class="line">        <span class="keyword">if</span> (index &gt; -<span class="number">1</span>) &#123;</span><br><span class="line">            callbackList.splice(index, <span class="number">1</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 发布主题</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param <span class="type">&#123;String&#125;</span> </span>subject 主题</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param <span class="type">&#123;Argument&#125;</span> </span>data 参数</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function"><span class="title">emit</span>(<span class="params">subject, ...data</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">this</span>.hasSubject(subject)) &#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">this</span>.subjects[subject].forEach(<span class="function"><span class="params">callback</span> =&gt;</span> &#123;</span><br><span class="line">            callback(...data)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> channel = <span class="keyword">new</span> EventChannel()</span><br><span class="line"></span><br><span class="line">channel.on(<span class="string">&#x27;update&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`update value: <span class="subst">$&#123;data&#125;</span>`</span>)</span><br><span class="line">&#125;)</span><br><span class="line">channel.emit(<span class="string">&#x27;update&#x27;</span>, <span class="number">123</span>)</span><br></pre></td></tr></table></figure>

<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ol>
<li>《JavaScript Patterns》</li>
</ol>
<p><strong>本部分内容到这结束</strong></p>
<table>
<thead>
<tr>
<th>Author</th>
<th>王平安</th>
</tr>
</thead>
<tbody><tr>
<td>E-mail</td>
<td><a href="mailto:&#112;&#x69;&#x6e;&#x67;&#97;&#x6e;&#x38;&#x37;&#x38;&#x37;&#x40;&#x71;&#113;&#x2e;&#x63;&#x6f;&#x6d;">&#112;&#x69;&#x6e;&#x67;&#97;&#x6e;&#x38;&#x37;&#x38;&#x37;&#x40;&#x71;&#113;&#x2e;&#x63;&#x6f;&#x6d;</a></td>
</tr>
<tr>
<td>博  客</td>
<td><a target="_blank" rel="noopener" href="http://www.pingan8787.com/">www.pingan8787.com</a></td>
</tr>
<tr>
<td>微  信</td>
<td>pingan8787</td>
</tr>
<tr>
<td>每日文章推荐</td>
<td><a target="_blank" rel="noopener" href="https://github.com/pingan8787/Leo_Reading/issues">https://github.com/pingan8787/Leo_Reading/issues</a></td>
</tr>
<tr>
<td>JS小册</td>
<td>js.pingan8787.com</td>
</tr>
<tr>
<td>微信公众号</td>
<td>前端自习课</td>
</tr>
</tbody></table>
<p><img src="http://images.pingan8787.com/2019_07_12guild_page.png" alt="bg">  </p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/03/03/154-%E3%80%90CuteJavaScript%E3%80%91%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E2%80%94%E2%80%94%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F/" data-id="ckts3ejtd003g4d9kbzf5arxs" data-title="154-【CuteJavaScript】设计模式——观察者模式" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/" rel="tag">JavaScript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" rel="tag">前端开发</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8E%9F%E5%88%9B/" rel="tag">原创</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" rel="tag">设计模式</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-153-【CuteJavaScript】设计模式——中介者模式" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/03/03/153-%E3%80%90CuteJavaScript%E3%80%91%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E2%80%94%E2%80%94%E4%B8%AD%E4%BB%8B%E8%80%85%E6%A8%A1%E5%BC%8F/" class="article-date">
  <time class="dt-published" datetime="2019-03-03T13:59:08.000Z" itemprop="datePublished">2019-03-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/03/03/153-%E3%80%90CuteJavaScript%E3%80%91%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E2%80%94%E2%80%94%E4%B8%AD%E4%BB%8B%E8%80%85%E6%A8%A1%E5%BC%8F/">153-【CuteJavaScript】设计模式——中介者模式</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <hr>
<table>
<thead>
<tr>
<th>Author</th>
<th>王平安</th>
</tr>
</thead>
<tbody><tr>
<td>E-mail</td>
<td><a href="mailto:&#112;&#105;&#x6e;&#103;&#97;&#110;&#56;&#x37;&#56;&#x37;&#64;&#113;&#113;&#x2e;&#99;&#111;&#109;">&#112;&#105;&#x6e;&#103;&#97;&#110;&#56;&#x37;&#56;&#x37;&#64;&#113;&#113;&#x2e;&#99;&#111;&#109;</a></td>
</tr>
<tr>
<td>博  客</td>
<td><a target="_blank" rel="noopener" href="http://www.pingan8787.com/">www.pingan8787.com</a></td>
</tr>
<tr>
<td>微  信</td>
<td>pingan8787</td>
</tr>
<tr>
<td>每日文章推荐</td>
<td><a target="_blank" rel="noopener" href="https://github.com/pingan8787/Leo_Reading/issues">https://github.com/pingan8787/Leo_Reading/issues</a></td>
</tr>
<tr>
<td>微信公众号</td>
<td>前端自习课</td>
</tr>
</tbody></table>
<h2 id="八、中介者模式-Mediator-Pattern"><a href="#八、中介者模式-Mediator-Pattern" class="headerlink" title="八、中介者模式(Mediator Pattern)"></a>八、中介者模式(Mediator Pattern)</h2><h3 id="1-概念介绍"><a href="#1-概念介绍" class="headerlink" title="1.概念介绍"></a>1.概念介绍</h3><p><strong>中介者模式(Mediator Pattern)</strong> 是用来降低多个对象和类之间的通信复杂性，促进形成松耦合，提高可维护性。   </p>
<p><img src="http://images.pingan8787.com/20190303_mdiator.png" alt="装饰者模式1">   </p>
<p>在这种模式下，独立的对象之间不能直接通信，而是需要中间对象（<code>mediator</code>对象），当其中一个对象（<code>colleague</code>对象）状态改变后，它会通知<code>mediator</code>对象，<br>然后<code>mediator</code>对象会把该变换通知到任意需要知道此变化的<code>colleague</code>对象。   </p>
<h3 id="2-优缺点和应用场景"><a href="#2-优缺点和应用场景" class="headerlink" title="2.优缺点和应用场景"></a>2.优缺点和应用场景</h3><h4 id="2-1优点"><a href="#2-1优点" class="headerlink" title="2.1优点"></a>2.1优点</h4><ul>
<li>降低类的复杂度，从一对多转成一对一。</li>
<li>为各个类之间解耦。  </li>
<li>提高代码可维护性。 </li>
</ul>
<h4 id="2-2缺点"><a href="#2-2缺点" class="headerlink" title="2.2缺点"></a>2.2缺点</h4><p>中介者会越来越庞大，变得难以维护。   </p>
<h4 id="2-3应用场景"><a href="#2-3应用场景" class="headerlink" title="2.3应用场景"></a>2.3应用场景</h4><ul>
<li>系统中对象之间存在比较复杂的引用关系，而且难以复用该对象。 </li>
<li>需要生成最少的子类，实现一个中间类封装多个类中的行为的时候。</li>
</ul>
<p>另外： 不要在职责混乱的时候使用。 </p>
<h3 id="3-基本案例"><a href="#3-基本案例" class="headerlink" title="3.基本案例"></a>3.基本案例</h3><p>这里我们实现一个简单的案例，一场测试结束后，公布结果，告知解答出题目的人挑战成功，否则挑战失败：<br>这个案例来自<a target="_blank" rel="noopener" href="https://juejin.im/post/5afe6430518825428630bc4d">JavaScript 中常见设计模式整理</a>   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> player = <span class="function"><span class="keyword">function</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.name = name;</span><br><span class="line">    playerMiddle.add(name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">player.prototype.win = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    playerMiddle.win(<span class="built_in">this</span>.name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">player.prototype.lose = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    playerMiddle.lose(<span class="built_in">this</span>.name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> playerMiddle = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// 将就用下这个 demo，这个函数当成中介者</span></span><br><span class="line">    <span class="keyword">const</span> players = [];</span><br><span class="line">    <span class="keyword">const</span> winArr =  [];</span><br><span class="line">    <span class="keyword">const</span> loseArr = [];</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">add</span>: <span class="function"><span class="keyword">function</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">            players.push(name)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">win</span>: <span class="function"><span class="keyword">function</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">            winArr.push(name)</span><br><span class="line">            <span class="keyword">if</span> (winArr.length + loseArr.length === players.length) &#123;</span><br><span class="line">                <span class="built_in">this</span>.show()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">lose</span>: <span class="function"><span class="keyword">function</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">            loseArr.push(name)</span><br><span class="line">            <span class="keyword">if</span> (winArr.length + loseArr.length === players.length) &#123;</span><br><span class="line">                <span class="built_in">this</span>.show()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">show</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">let</span> winner <span class="keyword">of</span> winArr) &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(winner + <span class="string">&#x27;挑战成功;&#x27;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">let</span> loser <span class="keyword">of</span> loseArr) &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(loser + <span class="string">&#x27;挑战失败;&#x27;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;())</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> a = <span class="keyword">new</span> player(<span class="string">&#x27;A 选手&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> b = <span class="keyword">new</span> player(<span class="string">&#x27;B 选手&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> c = <span class="keyword">new</span> player(<span class="string">&#x27;C 选手&#x27;</span>);</span><br><span class="line"></span><br><span class="line">a.win()</span><br><span class="line">b.win()</span><br><span class="line">c.lose()</span><br><span class="line"></span><br><span class="line"><span class="comment">// A 选手挑战成功;</span></span><br><span class="line"><span class="comment">// B 选手挑战成功;</span></span><br><span class="line"><span class="comment">// C 选手挑战失败;</span></span><br></pre></td></tr></table></figure>

<h3 id="4-书本案例"><a href="#4-书本案例" class="headerlink" title="4.书本案例"></a>4.书本案例</h3><p>这个案例来自 《JavaScript 设计模式》第七章 中介者模式 的案例。<br>这里我们有这么一个游戏例子，规则是两个玩家在规定时间内，比比谁点击按钮次数更多，玩家1按按键2，玩家2按按键0，并且计分板实时更新。   </p>
<p><img src="http://images.pingan8787.com/20190303_mdiator2.png" alt="装饰者模式1"></p>
<p>这里的中介者需要知道所有其他对象信息，并且它需要知道哪个玩家点击了一次，随后通知玩家。玩家进行游戏的时候，还要通知中介者它做的事情，中介者更新分数并显示比分。   </p>
<p>这里的<code>player</code>对象都是通过<code>Player()</code>构造函数生成，并且都有<code>points</code>和<code>name</code>属性，每次调用<code>play()</code>都会增加1分并通知中介者。   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Player</span>(<span class="params">name</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.points = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">this</span>.name   = name;</span><br><span class="line">&#125;</span><br><span class="line">Player.prototype.play = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.points += <span class="number">1</span>;</span><br><span class="line">    mediator.played();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>计分板有个<code>update()</code>方法，当玩家回合结束就会调用，它不知道任何玩家的信息也没有保存分值，只是实现展示当前分数。   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> scoreboard = &#123;</span><br><span class="line">    <span class="comment">// 待更新HTML元素</span></span><br><span class="line">    <span class="attr">ele</span>: <span class="built_in">document</span>.getElementById(<span class="string">&#x27;result&#x27;</span>);</span><br><span class="line">    <span class="comment">// 更新比分</span></span><br><span class="line">    update: <span class="function"><span class="keyword">function</span> (<span class="params">score</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> msg = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">let</span> k <span class="keyword">in</span> score)&#123;</span><br><span class="line">            <span class="keyword">if</span>(score.hasOwnProperty(k))&#123;</span><br><span class="line">                msg = <span class="string">`&lt;p&gt;<span class="subst">$&#123;k&#125;</span> : <span class="subst">$&#123;score[k]&#125;</span>&lt;\/p&gt;`</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">this</span>.ele.innerHTML = msg;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>接下来创建<code>mediator</code>对象：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> mediator = &#123;</span><br><span class="line">    <span class="attr">players</span>: &#123;&#125;,       <span class="comment">// 所有玩家</span></span><br><span class="line">    <span class="attr">setup</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="comment">// 初始化</span></span><br><span class="line">        <span class="keyword">let</span> players = <span class="built_in">this</span>.players;</span><br><span class="line">        players.homw = <span class="keyword">new</span> Player(<span class="string">&#x27;Home&#x27;</span>);</span><br><span class="line">        players.guest = <span class="keyword">new</span> Player(<span class="string">&#x27;Guest&#x27;</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 当有人玩时 更新分数</span></span><br><span class="line">    <span class="attr">played</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> players = <span class="built_in">this</span>.players </span><br><span class="line">        <span class="keyword">let</span> score = &#123;</span><br><span class="line">            <span class="attr">Home</span>: players.home.points,</span><br><span class="line">            <span class="attr">Guest</span>: players.guest.points,</span><br><span class="line">        &#125;</span><br><span class="line">        scoreboard.update(score);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 处理用户交互</span></span><br><span class="line">    <span class="attr">keypress</span>: <span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">        e = e || <span class="built_in">window</span>.event;  <span class="comment">// 兼容IE</span></span><br><span class="line">        <span class="keyword">if</span>(e.which === <span class="number">49</span>)&#123;     <span class="comment">// 按键1</span></span><br><span class="line">            mediator.players.home.play();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(e.which === <span class="number">48</span>)&#123;     <span class="comment">// 按键0</span></span><br><span class="line">            mediator.players.guest.play();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>最后就是需要运行和卸载游戏了：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mediator.setup();</span><br><span class="line"><span class="built_in">window</span>.onkeypress = mediator.keypress;</span><br><span class="line"><span class="comment">// 游戏30秒后结束</span></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">window</span>.onkeypress = <span class="literal">null</span>;</span><br><span class="line">    alert(<span class="string">&#x27;游戏结束&#x27;</span>);</span><br><span class="line">&#125;, <span class="number">30000</span>)</span><br></pre></td></tr></table></figure>

<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ol>
<li>《JavaScript Patterns》</li>
</ol>
<p><strong>本部分内容到这结束</strong></p>
<table>
<thead>
<tr>
<th>Author</th>
<th>王平安</th>
</tr>
</thead>
<tbody><tr>
<td>E-mail</td>
<td><a href="mailto:&#112;&#105;&#x6e;&#x67;&#x61;&#x6e;&#56;&#55;&#x38;&#x37;&#64;&#113;&#x71;&#46;&#x63;&#111;&#109;">&#112;&#105;&#x6e;&#x67;&#x61;&#x6e;&#56;&#55;&#x38;&#x37;&#64;&#113;&#x71;&#46;&#x63;&#111;&#109;</a></td>
</tr>
<tr>
<td>博  客</td>
<td><a target="_blank" rel="noopener" href="http://www.pingan8787.com/">www.pingan8787.com</a></td>
</tr>
<tr>
<td>微  信</td>
<td>pingan8787</td>
</tr>
<tr>
<td>每日文章推荐</td>
<td><a target="_blank" rel="noopener" href="https://github.com/pingan8787/Leo_Reading/issues">https://github.com/pingan8787/Leo_Reading/issues</a></td>
</tr>
<tr>
<td>JS小册</td>
<td>js.pingan8787.com</td>
</tr>
<tr>
<td>微信公众号</td>
<td>前端自习课</td>
</tr>
</tbody></table>
<p><img src="http://images.pingan8787.com/2019_07_12guild_page.png" alt="bg">  </p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/03/03/153-%E3%80%90CuteJavaScript%E3%80%91%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E2%80%94%E2%80%94%E4%B8%AD%E4%BB%8B%E8%80%85%E6%A8%A1%E5%BC%8F/" data-id="ckts3ejtc003e4d9k3qfrac4y" data-title="153-【CuteJavaScript】设计模式——中介者模式" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/" rel="tag">JavaScript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" rel="tag">前端开发</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8E%9F%E5%88%9B/" rel="tag">原创</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" rel="tag">设计模式</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-152-【CuteJavaScript】设计模式——代理模式" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/03/03/152-%E3%80%90CuteJavaScript%E3%80%91%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E2%80%94%E2%80%94%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/" class="article-date">
  <time class="dt-published" datetime="2019-03-03T13:59:01.000Z" itemprop="datePublished">2019-03-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/03/03/152-%E3%80%90CuteJavaScript%E3%80%91%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E2%80%94%E2%80%94%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/">152-【CuteJavaScript】设计模式——代理模式</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <hr>
<table>
<thead>
<tr>
<th>Author</th>
<th>王平安</th>
</tr>
</thead>
<tbody><tr>
<td>E-mail</td>
<td><a href="mailto:&#112;&#105;&#x6e;&#x67;&#97;&#x6e;&#56;&#x37;&#x38;&#x37;&#x40;&#113;&#x71;&#46;&#x63;&#111;&#x6d;">&#112;&#105;&#x6e;&#x67;&#97;&#x6e;&#56;&#x37;&#x38;&#x37;&#x40;&#113;&#x71;&#46;&#x63;&#111;&#x6d;</a></td>
</tr>
<tr>
<td>博  客</td>
<td><a target="_blank" rel="noopener" href="http://www.pingan8787.com/">www.pingan8787.com</a></td>
</tr>
<tr>
<td>微  信</td>
<td>pingan8787</td>
</tr>
<tr>
<td>每日文章推荐</td>
<td><a target="_blank" rel="noopener" href="https://github.com/pingan8787/Leo_Reading/issues">https://github.com/pingan8787/Leo_Reading/issues</a></td>
</tr>
<tr>
<td>微信公众号</td>
<td>前端自习课</td>
</tr>
</tbody></table>
<h2 id="七、代理模式-Proxy-Pattern"><a href="#七、代理模式-Proxy-Pattern" class="headerlink" title="七、代理模式(Proxy Pattern)"></a>七、代理模式(Proxy Pattern)</h2><h3 id="1-概念介绍"><a href="#1-概念介绍" class="headerlink" title="1.概念介绍"></a>1.概念介绍</h3><p><strong>代理模式(Proxy Pattern)</strong> 为其他对象提供一种代理，来控制这个对象的访问，代理是在客户端和真实对象之间的介质。   </p>
<p><img src="http://images.pingan8787.com/20190303_proxy.png" alt="装饰者模式1">   </p>
<p>简单的理解：如我们需要请明星来做广告，我们会先通过联系Ta的经纪人，谈好条件才会给明星签合同。</p>
<h3 id="2-优缺点和应用场景"><a href="#2-优缺点和应用场景" class="headerlink" title="2.优缺点和应用场景"></a>2.优缺点和应用场景</h3><h4 id="2-1优点"><a href="#2-1优点" class="headerlink" title="2.1优点"></a>2.1优点</h4><ul>
<li>职责单一且清晰。   </li>
<li>保护真实对象。 </li>
<li>开闭原则，高拓展性。</li>
</ul>
<h4 id="2-2缺点"><a href="#2-2缺点" class="headerlink" title="2.2缺点"></a>2.2缺点</h4><ul>
<li>由于在客户端和真实对象间添加代理对象，导致请求处理速度变慢。</li>
<li>实现代理模式需要额外工作，有些代理模式实现起来非常复杂。   </li>
</ul>
<h4 id="2-3应用场景"><a href="#2-3应用场景" class="headerlink" title="2.3应用场景"></a>2.3应用场景</h4><ul>
<li>需要隐藏或保护某个类，则为这个类添加代理。</li>
<li>需要给不同访问者提供不同权限，则在代理类上做判断。</li>
<li>需要为某个类添加功能，如添加日志缓存等，我们可以在代理的类做添加，而不管去改原来封装好的类。  </li>
</ul>
<h3 id="3-基本案例"><a href="#3-基本案例" class="headerlink" title="3.基本案例"></a>3.基本案例</h3><p>这里我们以吃午饭问题来学习<strong>代理模式</strong>。通常情况下，我们会有两种方式解决午饭问题：“去餐厅吃”和“叫外卖”。<br>去餐厅吃的话，我们就是自己过去吃饭了呗，如果是叫外卖，我们就会通过外卖小哥来拿到午饭才能吃起来。   </p>
<ul>
<li><strong>去餐厅吃</strong>（没有使用代理模式）</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义午饭类 参数 菜名</span></span><br><span class="line"><span class="keyword">let</span> Lunch = <span class="function"><span class="keyword">function</span>(<span class="params">greens</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.greens = greens;</span><br><span class="line">&#125;</span><br><span class="line">Lunch.prototype.getGreens = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.greens;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 定义我这个对象</span></span><br><span class="line"><span class="keyword">let</span> leo = &#123;</span><br><span class="line">    <span class="attr">buy</span>: <span class="function"><span class="keyword">function</span>(<span class="params">greens</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`午饭吃<span class="subst">$&#123;greens.getGreens()&#125;</span>`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 去餐厅吃</span></span><br><span class="line">leo.buy(<span class="keyword">new</span> Lunch(<span class="string">&#x27;青椒炒肉&#x27;</span>)); <span class="comment">// 午饭吃青椒炒肉</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>叫外卖</strong>（有使用代理模式）</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义午饭类 参数 菜名</span></span><br><span class="line"><span class="keyword">let</span> Lunch = <span class="function"><span class="keyword">function</span>(<span class="params">greens</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.greens = greens;</span><br><span class="line">&#125;</span><br><span class="line">Lunch.prototype.getGreens = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.greens;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 定义外卖小哥这个对象</span></span><br><span class="line"><span class="keyword">let</span> brother = &#123;</span><br><span class="line">    <span class="attr">buy</span>: <span class="function"><span class="keyword">function</span>(<span class="params">lunch</span>)</span>&#123;</span><br><span class="line">        leo.buy(lunch.getGreens());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 定义我这个对象</span></span><br><span class="line"><span class="keyword">let</span> leo = &#123;</span><br><span class="line">    <span class="attr">buy</span>: <span class="function"><span class="keyword">function</span>(<span class="params">greens</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`午饭吃<span class="subst">$&#123;greens&#125;</span>`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 叫外卖</span></span><br><span class="line">brother.buy(<span class="keyword">new</span> Lunch(<span class="string">&#x27;青椒炒肉&#x27;</span>)); <span class="comment">// 午饭吃青椒炒肉</span></span><br></pre></td></tr></table></figure>
<p>并且外卖小哥还会帮我们做一些其他事，比如帮我们带瓶可乐，我们改造<code>brother</code>和<code>leo</code>这2个对象，再看看效果：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> brother = &#123;</span><br><span class="line">    <span class="attr">buy</span>: <span class="function"><span class="keyword">function</span>(<span class="params">lunch</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(leo.needCola) leo.buyCola();</span><br><span class="line">        leo.buy(lunch.getGreens());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> leo = &#123;</span><br><span class="line">    <span class="attr">needCola</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">buy</span>: <span class="function"><span class="keyword">function</span>(<span class="params">greens</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`午饭吃<span class="subst">$&#123;greens&#125;</span>`</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">buyCola</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`顺手买瓶可乐！`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">brother.buy(<span class="keyword">new</span> Lunch(<span class="string">&#x27;青椒炒肉&#x27;</span>));</span><br><span class="line"><span class="comment">// 顺手买瓶可乐！</span></span><br><span class="line"><span class="comment">// 午饭吃青椒炒肉</span></span><br></pre></td></tr></table></figure>

<h3 id="4-保护代理"><a href="#4-保护代理" class="headerlink" title="4.保护代理"></a>4.保护代理</h3><p>还是借用 <strong>3.基本案例</strong> 的叫外卖的例子，我们现在要实现保护代理，而我们需要外卖小哥为了我们的身体健康，超过晚上9点，就不帮我们买可乐。<br>还是改造上面买可乐的<code>brother</code>对象代码：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> brother = &#123;</span><br><span class="line">    <span class="attr">buy</span>: <span class="function"><span class="keyword">function</span>(<span class="params">lunch</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> nowDate = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">        <span class="keyword">if</span>(nowDate.getHours() &gt;= <span class="number">21</span>)&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&#x27;亲，这么晚不要喝可乐哟！&#x27;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(leo.needCola) leo.buyCola();</span><br><span class="line">            leo.buy(lunch.getGreens());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">brother.buy(<span class="keyword">new</span> Lunch(<span class="string">&#x27;青椒炒肉&#x27;</span>));</span><br><span class="line"><span class="comment">// 顺手买瓶可乐！</span></span><br><span class="line"><span class="comment">// 午饭吃青椒炒肉</span></span><br></pre></td></tr></table></figure>

<h3 id="5-虚拟代理"><a href="#5-虚拟代理" class="headerlink" title="5.虚拟代理"></a>5.虚拟代理</h3><p>虚拟代理能把一些开销大的对象，延迟到真正需要的时候才去创建和执行。<br>我们这里举个图片懒加载的例子：<br>这个案例参考自<a target="_blank" rel="noopener" href="https://juejin.im/entry/59d85109f265da065b66e25e">JS设计模式-代理模式</a>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 图片加载</span></span><br><span class="line"><span class="keyword">let</span> ele = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> node = <span class="built_in">document</span>.createElement(<span class="string">&#x27;img&#x27;</span>);</span><br><span class="line">    <span class="built_in">document</span>.body.appendChild(node);</span><br><span class="line">    <span class="keyword">return</span>&#123;</span><br><span class="line">        <span class="attr">setSrc</span> : <span class="function"><span class="keyword">function</span>(<span class="params">src</span>)</span>&#123;</span><br><span class="line">            node.src = src;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 代理对象</span></span><br><span class="line"><span class="keyword">let</span> proxy = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> img = <span class="keyword">new</span> Image();</span><br><span class="line">    img.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        ele.setSrc(<span class="built_in">this</span>.src);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">setSrc</span> : <span class="function"><span class="keyword">function</span>(<span class="params">src</span>)</span>&#123;</span><br><span class="line">            img.src = src;</span><br><span class="line">            ele.setSrc(<span class="string">&#x27;loading.png&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)()</span><br><span class="line"></span><br><span class="line">proxy.setSrc(<span class="string">&#x27;example.png&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="6-缓存代理"><a href="#6-缓存代理" class="headerlink" title="6.缓存代理"></a>6.缓存代理</h3><p>缓存代理是将一些开销大的运算结果提供暂存功能，当下次计算时，参数和之前一直，则将缓存的结果返回：<br>这个案例参考自<a target="_blank" rel="noopener" href="https://juejin.im/entry/59d85109f265da065b66e25e">JS设计模式-代理模式</a>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//计算乘积</span></span><br><span class="line"><span class="keyword">let</span> mult = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> result = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i&lt;<span class="built_in">arguments</span>.length; i++)&#123;</span><br><span class="line">        result *= <span class="built_in">arguments</span>[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 缓存代理</span></span><br><span class="line"><span class="keyword">let</span> proxy = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> cache = &#123;&#125;;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> args = <span class="built_in">Array</span>.prototype.join.call(<span class="built_in">arguments</span>, <span class="string">&#x27;&#x27;</span>,);</span><br><span class="line">        <span class="keyword">if</span>(args <span class="keyword">in</span> cache)&#123;</span><br><span class="line">            <span class="keyword">return</span> cache[args];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> cache[args] = mult.apply(<span class="built_in">this</span>,<span class="built_in">arguments</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>

<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ol>
<li>《JavaScript Patterns》</li>
</ol>
<p><strong>本部分内容到这结束</strong></p>
<table>
<thead>
<tr>
<th>Author</th>
<th>王平安</th>
</tr>
</thead>
<tbody><tr>
<td>E-mail</td>
<td><a href="mailto:&#112;&#x69;&#110;&#x67;&#97;&#110;&#x38;&#55;&#56;&#55;&#x40;&#x71;&#x71;&#46;&#99;&#x6f;&#109;">&#112;&#x69;&#110;&#x67;&#97;&#110;&#x38;&#55;&#56;&#55;&#x40;&#x71;&#x71;&#46;&#99;&#x6f;&#109;</a></td>
</tr>
<tr>
<td>博  客</td>
<td><a target="_blank" rel="noopener" href="http://www.pingan8787.com/">www.pingan8787.com</a></td>
</tr>
<tr>
<td>微  信</td>
<td>pingan8787</td>
</tr>
<tr>
<td>每日文章推荐</td>
<td><a target="_blank" rel="noopener" href="https://github.com/pingan8787/Leo_Reading/issues">https://github.com/pingan8787/Leo_Reading/issues</a></td>
</tr>
<tr>
<td>JS小册</td>
<td>js.pingan8787.com</td>
</tr>
<tr>
<td>微信公众号</td>
<td>前端自习课</td>
</tr>
</tbody></table>
<p><img src="http://images.pingan8787.com/2019_07_12guild_page.png" alt="bg">  </p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/03/03/152-%E3%80%90CuteJavaScript%E3%80%91%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E2%80%94%E2%80%94%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/" data-id="ckts3ejtb003b4d9kfptd7504" data-title="152-【CuteJavaScript】设计模式——代理模式" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/" rel="tag">JavaScript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" rel="tag">前端开发</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8E%9F%E5%88%9B/" rel="tag">原创</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" rel="tag">设计模式</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-151-【CuteJavaScript】设计模式——外观模式" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/03/03/151-%E3%80%90CuteJavaScript%E3%80%91%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E2%80%94%E2%80%94%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F/" class="article-date">
  <time class="dt-published" datetime="2019-03-03T13:58:53.000Z" itemprop="datePublished">2019-03-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/03/03/151-%E3%80%90CuteJavaScript%E3%80%91%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E2%80%94%E2%80%94%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F/">151-【CuteJavaScript】设计模式——外观模式</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <hr>
<table>
<thead>
<tr>
<th>Author</th>
<th>王平安</th>
</tr>
</thead>
<tbody><tr>
<td>E-mail</td>
<td><a href="mailto:&#x70;&#105;&#x6e;&#103;&#97;&#x6e;&#x38;&#55;&#56;&#55;&#x40;&#113;&#x71;&#x2e;&#x63;&#111;&#109;">&#x70;&#105;&#x6e;&#103;&#97;&#x6e;&#x38;&#55;&#56;&#55;&#x40;&#113;&#x71;&#x2e;&#x63;&#111;&#109;</a></td>
</tr>
<tr>
<td>博  客</td>
<td><a target="_blank" rel="noopener" href="http://www.pingan8787.com/">www.pingan8787.com</a></td>
</tr>
<tr>
<td>微  信</td>
<td>pingan8787</td>
</tr>
<tr>
<td>每日文章推荐</td>
<td><a target="_blank" rel="noopener" href="https://github.com/pingan8787/Leo_Reading/issues">https://github.com/pingan8787/Leo_Reading/issues</a></td>
</tr>
<tr>
<td>微信公众号</td>
<td>前端自习课</td>
</tr>
</tbody></table>
<h2 id="六-外观模式-Facade-Pattern"><a href="#六-外观模式-Facade-Pattern" class="headerlink" title="六.外观模式(Facade Pattern)"></a>六.外观模式(Facade Pattern)</h2><h3 id="1-概念介绍"><a href="#1-概念介绍" class="headerlink" title="1.概念介绍"></a>1.概念介绍</h3><p>**外观模式(Facade Pattern)**是一种简单又常见的模式，它为一些复杂的子系统接口提供一个更高级的统一接口，方便对这些子系统的接口访问。   </p>
<p>它不仅简化类中的接口，还对接口和调用者进行解耦，外观模式也常被认为是开发者必备，它可以将一些复杂操作封装起来，并创建一个简单接口用于调用。   </p>
<h3 id="2-优缺点和应用场景"><a href="#2-优缺点和应用场景" class="headerlink" title="2.优缺点和应用场景"></a>2.优缺点和应用场景</h3><h4 id="2-1优点"><a href="#2-1优点" class="headerlink" title="2.1优点"></a>2.1优点</h4><ul>
<li>轻量级，减少系统相互依赖。 </li>
<li>提高灵活性。 </li>
<li>提高了安全性。</li>
</ul>
<h4 id="2-2缺点"><a href="#2-2缺点" class="headerlink" title="2.2缺点"></a>2.2缺点</h4><ul>
<li>不符合开闭原则，如果要改东西很麻烦，继承重写都不合适。</li>
</ul>
<h4 id="2-3应用场景"><a href="#2-3应用场景" class="headerlink" title="2.3应用场景"></a>2.3应用场景</h4><ul>
<li>为复杂的模块或子系统提供外界访问的模块。 </li>
<li>子系统相对独立。 </li>
<li>预防低水平人员带来的风险。</li>
<li>项目重构。</li>
</ul>
<h3 id="3-基本案例"><a href="#3-基本案例" class="headerlink" title="3.基本案例"></a>3.基本案例</h3><p>经常我们在处理一些特殊情况的时候，需要一起调用好几个方法，我们使用外观模式，就可以将多个方法包装成一个方法，哪里需要使用直接调用这个包装好的方法就可以。<br>比如我们经常处理浏览器事件，需要同时调用<code>stopPropagation()</code>和<code>preventDefault()</code>，于是我们就可以新建一个外观方法，实现这两个方法同时调用：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> myEvent = &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="attr">stop</span>: <span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">        e.stopPropagation();</span><br><span class="line">        e.preventDefault();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>然后我们也可以使用外观模式，来做IE事件的兼容性：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> myEvent = &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="attr">stop</span>: <span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 其他 </span></span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">typeof</span> e.preventDefault === <span class="string">&#x27;function&#x27;</span>)&#123;</span><br><span class="line">            e.preventDefault();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">typeof</span> e.stopPropagation === <span class="string">&#x27;function&#x27;</span>)&#123;</span><br><span class="line">            e.stopPropagation();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// IE</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">typeof</span> e.returnValue === <span class="string">&#x27;boolean&#x27;</span>)&#123;</span><br><span class="line">            e.returnValue = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">typeof</span> e.cancelBubble === <span class="string">&#x27;boolean&#x27;</span>)&#123;</span><br><span class="line">            e.cancelBubble = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ol>
<li>《JavaScript Patterns》</li>
</ol>
<p><strong>本部分内容到这结束</strong></p>
<table>
<thead>
<tr>
<th>Author</th>
<th>王平安</th>
</tr>
</thead>
<tbody><tr>
<td>E-mail</td>
<td><a href="mailto:&#x70;&#105;&#x6e;&#103;&#97;&#110;&#56;&#x37;&#56;&#x37;&#x40;&#x71;&#113;&#46;&#x63;&#111;&#x6d;">&#x70;&#105;&#x6e;&#103;&#97;&#110;&#56;&#x37;&#56;&#x37;&#x40;&#x71;&#113;&#46;&#x63;&#111;&#x6d;</a></td>
</tr>
<tr>
<td>博  客</td>
<td><a target="_blank" rel="noopener" href="http://www.pingan8787.com/">www.pingan8787.com</a></td>
</tr>
<tr>
<td>微  信</td>
<td>pingan8787</td>
</tr>
<tr>
<td>每日文章推荐</td>
<td><a target="_blank" rel="noopener" href="https://github.com/pingan8787/Leo_Reading/issues">https://github.com/pingan8787/Leo_Reading/issues</a></td>
</tr>
<tr>
<td>JS小册</td>
<td>js.pingan8787.com</td>
</tr>
<tr>
<td>微信公众号</td>
<td>前端自习课</td>
</tr>
</tbody></table>
<p><img src="http://images.pingan8787.com/2019_07_12guild_page.png" alt="bg">  </p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/03/03/151-%E3%80%90CuteJavaScript%E3%80%91%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E2%80%94%E2%80%94%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F/" data-id="ckts3ejta00394d9kgx4r58qf" data-title="151-【CuteJavaScript】设计模式——外观模式" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/" rel="tag">JavaScript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" rel="tag">前端开发</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8E%9F%E5%88%9B/" rel="tag">原创</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" rel="tag">设计模式</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-150-【CuteJavaScript】设计模式——策略模式" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/03/03/150-%E3%80%90CuteJavaScript%E3%80%91%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E2%80%94%E2%80%94%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F/" class="article-date">
  <time class="dt-published" datetime="2019-03-03T13:58:44.000Z" itemprop="datePublished">2019-03-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/03/03/150-%E3%80%90CuteJavaScript%E3%80%91%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E2%80%94%E2%80%94%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F/">150-【CuteJavaScript】设计模式——策略模式</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <hr>
<table>
<thead>
<tr>
<th>Author</th>
<th>王平安</th>
</tr>
</thead>
<tbody><tr>
<td>E-mail</td>
<td><a href="mailto:&#x70;&#105;&#x6e;&#103;&#97;&#110;&#56;&#55;&#x38;&#x37;&#64;&#113;&#x71;&#46;&#x63;&#x6f;&#x6d;">&#x70;&#105;&#x6e;&#103;&#97;&#110;&#56;&#55;&#x38;&#x37;&#64;&#113;&#x71;&#46;&#x63;&#x6f;&#x6d;</a></td>
</tr>
<tr>
<td>博  客</td>
<td><a target="_blank" rel="noopener" href="http://www.pingan8787.com/">www.pingan8787.com</a></td>
</tr>
<tr>
<td>微  信</td>
<td>pingan8787</td>
</tr>
<tr>
<td>每日文章推荐</td>
<td><a target="_blank" rel="noopener" href="https://github.com/pingan8787/Leo_Reading/issues">https://github.com/pingan8787/Leo_Reading/issues</a></td>
</tr>
<tr>
<td>微信公众号</td>
<td>前端自习课</td>
</tr>
</tbody></table>
<h2 id="五、策略模式-Strategy-Pattern"><a href="#五、策略模式-Strategy-Pattern" class="headerlink" title="五、策略模式(Strategy Pattern)"></a>五、策略模式(Strategy Pattern)</h2><h3 id="1-概念介绍"><a href="#1-概念介绍" class="headerlink" title="1.概念介绍"></a>1.概念介绍</h3><p><strong>策略模式(Strategy Pattern)<strong>：封装一系列算法，支持我们在运行时，使用相同接口，选择不同算法。它的目的是为了</strong>将算法的使用与算法的实现分离开来</strong>。  </p>
<p>策略模式通常会有两部分组成，一部分是<strong>策略类</strong>，它负责实现通用的算法，另一部分是<strong>环境类</strong>，它用户接收客户端请求并委托给策略类。</p>
<h3 id="2-优缺点"><a href="#2-优缺点" class="headerlink" title="2.优缺点"></a>2.优缺点</h3><h4 id="2-1优点"><a href="#2-1优点" class="headerlink" title="2.1优点"></a>2.1优点</h4><ul>
<li>有效地避免多重条件选择语句；   </li>
<li>支持开闭原则，将算法独立封装，使得更加便于切换、理解和扩展；  </li>
<li>更加便于代码复用；  </li>
</ul>
<h4 id="2-2缺点"><a href="#2-2缺点" class="headerlink" title="2.2缺点"></a>2.2缺点</h4><ul>
<li>策略类会增多；   </li>
<li>所有策略类都需要对外暴露；   </li>
</ul>
<h3 id="3-基本案例"><a href="#3-基本案例" class="headerlink" title="3.基本案例"></a>3.基本案例</h3><p>我们可以很简单的将策略和算法直接做映射：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> add = &#123;</span><br><span class="line">    <span class="string">&quot;add3&quot;</span> : <span class="function">(<span class="params">num</span>) =&gt;</span> num + <span class="number">3</span>,</span><br><span class="line">    <span class="string">&quot;add5&quot;</span> : <span class="function">(<span class="params">num</span>) =&gt;</span> num + <span class="number">5</span>,</span><br><span class="line">    <span class="string">&quot;add10&quot;</span>: <span class="function">(<span class="params">num</span>) =&gt;</span> num + <span class="number">10</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> demo = <span class="function">(<span class="params">type, num</span>) =&gt;</span> add[type](num);</span><br><span class="line"><span class="built_in">console</span>.log(demo(<span class="string">&#x27;add3&#x27;</span>, <span class="number">10</span>));  <span class="comment">// 13</span></span><br><span class="line"><span class="built_in">console</span>.log(demo(<span class="string">&#x27;add10&#x27;</span>, <span class="number">12</span>)); <span class="comment">// 22</span></span><br></pre></td></tr></table></figure>
<p>然后我们再把每个策略的算法抽出来：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> fun3  = <span class="function">(<span class="params">num</span>) =&gt;</span> num + <span class="number">3</span>;</span><br><span class="line"><span class="keyword">let</span> fun5  = <span class="function">(<span class="params">num</span>) =&gt;</span> num + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">let</span> fun10 = <span class="function">(<span class="params">num</span>) =&gt;</span> num + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">let</span> add = &#123;</span><br><span class="line">    <span class="string">&quot;add3&quot;</span> : <span class="function">(<span class="params">num</span>) =&gt;</span> fun3(num),</span><br><span class="line">    <span class="string">&quot;add5&quot;</span> : <span class="function">(<span class="params">num</span>) =&gt;</span> fun5(num),</span><br><span class="line">    <span class="string">&quot;add10&quot;</span>: <span class="function">(<span class="params">num</span>) =&gt;</span> fun10(num),</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> demo = <span class="function">(<span class="params">type, num</span>) =&gt;</span> add[type](num);</span><br><span class="line"><span class="built_in">console</span>.log(demo(<span class="string">&#x27;add3&#x27;</span>, <span class="number">10</span>));  <span class="comment">// 13</span></span><br><span class="line"><span class="built_in">console</span>.log(demo(<span class="string">&#x27;add10&#x27;</span>, <span class="number">12</span>)); <span class="comment">// 22</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="4-表单验证案例"><a href="#4-表单验证案例" class="headerlink" title="4.表单验证案例"></a>4.表单验证案例</h3><p>我们需要使用策略模式，实现一个处理表单验证的方法，无论表单的具体类型是什么都会调用验证方法。我们需要让验证器能选择最佳的策略来处理任务，并将具体的验证数据委托给适当算法。   </p>
<p>我们假设需要验证下面的表单数据的有效性：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> data = &#123;</span><br><span class="line">    <span class="attr">name</span>    : <span class="string">&#x27;pingan&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>     : <span class="string">&#x27;unknown&#x27;</span>,</span><br><span class="line">    <span class="attr">nickname</span>: <span class="string">&#x27;leo&#x27;</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里需要先配置验证器，对表单数据中不同的数据使用不同的算法：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">validator.config = &#123;</span><br><span class="line">    <span class="attr">name</span>    : <span class="string">&#x27;isNonEmpty&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>     : <span class="string">&#x27;isNumber&#x27;</span>,</span><br><span class="line">    <span class="attr">nickname</span>: <span class="string">&#x27;isAlphaNum&#x27;</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>并且我们需要将验证的错误信息打印到控制台：    </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">validator.validate(data);</span><br><span class="line"><span class="keyword">if</span>(validator.hasErrors())&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(validator.msg.join(<span class="string">&#x27;\n&#x27;</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>接下来我们才要实现<code>validator</code>中具体的验证算法，他们都有一个相同接口<code>validator.types</code>，提供<code>validate()</code>方法和<code>instructions</code>帮助信息：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 非空值检查</span></span><br><span class="line">validator.types.isNonEmpty = &#123;</span><br><span class="line">    <span class="attr">validate</span>: <span class="function"><span class="keyword">function</span>(<span class="params">value</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> value !== <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="attr">instructions</span>: <span class="string">&#x27;该值不能为空&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 数值类型检查</span></span><br><span class="line">validator.types.isNumber = &#123;</span><br><span class="line">    <span class="attr">validate</span>: <span class="function"><span class="keyword">function</span>(<span class="params">value</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> !<span class="built_in">isNaN</span>(value);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="attr">instructions</span>: <span class="string">&#x27;该值只能是数字&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 检查是否只包含数字和字母</span></span><br><span class="line">validator.types.isAlphaNum = &#123;</span><br><span class="line">    <span class="attr">validate</span>: <span class="function"><span class="keyword">function</span>(<span class="params">value</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> !<span class="regexp">/[^a-z0-9]/i</span>.test(value);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="attr">instructions</span>: <span class="string">&#x27;该值只能包含数字和字母，且不包含特殊字符&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>最后就是要实现最核心的<code>validator</code>对象：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> validator = &#123;</span><br><span class="line">    <span class="attr">types</span>: &#123;&#125;, <span class="comment">// 所有可用的检查</span></span><br><span class="line">    <span class="attr">msg</span>:[],    <span class="comment">// 当前验证的错误信息</span></span><br><span class="line">    <span class="attr">config</span>:&#123;&#125;, <span class="comment">// 验证配置</span></span><br><span class="line">    <span class="attr">validate</span>: <span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123; <span class="comment">// 接口方法</span></span><br><span class="line">        <span class="keyword">let</span> type, checker, result;</span><br><span class="line">        <span class="built_in">this</span>.msg = []; <span class="comment">// 清空错误信息</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">let</span> k <span class="keyword">in</span> data)&#123;</span><br><span class="line">            <span class="keyword">if</span>(data.hasOwnProperty(k))&#123;</span><br><span class="line">                type = <span class="built_in">this</span>.config[k];</span><br><span class="line">                checker = <span class="built_in">this</span>.types[type];</span><br><span class="line">                <span class="keyword">if</span>(!type) <span class="keyword">continue</span>;  <span class="comment">// 不存在类型 则 不需要验证</span></span><br><span class="line">                <span class="keyword">if</span>(!checker)&#123;</span><br><span class="line">                    <span class="keyword">throw</span> &#123;</span><br><span class="line">                        <span class="attr">name</span>: <span class="string">&#x27;验证失败&#x27;</span>,</span><br><span class="line">                        <span class="attr">msg</span>: <span class="string">`不能验证类型：<span class="subst">$&#123;type&#125;</span>`</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                result = checker.validate(data[k]);</span><br><span class="line">                <span class="keyword">if</span>(!result)&#123;</span><br><span class="line">                    <span class="built_in">this</span>.msg.push(<span class="string">`无效的值：<span class="subst">$&#123;k&#125;</span>，<span class="subst">$&#123;checker.instructions&#125;</span>`</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.hasErrors();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="attr">hasErrors</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.msg.length != <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>总结这个案例，我们可以看出<code>validator</code>对象是通用的，需要增强<code>validator</code>对象的方法只需添加更多的类型检查，后续针对每个新的用例，只需配置验证器和运行<code>validator()</code>方法就可以。</p>
<h3 id="5-小结"><a href="#5-小结" class="headerlink" title="5.小结"></a>5.小结</h3><p>日常开发的时候，还是需要根据实际情况来选择设计模式，而不能为了设计模式而去设计模式。通过上面的学习，我们使用策略模式来避免多重条件判断，并且通过开闭原则来封装方法。我们应该多在开发中，逐渐积累自己的开发工具库，便于以后使用。  </p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ol>
<li>《JavaScript Patterns》</li>
</ol>
<p><strong>本部分内容到这结束</strong></p>
<table>
<thead>
<tr>
<th>Author</th>
<th>王平安</th>
</tr>
</thead>
<tbody><tr>
<td>E-mail</td>
<td><a href="mailto:&#112;&#x69;&#x6e;&#103;&#97;&#110;&#x38;&#55;&#56;&#55;&#64;&#113;&#x71;&#x2e;&#99;&#111;&#x6d;">&#112;&#x69;&#x6e;&#103;&#97;&#110;&#x38;&#55;&#56;&#55;&#64;&#113;&#x71;&#x2e;&#99;&#111;&#x6d;</a></td>
</tr>
<tr>
<td>博  客</td>
<td><a target="_blank" rel="noopener" href="http://www.pingan8787.com/">www.pingan8787.com</a></td>
</tr>
<tr>
<td>微  信</td>
<td>pingan8787</td>
</tr>
<tr>
<td>每日文章推荐</td>
<td><a target="_blank" rel="noopener" href="https://github.com/pingan8787/Leo_Reading/issues">https://github.com/pingan8787/Leo_Reading/issues</a></td>
</tr>
<tr>
<td>JS小册</td>
<td>js.pingan8787.com</td>
</tr>
<tr>
<td>微信公众号</td>
<td>前端自习课</td>
</tr>
</tbody></table>
<p><img src="http://images.pingan8787.com/2019_07_12guild_page.png" alt="bg">  </p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/03/03/150-%E3%80%90CuteJavaScript%E3%80%91%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E2%80%94%E2%80%94%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F/" data-id="ckts3ejt800344d9kba4v71tk" data-title="150-【CuteJavaScript】设计模式——策略模式" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/" rel="tag">JavaScript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" rel="tag">前端开发</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8E%9F%E5%88%9B/" rel="tag">原创</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" rel="tag">设计模式</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-149-【CuteJavaScript】设计模式——装饰者模式" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/03/03/149-%E3%80%90CuteJavaScript%E3%80%91%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E2%80%94%E2%80%94%E8%A3%85%E9%A5%B0%E8%80%85%E6%A8%A1%E5%BC%8F/" class="article-date">
  <time class="dt-published" datetime="2019-03-03T13:57:33.000Z" itemprop="datePublished">2019-03-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/03/03/149-%E3%80%90CuteJavaScript%E3%80%91%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E2%80%94%E2%80%94%E8%A3%85%E9%A5%B0%E8%80%85%E6%A8%A1%E5%BC%8F/">149-【CuteJavaScript】设计模式——装饰者模式</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <hr>
<table>
<thead>
<tr>
<th>Author</th>
<th>王平安</th>
</tr>
</thead>
<tbody><tr>
<td>E-mail</td>
<td><a href="mailto:&#112;&#x69;&#110;&#103;&#x61;&#110;&#56;&#x37;&#56;&#x37;&#x40;&#x71;&#113;&#46;&#99;&#111;&#109;">&#112;&#x69;&#110;&#103;&#x61;&#110;&#56;&#x37;&#56;&#x37;&#x40;&#x71;&#113;&#46;&#99;&#111;&#109;</a></td>
</tr>
<tr>
<td>博  客</td>
<td><a target="_blank" rel="noopener" href="http://www.pingan8787.com/">www.pingan8787.com</a></td>
</tr>
<tr>
<td>微  信</td>
<td>pingan8787</td>
</tr>
<tr>
<td>每日文章推荐</td>
<td><a target="_blank" rel="noopener" href="https://github.com/pingan8787/Leo_Reading/issues">https://github.com/pingan8787/Leo_Reading/issues</a></td>
</tr>
<tr>
<td>微信公众号</td>
<td>前端自习课</td>
</tr>
</tbody></table>
<h2 id="四、装饰者模式-Decorator-Pattern"><a href="#四、装饰者模式-Decorator-Pattern" class="headerlink" title="四、装饰者模式(Decorator Pattern)"></a>四、装饰者模式(Decorator Pattern)</h2><h3 id="1-概念介绍"><a href="#1-概念介绍" class="headerlink" title="1.概念介绍"></a>1.概念介绍</h3><p><strong>装饰者模式（Decorator Pattern）</strong>：在不改变原类和继承情况下，动态添加功能到对象中，通过包装一个对象实现一个新的具有原对象相同接口的新对象。    </p>
<p>装饰者模式有以下特点：    </p>
<ol>
<li><strong>添加功能时不改变原对象结构</strong>。</li>
<li><strong>装饰对象和原对象提供的接口相同</strong>，方便按照源对象的接口来使用装饰对象。   </li>
<li><strong>装饰对象中包含原对象的引用</strong>。即装饰对象是真正的原对象包装后的对象。   </li>
</ol>
<p>实际上，装饰着模式的一个比较方便的特征在于其预期行为的可定制和可配置特性。从只有基本功能的普通对象开始，不断增强对象的一些功能，并按照顺序进行装饰。    </p>
<h3 id="2-优缺点和应用场景"><a href="#2-优缺点和应用场景" class="headerlink" title="2.优缺点和应用场景"></a>2.优缺点和应用场景</h3><h4 id="2-1优点"><a href="#2-1优点" class="headerlink" title="2.1优点"></a>2.1优点</h4><ul>
<li>装饰类和被装饰类可以独立发展，不会相互耦合，装饰模式是继承的一个替代模式，装饰模式可以动态扩展一个实现类的功能。</li>
</ul>
<h4 id="2-2缺点"><a href="#2-2缺点" class="headerlink" title="2.2缺点"></a>2.2缺点</h4><ul>
<li>多层装饰比较复杂。</li>
</ul>
<h4 id="2-3应用场景"><a href="#2-3应用场景" class="headerlink" title="2.3应用场景"></a>2.3应用场景</h4><ul>
<li>扩展一个类的功能。 </li>
<li>动态增加功能，动态撤销。</li>
</ul>
<h3 id="3-基本案例"><a href="#3-基本案例" class="headerlink" title="3.基本案例"></a>3.基本案例</h3><p>我们这里实现一个基本对象<code>sale</code>，可以通过<code>sale</code>对象获取不同项目的价格，并通过调用<code>sale.getPrice()</code>方法返回对应价格。并且在不同情况下，用额外的功能来装饰它，会得到不同情况下的价格。      </p>
<h4 id="3-1创建对象"><a href="#3-1创建对象" class="headerlink" title="3.1创建对象"></a>3.1创建对象</h4><p>这里我们假设客户需要支付国家税和省级税。按照装饰者模式，我们就需要使用国家税和省级税两个装饰者来装饰这个<code>sale</code>对象，然后在对使用价格格式化功能的装饰者装饰。实际看起来是这样：    </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> sale = <span class="keyword">new</span> Sale(<span class="number">100</span>);</span><br><span class="line">sale = sale.decorate(<span class="string">&#x27;country&#x27;</span>);</span><br><span class="line">sale = sale.decorate(<span class="string">&#x27;privince&#x27;</span>);</span><br><span class="line">sale = sale.decorate(<span class="string">&#x27;money&#x27;</span>);</span><br><span class="line">sale.getPrice();</span><br></pre></td></tr></table></figure>

<p>使用装饰者模式后，每个装饰都非常灵活，主要根据其装饰者顺序，于是如果客户不需要上缴国家税，代码就可以这么实现：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> sale = <span class="keyword">new</span> Sale(<span class="number">100</span>);</span><br><span class="line">sale = sale.decorate(<span class="string">&#x27;privince&#x27;</span>);</span><br><span class="line">sale = sale.decorate(<span class="string">&#x27;money&#x27;</span>);</span><br><span class="line">sale.getPrice();</span><br></pre></td></tr></table></figure>

<h4 id="3-2实现对象"><a href="#3-2实现对象" class="headerlink" title="3.2实现对象"></a>3.2实现对象</h4><p>接下来我们需要考虑的是如何实现<code>Sale</code>对象了。   </p>
<p><strong>实现装饰者模式的其中一个方法是使得每个装饰者成为一个对象，并且该对象包含了应该被重载的方法</strong>。每个装饰者实际上继承了目前已经被前一个装饰者进行装饰后的对象，每个装饰方法在<code>uber</code>（继承的对象）上调用同样的方法并获取值，此外还继续执行一些操作。   </p>
<blockquote>
<p><code>uber</code>关键字类似Java的<code>super</code>，它可以让某个方法调用父类的方法，<code>uber</code>属性指向父类原型。</p>
</blockquote>
<p>即：当我们调用<code>sale.getPrice()</code>方法时，会调用<code>money</code>装饰者的方法，然后每个装饰方法都会先调用父对象的方法，因此一直往上调用，直到开始的<code>Sale</code>构造函数实现的未被装饰的<code>getPrice()</code>方法。理解如下图：       </p>
<p><img src="http://images.pingan8787.com/20190303_decorator1.png" alt="装饰者模式1">   </p>
<p>我们这里可以先实现构造函数<code>Sale()</code>和原型方法<code>getPrice()</code>：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Sale</span> (<span class="params">price</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.price = price || <span class="number">100</span>;</span><br><span class="line">&#125;</span><br><span class="line">Sale.prototype.getPrice = <span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.price;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>并且装饰者对象都将以构造函数的属性来实现：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Sale.decorators = &#123;&#125;;</span><br></pre></td></tr></table></figure>
<p>接下来实现<code>country</code>这个装饰者并实现它的<code>getPrice()</code>，改方法首先从父对象的方法获取值再做修改：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Sale.decorators.country = &#123;</span><br><span class="line">    <span class="attr">getPrice</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> price = <span class="built_in">this</span>.uber.getPrice(); <span class="comment">// 获取父对象的值</span></span><br><span class="line">        price += price * <span class="number">5</span> / <span class="number">100</span>;</span><br><span class="line">        <span class="keyword">return</span> price;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>按照相同方法，实现其他装饰者：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Sale.decorators.privince = &#123;</span><br><span class="line">    <span class="attr">getPrice</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> price = <span class="built_in">this</span>.uber.getPrice();</span><br><span class="line">        price += price * <span class="number">7</span> / <span class="number">100</span>;</span><br><span class="line">        <span class="keyword">return</span> price;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">Sale.decorators.money = &#123;</span><br><span class="line">    <span class="attr">getPrice</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;￥&quot;</span> + <span class="built_in">this</span>.uber.getPrice().toFixed(<span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>最后我们还需要实现前面的<code>decorate()</code>方法，它将我们所有装饰者拼接一起，并且做了下面的事情：<br>创建了个新对象<code>newobj</code>，继承目前我们所拥有的对象(<code>Sale</code>)，无论是原始对象还是最后装饰后的对象，这里就是对象<code>this</code>，并设置<code>newobj</code>的<code>uber</code>属性，便于子对象访问父对象，然后将所有装饰者的额外属性复制到<code>newobj</code>中，返回<code>newobj</code>，即成为更新的<code>sale</code>对象：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Sale.prototype.decorate = <span class="function"><span class="keyword">function</span>(<span class="params">decorator</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> F = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;, newobj,</span><br><span class="line">        overrides = <span class="built_in">this</span>.constructor.decorators[decorator];</span><br><span class="line">    F.prototype = <span class="built_in">this</span>;</span><br><span class="line">    newobj = <span class="keyword">new</span> F();</span><br><span class="line">    newobj.user = F.prototype;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> k <span class="keyword">in</span> overrides)&#123;</span><br><span class="line">        <span class="keyword">if</span>(overrides.hasOwnProperty(k))&#123;</span><br><span class="line">            newobj[k] = overrides[k];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> newobj;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-改造基本案例"><a href="#4-改造基本案例" class="headerlink" title="4.改造基本案例"></a>4.改造基本案例</h3><p>这里我们使用列表实现相同功能，这个方法利用JavaScript语言的动态性质，并且不需要使用继承，也不需要让每个装饰方法调用链中前面的方法，可以简单的将前面方法的结果作为参数传递给下一个方法。    </p>
<p>这样实现也有个好处，支持反装饰或撤销装饰，我们还是实现以下功能：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> sale = <span class="keyword">new</span> Sale(<span class="number">100</span>);</span><br><span class="line">sale = sale.decorate(<span class="string">&#x27;country&#x27;</span>);</span><br><span class="line">sale = sale.decorate(<span class="string">&#x27;privince&#x27;</span>);</span><br><span class="line">sale = sale.decorate(<span class="string">&#x27;money&#x27;</span>);</span><br><span class="line">sale.getPrice();</span><br></pre></td></tr></table></figure>
<p>现在的<code>Sale()</code>构造函数中多了个装饰者列表的属性：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Sale</span>(<span class="params">price</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.price = (price &gt; <span class="number">0</span>) || <span class="number">100</span>;</span><br><span class="line">    <span class="built_in">this</span>.decorators_list = [];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后还是需要实现<code>Sale.decorators</code>，这里的<code>getPrice()</code>将变得更简单，也没有去调用父对象的<code>getPrice()</code>，而是将结果作为参数传递：    </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Sale.decorators = &#123;&#125;;</span><br><span class="line">Sale.decorators.country = &#123;</span><br><span class="line">    <span class="attr">getPrice</span>: <span class="function"><span class="keyword">function</span>(<span class="params">price</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> price + price * <span class="number">5</span> / <span class="number">100</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">Sale.decorators.privince = &#123;</span><br><span class="line">    <span class="attr">getPrice</span>: <span class="function"><span class="keyword">function</span>(<span class="params">price</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> price + price * <span class="number">7</span> / <span class="number">100</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">Sale.decorators.money = &#123;</span><br><span class="line">    <span class="attr">getPrice</span>: <span class="function"><span class="keyword">function</span>(<span class="params">price</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;￥&quot;</span> + <span class="built_in">this</span>.uber.getPrice().toFixed(<span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>而这时候父对象的<code>decorate()</code>和<code>getPrice()</code>变得复杂，<code>decorate()</code>用于追加装饰者列表，<code>getPrice()</code>需要完成包括遍历当前添加的装饰者一级调用每个装饰者的<code>getPrice()</code>方法、传递从前一个方法获得的结果：    </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Sale.prototype.decorate = <span class="function"><span class="keyword">function</span>(<span class="params">decorators</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.decorators_list.push(decorators);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Sale.propotype.getPrice = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> price = <span class="built_in">this</span>.price, name;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span> ;i&lt; <span class="built_in">this</span>.decorators_list.length; i++)&#123;</span><br><span class="line">        name = <span class="built_in">this</span>.decorators_list[i];</span><br><span class="line">        price = Sale.decorators[name].getPrice(price);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> price;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-对比两个方法"><a href="#5-对比两个方法" class="headerlink" title="5.对比两个方法"></a>5.对比两个方法</h3><p>很显然，第二种列表实现方法会更简单，不用设计继承，并且装饰方法也简单。<br>案例中<code>getPrice()</code>是唯一可以装饰的方法，如果想实现更多可以被装饰的方法，我们可以抽一个方法，来将每个额外的装饰方法重复遍历装饰者列表中的这块代码，通过它来接收方法并使其成为“可装饰”的方法。这样实现，<code>sale</code>的<code>decorators_list</code>属性会成为一个对象，且该对象每个属性都是以装饰者对象数组中的方法和值命名。   </p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ol>
<li>《JavaScript Patterns》</li>
</ol>
<p><strong>本部分内容到这结束</strong></p>
<table>
<thead>
<tr>
<th>Author</th>
<th>王平安</th>
</tr>
</thead>
<tbody><tr>
<td>E-mail</td>
<td><a href="mailto:&#x70;&#x69;&#x6e;&#103;&#97;&#110;&#56;&#x37;&#x38;&#55;&#x40;&#x71;&#113;&#46;&#99;&#111;&#x6d;">&#x70;&#x69;&#x6e;&#103;&#97;&#110;&#56;&#x37;&#x38;&#55;&#x40;&#x71;&#113;&#46;&#99;&#111;&#x6d;</a></td>
</tr>
<tr>
<td>博  客</td>
<td><a target="_blank" rel="noopener" href="http://www.pingan8787.com/">www.pingan8787.com</a></td>
</tr>
<tr>
<td>微  信</td>
<td>pingan8787</td>
</tr>
<tr>
<td>每日文章推荐</td>
<td><a target="_blank" rel="noopener" href="https://github.com/pingan8787/Leo_Reading/issues">https://github.com/pingan8787/Leo_Reading/issues</a></td>
</tr>
<tr>
<td>JS小册</td>
<td>js.pingan8787.com</td>
</tr>
<tr>
<td>微信公众号</td>
<td>前端自习课</td>
</tr>
</tbody></table>
<p><img src="http://images.pingan8787.com/2019_07_12guild_page.png" alt="bg">  </p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/03/03/149-%E3%80%90CuteJavaScript%E3%80%91%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E2%80%94%E2%80%94%E8%A3%85%E9%A5%B0%E8%80%85%E6%A8%A1%E5%BC%8F/" data-id="ckts3ejt700314d9kh29ibnou" data-title="149-【CuteJavaScript】设计模式——装饰者模式" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/" rel="tag">JavaScript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" rel="tag">前端开发</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8E%9F%E5%88%9B/" rel="tag">原创</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" rel="tag">设计模式</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-148-【CuteJavaScript】设计模式——迭代器模式" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/03/03/148-%E3%80%90CuteJavaScript%E3%80%91%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E2%80%94%E2%80%94%E8%BF%AD%E4%BB%A3%E5%99%A8%E6%A8%A1%E5%BC%8F/" class="article-date">
  <time class="dt-published" datetime="2019-03-03T13:55:44.000Z" itemprop="datePublished">2019-03-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/03/03/148-%E3%80%90CuteJavaScript%E3%80%91%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E2%80%94%E2%80%94%E8%BF%AD%E4%BB%A3%E5%99%A8%E6%A8%A1%E5%BC%8F/">148-【CuteJavaScript】设计模式——迭代器模式</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <hr>
<table>
<thead>
<tr>
<th>Author</th>
<th>王平安</th>
</tr>
</thead>
<tbody><tr>
<td>E-mail</td>
<td><a href="mailto:&#x70;&#x69;&#x6e;&#103;&#x61;&#x6e;&#x38;&#55;&#x38;&#55;&#x40;&#x71;&#113;&#x2e;&#x63;&#111;&#x6d;">&#x70;&#x69;&#x6e;&#103;&#x61;&#x6e;&#x38;&#55;&#x38;&#55;&#x40;&#x71;&#113;&#x2e;&#x63;&#111;&#x6d;</a></td>
</tr>
<tr>
<td>博  客</td>
<td><a target="_blank" rel="noopener" href="http://www.pingan8787.com/">www.pingan8787.com</a></td>
</tr>
<tr>
<td>微  信</td>
<td>pingan8787</td>
</tr>
<tr>
<td>每日文章推荐</td>
<td><a target="_blank" rel="noopener" href="https://github.com/pingan8787/Leo_Reading/issues">https://github.com/pingan8787/Leo_Reading/issues</a></td>
</tr>
<tr>
<td>微信公众号</td>
<td>前端自习课</td>
</tr>
</tbody></table>
<h2 id="三、迭代器模式-Iterator-Pattern"><a href="#三、迭代器模式-Iterator-Pattern" class="headerlink" title="三、迭代器模式(Iterator Pattern)"></a>三、迭代器模式(Iterator Pattern)</h2><h3 id="1-概念介绍"><a href="#1-概念介绍" class="headerlink" title="1.概念介绍"></a>1.概念介绍</h3><p>**迭代器模式(Iterator Pattern)**是提供一种方法，顺序访问一个聚合对象中每个元素，并且不暴露该对象内部。    </p>
<p>这种模式属于行为型模式，有以下几个特点：   </p>
<ul>
<li>访问一个聚合对象的内容，而无需暴露它的内部表示。    </li>
<li>提供统一接口来遍历不同结构的数据集合。   </li>
<li>遍历的同事更改迭代器所在的集合结构可能会导致问题。   </li>
</ul>
<p>在迭代器模式中，通常包含有一个包含某种数据集合的对象，需要提供一种简单的方法来访问每个元素。<br>这里对象需要提供一个<code>next()</code>方法，每次调用都必须返回下一个连续的元素。    </p>
<p>这里假设创建一个对象<code>leo</code>，我们通过调用它的<code>next()</code>方法访问下一个连续的元素：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj;</span><br><span class="line"><span class="keyword">while</span>(obj = leo.next())&#123;</span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">    <span class="built_in">console</span>.log(obj);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>另外迭代器模式中，聚合对象还会提供一个更为渐变的<code>hasNext()</code>方法，来检查是否已经到达数据末尾，我们这么修改前面的代码：    </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span>(leo.hasNext())&#123;</span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">    <span class="built_in">console</span>.log(obj);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-优缺点和应用场景"><a href="#2-优缺点和应用场景" class="headerlink" title="2.优缺点和应用场景"></a>2.优缺点和应用场景</h3><h4 id="2-1优点"><a href="#2-1优点" class="headerlink" title="2.1优点"></a>2.1优点</h4><ul>
<li>它简化了聚合类，并支持以不同的方式遍历一个聚合对象。 </li>
<li>在同一个聚合上可以有多个遍历。 </li>
<li>在迭代器模式中，增加新的聚合类和迭代器类都很方便，无须修改原有代码。</li>
</ul>
<h4 id="2-2缺点"><a href="#2-2缺点" class="headerlink" title="2.2缺点"></a>2.2缺点</h4><p>由于迭代器模式将存储数据和遍历数据的职责分离，增加新的聚合类需要对应增加新的迭代器类，类的个数成对增加，这在一定程度上增加了系统的复杂性。</p>
<h4 id="2-3应用场景"><a href="#2-3应用场景" class="headerlink" title="2.3应用场景"></a>2.3应用场景</h4><ul>
<li>访问一个聚合对象的内容而无须暴露它的内部表示。 </li>
<li>需要为聚合对象提供多种遍历方式。 </li>
<li>为遍历不同的聚合结构提供一个统一的接口。</li>
</ul>
<h3 id="3-简单案例"><a href="#3-简单案例" class="headerlink" title="3.简单案例"></a>3.简单案例</h3><p>根据上面的介绍，我们这里实现一个简单案例，将设我们数据只是普通数组，然后每次检索，返回的是间隔一个的数组元素（即不是连续返回）：    </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> leo = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> index = <span class="number">0</span>, data = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>],</span><br><span class="line">        len = data.length;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">next</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">let</span> obj;</span><br><span class="line">            <span class="keyword">if</span>(!<span class="built_in">this</span>.hasNext())&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">            &#125;;</span><br><span class="line">            obj = data[index];</span><br><span class="line">            index = index + <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">return</span> obj;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">hasNext</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> index &lt; len;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)()</span><br></pre></td></tr></table></figure>
<p>然后我们还要给它提供更简单的访问方式和多次迭代数据的能力，我们需要添加下面两个方法：   </p>
<ul>
<li><code>rewind()</code>  重置指针到初始位置；   </li>
<li><code>current()</code>  返回当前元素，因为当指针步前进时无法使用<code>next()</code>操作；   </li>
</ul>
<p>代码变成这样：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> leo = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">//.. </span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">         <span class="comment">// .. </span></span><br><span class="line">         <span class="attr">rewind</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">             index = <span class="number">0</span>;</span><br><span class="line">         &#125;,</span><br><span class="line">         <span class="attr">current</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">             <span class="keyword">return</span> data[index];</span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>
<p>这样这个案例就完整了，接下来我们来测试：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 读取记录</span></span><br><span class="line"><span class="keyword">while</span>(leo.hasNext())&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(leo.next());</span><br><span class="line">&#125;;  <span class="comment">// 打印 1 3 5</span></span><br><span class="line"><span class="comment">// 回退</span></span><br><span class="line">leo.rewind();</span><br><span class="line"><span class="comment">// 获取当前</span></span><br><span class="line"><span class="built_in">console</span>.log(leo.current()); <span class="comment">// 回到初始位置，打印1</span></span><br></pre></td></tr></table></figure>

<h3 id="4-应用场景"><a href="#4-应用场景" class="headerlink" title="4.应用场景"></a>4.应用场景</h3><p>迭代器模式通常用于：对于集合内部结果常常变化各异，我们不想暴露其内部结构的话，但又响让客户代码透明底访问其中的元素，这种情况下我们可以使用迭代器模式。</p>
<p><strong>简单理解：</strong>遍历一个聚合对象。   </p>
<ul>
<li>jQuery应用例子：   </li>
</ul>
<p>jQuery中的<code>$.each()</code>方法，可以让我们传入一个方法，实现对所有项的迭代操作：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$.each([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>],<span class="function"><span class="keyword">function</span>(<span class="params">index, value</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;index&#125;</span>: <span class="subst">$&#123;value&#125;</span>`</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li>使用迭代器模式实现<code>each()</code>方法</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> myEach = <span class="function"><span class="keyword">function</span>(<span class="params">arr, callback</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i&lt; arr.length; i++)&#123;</span><br><span class="line">        callback(i, arr[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-小结"><a href="#4-小结" class="headerlink" title="4.小结"></a>4.小结</h3><p>迭代器模式是一种相对简单的模式，目前绝大多数语言都内置了迭代器。而且迭代器模式也是非常常用，有时候不经意就是用了。    </p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ol>
<li>《JavaScript Patterns》</li>
</ol>
<p><strong>本部分内容到这结束</strong></p>
<table>
<thead>
<tr>
<th>Author</th>
<th>王平安</th>
</tr>
</thead>
<tbody><tr>
<td>E-mail</td>
<td><a href="mailto:&#x70;&#x69;&#x6e;&#x67;&#x61;&#110;&#56;&#x37;&#56;&#x37;&#x40;&#x71;&#113;&#x2e;&#x63;&#111;&#x6d;">&#x70;&#x69;&#x6e;&#x67;&#x61;&#110;&#56;&#x37;&#56;&#x37;&#x40;&#x71;&#113;&#x2e;&#x63;&#111;&#x6d;</a></td>
</tr>
<tr>
<td>博  客</td>
<td><a target="_blank" rel="noopener" href="http://www.pingan8787.com/">www.pingan8787.com</a></td>
</tr>
<tr>
<td>微  信</td>
<td>pingan8787</td>
</tr>
<tr>
<td>每日文章推荐</td>
<td><a target="_blank" rel="noopener" href="https://github.com/pingan8787/Leo_Reading/issues">https://github.com/pingan8787/Leo_Reading/issues</a></td>
</tr>
<tr>
<td>JS小册</td>
<td>js.pingan8787.com</td>
</tr>
<tr>
<td>微信公众号</td>
<td>前端自习课</td>
</tr>
</tbody></table>
<p><img src="http://images.pingan8787.com/2019_07_12guild_page.png" alt="bg">  </p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/03/03/148-%E3%80%90CuteJavaScript%E3%80%91%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E2%80%94%E2%80%94%E8%BF%AD%E4%BB%A3%E5%99%A8%E6%A8%A1%E5%BC%8F/" data-id="ckts3ejt7002z4d9k0xv6arrq" data-title="148-【CuteJavaScript】设计模式——迭代器模式" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/" rel="tag">JavaScript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" rel="tag">前端开发</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8E%9F%E5%88%9B/" rel="tag">原创</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" rel="tag">设计模式</a></li></ul>

    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/7/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="page-number" href="/page/7/">7</a><span class="page-number current">8</span><a class="page-number" href="/page/9/">9</a><a class="page-number" href="/page/10/">10</a><span class="space">&hellip;</span><a class="page-number" href="/page/23/">23</a><a class="extend next" rel="next" href="/page/9/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Angular/" rel="tag">Angular</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CSS/" rel="tag">CSS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CSS%E5%8A%A8%E7%94%BB/" rel="tag">CSS动画</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Chrome/" rel="tag">Chrome</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ES6-ES7-ES8/" rel="tag">ES6/ES7/ES8</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Eslint/" rel="tag">Eslint</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Express/" rel="tag">Express</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GraphQL/" rel="tag">GraphQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/H5/" rel="tag">H5</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTML/" rel="tag">HTML</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTTP/" rel="tag">HTTP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTTP%E5%8D%8F%E8%AE%AE/" rel="tag">HTTP协议</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hybrid/" rel="tag">Hybrid</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaScript/" rel="tag">JavaScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NPM/" rel="tag">NPM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nodejs/" rel="tag">Nodejs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Numpy/" rel="tag">Numpy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/" rel="tag">Python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/React/" rel="tag">React</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Tensorflow/" rel="tag">Tensorflow</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TyeScript/" rel="tag">TyeScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TypeScript/" rel="tag">TypeScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vuejs/" rel="tag">Vuejs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WebSocket/" rel="tag">WebSocket</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Webpack/" rel="tag">Webpack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/demo/" rel="tag">demo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%AD%E9%97%B4%E4%BB%B6/" rel="tag">中间件</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/" rel="tag">人工智能</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91/" rel="tag">全栈开发</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" rel="tag">前端开发</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E6%8E%A2%E7%B4%A2/" rel="tag">前端探索</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E7%9F%A5%E4%B9%8E%E7%B3%BB%E5%88%97/" rel="tag">前端知乎系列</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8E%9F%E5%88%9B/" rel="tag">原创</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B8%B8%E7%94%A8%E6%8A%80%E6%9C%AF/" rel="tag">常用技术</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BE%AE%E5%89%8D%E7%AB%AF/" rel="tag">微前端</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%80%BB%E7%BB%93/" rel="tag">总结</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" rel="tag">数据结构</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" rel="tag">机器学习</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/" rel="tag">构建工具</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" rel="tag">正则表达式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%BA%90%E7%A0%81/" rel="tag">源码</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%BA%90%E7%A0%81%E7%B2%BE%E8%AF%BB/" rel="tag">源码精读</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%83%AD%E9%97%A8/" rel="tag">热门</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%94%9F%E6%B4%BB%E6%9D%82%E8%AE%B0/" rel="tag">生活杂记</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/" rel="tag">编译原理</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82/" rel="tag">网络请求</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" rel="tag">设计模式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" rel="tag">读书笔记</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%87%8D%E6%B8%A9%E5%9F%BA%E7%A1%80/" rel="tag">重温基础</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9D%A2%E8%AF%95%E9%A2%98/" rel="tag">面试题</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Angular/" style="font-size: 11.88px;">Angular</a> <a href="/tags/CSS/" style="font-size: 18.13px;">CSS</a> <a href="/tags/CSS%E5%8A%A8%E7%94%BB/" style="font-size: 12.5px;">CSS动画</a> <a href="/tags/Chrome/" style="font-size: 10px;">Chrome</a> <a href="/tags/ES6-ES7-ES8/" style="font-size: 10.63px;">ES6/ES7/ES8</a> <a href="/tags/Eslint/" style="font-size: 10px;">Eslint</a> <a href="/tags/Express/" style="font-size: 10px;">Express</a> <a href="/tags/GraphQL/" style="font-size: 10px;">GraphQL</a> <a href="/tags/H5/" style="font-size: 10px;">H5</a> <a href="/tags/HTML/" style="font-size: 10px;">HTML</a> <a href="/tags/HTTP/" style="font-size: 11.88px;">HTTP</a> <a href="/tags/HTTP%E5%8D%8F%E8%AE%AE/" style="font-size: 11.25px;">HTTP协议</a> <a href="/tags/Hybrid/" style="font-size: 10.63px;">Hybrid</a> <a href="/tags/JavaScript/" style="font-size: 19.38px;">JavaScript</a> <a href="/tags/NPM/" style="font-size: 10px;">NPM</a> <a href="/tags/Nodejs/" style="font-size: 11.25px;">Nodejs</a> <a href="/tags/Numpy/" style="font-size: 10.63px;">Numpy</a> <a href="/tags/Python/" style="font-size: 17.5px;">Python</a> <a href="/tags/React/" style="font-size: 12.5px;">React</a> <a href="/tags/Tensorflow/" style="font-size: 10.63px;">Tensorflow</a> <a href="/tags/TyeScript/" style="font-size: 10px;">TyeScript</a> <a href="/tags/TypeScript/" style="font-size: 11.25px;">TypeScript</a> <a href="/tags/Vuejs/" style="font-size: 14.38px;">Vuejs</a> <a href="/tags/WebSocket/" style="font-size: 10px;">WebSocket</a> <a href="/tags/Webpack/" style="font-size: 15.63px;">Webpack</a> <a href="/tags/demo/" style="font-size: 10.63px;">demo</a> <a href="/tags/%E4%B8%AD%E9%97%B4%E4%BB%B6/" style="font-size: 10px;">中间件</a> <a href="/tags/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/" style="font-size: 16.25px;">人工智能</a> <a href="/tags/%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91/" style="font-size: 11.25px;">全栈开发</a> <a href="/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" style="font-size: 20px;">前端开发</a> <a href="/tags/%E5%89%8D%E7%AB%AF%E6%8E%A2%E7%B4%A2/" style="font-size: 11.25px;">前端探索</a> <a href="/tags/%E5%89%8D%E7%AB%AF%E7%9F%A5%E4%B9%8E%E7%B3%BB%E5%88%97/" style="font-size: 10.63px;">前端知乎系列</a> <a href="/tags/%E5%8E%9F%E5%88%9B/" style="font-size: 18.75px;">原创</a> <a href="/tags/%E5%B8%B8%E7%94%A8%E6%8A%80%E6%9C%AF/" style="font-size: 10.63px;">常用技术</a> <a href="/tags/%E5%BE%AE%E5%89%8D%E7%AB%AF/" style="font-size: 10px;">微前端</a> <a href="/tags/%E6%80%BB%E7%BB%93/" style="font-size: 13.75px;">总结</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" style="font-size: 10px;">数据结构</a> <a href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" style="font-size: 15px;">机器学习</a> <a href="/tags/%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/" style="font-size: 10.63px;">构建工具</a> <a href="/tags/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" style="font-size: 10.63px;">正则表达式</a> <a href="/tags/%E6%BA%90%E7%A0%81/" style="font-size: 10px;">源码</a> <a href="/tags/%E6%BA%90%E7%A0%81%E7%B2%BE%E8%AF%BB/" style="font-size: 10px;">源码精读</a> <a href="/tags/%E7%83%AD%E9%97%A8/" style="font-size: 10px;">热门</a> <a href="/tags/%E7%94%9F%E6%B4%BB%E6%9D%82%E8%AE%B0/" style="font-size: 10px;">生活杂记</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 13.13px;">算法</a> <a href="/tags/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/" style="font-size: 10px;">编译原理</a> <a href="/tags/%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82/" style="font-size: 10px;">网络请求</a> <a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" style="font-size: 15px;">设计模式</a> <a href="/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" style="font-size: 14.38px;">读书笔记</a> <a href="/tags/%E9%87%8D%E6%B8%A9%E5%9F%BA%E7%A1%80/" style="font-size: 16.88px;">重温基础</a> <a href="/tags/%E9%9D%A2%E8%AF%95%E9%A2%98/" style="font-size: 10px;">面试题</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">May 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">March 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">September 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">June 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">May 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">April 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/07/28/227-%E3%80%90%E6%80%BB%E7%BB%93%E3%80%91%E5%A6%82%E4%BD%95%E4%BC%98%E9%9B%85%E7%9A%84%E5%9C%A8%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E4%BD%BF%E7%94%A8SVG%E5%AD%97%E4%BD%93%E5%9B%BE%E6%A0%87/">227-【总结】如何优雅的在微信小程序使用SVG字体图标</a>
          </li>
        
          <li>
            <a href="/2021/07/28/226-%E3%80%90HTTP%E3%80%91%E5%A6%82%E4%BD%95%E4%BC%98%E9%9B%85%E7%9A%84%E7%AE%A1%E7%90%86HTTP%E8%AF%B7%E6%B1%82%E5%92%8C%E5%93%8D%E5%BA%94%E6%8B%A6%E6%88%AA%E5%99%A8%EF%BC%9F/">226-【HTTP】如何优雅的管理HTTP请求和响应拦截器？</a>
          </li>
        
          <li>
            <a href="/2021/07/28/225-%E3%80%90Vue%E3%80%91%E4%BB%8E%E6%89%8B%E5%86%99Vue3%E7%9A%84Reactivity%E5%BC%80%E5%A7%8B%E6%B7%B1%E5%85%A5Vue3%E6%BA%90%E7%A0%81/">225-【Vue】从手写Vue3的Reactivity开始深入Vue3源码</a>
          </li>
        
          <li>
            <a href="/2021/05/30/224-%E3%80%90Chrome%E3%80%915%E4%B8%AAChrome%E8%B0%83%E8%AF%95%E6%B7%B7%E5%90%88%E5%BA%94%E7%94%A8%E7%9A%84%E6%8A%80%E5%B7%A7/">224-【Chrome】5个Chrome调试混合应用的技巧</a>
          </li>
        
          <li>
            <a href="/2021/03/19/223-%E3%80%90%E5%89%8D%E7%AB%AF%E6%8E%A2%E7%B4%A2%E3%80%91%E6%8E%A2%E7%B4%A2Snabbdom%E6%A8%A1%E5%9D%97%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86/">223-【前端探索】探索Snabbdom模块系统原理</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>