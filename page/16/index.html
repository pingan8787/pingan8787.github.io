<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/page/16/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-77-【CSS】酷炫Wave动画" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/09/03/77-%E3%80%90CSS%E3%80%91%E9%85%B7%E7%82%ABWave%E5%8A%A8%E7%94%BB/" class="article-date">
  <time class="dt-published" datetime="2018-09-03T12:36:15.000Z" itemprop="datePublished">2018-09-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/09/03/77-%E3%80%90CSS%E3%80%91%E9%85%B7%E7%82%ABWave%E5%8A%A8%E7%94%BB/">77-【CSS】酷炫Wave动画</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <hr>
<table>
<thead>
<tr>
<th>Author</th>
<th>王平安</th>
</tr>
</thead>
<tbody><tr>
<td>E-mail</td>
<td><a href="mailto:&#x70;&#x69;&#x6e;&#103;&#x61;&#110;&#x38;&#55;&#56;&#x37;&#x40;&#113;&#x71;&#46;&#99;&#111;&#x6d;">&#x70;&#x69;&#x6e;&#103;&#x61;&#110;&#x38;&#55;&#56;&#x37;&#x40;&#113;&#x71;&#46;&#99;&#111;&#x6d;</a></td>
</tr>
<tr>
<td>博  客</td>
<td><a target="_blank" rel="noopener" href="http://www.pingan8787.com/">www.pingan8787.com</a></td>
</tr>
<tr>
<td>微  信</td>
<td>pingan8787</td>
</tr>
<tr>
<td>每日文章</td>
<td><a target="_blank" rel="noopener" href="https://0x9.me/KMrv3">https://0x9.me/KMrv3</a></td>
</tr>
</tbody></table>
<hr>
<p><a target="_blank" rel="noopener" href="https://w3ctrain.com/2018/06/26/wave-step-by-step/#more">参考文章</a></p>
<h2 id="单条曲线"><a href="#单条曲线" class="headerlink" title="单条曲线"></a>单条曲线</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;ie=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>12-酷炫Wave动画<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">        <span class="selector-tag">body</span>,</span></span><br><span class="line"><span class="css">        <span class="selector-tag">html</span> &#123;</span></span><br><span class="line"><span class="css">            <span class="attribute">padding</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">margin</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="css">        &#125;</span></span><br><span class="line"><span class="css">        </span></span><br><span class="line"><span class="css">        <span class="selector-tag">canvas</span> &#123;</span></span><br><span class="line"><span class="css">            <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">background</span>: <span class="number">#333</span>;</span></span><br><span class="line"><span class="css">        &#125;</span></span><br><span class="line"><span class="css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 参考文章 https://w3ctrain.com/2018/06/26/wave-step-by-step/#more</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">const</span> canvas = <span class="built_in">document</span>.createElement(<span class="string">&#x27;canvas&#x27;</span>);</span></span><br><span class="line"><span class="javascript">    <span class="built_in">document</span>.body.appendChild(canvas);</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">const</span> ctx = canvas.getContext(<span class="string">&#x27;2d&#x27;</span>);</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">const</span> width = canvas.width = canvas.offsetWidth;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">const</span> height = canvas.height = canvas.offsetHeight;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> xMove = <span class="number">0</span>;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> xSpeed = -<span class="number">.04</span></span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">const</span> run = <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">        requestAnimationFrame(run);</span></span><br><span class="line"><span class="javascript">        ctx.clearRect(<span class="number">0</span>, <span class="number">0</span>, width, height);</span></span><br><span class="line"><span class="javascript">        ctx.beginPath();</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">        <span class="comment">// 添加样式</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">const</span> grap = ctx.createLinearGradient(<span class="number">0</span>, <span class="number">0</span>, width, <span class="number">0</span>);</span></span><br><span class="line"><span class="javascript">        grap.addColorStop(<span class="number">0</span>, <span class="string">&#x27;#6e45e2&#x27;</span>);</span></span><br><span class="line"><span class="javascript">        grap.addColorStop(<span class="number">1</span>, <span class="string">&#x27;#88d3ce&#x27;</span>);</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">        ctx.strokeStyle = grap;</span></span><br><span class="line"><span class="javascript">        ctx.lineWidth = <span class="number">1</span>;</span></span><br><span class="line"><span class="javascript">        ctx.moveTo(<span class="number">0</span>, height * <span class="number">.5</span>);</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">        xMove += xSpeed;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">        <span class="keyword">for</span> (<span class="keyword">let</span> x = <span class="number">0</span>; x &lt; width; x++) &#123;</span></span><br><span class="line"><span class="javascript">            <span class="comment">// 调整振幅和放大坐标</span></span></span><br><span class="line"><span class="javascript">            <span class="keyword">const</span> scale = (<span class="built_in">Math</span>.sin(x / width * <span class="built_in">Math</span>.PI * <span class="number">2</span> - <span class="built_in">Math</span>.PI * <span class="number">.5</span>) + <span class="number">1</span>) * <span class="number">.5</span>;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">const</span> y = <span class="built_in">Math</span>.sin(x * <span class="number">.02</span> + xMove) * <span class="number">50</span> * scale + height / <span class="number">2</span>;</span></span><br><span class="line"><span class="javascript">            ctx.lineTo(x, y);</span></span><br><span class="line"><span class="javascript">        &#125;</span></span><br><span class="line"><span class="javascript">        ctx.stroke();</span></span><br><span class="line"><span class="javascript">        ctx.closePath();</span></span><br><span class="line"><span class="javascript">    &#125;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">    run();</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="多条曲线"><a href="#多条曲线" class="headerlink" title="多条曲线"></a>多条曲线</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;ie=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>12-酷炫Wave动画<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">        <span class="selector-tag">body</span>,</span></span><br><span class="line"><span class="css">        <span class="selector-tag">html</span> &#123;</span></span><br><span class="line"><span class="css">            <span class="attribute">padding</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">margin</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="css">        &#125;</span></span><br><span class="line"><span class="css">        </span></span><br><span class="line"><span class="css">        <span class="selector-tag">canvas</span> &#123;</span></span><br><span class="line"><span class="css">            <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">background</span>: <span class="number">#333</span>;</span></span><br><span class="line"><span class="css">        &#125;</span></span><br><span class="line"><span class="css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 参考文章 https://w3ctrain.com/2018/06/26/wave-step-by-step/#more</span></span></span><br><span class="line"><span class="javascript">    <span class="function"><span class="keyword">function</span> <span class="title">valueMapping</span>(<span class="params">x, inMin, inMax, outMin, outMax</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">return</span> (x - inMin) * (outMax - outMin) / (inMax - inMin) + outMin;</span></span><br><span class="line"><span class="javascript">    &#125;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">const</span> canvas = &#123;</span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="title">init</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">this</span>.ele = <span class="built_in">document</span>.createElement(<span class="string">&#x27;canvas&#x27;</span>)</span></span><br><span class="line"><span class="javascript">            <span class="built_in">document</span>.body.appendChild(<span class="built_in">this</span>.ele)</span></span><br><span class="line"><span class="javascript">            <span class="built_in">this</span>.resize()</span></span><br><span class="line"><span class="javascript">            <span class="built_in">window</span>.addEventListener(<span class="string">&#x27;resize&#x27;</span>, <span class="function">() =&gt;</span> <span class="built_in">this</span>.resize(), <span class="literal">false</span>)</span></span><br><span class="line"><span class="javascript">            <span class="built_in">this</span>.ctx = <span class="built_in">this</span>.ele.getContext(<span class="string">&#x27;2d&#x27;</span>)</span></span><br><span class="line"><span class="javascript">            <span class="keyword">return</span> <span class="built_in">this</span>.ctx</span></span><br><span class="line"><span class="javascript">        &#125;,</span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="title">onResize</span>(<span class="params">callback</span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">this</span>.resizeCallback = callback</span></span><br><span class="line"><span class="javascript">        &#125;,</span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="title">resize</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">this</span>.width = <span class="built_in">this</span>.ele.width = <span class="built_in">this</span>.ele.offsetWidth</span></span><br><span class="line"><span class="javascript">            <span class="built_in">this</span>.height = <span class="built_in">this</span>.ele.height = <span class="built_in">this</span>.ele.offsetHeight</span></span><br><span class="line"><span class="javascript">            <span class="built_in">this</span>.resizeCallback &amp;&amp; <span class="built_in">this</span>.resizeCallback()</span></span><br><span class="line"><span class="javascript">        &#125;,</span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="title">run</span>(<span class="params">callback</span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">            requestAnimationFrame(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">                <span class="built_in">this</span>.run(callback)</span></span><br><span class="line"><span class="javascript">            &#125;)</span></span><br><span class="line"><span class="javascript">            callback(<span class="built_in">this</span>.ctx)</span></span><br><span class="line"><span class="javascript">        &#125;</span></span><br><span class="line"><span class="javascript">    &#125;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">const</span> ctx = canvas.init()</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">    <span class="class"><span class="keyword">class</span> <span class="title">Wave</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="title">constructor</span>(<span class="params">cavans, options</span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">this</span>.canvas = canvas</span></span><br><span class="line"><span class="javascript">            <span class="built_in">this</span>.options = options</span></span><br><span class="line"><span class="javascript">            <span class="built_in">this</span>.xMove = <span class="built_in">this</span>.options.offset</span></span><br><span class="line"><span class="javascript">            <span class="built_in">this</span>.xSpeed = <span class="built_in">this</span>.options.xSpeed</span></span><br><span class="line"><span class="javascript">            <span class="built_in">this</span>.resize()</span></span><br><span class="line"><span class="javascript">        &#125;</span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="title">resize</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">this</span>.width = canvas.width</span></span><br><span class="line"><span class="javascript">            <span class="built_in">this</span>.height = canvas.height</span></span><br><span class="line"><span class="javascript">            <span class="built_in">this</span>.amplitude = <span class="built_in">this</span>.canvas.height * <span class="built_in">this</span>.options.amplitude</span></span><br><span class="line"><span class="javascript">        &#125;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="title">draw</span>(<span class="params">ctx</span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">            ctx.beginPath()</span></span><br><span class="line"><span class="javascript">            <span class="built_in">this</span>.xMove += <span class="built_in">this</span>.xSpeed</span></span><br><span class="line"><span class="javascript">            ctx.moveTo(<span class="number">0</span>, <span class="built_in">this</span>.height / <span class="number">2</span>)</span></span><br><span class="line"><span class="javascript">            <span class="keyword">var</span> grad = ctx.createLinearGradient(<span class="number">0</span>, <span class="number">0</span>, <span class="built_in">this</span>.width, <span class="number">0</span>);</span></span><br><span class="line"><span class="javascript">            grad.addColorStop(<span class="number">0</span>, <span class="built_in">this</span>.options.start);</span></span><br><span class="line"><span class="javascript">            grad.addColorStop(<span class="number">1</span>, <span class="built_in">this</span>.options.stop);</span></span><br><span class="line"><span class="javascript">            ctx.strokeStyle = grad</span></span><br><span class="line"><span class="javascript">            ctx.lineWidth = <span class="built_in">this</span>.options.lineWidth</span></span><br><span class="line"><span class="javascript">            <span class="keyword">for</span> (<span class="keyword">let</span> x = <span class="number">0</span>; x &lt; <span class="built_in">this</span>.width; x++) &#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">const</span> radians = x / <span class="built_in">this</span>.width * <span class="built_in">Math</span>.PI * <span class="number">2</span></span></span><br><span class="line"><span class="javascript">                <span class="keyword">const</span> scale = (<span class="built_in">Math</span>.sin(radians - <span class="built_in">Math</span>.PI * <span class="number">0.5</span>) + <span class="number">1</span>) * <span class="number">0.5</span></span></span><br><span class="line"><span class="javascript">                <span class="keyword">const</span> y = <span class="built_in">Math</span>.sin(x * <span class="number">0.02</span> + <span class="built_in">this</span>.xMove) * <span class="built_in">this</span>.amplitude * scale + <span class="built_in">this</span>.height / <span class="number">2</span></span></span><br><span class="line"><span class="javascript">                ctx.lineTo(x, y)</span></span><br><span class="line"><span class="javascript">            &#125;</span></span><br><span class="line"><span class="javascript">            ctx.stroke()</span></span><br><span class="line"><span class="javascript">            ctx.closePath()</span></span><br><span class="line"><span class="javascript">        &#125;</span></span><br><span class="line"><span class="javascript">    &#125;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">const</span> gradients = [</span></span><br><span class="line"><span class="javascript">        [<span class="string">&#x27;#6e45e2&#x27;</span>, <span class="string">&#x27;#88d3ce&#x27;</span>],</span></span><br><span class="line"><span class="javascript">        [<span class="string">&#x27;#de6262&#x27;</span>, <span class="string">&#x27;#ffb88c&#x27;</span>],</span></span><br><span class="line"><span class="javascript">        [<span class="string">&#x27;#64b3f4&#x27;</span>, <span class="string">&#x27;#c2e59c&#x27;</span>],</span></span><br><span class="line"><span class="javascript">        [<span class="string">&#x27;#0fd850&#x27;</span>, <span class="string">&#x27;#f9f047&#x27;</span>],</span></span><br><span class="line"><span class="javascript">        [<span class="string">&#x27;#007adf&#x27;</span>, <span class="string">&#x27;#00ecbc&#x27;</span>],</span></span><br><span class="line"><span class="javascript">        [<span class="string">&#x27;#B6CEE8&#x27;</span>, <span class="string">&#x27;#F578DC&#x27;</span>],</span></span><br><span class="line"><span class="javascript">        [<span class="string">&#x27;#9be15d&#x27;</span>, <span class="string">&#x27;#00e3ae&#x27;</span>]</span></span><br><span class="line"><span class="javascript">    ]</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> waves = []</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">const</span> init = <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">        waves = []</span></span><br><span class="line"><span class="javascript">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">const</span> [start, stop] = gradients[<span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * gradients.length)]</span></span><br><span class="line"><span class="javascript">            waves.push(<span class="keyword">new</span> Wave(canvas, &#123;</span></span><br><span class="line"><span class="javascript">                start,</span></span><br><span class="line"><span class="javascript">                stop,</span></span><br><span class="line"><span class="javascript">                <span class="attr">lineWidth</span>: <span class="number">1</span>,</span></span><br><span class="line"><span class="javascript">                <span class="attr">xSpeed</span>: valueMapping(<span class="built_in">Math</span>.random(), <span class="number">0</span>, <span class="number">1</span>, -<span class="number">0.05</span>, -<span class="number">0.08</span>),</span></span><br><span class="line"><span class="javascript">                <span class="attr">amplitude</span>: valueMapping(<span class="built_in">Math</span>.random(), <span class="number">0</span>, <span class="number">1</span>, <span class="number">0.05</span>, <span class="number">0.5</span>),</span></span><br><span class="line"><span class="javascript">                <span class="attr">offset</span>: <span class="built_in">Math</span>.random() * <span class="number">100</span></span></span><br><span class="line"><span class="javascript">            &#125;))</span></span><br><span class="line"><span class="javascript">        &#125;</span></span><br><span class="line"><span class="javascript">    &#125;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">    <span class="built_in">document</span>.addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">        init()</span></span><br><span class="line"><span class="javascript">    &#125;)</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">    init()</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">    canvas.run(<span class="function"><span class="params">ctx</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">        ctx.clearRect(<span class="number">0</span>, <span class="number">0</span>, canvas.width, canvas.height)</span></span><br><span class="line"><span class="javascript">        waves.forEach(<span class="function"><span class="params">wave</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">            wave.draw(ctx)</span></span><br><span class="line"><span class="javascript">        &#125;)</span></span><br><span class="line"><span class="javascript">    &#125;)</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">    canvas.onResize(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">        init()</span></span><br><span class="line"><span class="javascript">    &#125;)</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/09/03/77-%E3%80%90CSS%E3%80%91%E9%85%B7%E7%82%ABWave%E5%8A%A8%E7%94%BB/" data-id="ckts3ejvw00ab4d9k8erqawvz" data-title="77-【CSS】酷炫Wave动画" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CSS/" rel="tag">CSS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CSS%E5%8A%A8%E7%94%BB/" rel="tag">CSS动画</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" rel="tag">前端开发</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-76-【CSS】单位px-em-rem-vh-vw-vmin-vmax区别" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/09/03/76-%E3%80%90CSS%E3%80%91%E5%8D%95%E4%BD%8Dpx-em-rem-vh-vw-vmin-vmax%E5%8C%BA%E5%88%AB/" class="article-date">
  <time class="dt-published" datetime="2018-09-03T08:13:15.000Z" itemprop="datePublished">2018-09-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/09/03/76-%E3%80%90CSS%E3%80%91%E5%8D%95%E4%BD%8Dpx-em-rem-vh-vw-vmin-vmax%E5%8C%BA%E5%88%AB/">76-【CSS】单位px/em/rem/vh/vw/vmin/vmax区别</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <hr>
<table>
<thead>
<tr>
<th>Author</th>
<th>王平安</th>
</tr>
</thead>
<tbody><tr>
<td>E-mail</td>
<td><a href="mailto:&#x70;&#105;&#x6e;&#103;&#x61;&#110;&#56;&#55;&#56;&#x37;&#64;&#113;&#x71;&#46;&#x63;&#111;&#109;">&#x70;&#105;&#x6e;&#103;&#x61;&#110;&#56;&#55;&#56;&#x37;&#64;&#113;&#x71;&#46;&#x63;&#111;&#109;</a></td>
</tr>
<tr>
<td>博  客</td>
<td><a target="_blank" rel="noopener" href="http://www.pingan8787.com/">www.pingan8787.com</a></td>
</tr>
<tr>
<td>微  信</td>
<td>pingan8787</td>
</tr>
<tr>
<td>每日文章</td>
<td><a target="_blank" rel="noopener" href="https://0x9.me/KMrv3">https://0x9.me/KMrv3</a></td>
</tr>
</tbody></table>
<hr>
<h3 id="1-px"><a href="#1-px" class="headerlink" title="1.px"></a>1.px</h3><p>相对长度单位，像素px是相对于显示器屏幕分辨率而言的。</p>
<h3 id="2-em"><a href="#2-em" class="headerlink" title="2.em"></a>2.em</h3><p>相对长度单位，相对于当前对象内文本的字体尺寸。如当前对行内文本的字体尺寸未被人为设置，则相对于浏览器的默认字体尺寸。 </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span>body</span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;div1&quot;</span>&gt;</span>div1</span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;div2&quot;</span>&gt;</span>div2</span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;div3&quot;</span>&gt;</span>div3<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span>&#123;</span><br><span class="line">    <span class="attribute">font-size</span>:<span class="number">1.5em</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="http://images.pingan8787.com/a1.png" alt="预览">  </p>
<p>计算关系是这样的：  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">body的font-size是继承自跟元素html，html的尺寸是浏览器默认尺寸14px；</span><br><span class="line">div1的font-size=1.5*14px = 21px;</span><br><span class="line">div2的font-size=1.5*21px = 31.5px;</span><br><span class="line">div3的font-size=1.5*31.5px = 47.25px;</span><br></pre></td></tr></table></figure>
<p>如果手动设置div2的font-size为40px，div3的font-size应该为1.5*40px = 60px。</p>
<h3 id="3-rem"><a href="#3-rem" class="headerlink" title="3.rem"></a>3.rem</h3><p>相对长度单位。r 是<code>root</code>的缩写，相对于根元素<html>的字体大小。<br>例如还是上面的html代码，添加如下样式：  </p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.div3</span>&#123;</span><br><span class="line">    <span class="attribute">font-size</span>:<span class="number">1.5rem</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="http://images.pingan8787.com/a2.png" alt="预览">   </p>
<p>此时div3的font-size = 1.5<em>14px = 1.5</em>html的font-size。  </p>
<p>另外需注意chrome强制最小字体为12号，即使设置成 10px 最终都会显示成 12px，当把html的font-size设置成10px,子节点rem的计算还是以12px为基准，所以网上很多文章提到的将html的font-size设为10方便计算不是那么可取。<br>rem在移动端应用可参考淘宝的页面<a target="_blank" rel="noopener" href="http://m.taobao.com/">http://m.taobao.com</a> (html的font-size通过动态计算获取)<br>页面基准320px(20px),html font-size值的计算：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ele=<span class="built_in">document</span>.getElementsByTagName(<span class="string">&quot;html&quot;</span>)[<span class="number">0</span>],</span><br><span class="line">size=<span class="built_in">document</span>.body.clientWidth/<span class="number">320</span>*<span class="number">20</span>;</span><br><span class="line">ele.style.fontSize=size+<span class="string">&quot;px&quot;</span></span><br></pre></td></tr></table></figure>
<p>注：需设置meta缩放比1:1  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="4-vh-and-vw："><a href="#4-vh-and-vw：" class="headerlink" title="4.vh and vw："></a>4.vh and vw：</h3><p>相对于视口的高度和宽度，而不是父元素的（CSS百分比是相对于包含它的最近的父元素的高度和宽度）。  </p>
<p>1vh 等于1/100的视口高度，1vw 等于1/100的视口宽度。  </p>
<p>比如：浏览器高度900px，宽度为750px, 1 vh = 900px/100 = 9 px，1vw = 750px/100 = 7.5 px。  </p>
<p>很容易实现与同屏幕等高的框：<code>.slide &#123; height: 100vh;&#125;</code><br>设置一个和屏幕同宽的标题，<code>h1&#123;font-size:100vw&#125;</code>，那标题的字体大小就会自动根据浏览器的宽度进行缩放，以达到字体和viewport大小同步的效果。  </p>
<h3 id="5-vmin-and-vmax："><a href="#5-vmin-and-vmax：" class="headerlink" title="5.vmin and vmax："></a>5.vmin and vmax：</h3><p>关于视口高度和宽度两者的最小值或者最大值。<br>比如，浏览器的宽度设置为1200px，高度设置为800px， 1vmax = 1200/100px = 12px， 1vmin = 800/100px = 8px。如果宽度设置为600px,高度设置为1080px, 1vmin就等于6px, 1vmax则未10.8px。  </p>
<p>有一个元素，你需要让它始终在屏幕上可见：  </p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123; </span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100vmin</span>; </span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100vmin</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="http://images.pingan8787.com/a3.png" alt="预览">  </p>
<p>如果你要让这个元素始终铺满整个视口的可见区域：  </p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123; </span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100vmax</span>; </span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100vmax</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="http://images.pingan8787.com/a4.png" alt="预览">  </p>
<h3 id="注意："><a href="#注意：" class="headerlink" title="注意："></a>注意：</h3><p>vw, vh, vmin, vmax：IE9+局部支持；<br>chrome/firefox/safari/opera支持；<br>ios safari 8+支持；<br>android browser4.4+支持；<br>chrome for android39支持；</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/09/03/76-%E3%80%90CSS%E3%80%91%E5%8D%95%E4%BD%8Dpx-em-rem-vh-vw-vmin-vmax%E5%8C%BA%E5%88%AB/" data-id="ckts3ejvv00a84d9kb5ph1hki" data-title="76-【CSS】单位px/em/rem/vh/vw/vmin/vmax区别" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CSS/" rel="tag">CSS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" rel="tag">前端开发</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-75-【CSS】filter滤镜属性演示demo" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/09/03/75-%E3%80%90CSS%E3%80%91filter%E6%BB%A4%E9%95%9C%E5%B1%9E%E6%80%A7%E6%BC%94%E7%A4%BAdemo/" class="article-date">
  <time class="dt-published" datetime="2018-09-03T08:08:45.000Z" itemprop="datePublished">2018-09-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/09/03/75-%E3%80%90CSS%E3%80%91filter%E6%BB%A4%E9%95%9C%E5%B1%9E%E6%80%A7%E6%BC%94%E7%A4%BAdemo/">75-【CSS】filter滤镜属性演示demo</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <hr>
<table>
<thead>
<tr>
<th>Author</th>
<th>王平安</th>
</tr>
</thead>
<tbody><tr>
<td>E-mail</td>
<td><a href="mailto:&#x70;&#105;&#x6e;&#103;&#97;&#x6e;&#56;&#55;&#x38;&#x37;&#64;&#113;&#113;&#x2e;&#x63;&#111;&#x6d;">&#x70;&#105;&#x6e;&#103;&#97;&#x6e;&#56;&#55;&#x38;&#x37;&#64;&#113;&#113;&#x2e;&#x63;&#111;&#x6d;</a></td>
</tr>
<tr>
<td>博  客</td>
<td><a target="_blank" rel="noopener" href="http://www.pingan8787.com/">www.pingan8787.com</a></td>
</tr>
<tr>
<td>微  信</td>
<td>pingan8787</td>
</tr>
<tr>
<td>每日文章</td>
<td><a target="_blank" rel="noopener" href="https://0x9.me/KMrv3">https://0x9.me/KMrv3</a></td>
</tr>
</tbody></table>
<hr>
<h2 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h2><p><a target="_blank" rel="noopener" href="http://www.runoob.com/cssref/css3-pr-filter.html">文档地址</a></p>
<h2 id="实例代码"><a href="#实例代码" class="headerlink" title="实例代码"></a>实例代码</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;ie=edge&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>filter滤镜使用<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">            <span class="selector-class">.box</span>&#123;</span></span><br><span class="line"><span class="css">                <span class="attribute">width</span>:<span class="number">300px</span>;</span></span><br><span class="line"><span class="css">                <span class="attribute">border</span>: <span class="number">1px</span> solid red;</span></span><br><span class="line"><span class="css">                <span class="attribute">padding</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="css">                <span class="attribute">background-color</span>: greenyellow;</span></span><br><span class="line"><span class="css">                <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="css">                <span class="attribute">margin-bottom</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="css">            &#125;</span></span><br><span class="line"><span class="css">            <span class="selector-tag">img</span>&#123;</span></span><br><span class="line"><span class="css">                <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="css">                <span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="css">            &#125;</span></span><br><span class="line"><span class="css">            <span class="selector-class">.img1</span>&#123;</span></span><br><span class="line"><span class="css">                <span class="attribute">filter</span>: <span class="built_in">blur</span>(<span class="number">10px</span>);</span></span><br><span class="line"><span class="css">            &#125;</span></span><br><span class="line"><span class="css">            <span class="selector-class">.img2</span>&#123;</span></span><br><span class="line"><span class="css">                <span class="attribute">filter</span>: <span class="built_in">brightness</span>(<span class="number">60%</span>);</span></span><br><span class="line"><span class="css">            &#125;</span></span><br><span class="line"><span class="css">            <span class="selector-class">.img3</span>&#123;</span></span><br><span class="line"><span class="css">                <span class="attribute">filter</span>: <span class="built_in">contrast</span>(<span class="number">50%</span>);</span></span><br><span class="line"><span class="css">            &#125;</span></span><br><span class="line"><span class="css">            <span class="selector-class">.img4</span>&#123;</span></span><br><span class="line"><span class="css">                <span class="attribute">filter</span>: <span class="built_in">drop-shadow</span>(<span class="number">5px</span> <span class="number">5px</span> <span class="number">10px</span> red);</span></span><br><span class="line"><span class="css">            &#125;</span></span><br><span class="line"><span class="css">            <span class="selector-class">.img5</span>&#123;</span></span><br><span class="line"><span class="css">                <span class="attribute">filter</span>: <span class="built_in">grayscale</span>(<span class="number">60%</span>);</span></span><br><span class="line"><span class="css">            &#125;</span></span><br><span class="line"><span class="css">            <span class="selector-class">.img6</span>&#123;</span></span><br><span class="line"><span class="css">                <span class="attribute">filter</span>: <span class="built_in">hue-rotate</span>(<span class="number">45deg</span>);</span></span><br><span class="line"><span class="css">            &#125;</span></span><br><span class="line"><span class="css">            <span class="selector-class">.img7</span>&#123;</span></span><br><span class="line"><span class="css">                <span class="attribute">filter</span>: <span class="built_in">invert</span>(<span class="number">60%</span>);</span></span><br><span class="line"><span class="css">            &#125;</span></span><br><span class="line"><span class="css">            <span class="selector-class">.img8</span>&#123;</span></span><br><span class="line"><span class="css">                <span class="attribute">filter</span>: <span class="built_in">opacity</span>(<span class="number">60%</span>);</span></span><br><span class="line"><span class="css">            &#125;</span></span><br><span class="line"><span class="css">            <span class="selector-class">.img9</span>&#123;</span></span><br><span class="line"><span class="css">                <span class="attribute">filter</span>: <span class="built_in">saturate</span>(<span class="number">60%</span>);</span></span><br><span class="line"><span class="css">            &#125;</span></span><br><span class="line"><span class="css">            <span class="selector-class">.img10</span>&#123;</span></span><br><span class="line"><span class="css">                <span class="attribute">filter</span>: <span class="built_in">sepia</span>(<span class="number">60%</span>);</span></span><br><span class="line"><span class="css">            &#125;</span></span><br><span class="line"><span class="css">        </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span>&gt;</span>原图<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;./img/img1.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span>&gt;</span>blur 高斯模糊<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">&quot;img1&quot;</span> <span class="attr">src</span>=<span class="string">&quot;./img/img1.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span>&gt;</span>brightness 亮度调节<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">&quot;img2&quot;</span> <span class="attr">src</span>=<span class="string">&quot;./img/img1.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span>&gt;</span>contrast 对比度调节<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">&quot;img3&quot;</span> <span class="attr">src</span>=<span class="string">&quot;./img/img1.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span>&gt;</span>drop-shadow 阴影效果调节<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">&quot;img4&quot;</span> <span class="attr">src</span>=<span class="string">&quot;./img/img1.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span>&gt;</span>grayscale 黑白比例<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">&quot;img5&quot;</span> <span class="attr">src</span>=<span class="string">&quot;./img/img1.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span>&gt;</span>hue-rotate 图像应用色相旋转<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">&quot;img6&quot;</span> <span class="attr">src</span>=<span class="string">&quot;./img/img1.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span>&gt;</span>invert 反转输入图像<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">&quot;img7&quot;</span> <span class="attr">src</span>=<span class="string">&quot;./img/img1.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span>&gt;</span>opacity 图像透明程度<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">&quot;img8&quot;</span> <span class="attr">src</span>=<span class="string">&quot;./img/img1.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span>&gt;</span>saturate 图像饱和度<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">&quot;img9&quot;</span> <span class="attr">src</span>=<span class="string">&quot;./img/img1.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span>&gt;</span>sepia 图像转换为深褐色比例<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">&quot;img10&quot;</span> <span class="attr">src</span>=<span class="string">&quot;./img/img1.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/09/03/75-%E3%80%90CSS%E3%80%91filter%E6%BB%A4%E9%95%9C%E5%B1%9E%E6%80%A7%E6%BC%94%E7%A4%BAdemo/" data-id="ckts3ejvu00a64d9ka3jw7ze7" data-title="75-【CSS】filter滤镜属性演示demo" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CSS/" rel="tag">CSS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" rel="tag">前端开发</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-74-【CSS】纯CSS绘制闪闪发光的霓虹灯文字效果" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/09/03/74-%E3%80%90CSS%E3%80%91%E7%BA%AFCSS%E7%BB%98%E5%88%B6%E9%97%AA%E9%97%AA%E5%8F%91%E5%85%89%E7%9A%84%E9%9C%93%E8%99%B9%E7%81%AF%E6%96%87%E5%AD%97%E6%95%88%E6%9E%9C/" class="article-date">
  <time class="dt-published" datetime="2018-09-03T07:59:52.000Z" itemprop="datePublished">2018-09-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/09/03/74-%E3%80%90CSS%E3%80%91%E7%BA%AFCSS%E7%BB%98%E5%88%B6%E9%97%AA%E9%97%AA%E5%8F%91%E5%85%89%E7%9A%84%E9%9C%93%E8%99%B9%E7%81%AF%E6%96%87%E5%AD%97%E6%95%88%E6%9E%9C/">74-【CSS】纯CSS绘制闪闪发光的霓虹灯文字效果</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <hr>
<table>
<thead>
<tr>
<th>Author</th>
<th>王平安</th>
</tr>
</thead>
<tbody><tr>
<td>E-mail</td>
<td><a href="mailto:&#x70;&#105;&#x6e;&#x67;&#x61;&#110;&#x38;&#x37;&#56;&#x37;&#x40;&#113;&#113;&#46;&#99;&#x6f;&#x6d;">&#x70;&#105;&#x6e;&#x67;&#x61;&#110;&#x38;&#x37;&#56;&#x37;&#x40;&#113;&#113;&#46;&#99;&#x6f;&#x6d;</a></td>
</tr>
<tr>
<td>博  客</td>
<td><a target="_blank" rel="noopener" href="http://www.pingan8787.com/">www.pingan8787.com</a></td>
</tr>
<tr>
<td>微  信</td>
<td>pingan8787</td>
</tr>
<tr>
<td>每日文章</td>
<td><a target="_blank" rel="noopener" href="https://0x9.me/KMrv3">https://0x9.me/KMrv3</a></td>
</tr>
</tbody></table>
<hr>
<p><a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000015939758">参考文章</a><br><img src="https://image-static.segmentfault.com/119/022/1190226986-5b6b895a076dc_articlex" alt="预览图"></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;ie=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>纯 CSS 创作闪闪发光的霓虹灯文字<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">        <span class="selector-tag">body</span> &#123;</span></span><br><span class="line"><span class="css">            <span class="attribute">margin</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">height</span>: <span class="number">100vh</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">            <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="css">            <span class="attribute">justify-content</span>: center;</span></span><br><span class="line"><span class="css">            <span class="attribute">background-color</span>: black;</span></span><br><span class="line"><span class="css">        &#125;</span></span><br><span class="line"><span class="css">        </span></span><br><span class="line"><span class="css">        <span class="selector-class">.neon</span> &#123;</span></span><br><span class="line"><span class="css">            <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="css">            <span class="attribute">overflow</span>: hidden;</span></span><br><span class="line"><span class="css">            <span class="comment">/* 调高亮度 */</span></span></span><br><span class="line"><span class="css">            <span class="attribute">filter</span>: <span class="built_in">brightness</span>(<span class="number">200%</span>);</span></span><br><span class="line"><span class="css">        &#125;</span></span><br><span class="line"><span class="css">        </span></span><br><span class="line"><span class="css">        <span class="selector-class">.text</span> &#123;</span></span><br><span class="line"><span class="css">            <span class="attribute">background-color</span>: black;</span></span><br><span class="line"><span class="css">            <span class="attribute">color</span>: white;</span></span><br><span class="line"><span class="css">            <span class="attribute">font-size</span>: <span class="number">80px</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">font-weight</span>: bold;</span></span><br><span class="line"><span class="css">            <span class="attribute">font-family</span>: sans-serif;</span></span><br><span class="line"><span class="css">            <span class="attribute">text-transform</span>: uppercase;</span></span><br><span class="line"><span class="css">            <span class="comment">/* 文字不能被选中 */</span></span></span><br><span class="line"><span class="css">            user-select: none;</span></span><br><span class="line"><span class="css">        &#125;</span></span><br><span class="line"><span class="css">        </span></span><br><span class="line"><span class="css">        <span class="selector-class">.text</span><span class="selector-pseudo">::before</span> &#123;</span></span><br><span class="line"><span class="css">            <span class="comment">/* 用伪元素和数据属性增加文字，产生描边效果 */</span></span></span><br><span class="line"><span class="css">            <span class="attribute">content</span>: <span class="built_in">attr</span>(data-text);</span></span><br><span class="line"><span class="css">            <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="css">            <span class="attribute">color</span>: white;</span></span><br><span class="line"><span class="css">            <span class="attribute">filter</span>: <span class="built_in">blur</span>(<span class="number">0.02em</span>);</span></span><br><span class="line"><span class="css">            <span class="comment">/* 用混色模式产生描边效果 */</span></span></span><br><span class="line"><span class="css">            mix-blend-mode: difference;</span></span><br><span class="line"><span class="css">        &#125;</span></span><br><span class="line"><span class="css">        </span></span><br><span class="line"><span class="css">        <span class="selector-class">.gradient</span> &#123;</span></span><br><span class="line"><span class="css">            <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="css">            <span class="comment">/* 设置渐变色背景 */</span></span></span><br><span class="line"><span class="css">            <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(<span class="number">45deg</span>, red, gold, lightgreen, gold, red);</span></span><br><span class="line"><span class="css">            <span class="attribute">top</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">left</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">right</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">bottom</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">            <span class="comment">/* 设置渐变色背景 */</span></span></span><br><span class="line"><span class="css">            mix-blend-mode: multiply;</span></span><br><span class="line"><span class="css">        &#125;</span></span><br><span class="line"><span class="css">        </span></span><br><span class="line"><span class="css">        <span class="selector-class">.spotlight</span> &#123;</span></span><br><span class="line"><span class="css">            <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="css">            <span class="attribute">top</span>: -<span class="number">100%</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">left</span>: -<span class="number">100%</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">right</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">bottom</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">            <span class="comment">/* 用径向渐变制作光影背景 */</span></span></span><br><span class="line"><span class="css">            <span class="attribute">background</span>: </span></span><br><span class="line"><span class="css">	            <span class="built_in">radial-gradient</span>(</span></span><br><span class="line"><span class="css">	            	circle, white, transparent <span class="number">25%</span></span></span><br><span class="line"><span class="css">	            	) center / <span class="number">25%</span> <span class="number">25%</span>, </span></span><br><span class="line"><span class="css">	            <span class="built_in">radial-gradient</span>(</span></span><br><span class="line"><span class="css">	            	circle, white, black <span class="number">25%</span></span></span><br><span class="line"><span class="css">	            	) center / <span class="number">12.5%</span> <span class="number">12.5%</span>;</span></span><br><span class="line"><span class="css">            <span class="attribute">animation</span>: light <span class="number">5s</span> linear infinite;</span></span><br><span class="line"><span class="css">            mix-blend-mode: color-dodge;</span></span><br><span class="line"><span class="css">        &#125;</span></span><br><span class="line"><span class="css">        <span class="comment">/* 设置光影移动的动画效果 */</span></span></span><br><span class="line"><span class="css">        </span></span><br><span class="line"><span class="css">        <span class="keyword">@keyframes</span> light &#123;</span></span><br><span class="line"><span class="css">            <span class="selector-tag">to</span> &#123;</span></span><br><span class="line"><span class="css">                <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">50%</span>, <span class="number">50%</span>);</span></span><br><span class="line"><span class="css">            &#125;</span></span><br><span class="line"><span class="css">        &#125;</span></span><br><span class="line"><span class="css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;neon&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;text&quot;</span> <span class="attr">data-text</span>=<span class="string">&quot;thanks&quot;</span>&gt;</span>thanks<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;gradient&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;spotlight&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/09/03/74-%E3%80%90CSS%E3%80%91%E7%BA%AFCSS%E7%BB%98%E5%88%B6%E9%97%AA%E9%97%AA%E5%8F%91%E5%85%89%E7%9A%84%E9%9C%93%E8%99%B9%E7%81%AF%E6%96%87%E5%AD%97%E6%95%88%E6%9E%9C/" data-id="ckts3ejvt00a34d9k3t17gsr0" data-title="74-【CSS】纯CSS绘制闪闪发光的霓虹灯文字效果" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CSS/" rel="tag">CSS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CSS%E5%8A%A8%E7%94%BB/" rel="tag">CSS动画</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" rel="tag">前端开发</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-73-【JavaScript】前端本地文件操作和上传" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/09/03/73-%E3%80%90JavaScript%E3%80%91%E5%89%8D%E7%AB%AF%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C%E5%92%8C%E4%B8%8A%E4%BC%A0/" class="article-date">
  <time class="dt-published" datetime="2018-09-03T07:57:17.000Z" itemprop="datePublished">2018-09-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/09/03/73-%E3%80%90JavaScript%E3%80%91%E5%89%8D%E7%AB%AF%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C%E5%92%8C%E4%B8%8A%E4%BC%A0/">73-【JavaScript】前端本地文件操作和上传</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <hr>
<table>
<thead>
<tr>
<th>Author</th>
<th>王平安</th>
</tr>
</thead>
<tbody><tr>
<td>E-mail</td>
<td><a href="mailto:&#x70;&#x69;&#110;&#103;&#97;&#x6e;&#x38;&#x37;&#56;&#55;&#64;&#x71;&#113;&#x2e;&#x63;&#111;&#x6d;">&#x70;&#x69;&#110;&#103;&#97;&#x6e;&#x38;&#x37;&#56;&#55;&#64;&#x71;&#113;&#x2e;&#x63;&#111;&#x6d;</a></td>
</tr>
<tr>
<td>博  客</td>
<td><a target="_blank" rel="noopener" href="http://www.pingan8787.com/">www.pingan8787.com</a></td>
</tr>
<tr>
<td>微  信</td>
<td>pingan8787</td>
</tr>
<tr>
<td>每日文章</td>
<td><a target="_blank" rel="noopener" href="https://0x9.me/KMrv3">https://0x9.me/KMrv3</a></td>
</tr>
</tbody></table>
<hr>
<p><a target="_blank" rel="noopener" href="https://juejin.im/post/5a193b4bf265da43052e528a">原文地址</a> </p>
<p>前端无法像原生APP一样直接操作本地文件，否则的话打开个网页就能把用户电脑上的文件偷光了，所以需要通过用户触发，用户可通过以下三种方式操作触发：  </p>
<ol>
<li>通过input type=”file” 选择本地文件   </li>
<li>通过拖拽的方式把文件拖过来  </li>
<li>在编辑框里面复制粘贴  </li>
</ol>
<h3 id="第一种"><a href="#第一种" class="headerlink" title="第一种"></a>第一种</h3><p>第一种是最常用的手段，通常还会自定义一个按钮，然后盖在它上面，因为<code>type=&quot;file&quot;</code>的input不好改变样式。如下代码写一个选择控件，并放在form里面：  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">id</span>=<span class="string">&quot;file-input&quot;</span> <span class="attr">name</span>=<span class="string">&quot;fileContent&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>然后就可以用FormData获取整个表单的内容：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&quot;#file-input&quot;</span>).on(<span class="string">&quot;change&quot;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`file name is <span class="subst">$&#123;<span class="built_in">this</span>.value&#125;</span>`</span>);</span><br><span class="line">    <span class="keyword">let</span> formData = <span class="keyword">new</span> FormData(<span class="built_in">this</span>.form);</span><br><span class="line">    formData.append(<span class="string">&quot;fileName&quot;</span>, <span class="built_in">this</span>.value);</span><br><span class="line">    <span class="built_in">console</span>.log(formData);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>把input的value和formData打印出来是这样的：<br><img src="https://user-gold-cdn.xitu.io/2017/11/25/15ff349ac0afefa0?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="预览">  </p>
<p>可以看到文件的路径是一个假的路径，也就是说在浏览器无法获取到文件的真实存放位置。同时FormData打印出来是一个空的Objet，但并不是说它的内容是空的，只是它对前端开发人员是透明的，无法查看、修改、删除里面的内容，只能<code>append</code>添加字段。  </p>
<p><code>FormData</code>无法得到文件的内容，而使用<code>FileReader</code>可以读取整个文件的内容。用户选择文件之后，<code>input.files</code>就可以得到用户选中的文件，如下代码：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&quot;#file-input&quot;</span>).on(<span class="string">&quot;change&quot;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> fileReader = <span class="keyword">new</span> FileReader(),</span><br><span class="line">        fileType = <span class="built_in">this</span>.files[<span class="number">0</span>].type;</span><br><span class="line">    fileReader.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="regexp">/^image/</span>.test(fileType)) &#123;</span><br><span class="line">            <span class="comment">// 读取结果在fileReader.result里面</span></span><br><span class="line">            $(<span class="string">`&lt;img src=&quot;<span class="subst">$&#123;<span class="built_in">this</span>.result&#125;</span>&quot;&gt;`</span>).appendTo(<span class="string">&quot;body&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 打印原始File对象</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">this</span>.files[<span class="number">0</span>]);</span><br><span class="line">    <span class="comment">// base64方式读取</span></span><br><span class="line">    fileReader.readAsDataURL(<span class="built_in">this</span>.files[<span class="number">0</span>]);    </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>把原始的File对象打印出来是这样的：<br><img src="https://user-gold-cdn.xitu.io/2017/11/25/15ff349ac079ba68?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="预览">  </p>
<p>它是一个window.File的实例，包含了文件的修改时间、文件名、文件的大小、文件的mime类型等。<br>如果需要<code>限制上传文件的大小</code>就可以通过判断<code>size</code>属性有没有超，单位是字节，而要判断是否为图片文件就可以通过type类型是否以image开头。通过判断文件名的后缀可能会不准，而通过这种判断会比较准。上面的代码使用了一个正则判断，如果是一张图片的话就把它赋值给img的src，并添加到dom里面，但其实这段代码有点问题，就是web不是所有的图片都能通过img标签展示出来，通常是jpg/png/gif这三种，所以你应该需要再判断一下图片格式，如可以把判断改成：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/^image\/[jpeg|png|gif]/.test(<span class="built_in">this</span>.type)</span><br></pre></td></tr></table></figure>
<p>然后实例化一个<code>FileReader</code>，调它的<code>readAsDataURL</code>并把<code>File</code>对象传给它，监听它的<code>onload</code>事件，load完读取的结果就在它的<code>result</code>属性里了。它是一个<code>base64</code>格式的，可直接赋值给一个img的src。    </p>
<p>使用<code>FileReader</code>除了可读取为<code>base64</code>之外，还能读取为以下格式：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 按base64的方式读取，结果是base64，任何文件都可转成base64的形式</span></span><br><span class="line">fileReader.readAsDataURL(<span class="built_in">this</span>.files[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 以二进制字符串方式读取，结果是二进制内容的utf-8形式，已被废弃了</span></span><br><span class="line">fileReader.readAsBinaryString(<span class="built_in">this</span>.files[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 以原始二进制方式读取，读取结果可直接转成整数数组</span></span><br><span class="line">fileReader.readAsArrayBuffer(<span class="built_in">this</span>.files[<span class="number">0</span>]);</span><br></pre></td></tr></table></figure>
<p>其它的主要是能读取为<code>ArrayBuffer</code>，它是一个原始二进制格式的结果。把<code>ArrayBuffer</code>打印出来是这样的：<br><img src="https://user-gold-cdn.xitu.io/2017/11/25/15ff349ac05a9b42?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="预览"><br>可以看到，它对前端开发人员也是透明的，不能够直接读取里面的内容，但可以通过<code>ArrayBuffer.length</code>得到长度，还能转成整型数组，就能知道文件的原始二进制内容了：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> buffer = <span class="built_in">this</span>.result;</span><br><span class="line"><span class="comment">// 依次每字节8位读取，放到一个整数数组</span></span><br><span class="line"><span class="keyword">let</span> view = <span class="keyword">new</span> <span class="built_in">Uint8Array</span>(buffer);</span><br><span class="line"><span class="built_in">console</span>.log(view);</span><br></pre></td></tr></table></figure>

<h3 id="第二种"><a href="#第二种" class="headerlink" title="第二种"></a>第二种</h3><p>如果是通过第二种拖拽的方式，应该怎么读取文件呢？如下html（样式略）：  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;img-container&quot;</span>&gt;</span></span><br><span class="line">    drop your image here</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这将在页面显示一个框：<br><img src="https://user-gold-cdn.xitu.io/2017/11/25/15ff349ac1f2ebd5?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="预览">  </p>
<p>然后监听它的拖拽事件：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&quot;.img-container&quot;</span>).on(<span class="string">&quot;dragover&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line">    event.preventDefault();</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">.on(<span class="string">&quot;drop&quot;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">    event.preventDefault();</span><br><span class="line">    <span class="comment">// 数据在event的dataTransfer对象里</span></span><br><span class="line">    <span class="keyword">let</span> file = event.originalEvent.dataTransfer.files[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 然后就可以使用FileReader进行操作</span></span><br><span class="line">    fileReader.readAsDataURL(file);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 或者是添加到一个FormData</span></span><br><span class="line">    <span class="keyword">let</span> formData = <span class="keyword">new</span> FormData();</span><br><span class="line">    formData.append(<span class="string">&quot;fileContent&quot;</span>, file);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>数据在<code>drop</code>事件的<code>event.dataTransfer.files</code>里面，拿到这个<code>File</code>对象之后就可以和输入框进行一样的操作了，即使用<code>FileReader</code>读取，或者是新建一个空的<code>formData</code>，然后把它<code>append</code>到<code>formData</code>里面。</p>
<h3 id="第三种"><a href="#第三种" class="headerlink" title="第三种"></a>第三种</h3><p>第三种粘贴的方式，通常是在一个编辑框里操作，如把<code>div</code>的<code>contenteditable</code>设置为true：  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">contenteditable</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">    hello, paste your image here</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>粘贴的数据是在<code>event.clipboardData.files</code>里面：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&quot;#editor&quot;</span>).on(<span class="string">&quot;paste&quot;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> file = event.originalEvent.clipboardData.files[<span class="number">0</span>];</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>但是Safari的粘贴不是通过<code>event</code>传递的，它是直接在输入框里面添加一张图片，如下图所示：<br><img src="https://user-gold-cdn.xitu.io/2017/11/25/15ff349ac3330972?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="预览">  </p>
<p>它新建了一个<code>img</code>标签，并把<code>img</code>的<code>src</code>指向一个<code>blob</code>的本地数据。什么是<code>blob</code>呢，如何读取<code>blob</code>的内容呢？<br>blob是一种类文件的存储格式，它可以存储几乎任何格式的内容，如json：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> data = &#123;<span class="attr">hello</span>: <span class="string">&quot;world&quot;</span>&#125;;</span><br><span class="line"><span class="keyword">let</span> blob = <span class="keyword">new</span> Blob([<span class="built_in">JSON</span>.stringify(data)],</span><br><span class="line">  &#123;<span class="attr">type</span> : <span class="string">&#x27;application/json&#x27;</span>&#125;);</span><br></pre></td></tr></table></figure>
<p>为了获取本地的blob数据，我们可以用ajax发个本地的请求：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&quot;#editor&quot;</span>).on(<span class="string">&quot;paste&quot;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 需要setTimeout 0等图片出来了再处理</span></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> img = $(<span class="built_in">this</span>).find(<span class="string">&quot;img[src^=&#x27;blob&#x27;]&quot;</span>)[<span class="number">0</span>];</span><br><span class="line">        <span class="built_in">console</span>.log(img.src);</span><br><span class="line">        <span class="comment">// 用一个xhr获取blob数据</span></span><br><span class="line">        <span class="keyword">let</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">        xhr.open(<span class="string">&quot;GET&quot;</span>, img.src);</span><br><span class="line">        <span class="comment">// 改变mime类型</span></span><br><span class="line">        xhr.responseType = <span class="string">&quot;blob&quot;</span>;</span><br><span class="line">        xhr.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="comment">// response就是一个Blob对象</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="built_in">this</span>.response);</span><br><span class="line">        &#125;;</span><br><span class="line">        xhr.send();</span><br><span class="line">    &#125;, <span class="number">0</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>上面代码把blob打印出来是这样的：<br><img src="https://user-gold-cdn.xitu.io/2017/11/25/15ff349ac408b172?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="预览">  </p>
<p>能得到它的大小和类型，但是具体内容也是不可见的，它有一个<code>slice</code>的方法，可用于切割大文件。和<code>File</code>一样，可以使用<code>FileReader</code>读取它的内容：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">readBlob</span>(<span class="params">blobImg</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> fileReader = <span class="keyword">new</span> FileReader();</span><br><span class="line">    fileReader.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="built_in">this</span>.result);</span><br><span class="line">    &#125;</span><br><span class="line">    fileReader.onerror = <span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(err);</span><br><span class="line">    &#125;</span><br><span class="line">    fileReader.readAsDataURL(blobImg);</span><br><span class="line">&#125;</span><br><span class="line">readBlob(<span class="built_in">this</span>.response);</span><br></pre></td></tr></table></figure>
<p>除此，还能使用<code>window.URL</code>读取，这是一个新的API，经常和<code>Service Worker</code>配套使用，因为SW里面常常要解析url。如下代码：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">readBlob</span>(<span class="params">blobImg</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> urlCreator = <span class="built_in">window</span>.URL || <span class="built_in">window</span>.webkitURL;</span><br><span class="line">    <span class="comment">// 得到base64结果</span></span><br><span class="line">    <span class="keyword">let</span> imageUrl = urlCreator.createObjectURL(<span class="built_in">this</span>.response);</span><br><span class="line">    <span class="keyword">return</span> imageUrl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">readBlob(<span class="built_in">this</span>.response);</span><br></pre></td></tr></table></figure>
<p>关于src使用的是blob链接的，除了上面提到的img之外，另外一个很常见的是video标签，如youtobe的视频就是使用的blob：<br><img src="https://user-gold-cdn.xitu.io/2017/11/25/15ff349af40951d9?imageView2/0/w/1280/h/960/format/webp/ignore-error/1">  </p>
<p>这种数据不是直接在本地的，而是通过持续请求视频数据，然后再通过<code>blob</code>这个容器媒介添加到<code>video</code>里面，它也是通过URL的API创建的：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> mediaSource = <span class="keyword">new</span> MediaSource();</span><br><span class="line">video.src = URL.createObjectURL(mediaSource);</span><br><span class="line"><span class="keyword">let</span> sourceBuffer = mediaSource.addSourceBuffer(<span class="string">&#x27;video/mp4; codecs=&quot;avc1.42E01E, mp4a.40.2&quot;&#x27;</span>);</span><br><span class="line">sourceBuffer.appendBuffer(buf);</span><br></pre></td></tr></table></figure>
<p>具体我也没实践过，不再展开讨论。  </p>
<p>上面，我们使用了三种方式获取文件内容，最后得到：  </p>
<ol>
<li><code>FormData</code>格式</li>
<li><code>FileReader</code>读取得到的<code>base64</code>或者<code>ArrayBuffer</code>二进制格式  </li>
</ol>
<p>如果直接就是一个<code>FormData</code>了，那么直接用<code>ajax</code>发出去就行了，不用做任何处理：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> form = <span class="built_in">document</span>.querySelector(<span class="string">&quot;form&quot;</span>),</span><br><span class="line">    formData = <span class="keyword">new</span> FormData(form),</span><br><span class="line">formData.append(<span class="string">&quot;fileName&quot;</span>, <span class="string">&quot;photo.png&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line"><span class="comment">// 假设上传文件的接口叫upload</span></span><br><span class="line">xhr.open(<span class="string">&quot;POST&quot;</span>, <span class="string">&quot;/upload&quot;</span>);</span><br><span class="line">xhr.send(formData);</span><br></pre></td></tr></table></figure>
<p>如果用jQuery的话，要设置两个属性为false：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$.ajax(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&quot;/upload&quot;</span>,</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">    <span class="attr">data</span>: formData,</span><br><span class="line">    <span class="attr">processData</span>: <span class="literal">false</span>,  <span class="comment">// 不处理数据</span></span><br><span class="line">    <span class="attr">contentType</span>: <span class="literal">false</span>   <span class="comment">// 不设置内容类型</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>因为jQuery会自动把内容做一些转义，并且根据<code>data</code>自动设置请求<code>mime</code>类型，这里告诉jQuery直接用<code>xhr.send</code>发出去就行了。  </p>
<p>观察控制台发请求的数据：<br><img src="https://user-gold-cdn.xitu.io/2017/11/25/15ff349b104c3494?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="预览">  </p>
<p>可以看到这是一种区别于用<code>&amp;</code>连接参数的方式，它的编码格式是<code>multipart/form-data</code>，就是上传文件<code>form</code>表单写的<code>enctype</code>：  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;fileContent&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>如果<code>xhr.send</code>的是<code>FormData</code>类型话，它会自动设置<code>enctype</code>，如果你用默认表单提交上传文件的话就得在<code>form</code>上面设置这个属性，因为上传文件只能使用<code>POST</code>的这种编码。常用的<code>POST</code>编码是<code>application/x-www-form-urlencoded</code>，它和<code>GET</code>一样，发送的数据里面，参数和参数之间使用<code>&amp;</code>连接，如：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">key1=value1&amp;key2=value2</span><br></pre></td></tr></table></figure>
<p>特殊字符做转义，这个数据<code>POST</code>是放在请求<code>body</code>里的，而<code>GET</code>是拼在<code>url</code>上面的，如果用jq的话，jq会帮你拼并做转义。</p>
<p>而上传文件用的这种<code>multipart/form-data</code>，参数和参数之间是且一个相同的字符串隔开的，上面的是使用：  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">------WebKitFormBoundary72yvM25iSPYZ4a3F</span><br></pre></td></tr></table></figure>
<p>这个字符通常会取得比较长、比较随机，因为要保证正常的内容里面不会出现这个字符串，这样内容的特殊字符就不用做转义了。  </p>
<p>请求的contentType被浏览器设置成：  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Content-Type:</span><br><span class="line">multipart/form-data; boundary=----WebKitFormBoundary72yvM25iSPYZ4a3F</span><br></pre></td></tr></table></figure>
<p>后端服务通过这个就知道怎么解析这么一段数据了。（通常是使用的框架处理了，而具体的接口不需要关心应该怎么解析）  </p>
<p>如果读取结果是<code>ArrayBuffer</code>的话，也是可以直接用<code>xhr.send</code>发送出去的，但是一般我们不会直接把一个文件的内容发出去，而是用某个字段名等于文件内容的方式。如果你读取为<code>ArrayBuffer</code>的话再上传的话其实作用不是很大，还不如直接用<code>formData</code>添加一个<code>File</code>对象的内容，因为上面三种方式都可以拿到<code>File</code>对象。如果一开始就是一个<code>ArrayBuffer</code>了，那么可以转成<code>blob</code>然后再<code>append</code>到<code>FormData</code>里面。  </p>
<p>使用比较多的应该是<code>base64</code>，因为前端经常要处理图片，读取为<code>base64</code>之后就可以把它画到一个<code>canvas</code>里面，然后就可以做一些处理，如压缩、裁剪、旋转等。最后再用<code>canvas</code>导出一个<code>base64</code>格式的图片，那怎么上传<code>base64</code>格式的呢？  </p>
<h3 id="怎么上传base64格式"><a href="#怎么上传base64格式" class="headerlink" title="怎么上传base64格式"></a>怎么上传<code>base64</code>格式</h3><p>第一种是拼一个表单上传的<code>multipart/form-data</code>的格式，再用<code>xhr.sendAsBinary</code>发出去，如下代码：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> base64Data = base64Data.replace(<span class="regexp">/^data:image\/[^;]+;base64,/</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> boundary = <span class="string">&quot;----------boundaryasoifvlkasldvavoadv&quot;</span>;</span><br><span class="line">xhr.sendAsBinary([</span><br><span class="line">    <span class="comment">// name=data</span></span><br><span class="line">    boundary,</span><br><span class="line">        <span class="string">&#x27;Content-Disposition: form-data; name=&quot;data&quot;; filename=&quot;&#x27;</span> + fileName + <span class="string">&#x27;&quot;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Content-Type: &#x27;</span> + <span class="string">&quot;image/&quot;</span> + fileType, <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        atob(base64Data), boundary,</span><br><span class="line">    <span class="comment">//name=imageType</span></span><br><span class="line">    boundary,</span><br><span class="line">        <span class="string">&#x27;Content-Disposition: form-data; name=&quot;imageType&quot;&#x27;</span>, <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        fileType,</span><br><span class="line">    boundary + <span class="string">&#x27;--&#x27;</span></span><br><span class="line">].join(<span class="string">&#x27;\r\n&#x27;</span>));</span><br></pre></td></tr></table></figure>
<p>上面代码使用了<code>window.atob</code>的api，它可以把<code>base64</code>还原成原始内容的字符串表示，如下图所示：<br><img src="https://user-gold-cdn.xitu.io/2017/11/25/15ff349b4c18f7d8?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="预览"></p>
<p><code>btoa</code>是把内容转化成<code>base64</code>编码，而<code>atob</code>是把<code>base64</code>还原。在调<code>atob</code>之前，需要把表示内容格式的不属于<code>base64</code>内容的字符串去掉，即上面代码第一行的<code>replace</code>处理。  </p>
<p>这样就和使用<code>formData</code>类似了，但是由于<code>sendAsBinary</code>已经被<code>deprecated</code>了，所以新代码不建议再使用这种方式。那怎么办呢？</p>
<p>可以把<code>base64</code>转化成<code>blob</code>，然后再<code>append</code>到一个<code>formData</code>里面，下面的函数（来自b64-to-blob）可以把<code>base64</code>转成<code>blob</code>：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">b64toBlob</span>(<span class="params">b64Data, contentType, sliceSize</span>) </span>&#123;</span><br><span class="line">    contentType = contentType || <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    sliceSize = sliceSize || <span class="number">512</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> byteCharacters = atob(b64Data);</span><br><span class="line">    <span class="keyword">var</span> byteArrays = [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> offset = <span class="number">0</span>; offset &lt; byteCharacters.length; offset += sliceSize) &#123;</span><br><span class="line">      <span class="keyword">var</span> slice = byteCharacters.slice(offset, offset + sliceSize);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">var</span> byteNumbers = <span class="keyword">new</span> <span class="built_in">Array</span>(slice.length);</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; slice.length; i++) &#123;</span><br><span class="line">        byteNumbers[i] = slice.charCodeAt(i);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">var</span> byteArray = <span class="keyword">new</span> <span class="built_in">Uint8Array</span>(byteNumbers);</span><br><span class="line"></span><br><span class="line">      byteArrays.push(byteArray);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> blob = <span class="keyword">new</span> Blob(byteArrays, &#123;<span class="attr">type</span>: contentType&#125;);</span><br><span class="line">    <span class="keyword">return</span> blob;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后就可以<code>append</code>到<code>formData</code>里面：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> blob = b64toBlob(b64Data, <span class="string">&quot;image/png&quot;</span>),</span><br><span class="line">    formData = <span class="keyword">new</span> FormData();</span><br><span class="line">formData.append(<span class="string">&quot;fileContent&quot;</span>, blob);</span><br></pre></td></tr></table></figure>
<p>这样就不用自己去拼一个<code>multipart/form-data</code>的格式数据了。  </p>
<p>上面处理和上传文件的API可以兼容到IE10+，如果要兼容老的浏览器应该怎么办呢？  </p>
<p>可以借助一个<code>iframe</code>，原理是默认的<code>form</code>表单提交会刷新页面，或者跳到<code>target</code>指定的那个url，但是如果把<code>ifrmae</code>的<code>target</code>指向一个<code>iframe</code>，那么刷新的就是<code>iframe</code>，返回结果也会显示在<code>ifame</code>，然后获取这个<code>ifrmae</code>的内容就可得到上传接口返回的结果。  </p>
<p>如下代码：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> iframe = <span class="built_in">document</span>.createElement(<span class="string">&quot;iframe&quot;</span>);</span><br><span class="line">iframe.display = <span class="string">&quot;none&quot;</span>;</span><br><span class="line">iframe.name = <span class="string">&quot;form-iframe&quot;</span>;</span><br><span class="line"><span class="built_in">document</span>.body.appendChild(iframe);</span><br><span class="line"><span class="comment">// 改变form的target</span></span><br><span class="line">form.target = <span class="string">&quot;form-iframe&quot;</span>;</span><br><span class="line"></span><br><span class="line">iframe.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//获取iframe的内容，即服务返回的数据</span></span><br><span class="line">    <span class="keyword">let</span> responseText = <span class="built_in">this</span>.contentDocument.body.textContent </span><br><span class="line">            || <span class="built_in">this</span>.contentWindow.document.body.textContent;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">form.submit();</span><br></pre></td></tr></table></figure>
<p><code>form.submit</code>会触发表单提交，当请求完成（成功或者失败）之后就会触发iframe的onload事件，然后在onload事件获取返回的数据，如果请求失败了的话，iframe里的内容就为空，可以用这个判断请求有没有成功。   </p>
<p>使用iframe没有办法获取上传进度，使用xhr可以获取当前上传的进度，这个是在XMLHttpRequest 2.0引入的：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">xhr.upload.onprogress = <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (event.lengthComputable) &#123;</span><br><span class="line">        <span class="comment">// 当前上传进度的百分比</span></span><br><span class="line">        duringCallback ((event.loaded / event.total)*<span class="number">100</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>这样就可以做一个真实的loading进度条。  </p>
<p>本文讨论了3种交互方式的读取方式，通过<code>input</code>控件在<code>input.files</code>可以得到File文件对象，通过拖拽的是在<code>drop</code>事件的<code>event.dataTransfer.files</code>里面，而通过粘贴的<code>paste</code>事件在<code>event.clipboardData.files</code>里面，Safari这个怪胎是在编辑器里面插入一个src指向本地的img标签，可以通过发送一个请求加载本地的<code>blob</code>数据，然后再通过<code>FileReader</code>读取，或者直接<code>append</code>到<code>formData</code>里面。得到的File对象就可以直接添加到<code>FormData</code>里面，如果需要先读取<code>base64</code>格式做处理的，那么可以把处理后的<code>base64</code>转化为<code>blob</code>数据再<code>append</code>到<code>formData</code>里面。对于老浏览器，可以使用一个iframe解决表单提交刷新页面或者跳页的问题。  </p>
<p>总之，前端处理和上传本地文件应该差不多就是这些内容了，但是应该还有好多细节没有提及到，读者可通过本文列的方向自行实践。如果有其它的上传方式还请告知。  </p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/09/03/73-%E3%80%90JavaScript%E3%80%91%E5%89%8D%E7%AB%AF%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C%E5%92%8C%E4%B8%8A%E4%BC%A0/" data-id="ckts3ejze00o44d9k3tkm6jby" data-title="73-【JavaScript】前端本地文件操作和上传" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/" rel="tag">JavaScript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" rel="tag">前端开发</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-72-【CSS】移动端页面开发常见问题和解决" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/08/31/72-%E3%80%90CSS%E3%80%91%E7%A7%BB%E5%8A%A8%E7%AB%AF%E9%A1%B5%E9%9D%A2%E5%BC%80%E5%8F%91%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E5%92%8C%E8%A7%A3%E5%86%B3/" class="article-date">
  <time class="dt-published" datetime="2018-08-31T06:10:08.000Z" itemprop="datePublished">2018-08-31</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/08/31/72-%E3%80%90CSS%E3%80%91%E7%A7%BB%E5%8A%A8%E7%AB%AF%E9%A1%B5%E9%9D%A2%E5%BC%80%E5%8F%91%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E5%92%8C%E8%A7%A3%E5%86%B3/">72-【CSS】移动端页面开发常见问题和解决</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <hr>
<table>
<thead>
<tr>
<th>Author</th>
<th>王平安</th>
</tr>
</thead>
<tbody><tr>
<td>E-mail</td>
<td><a href="mailto:&#x70;&#x69;&#110;&#103;&#x61;&#110;&#x38;&#x37;&#x38;&#x37;&#x40;&#113;&#x71;&#46;&#99;&#111;&#109;">&#x70;&#x69;&#110;&#103;&#x61;&#110;&#x38;&#x37;&#x38;&#x37;&#x40;&#113;&#x71;&#46;&#99;&#111;&#109;</a></td>
</tr>
<tr>
<td>博  客</td>
<td><a target="_blank" rel="noopener" href="http://www.pingan8787.com/">www.pingan8787.com</a></td>
</tr>
<tr>
<td>微  信</td>
<td>pingan8787</td>
</tr>
<tr>
<td>每日文章</td>
<td><a target="_blank" rel="noopener" href="https://0x9.me/KMrv3">https://0x9.me/KMrv3</a></td>
</tr>
</tbody></table>
<hr>
<h2 id="1-解决页面使用-overflow-scroll-在-iOS-上滑动卡顿的问题"><a href="#1-解决页面使用-overflow-scroll-在-iOS-上滑动卡顿的问题" class="headerlink" title="1.解决页面使用 overflow: scroll 在 iOS 上滑动卡顿的问题?"></a>1.解决页面使用 overflow: scroll 在 iOS 上滑动卡顿的问题?</h2><p>首先你可能会给页面的 html 和 body 增加了 height: 100%, 然后就可能造成 iOS 上页面滑动的卡顿问题。解决方案是：<br>(1) 看是否能把 body 和 html 的 height: 100% 去除掉。<br>(2) 在滚动的容器中增加：<code>-webkit-overflow-scrolling: touch</code> 或者给 body 增加：<code>body &#123;overflow-x: hidden&#125;</code>。  </p>
<h2 id="2-iOS-页面橡皮弹回效果遮挡页面选项卡？"><a href="#2-iOS-页面橡皮弹回效果遮挡页面选项卡？" class="headerlink" title="2.iOS 页面橡皮弹回效果遮挡页面选项卡？"></a>2.iOS 页面橡皮弹回效果遮挡页面选项卡？</h2><p>(1) 有时 body 和 html 的 height: 100% 去除掉问题可能就没有了。<br>(2) 到达临界值的时候在阻止事件默认行为  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> startY,endY;</span><br><span class="line"><span class="comment">//记录手指触摸的起点坐标</span></span><br><span class="line">$(<span class="string">&#x27;body&#x27;</span>).on(<span class="string">&#x27;touchstart&#x27;</span>,<span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">     startY = e.touches[<span class="number">0</span>].pageY;</span><br><span class="line">&#125;);</span><br><span class="line">$(<span class="string">&#x27;body&#x27;</span>).on(<span class="string">&#x27;touchmove&#x27;</span>,<span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">     endY = e.touches[<span class="number">0</span>].pageY;  <span class="comment">//记录手指触摸的移动中的坐标</span></span><br><span class="line">     <span class="comment">//手指下滑，页面到达顶端不能继续下滑</span></span><br><span class="line">     <span class="keyword">if</span>(endY&gt;startY&amp;&amp; $(<span class="built_in">window</span>).scrollTop()&lt;=<span class="number">0</span>)&#123;</span><br><span class="line">         e.preventDefault();</span><br><span class="line">     &#125;</span><br><span class="line">   <span class="comment">//手指上滑，页面到达底部能继续上滑</span></span><br><span class="line">     <span class="keyword">if</span>(endY&lt;startY&amp;&amp; $(<span class="built_in">window</span>).scrollTop()+ </span><br><span class="line">         $(<span class="built_in">window</span>).height()&gt;=$(<span class="string">&#x27;body&#x27;</span>)[<span class="number">0</span>].scrollHeight)&#123;</span><br><span class="line">         e.preventDefault();</span><br><span class="line">     &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>有时也会碰见弹窗出来后两个层的橡皮筋效果出现问题，我们可以在弹出弹出时给底层页面加上一个类名，类名禁止页面滑动这样下层的橡皮筋效果就会被禁止，就不会影响弹窗层。</p>
<h2 id="3-iOS-机型-margin-属性无效问题？"><a href="#3-iOS-机型-margin-属性无效问题？" class="headerlink" title="3.iOS 机型 margin 属性无效问题？"></a>3.iOS 机型 margin 属性无效问题？</h2><p>(1) 设置 html body 的高度为百分比时，margin-bottom 在 safari 里失效<br>(2) 直接 padding 代替 margin  </p>
<h2 id="4-iOS-绑定点击事件不执行？"><a href="#4-iOS-绑定点击事件不执行？" class="headerlink" title="4.iOS 绑定点击事件不执行？"></a>4.iOS 绑定点击事件不执行？</h2><p>(1) 添加样式 <code>cursor ：pointer</code>。点击后消除背景闪一下的 css：<code>-webkit-tap-highlight-color:transparent</code>;</p>
<h2 id="5-iOS-键盘换行变为搜索？"><a href="#5-iOS-键盘换行变为搜索？" class="headerlink" title="5.iOS 键盘换行变为搜索？"></a>5.iOS 键盘换行变为搜索？</h2><p>首先，input 要放在 form 里面。<br>这时 “换行” 已经变成 “前往”。<br>如果想变成 “搜索”，input 设置 <code>type=&quot;search&quot;</code>。  </p>
<h2 id="6-jQuery对-a-标签点击事件不生效？"><a href="#6-jQuery对-a-标签点击事件不生效？" class="headerlink" title="6.jQuery对 a 标签点击事件不生效？"></a>6.jQuery对 a 标签点击事件不生效？</h2><p>出现这种情况的原因不明，有的朋友解释：我们平时都是点击的 A 标签中的文字了。 所以要想用 JS 模拟点击 A 标签事件，就得先往 A 标签中的文字添加能被 JS 捕获的元素，然后再用 JS 模拟点击该元素即可。但是我觉得不合理，虽然找不到原因但是解决办法还是有的。  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 方法1</span></span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">&quot;abc&quot;</span>).click();</span><br><span class="line"><span class="comment">// 方法2</span></span><br><span class="line">$(<span class="string">&quot;#abc&quot;</span>)[<span class="number">0</span>].click();</span><br></pre></td></tr></table></figure>
<h2 id="7-有时因为服务器或者别的原因导致页面上的图片没有找到？"><a href="#7-有时因为服务器或者别的原因导致页面上的图片没有找到？" class="headerlink" title="7.有时因为服务器或者别的原因导致页面上的图片没有找到？"></a>7.有时因为服务器或者别的原因导致页面上的图片没有找到？</h2><p>这是我们想需要用一个本地的图片代替没有找的的图片   </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="javascript"> </span></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">nofind</span>(<span class="params"></span>)</span>&#123; </span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> img=event.srcElement; </span></span><br><span class="line"><span class="javascript">    img.src=<span class="string">&quot;images/logoError.png&quot;</span>; </span></span><br><span class="line"><span class="javascript">    img.onerror=<span class="literal">null</span>; 控制不要一直跳动 </span></span><br><span class="line"><span class="javascript">&#125; </span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;images/logo.png&quot;</span> <span class="attr">onerror</span>=<span class="string">&quot;nofind();&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="8-transform-属性影响-position-fixed？"><a href="#8-transform-属性影响-position-fixed？" class="headerlink" title="8.transform 属性影响 position:fixed？"></a>8.transform 属性影响 position:fixed？</h2><p>(1) 规范中有规定：如果元素的 transform 值不为 none，则该元素会生成包含块和层叠上下文。CSS Transforms Module Level 1 不只在手机上，电脑上也一样。除了 fixed 元素会受影响之外，z-index（层叠上下文）值也会受影响。绝对定位元素等和包含块有关的属性都会受到影响。当然如果 transform 元素的 display 值为 inline 时又会有所不同。最简单的解决方法就是 transform 元素内部不能有 absolute、fixed 元素.  </p>
<h2 id="9-iOS-对-position-fixed-不太友好，有时我们需要加点处理？"><a href="#9-iOS-对-position-fixed-不太友好，有时我们需要加点处理？" class="headerlink" title="9.iOS 对 position: fixed 不太友好，有时我们需要加点处理？"></a>9.iOS 对 position: fixed 不太友好，有时我们需要加点处理？</h2><p>在安卓上面，点击页面底部的输入框，软键盘弹出，页面移动上移。 而 iOS 上面，点击页面底部输入框，软键盘弹出，输入框看不到了。。。查资料说什么的都有，iscroll,jquery-moblie，absolute，fixe，static 都非常复杂，要改很多。。。 让他弹出时让滚动条在最低部  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> u = navigator.userAgent, app = navigator.appVersion;</span><br><span class="line"><span class="keyword">var</span> isiOS = !!u.match(<span class="regexp">/\(i[^;]+;( U;)? CPU.+Mac OS X/</span>); <span class="comment">//iOS终端</span></span><br><span class="line"><span class="keyword">if</span> (isiOS) &#123;</span><br><span class="line">    $(<span class="string">&#x27;textarea&#x27;</span>).focus(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">window</span>.setTimeout(<span class="string">&#x27;scrollBottom()&#x27;</span>, <span class="number">500</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">scrollBottom</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">window</span>.scrollTo(<span class="number">0</span>, $(<span class="string">&#x27;body&#x27;</span>).height());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="10-jQuery-validate-插件验证问题？"><a href="#10-jQuery-validate-插件验证问题？" class="headerlink" title="10.jQuery validate 插件验证问题？"></a>10.jQuery validate 插件验证问题？</h2><p>所有的 input 必须有 name 不然会出错  </p>
<h2 id="11-有时手机会出现断网的情况，我没可能会对断网的情况做一些处理？"><a href="#11-有时手机会出现断网的情况，我没可能会对断网的情况做一些处理？" class="headerlink" title="11.有时手机会出现断网的情况，我没可能会对断网的情况做一些处理？"></a>11.有时手机会出现断网的情况，我没可能会对断网的情况做一些处理？</h2><p><code>navigator.onLine</code> 可判断是否是脱机状态.  </p>
<h2 id="12-判断对象的长度？"><a href="#12-判断对象的长度？" class="headerlink" title="12.判断对象的长度？"></a>12.判断对象的长度？</h2><p>(1) 用 <code>Object.keys</code>，<code>Object.keys</code> 方法返回的是一个数组，数组里面装的是对象的属性。  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> person = &#123;</span><br><span class="line">    <span class="string">&quot;name&quot;</span> : <span class="string">&quot;zhangshan&quot;</span>,</span><br><span class="line">    <span class="string">&quot;sex&quot;</span> : <span class="string">&quot;man&quot;</span>,</span><br><span class="line">    <span class="string">&quot;age&quot;</span> : <span class="string">&quot;50&quot;</span>,</span><br><span class="line">    <span class="string">&quot;height&quot;</span> : <span class="string">&quot;180&quot;</span>,</span><br><span class="line">    <span class="string">&quot;phone&quot;</span> : <span class="string">&quot;1xxxxxxxxxx&quot;</span>,</span><br><span class="line">    <span class="string">&quot;email&quot;</span> : <span class="string">&quot;xxxxxxxxx@xxx.com&quot;</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> arr = <span class="built_in">Object</span>.keys(person);</span><br><span class="line"><span class="built_in">console</span>.log(arr.length);</span><br></pre></td></tr></table></figure>
<p>(2)Object.getOwnPropertyNames(obj).length</p>
<h2 id="13-上一题我们用到了-Object-keys-与-Object-getOwnPropertyNames-他们的区别？"><a href="#13-上一题我们用到了-Object-keys-与-Object-getOwnPropertyNames-他们的区别？" class="headerlink" title="13.上一题我们用到了 Object.keys 与 Object.getOwnPropertyNames 他们的区别？"></a>13.上一题我们用到了 Object.keys 与 Object.getOwnPropertyNames 他们的区别？</h2><p><code>Object.keys</code> 定义：返回一个对象可枚举属性的字符串数组；<br><code>Object.getOwnPropertyNames</code> 定义：返回一个对象可枚举、不可枚举属性的名称；<br>属性的可枚举性、不可枚举性：定义：可枚举属性是指那些内部 “可枚举” 标志设置为 true 的属性，对于通过直接的赋值和属性初始化的属性，该标识值默认为即为 true，对于通过 <code>Object.defineProperty</code> 等定义的属性，该标识值默认为 false。    </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123; <span class="string">&quot;prop1&quot;</span>: <span class="string">&quot;v1&quot;</span> &#125;;</span><br><span class="line"><span class="built_in">Object</span>.defineProperty(obj, <span class="string">&quot;prop2&quot;</span>, &#123; <span class="attr">value</span>: <span class="string">&quot;v2&quot;</span>, <span class="attr">enumerable</span>: <span class="literal">false</span> &#125;);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.keys(obj).length);           <span class="comment">//output：1</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.getOwnPropertyNames(obj).length);    <span class="comment">//output：2</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.keys(obj));           <span class="comment">//output：Array[1] =&gt; [0: &quot;prop1&quot;]</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.getOwnPropertyNames(obj));    <span class="comment">//output：Array[2] =&gt; [0: &quot;prop1&quot;, 1: &quot;prop2&quot;]</span></span><br></pre></td></tr></table></figure>
<p><img src="http://images.pingan8787.com/196513361-5b16021f6db85_articlex.png" alt="内置的判断,访问和迭代方法"><br>综合实例：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123; <span class="string">&quot;prop1&quot;</span>: <span class="string">&quot;v1&quot;</span> &#125;;</span><br><span class="line"><span class="built_in">Object</span>.defineProperty(obj, <span class="string">&quot;prop2&quot;</span>, &#123; <span class="attr">value</span>: <span class="string">&quot;v2&quot;</span>, <span class="attr">enumerable</span>: <span class="literal">false</span>&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(obj.hasOwnProperty(<span class="string">&quot;prop1&quot;</span>)); <span class="comment">//output: true</span></span><br><span class="line"><span class="built_in">console</span>.log(obj.hasOwnProperty(<span class="string">&quot;prop2&quot;</span>)); <span class="comment">//output: true</span></span><br><span class="line"><span class="built_in">console</span>.log(obj.propertyIsEnumerable(<span class="string">&quot;prop1&quot;</span>)); <span class="comment">//output: true</span></span><br><span class="line"><span class="built_in">console</span>.log(obj.propertyIsEnumerable(<span class="string">&quot;prop2&quot;</span>)); <span class="comment">//output: false</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;prop1&#x27;</span> <span class="keyword">in</span> obj);    <span class="comment">//output: true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;prop2&#x27;</span> <span class="keyword">in</span> obj);    <span class="comment">//output: true</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> item <span class="keyword">in</span> obj) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(item);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//output：prop1</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> item <span class="keyword">in</span> <span class="built_in">Object</span>.getOwnPropertyNames(obj)) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">Object</span>.getOwnPropertyNames(obj)[item]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ouput:[prop1,prop2]</span></span><br></pre></td></tr></table></figure>

<h2 id="14-移动开发不同手机弹出数字键盘问题？"><a href="#14-移动开发不同手机弹出数字键盘问题？" class="headerlink" title="14.移动开发不同手机弹出数字键盘问题？"></a>14.移动开发不同手机弹出数字键盘问题？</h2><h4 id="1-type-”tel”"><a href="#1-type-”tel”" class="headerlink" title="1. type=”tel”"></a>1. type=”tel”</h4><p>iOS 和 Android 的键盘表现都差不多  </p>
<h4 id="2-type-”number”"><a href="#2-type-”number”" class="headerlink" title="2. type=”number”"></a>2. type=”number”</h4><p><strong>优点</strong>：Android 下实现的一个真正的数字键盘<br><strong>缺点一</strong>：iOS 下不是九宫格键盘，输入不方便<br><strong>缺点二</strong>：旧版 Android（包括微信所用的 X5 内核）在输入框后面会有超级鸡肋的小尾巴，好在 Android 4.4.4 以后给去掉了。 不过对于缺点二，我们可以用 webkit 私有的伪元素给 fix 掉：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">input[type=number]::-webkit-inner-spin-button,  </span><br><span class="line">input[type=number]::-webkit-outer-spin-button &#123; </span><br><span class="line">        -webkit-appearance: none; </span><br><span class="line">        appearance: none; </span><br><span class="line">        margin: <span class="number">0</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="3-pattern-属性"><a href="#3-pattern-属性" class="headerlink" title="3. pattern 属性"></a>3. pattern 属性</h4><p>pattern 用于验证表单输入的内容，通常 HTML5 的 type 属性，比如 email、tel、number、data 类、url 等，已经自带了简单的数据格式验证功能了，加上 pattern 后，前端部分的验证更加简单高效了。<br>显而易见，pattern 的属性值要用正则表达式。<br>实例 简单的数字验证<br>数字的验证有两个：  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;number&quot;</span> <span class="attr">pattern</span>=<span class="string">&quot;d&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;number&quot;</span> <span class="attr">pattern</span>=<span class="string">&quot;[0-9]*&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="15-input-number-类型输入非数字字符"><a href="#15-input-number-类型输入非数字字符" class="headerlink" title="15.input[number] 类型输入非数字字符"></a>15.input[number] 类型输入非数字字符</h2><p>js 获取的值是空；比如 - 12，+123 等  </p>
<h2 id="16-Javascript：history-go-和-history-back-的用法与区别？"><a href="#16-Javascript：history-go-和-history-back-的用法与区别？" class="headerlink" title="16.Javascript：history.go() 和 history.back() 的用法与区别？"></a>16.Javascript：history.go() 和 history.back() 的用法与区别？</h2><p><code>go(-1)</code>: 返回上一页，原页面表单中的内容会丢失；<br><code>back()</code>: 返回上一页，原页表表单中的内容会保留；<br><code>history.go(-1)</code>: 后退 + 刷新；<br><code>history.back()</code>: 后退；  </p>
<p>之所以注意到这个区别，是因为不同的浏览器后退行为也是有区别的，而区别就跟 <code>javascript：history.go()</code> 和 <code>history.back()</code> 的区别类似。<br>Chrome 和 ff 浏览器后退页面，会刷新后退的页面，若有数据请求也会提交数据申请。类似于 <code>history.go(-1)</code>;<br>而 safari（包括桌面版和 ipad 版）的后退按钮则不会刷新页面，也不会提交数据申请。类似于 <code>javascript：history.back()</code>;  </p>
<h2 id="17-Meta-基础知识："><a href="#17-Meta-基础知识：" class="headerlink" title="17.Meta 基础知识："></a>17.Meta 基础知识：</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span><span class="attr">content</span>=<span class="string">&quot;width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no&quot;</span> /&gt;</span></span><br><span class="line">// width    设置viewport宽度，为一个正整数，或字符串‘device-width’</span><br><span class="line">// height   设置viewport高度，一般设置了宽度，会自动解析出高度，可以不用设置</span><br><span class="line">// initial-scale    默认缩放比例，为一个数字，可以带小数</span><br><span class="line">// minimum-scale    允许用户最小缩放比例，为一个数字，可以带小数</span><br><span class="line">// maximum-scale    允许用户最大缩放比例，为一个数字，可以带小数</span><br><span class="line">// user-scalable    是否允许手动缩放 </span><br><span class="line">空白页基本meta标签</span><br><span class="line"><span class="comment">&lt;!-- 设置缩放 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1, user-scalable=no, minimal-ui&quot;</span> /&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 可隐藏地址栏，仅针对IOS的Safari（注：IOS7.0版本以后，safari上已看不到效果） --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;apple-mobile-web-app-capable&quot;</span> <span class="attr">content</span>=<span class="string">&quot;yes&quot;</span> /&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 仅针对IOS的Safari顶端状态条的样式（可选default/black/black-translucent ） --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;apple-mobile-web-app-status-bar-style&quot;</span> <span class="attr">content</span>=<span class="string">&quot;black&quot;</span> /&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- IOS中禁用将数字识别为电话号码/忽略Android平台中对邮箱地址的识别 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;format-detection&quot;</span><span class="attr">content</span>=<span class="string">&quot;telephone=no, email=no&quot;</span> /&gt;</span></span><br><span class="line">其他meta标签</span><br><span class="line"><span class="comment">&lt;!-- 启用360浏览器的极速模式(webkit) --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;renderer&quot;</span> <span class="attr">content</span>=<span class="string">&quot;webkit&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 避免IE使用兼容模式 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 针对手持设备优化，主要是针对一些老的不识别viewport的浏览器，比如黑莓 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;HandheldFriendly&quot;</span> <span class="attr">content</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 微软的老式浏览器 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;MobileOptimized&quot;</span> <span class="attr">content</span>=<span class="string">&quot;320&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- uc强制竖屏 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;screen-orientation&quot;</span> <span class="attr">content</span>=<span class="string">&quot;portrait&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- QQ强制竖屏 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;x5-orientation&quot;</span> <span class="attr">content</span>=<span class="string">&quot;portrait&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- UC强制全屏 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;full-screen&quot;</span> <span class="attr">content</span>=<span class="string">&quot;yes&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- QQ强制全屏 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;x5-fullscreen&quot;</span> <span class="attr">content</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- UC应用模式 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;browsermode&quot;</span> <span class="attr">content</span>=<span class="string">&quot;application&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- QQ应用模式 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;x5-page-mode&quot;</span> <span class="attr">content</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- windows phone 点击无高光 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;msapplication-tap-highlight&quot;</span> <span class="attr">content</span>=<span class="string">&quot;no&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="18-移动端如何定义字体-font-family？"><a href="#18-移动端如何定义字体-font-family？" class="headerlink" title="18.移动端如何定义字体 font-family？"></a>18.移动端如何定义字体 font-family？</h2><p>@ ———— 中文字体的英文名称<br>@ 宋体 SimSun<br>@ 黑体 SimHei<br>@ 微信雅黑 Microsoft Yahei<br>@ 微软正黑体 Microsoft JhengHei<br>@ 新宋体 NSimSun<br>@ 新细明体 MingLiU<br>@ 细明体 MingLiU<br>@ 标楷体 DFKai-SB<br>@ 仿宋 FangSong<br>@ 楷体 KaiTi<br>@ 仿宋GB2312 FangSongGB2312<br>@ 楷体GB2312 KaiTiGB2312<br><strong>说明</strong>：中文字体多数使用宋体、雅黑，英文用 Helvetica</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;<span class="attribute">font-family</span>: Microsoft Yahei,SimSun,Helvetica;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="19-打电话发短信写邮件怎么实现？"><a href="#19-打电话发短信写邮件怎么实现？" class="headerlink" title="19.打电话发短信写邮件怎么实现？"></a>19.打电话发短信写邮件怎么实现？</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">// 一、打电话</span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;tel:0755-10086&quot;</span>&gt;</span>打电话给:0755-10086<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">//  二、发短信，winphone系统无效</span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;sms:10086&quot;</span>&gt;</span>发短信给: 10086<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">// 三、写邮件</span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;mailto:863139978@qq.com&quot;</span>&gt;</span>点击我发邮件<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">//2.收件地址后添加?cc=开头，可添加抄送地址（Android存在兼容问题）</span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;mailto:863139978@qq.com?cc=zhangqian0406@yeah.net&quot;</span>&gt;</span>点击我发邮件<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">//3.跟着抄送地址后，写上&amp;bcc=,可添加密件抄送地址（Android存在兼容问题）</span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;mailto:863139978@qq.com?cc=zhangqian0406@yeah.net&amp;bcc=384900096@qq.com&quot;</span>&gt;</span>点击我发邮件<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">//4.包含多个收件人、抄送、密件抄送人，用分号(;)隔开多个邮件人的地址</span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;mailto:863139978@qq.com;384900096@qq.com&quot;</span>&gt;</span>点击我发邮件<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">//5.包含主题，用?subject=</span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;mailto:863139978@qq.com?subject=邮件主题&quot;</span>&gt;</span>点击我发邮件<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">//6.包含内容，用?body=;如内容包含文本，使用%0A给文本换行 </span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;mailto:863139978@qq.com?body=邮件主题内容%0A腾讯诚信%0A期待您的到来&quot;</span>&gt;</span>点击我发邮件<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">//7.内容包含链接，含http(s)://等的文本自动转化为链接</span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;mailto:863139978@qq.com?body=http://www.baidu.com&quot;</span>&gt;</span>点击我发邮件<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">//8.内容包含图片（PC不支持）</span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;mailto:863139978@qq.com?body=&lt;img src=&#x27;images/1.jpg&#x27; /&gt;&quot;</span>&gt;</span>点击我发邮件<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">//9.完整示例</span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;mailto:863139978@qq.com;384900096@qq.com?cc=zhangqian0406@yeah.net&amp;bcc=993233461@qq.com&amp;subject=[邮件主题]&amp;body=腾讯诚邀您参与%0A%0Ahttp://www.baidu.com%0A%0A&lt;img src=&#x27;images/1.jpg&#x27; /&gt;&quot;</span>&gt;</span>点击我发邮件<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="20-移动端-touch-事件（区分-webkit-和-winphone）？"><a href="#20-移动端-touch-事件（区分-webkit-和-winphone）？" class="headerlink" title="20.移动端 touch 事件（区分 webkit 和 winphone）？"></a>20.移动端 touch 事件（区分 webkit 和 winphone）？</h2><h4 id="1-以下支持-webkit"><a href="#1-以下支持-webkit" class="headerlink" title="1. 以下支持 webkit"></a>1. 以下支持 webkit</h4><p><strong>touchstart</strong>——当手指触碰屏幕时候发生。不管当前有多少只手指<br><strong>touchmove</strong>——当手指在屏幕上滑动时连续触发。通常我们再滑屏页面，会调用 event 的    **preventDefault() 可以阻止默认情况的发生：阻止页面滚动<br><strong>touchend</strong>——当手指离开屏幕时触发<br><strong>touchcancel</strong>——系统停止跟踪触摸时候会触发。例如在触摸过程中突然页面 alert() 一个提示框，此时会触发该事件，这个事件比较少用   </p>
<h4 id="2-TouchEvent-说明："><a href="#2-TouchEvent-说明：" class="headerlink" title="2. TouchEvent 说明："></a>2. TouchEvent 说明：</h4><p><strong>touches</strong>：屏幕上所有手指的信息<br><strong>targetTouches</strong>：手指在目标区域的手指信息<br><strong>changedTouches</strong>：最近一次触发该事件的手指信息<br>touchend 时，touches 与 targetTouches 信息会被删除，changedTouches 保存的最后一次的信息，最好用于计算手指信息   </p>
<h4 id="3-参数信息-changedTouches-0"><a href="#3-参数信息-changedTouches-0" class="headerlink" title="3.参数信息 (changedTouches[0])"></a>3.参数信息 (changedTouches[0])</h4><p><strong>clientX</strong>、<strong>clientY</strong> 在显示区的坐标<br><strong>target</strong>：当前元素   </p>
<h4 id="4-事件响应顺序"><a href="#4-事件响应顺序" class="headerlink" title="4.事件响应顺序"></a>4.事件响应顺序</h4><p>ontouchstart &gt; ontouchmove &gt; ontouchend &gt; onclick   </p>
<h2 id="21-点击元素产生背景或边框怎么去掉"><a href="#21-点击元素产生背景或边框怎么去掉" class="headerlink" title="21.点击元素产生背景或边框怎么去掉"></a>21.点击元素产生背景或边框怎么去掉</h2><ul>
<li><strong>iOS用户</strong> 点击一个链接，会出现一个半透明灰色遮罩, 如果想要禁用，可设置<code>-webkit-tap-highlight-color</code>的alpha值为<code>0</code>去除灰色半透明遮罩；  </li>
<li><strong>android用户</strong> 点击一个链接，会出现一个边框或者半透明灰色遮罩, 不同生产商定义出来额效果不一样，可设置<code>-webkit-tap-highlight-color</code>的alpha值为<code>0</code>去除部分机器自带的效果；  </li>
<li><strong>winphone系统</strong> 点击标签产生的灰色半透明背景，能通过设置<code>&lt;meta &gt;</code>去掉；  </li>
<li>特殊说明：有些机型去除不了，如小米2。对于按钮类还有个办法，不使用a或者input标签，直接用div标签 <figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">a</span>,<span class="selector-tag">button</span>,<span class="selector-tag">input</span>,<span class="selector-tag">textarea</span> &#123; </span><br><span class="line">    -webkit-tap-highlight-<span class="attribute">color</span>: <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>); </span><br><span class="line">    -webkit-user-modify<span class="selector-pseudo">:read-write</span>-plaintext-only; </span><br><span class="line">    //-webkit-user-modify 副作用 输入法不再能够输入多个字符</span><br><span class="line">&#125;   </span><br></pre></td></tr></table></figure>
也可以 <figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">* &#123; -webkit-tap-highlight-<span class="attribute">color</span>: <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>); &#125;</span><br></pre></td></tr></table></figure>
winphone下<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;msapplication-tap-highlight&quot;</span> <span class="attr">content</span>=<span class="string">&quot;no&quot;</span> &gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="22-美化表单元素"><a href="#22-美化表单元素" class="headerlink" title="22.美化表单元素"></a>22.美化表单元素</h2><h4 id="1-使用-appearance-改变-webkit-浏览器的默认外观"><a href="#1-使用-appearance-改变-webkit-浏览器的默认外观" class="headerlink" title="1. 使用 appearance 改变 webkit 浏览器的默认外观"></a>1. 使用 appearance 改变 webkit 浏览器的默认外观</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">input</span>,select &#123;-webkit-appearance:none; appearance: none;&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-winphone-下，使用伪元素改变表单元素默认外观"><a href="#2-winphone-下，使用伪元素改变表单元素默认外观" class="headerlink" title="2.winphone 下，使用伪元素改变表单元素默认外观"></a>2.winphone 下，使用伪元素改变表单元素默认外观</h4></li>
<li>1） 禁用 select 默认箭头，<code>::-ms-expand</code> 修改表单控件下拉箭头，设置隐藏并使用背景图片来修饰<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select::-ms-expand &#123;display:none;&#125;</span><br></pre></td></tr></table></figure></li>
<li>2） 禁用 radio 和 checkbox 默认样式，<code>::-ms-check</code> 修改表单复选框或单选框默认图标，设置隐藏并使用背景图片来修饰<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">input</span><span class="selector-attr">[type=radio]</span>::-ms-check,</span><br><span class="line">input[type=checkbox]::-ms-check &#123; display:none; &#125;</span><br></pre></td></tr></table></figure></li>
<li>3） 禁用 pc 端表单输入框默认清除按钮，<code>::-ms-clear</code> 修改清除按钮，设置隐藏并使用背景图片来修饰<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">input</span><span class="selector-attr">[type=text]</span>::-ms-clear,</span><br><span class="line">input[type=tel]::-ms-clear,</span><br><span class="line">input[type=number]::-ms-clear &#123; display:none; &#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="23-移动端字体单位-font-size-选择-px-还是-rem？"><a href="#23-移动端字体单位-font-size-选择-px-还是-rem？" class="headerlink" title="23.移动端字体单位 font-size 选择 px 还是 rem？"></a>23.移动端字体单位 font-size 选择 px 还是 rem？</h2><p>如需适配多种移动设备，建议使用 rem。以下为参考值：  </p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">html</span> &#123;<span class="attribute">font-size</span>: <span class="number">62.5%</span>;&#125; //<span class="number">10</span>*<span class="number">16</span> = <span class="number">62.5%</span></span><br></pre></td></tr></table></figure>
<p>设置 12px 字体 这里注意在 rem 前要加上对应的 px 值，解决不支持 rem 的浏览器的兼容问题，做到优雅降级   </p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;<span class="attribute">font-size</span>:<span class="number">12px</span>; <span class="attribute">font-size</span>:<span class="number">1.2rem</span>;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="24-input-标签添加上-disable-属性在-iOS-端字体颜色不兼容的问题？"><a href="#24-input-标签添加上-disable-属性在-iOS-端字体颜色不兼容的问题？" class="headerlink" title="24.input 标签添加上 disable 属性在 iOS 端字体颜色不兼容的问题？"></a>24.input 标签添加上 disable 属性在 iOS 端字体颜色不兼容的问题？</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">input</span><span class="selector-attr">[disabled]</span>,<span class="selector-tag">input</span><span class="selector-pseudo">:disabled</span>,<span class="selector-tag">input</span><span class="selector-class">.disabled</span>&#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#3e3e3e</span>;  </span><br><span class="line">    -webkit-text-fill-<span class="attribute">color</span>: <span class="number">#3e3e3e</span>;  </span><br><span class="line">    -webkit-<span class="attribute">opacity</span>:<span class="number">1</span>;  </span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">1</span>;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="25-iOS-的光标大小问题"><a href="#25-iOS-的光标大小问题" class="headerlink" title="25.iOS 的光标大小问题"></a>25.iOS 的光标大小问题</h2><h4 id="IE："><a href="#IE：" class="headerlink" title="IE："></a>IE：</h4><p>不管该行有没有文字，光标高度与 font-size 一致。</p>
<h4 id="FF："><a href="#FF：" class="headerlink" title="FF："></a>FF：</h4><p>该行有文字时，光标高度与 font-size 一致。该行无文字时，光标高度与 input 的 height 一致。</p>
<h4 id="Chrome："><a href="#Chrome：" class="headerlink" title="Chrome："></a>Chrome：</h4><p>该行无文字时，光标高度与 line-height 一致；该行有文字时，光标高度从 input 顶部到文字底部 (这两种情况都是在有设定 line-height 的时候)，如果没有 line-height，则是与 font-size 一致。  </p>
<p>iOS 中情况和 Chrome 相似。<br>设置字体大小和行高一致，然后通过 padding 撑开大小，只给 IE 浏览器设置  </p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">line-height</span>：-ms-<span class="attribute">line-height</span>:<span class="number">40px</span>;</span><br></pre></td></tr></table></figure>

<p>原文：<a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000015178877">https://segmentfault.com/a/1190000015178877</a> 作者：键盘上的眼泪</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/08/31/72-%E3%80%90CSS%E3%80%91%E7%A7%BB%E5%8A%A8%E7%AB%AF%E9%A1%B5%E9%9D%A2%E5%BC%80%E5%8F%91%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E5%92%8C%E8%A7%A3%E5%86%B3/" data-id="ckts3ejzc00o24d9k75cbfd0r" data-title="72-【CSS】移动端页面开发常见问题和解决" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CSS/" rel="tag">CSS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" rel="tag">前端开发</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-71-【CSS】CSS自定义属性和变量" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/08/28/71-%E3%80%90CSS%E3%80%91CSS%E8%87%AA%E5%AE%9A%E4%B9%89%E5%B1%9E%E6%80%A7%E5%92%8C%E5%8F%98%E9%87%8F/" class="article-date">
  <time class="dt-published" datetime="2018-08-27T23:11:30.000Z" itemprop="datePublished">2018-08-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/08/28/71-%E3%80%90CSS%E3%80%91CSS%E8%87%AA%E5%AE%9A%E4%B9%89%E5%B1%9E%E6%80%A7%E5%92%8C%E5%8F%98%E9%87%8F/">71-【CSS】CSS自定义属性和变量</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <hr>
<table>
<thead>
<tr>
<th>Author</th>
<th>王平安</th>
</tr>
</thead>
<tbody><tr>
<td>E-mail</td>
<td><a href="mailto:&#x70;&#105;&#x6e;&#103;&#x61;&#x6e;&#56;&#55;&#x38;&#55;&#x40;&#113;&#x71;&#x2e;&#99;&#x6f;&#109;">&#x70;&#105;&#x6e;&#103;&#x61;&#x6e;&#56;&#55;&#x38;&#55;&#x40;&#113;&#x71;&#x2e;&#99;&#x6f;&#109;</a></td>
</tr>
<tr>
<td>博  客</td>
<td><a target="_blank" rel="noopener" href="http://www.pingan8787.com/">www.pingan8787.com</a></td>
</tr>
<tr>
<td>微  信</td>
<td>pingan8787</td>
</tr>
<tr>
<td>每日文章</td>
<td><a target="_blank" rel="noopener" href="https://0x9.me/KMrv3">https://0x9.me/KMrv3</a></td>
</tr>
</tbody></table>
<hr>
<p><a target="_blank" rel="noopener" href="https://www.zhangxinxu.com/wordpress/2016/11/css-css3-variables-var/">张鑫旭 小tips:了解CSS/CSS3原生变量var</a></p>
<p>前言<br>一个《别说你懂CSS相对单位》系列文最后一篇了。今日早读文章由阿里@Yuying Wu翻译分享。  </p>
<blockquote>
<p>@Yuying Wu，前端爱好者&amp;鼓励师 / 新西兰working holiday / 铲屎官 / 咖啡爱好者。  </p>
</blockquote>
<p>正文从这开始~~  </p>
<h2 id="自定义属性（也叫“CSS变量”）"><a href="#自定义属性（也叫“CSS变量”）" class="headerlink" title="自定义属性（也叫“CSS变量”）"></a>自定义属性（也叫“CSS变量”）</h2><p>在2015年，一个大家期待已久的名为“用作层叠式变量的自定义属性”（Custom Properties for Cascading Variables）的CSS规范终于发布为“候选推荐标准”（Candidate Recommendation）。这套规范引入了CSS中“变量”的概念，支持一种新的基于上下文的动态样式定义方式。你可以声明一个变量，再给它赋值，然后就可以在样式表的任何地方引用它。你可以通过这样的方式，减少样式表中的重复代码，以及后续你会看到的一些有用的应用场景。  </p>
<p>在写这本书的时候，自定义属性已经被大多数主流浏览器支持了，除了IE。查看最新的浏览器支持情况，可以查看Can I Use的<a target="_blank" rel="noopener" href="http://caniuse.com/#feat=css-variables%E3%80%82">http://caniuse.com/#feat=css-variables。</a>  </p>
<blockquote>
<p>笔记<br>如果你刚好在用支持自定义变量的CSS预处理器，如Sass（syntactically awesome stylesheets）或Less，你可能会下意识拒绝CSS变量。千万别这么做。因为原生的CSS变量比任何一个预处理器能实现的功能都要强大和灵活。为了强调它们之间（原生CSS变量和预处理器自定义变量）的差异，我会把它叫作“自定义属性”，而不用“CSS变量”。  </p>
</blockquote>
<p>声明一个自定义属性，跟声明其他属性类似。代码片段2.23是自定义属性声明的例子。新建一个页面和样式表吧，然后添加以下的CSS代码。</p>
<p>[ 代码片段 2.23 声明一个自定义属性 ]</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-pseudo">:root</span> &#123;</span><br><span class="line">  --<span class="selector-tag">main</span>-<span class="attribute">font</span>: Helvetica, Arial, sans-serif;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>代码片段中，定义了一个名叫—main-font的变量，然后把它的值设定为普通的字体sans-serif。为了和其他属性区分开，命名的前缀必须是两道横杠（—），然后写上你想要的名字。</p>
<p>变量一定要声明在一个声明区块内。在这里，我使用了:root选择器，那么这个变量就可以在整个页面的样式里使用 —— 后面我会简单解释这个问题。</p>
<p>变量的声明，就它本身而言，不会做任何事情，直到我们在代码里引用它。我们在一个段落中使用它吧，做成像图2.13那样的效果。</p>
<p>[ 图 2.13 对一个简单段落使用用变量声明的字体sans-serif ]<br><img src="http://images.pingan8787.com/2018.08.28-01.jpg" alt="图 2.13"></p>
<p>我们可以用一个叫作var()的函数去引用自定义属性的值。现在，你可以利用这个函数去引用我们刚才声明的变量—main-font。把下面展示的代码片段添加到你的样式表中吧，把变量用起来。</p>
<p>[ 代码片段 2.24 使用一个自定义属性 ]</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-pseudo">:root</span> &#123;</span><br><span class="line">  --<span class="selector-tag">main</span>-<span class="attribute">font</span>: Helvetica, Arial, sans-serif;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">p</span> &#123;</span><br><span class="line">  <span class="attribute">font-family</span>: <span class="built_in">var</span>(--main-font);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>1 把段落的字体定义为 Helvetica, Arial, sans-serif</li>
</ul>
<p>自定义属性可以让你在一个地方声明它的值，作为一个“单一数据源”（single source of truth），然后在样式表的任意一个地方引用。这一点对一些反复出现的值特别有用，譬如颜色。下一个代码片段添加了一个名叫brand-color的自定义属性。你可以在样式表中多次使用这个变量，但假如你需要（全局）修改它的值，只需要在一行代码中编辑它的值就可以了。</p>
<p>[ 代码片段 2.25 对color使用自定义属性 ]</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-pseudo">:root</span> &#123;</span><br><span class="line">  --<span class="selector-tag">main</span>-<span class="attribute">font</span>: Helvetica, Arial, sans-serif;</span><br><span class="line">  --brand-<span class="attribute">color</span>: <span class="number">#369</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">p</span> &#123;</span><br><span class="line">  <span class="attribute">font-family</span>: <span class="built_in">var</span>(--main-font);</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--brand-color);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>1 声明一个蓝色的brand-color变量</li>
</ul>
<p>var()函数支持第二个参数，代表一个默认值。假如一个变量被声明的时候，第一个参数没有被声明，那么第二个参数值就会被引用。</p>
<p>[ 代码片段 2.26 提供回退默认值 ]</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-pseudo">:root</span> &#123;</span><br><span class="line">  --<span class="selector-tag">main</span>-<span class="attribute">font</span>: Helvetica, Arial, sans-serif;</span><br><span class="line">  --brand-<span class="attribute">color</span>: <span class="number">#369</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">p</span> &#123;</span><br><span class="line">  <span class="attribute">font-family</span>: <span class="built_in">var</span>(--main-font, sans-serif);</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--secondary-color, blue);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>1 声明一个默认值 sans-serif</p>
</li>
<li><p>2 变量 secondary-color 没有被声明，于是默认值 blue 会被使用</p>
</li>
</ul>
<p>这段代码在两个不同的声明中，定义了默认值。第一个声明里，—main-font被声明，值为Helvetica, Arial,sans-serif，于是这个值就会被用到了。第二个声明里，—secondary-color是一个没有声明过的变量，所以默认值 blue 被用到了。</p>
<blockquote>
<p>笔记<br>如果var()被定义为一个无效值，这个属性会被定义为它的初始值。举个例子，如果在padding: var(—brand-color)中，变量是一个色号，那对于padding来说这就是一个无效值。在这个情况下，padding的值会被定义为0。</p>
</blockquote>
<h3 id="动态改变自定义属性的值"><a href="#动态改变自定义属性的值" class="headerlink" title="动态改变自定义属性的值"></a>动态改变自定义属性的值</h3><p>从这些例子可以看到，自定义属性只是更方便了一点，也可以帮助你减少很多的重复代码。但让自定义属性更有意思的是，自定义属性的声明是可以层叠和继承的。你可以在多个选择器中声明同一个变量，这些变量在页面的不同部分可以有着不一样的值。</p>
<p>你可以声明一个变量是黑色的，举个例子，然后在一个特定的容器里把它重新定义为白色的。于是，在这个容器以外的所有依赖这个变量的颜色是黑色，而在容器内的就是白色。通过这样的方式，我们来实现一个像图2.14这样的效果。</p>
<p>[ 图 2.14 自定义属性基于不同域下的值，生成两个颜色不一样的面板 ]<br><img src="http://images.pingan8787.com/2018.08.28-02.jpg" alt=" 图 2.14"></p>
<p>这个面板类似你之前看到的那个（图2.7），HTML在代码片段2.27。这个面板有两个实例，一个在body下，另一个在一个深色的区块。来，更新下你的代码。</p>
<p>[ 代码片段 2.27 页面上不同上下文的两个面板 ]</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;panel&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>Single-origin<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;body&quot;</span>&gt;</span></span><br><span class="line">      We have built partnerships with small farms</span><br><span class="line">      around the world to hand-select beans at the</span><br><span class="line">      peak of season. We then careful roast in</span><br><span class="line">      small batches to maximize their potential.</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">aside</span> <span class="attr">class</span>=<span class="string">&quot;dark&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;panel&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h2</span>&gt;</span>Single-origin<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;body&quot;</span>&gt;</span></span><br><span class="line">        We have built partnerships with small farms</span><br><span class="line">        around the world to hand-select beans at the</span><br><span class="line">        peak of season. We then careful roast in</span><br><span class="line">        small batches to maximize their potential.</span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">aside</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>1 页面上一个普通的面板</p>
</li>
<li><p>2 第二个面板在深色容器里</p>
</li>
</ul>
<p>我们用变量重新改写一下面板中的文字和背景颜色。把下面的代码片段加进你的样式表。这里把背景颜色设成白色，文字颜色设成黑色。在你添加深色主题之前，我会解释这段代码的工作原理。</p>
<p>[ 代码片段 2.28 利用变量定义面板的颜色 ]</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-pseudo">:root</span> &#123;</span><br><span class="line">  --<span class="selector-tag">main</span>-bg: <span class="number">#fff</span>;</span><br><span class="line">  --<span class="selector-tag">main</span>-<span class="attribute">color</span>: <span class="number">#000</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.panel</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">1rem</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">1em</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#999</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">0.5em</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">var</span>(--main-bg);</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--main-color); </span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.panel</span> &gt; <span class="selector-tag">h2</span> &#123;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">0.8em</span>;</span><br><span class="line">  <span class="attribute">font-weight</span>: bold;</span><br><span class="line">  <span class="attribute">text-transform</span>: uppercase;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>1 分别把背景色和文字颜色定义为白色和黑色</p>
</li>
<li><p>2 在面板样式中使用变量</p>
</li>
</ul>
<p>你再一次把变量声明在:root选择器里。很明显，这样的话我们就可以在根元素（整个页面）下的任何元素中引用这个变量了。当根元素下的子元素使用这些变量时，它们就能拿到这些变量对应的值。</p>
<p>你有两个面板，不过它们仍然看起来是一样的。现在，再一次定义这些变量，但这次是在一个不同的选择器中。下一个代码片段是深色容器的，它有深灰色的背景色，以及小小的padding和margin。同时，它也重写了两个变量。添加到你的样式表吧。</p>
<p>[ 代码片段 2.29 设置深色容器的样式 ]</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.dark</span> &#123;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">2em</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">1em</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#999</span>;</span><br><span class="line">  --<span class="selector-tag">main</span>-bg: <span class="number">#333</span>;</span><br><span class="line">  --<span class="selector-tag">main</span>-<span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>1 在深色容器和上一个容器间设定一个margin</p>
</li>
<li><p>2 给深色容器设定深灰色的背景色</p>
</li>
<li><p>3 在当前容器的作用域下，重新定义–main-bg 和 –main-color的值</p>
</li>
</ul>
<p>刷新页面，第二个面板就会有深色背景和白色文字。这是因为当这个面板去调用这些变量时，拿到的是深色容器作用域下的值，而不是根元素域下的值。注意，你并不需要修改这个容器里的样式或者添加额外的类名。</p>
<p>在这个例子里，你两次定义了自定义属性，第一次在根元素作用域上（—main-color是黑色的），第二次在深色容器作用域（—main-color是白色的）。自定义属性表现得像作用域变量，因为值会被后代元素继承。在深色容器中，—main-color是白色的，而在页面的其他位置，它是黑色的。</p>
<h3 id="通过JavaScript改变自定义属性的值"><a href="#通过JavaScript改变自定义属性的值" class="headerlink" title="通过JavaScript改变自定义属性的值"></a>通过JavaScript改变自定义属性的值</h3><p>在浏览器中，自定义属性还可以被JavaScript访问和动态地修改。毕竟这不是一本讲JavaScript的书，我会告诉你足够多的基本概念，然后你再把这些融入到自己的JavaScript项目中。</p>
<p>[ 代码片段 2.30 在JavaScript里访问一个自定义变量 ]</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> rootElement = <span class="built_in">document</span>.documentElement;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> styles = getComputedStyle(rootElement);</span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> mainColor = styles.getPropertyValue(<span class="string">&#x27;--main-bg&#x27;</span>);</span></span><br><span class="line"><span class="javascript">  <span class="built_in">console</span>.log(<span class="built_in">String</span>(mainColor).trim());</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>1 获取元素的样式对象（style object）</p>
</li>
<li><p>2 从样式对象中获得 –main-bg 的值</p>
</li>
<li><p>3 确认 mainColor 是一个字符串以及把空格去掉，输出“#fff”</p>
</li>
</ul>
<p>因为你可以随手修改自定义属性的值，你可以用JavaScript给—main-bg动态地定义一个新的值。如果你把它定义为浅蓝色，它就是展示成这样（图2.15）。</p>
<p>[ 图 2.15 JavaScript可以通过改变变量–main-bg的值改变面板的背景色 ]<br><img src="http://images.pingan8787.com/2018.08.28-03.jpg" alt="图 2.15"></p>
<p>下面的代码片段，会在根元素下给—main-bg定义一个新的值，在<code>&lt;script&gt;</code>标签的最下面，加上这些的代码。</p>
<p>[ 代码片段 2.31 在JavaScript定义一个自定义变量的值 ]</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> rootElement = <span class="built_in">document</span>.documentElement;</span><br><span class="line">rootElement.style.setProperty(<span class="string">&#x27;--main-bg&#x27;</span>, <span class="string">&#x27;#cdf&#x27;</span>);</span><br></pre></td></tr></table></figure>
<ul>
<li>1 把根元素下的 –main-bg 定义为浅蓝色</li>
</ul>
<p>如果你执行这段代码，任何继承了—main-bg属性的元素都会发生改变，对应的值会变成新的。在你的页面上，这会把第一个面板的背景色变成浅蓝色。第二个面板保持不变，因为它继承的还是在深色容器里定义的值。</p>
<p>利用这项技术，你可以在浏览器里用JavaScript给你的站点换主题。或者你可以高亮页面上的某些部分，又或者随手就可以做一些改变。只需要少量几行JavaScript代码，你做的改变就可以影响到页面上大量的元素。</p>
<h3 id="初探自定义属性"><a href="#初探自定义属性" class="headerlink" title="初探自定义属性"></a>初探自定义属性</h3><p>自定义属性是一个全新的CSS领域，开发者才刚刚开始探索。因为目前浏览器的支持比较有限，所以还没有到使用它的“黄金时间”。我相信，一段时间之后，你会看到很多关于自定义属性的最佳实践和新颖的玩法。这是你需要留意的。尝试使用自定义属性，看看你可以做出些什么吧。</p>
<p>需要关注的一点，如果你使用<code>var()</code>声明，低版本浏览器不能识别就会忽略它。如果可以的话，给那些浏览器提供一个回退（fallback）方案。</p>
<p>[ 代码片段（没有编号） ]</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">color</span>: black;</span><br><span class="line"><span class="attribute">color</span>: <span class="built_in">var</span>(--main-color);</span><br></pre></td></tr></table></figure>
<p>自定义属性原生的动态特性，并不是总是可以使用的，可以关注它的<a target="_blank" rel="noopener" href="http://caniuse.com/">浏览器支持情况</a>。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ul>
<li><p>拥抱和使用相对单位，让页面的结构去定义样式代码的含义</p>
</li>
<li><p>个人喜欢对字号大小使用rem，选择性地对页面组件的一些简单缩放效果使用em</p>
</li>
<li><p>你可以让整个页面实现响应式缩放，而不需要任何的媒体查询</p>
</li>
<li><p>在声明行高时，使用不带单位的数值</p>
</li>
<li><p>开始了解和使用CSS最新的特性之一——自定义属性吧！</p>
</li>
</ul>
<p>关于本文<br>译者：@Yuying Wu<br>译文：</p>
<p>作者：@Keith J.Grant<br>原文：<a target="_blank" rel="noopener" href="https://livebook.manning.com/#!/book/css-in-depth/chapter-2">打开原文</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/08/28/71-%E3%80%90CSS%E3%80%91CSS%E8%87%AA%E5%AE%9A%E4%B9%89%E5%B1%9E%E6%80%A7%E5%92%8C%E5%8F%98%E9%87%8F/" data-id="ckts3ejvt00a14d9keddvadm0" data-title="71-【CSS】CSS自定义属性和变量" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CSS/" rel="tag">CSS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" rel="tag">前端开发</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="70-【h5】h5唤起app指南-70-【h5】h5唤起app指南-附开源唤醒库" class="h-entry article article-type-70-【h5】h5唤起app指南" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/08/27/70-%E3%80%90h5%E3%80%91h5%E5%94%A4%E8%B5%B7app%E6%8C%87%E5%8D%97-%E9%99%84%E5%BC%80%E6%BA%90%E5%94%A4%E9%86%92%E5%BA%93/" class="article-date">
  <time class="dt-published" datetime="2018-08-26T23:17:00.000Z" itemprop="datePublished">2018-08-27</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/08/27/70-%E3%80%90h5%E3%80%91h5%E5%94%A4%E8%B5%B7app%E6%8C%87%E5%8D%97-%E9%99%84%E5%BC%80%E6%BA%90%E5%94%A4%E9%86%92%E5%BA%93/">70-【h5】h5唤起app指南(附开源唤醒库)</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <hr>
<table>
<thead>
<tr>
<th>Author</th>
<th>王平安</th>
</tr>
</thead>
<tbody><tr>
<td>E-mail</td>
<td><a href="mailto:&#112;&#105;&#x6e;&#x67;&#97;&#110;&#56;&#55;&#x38;&#55;&#x40;&#113;&#113;&#46;&#99;&#111;&#x6d;">&#112;&#105;&#x6e;&#x67;&#97;&#110;&#56;&#55;&#x38;&#55;&#x40;&#113;&#113;&#46;&#99;&#111;&#x6d;</a></td>
</tr>
<tr>
<td>博  客</td>
<td><a target="_blank" rel="noopener" href="http://www.pingan8787.com/">www.pingan8787.com</a></td>
</tr>
<tr>
<td>微  信</td>
<td>pingan8787</td>
</tr>
<tr>
<td>每日文章</td>
<td><a target="_blank" rel="noopener" href="https://0x9.me/KMrv3">https://0x9.me/KMrv3</a></td>
</tr>
</tbody></table>
<hr>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://suanmei.github.io/2018/08/23/h5_call_app/">阅读原文 H5唤起APP指南 </a></p>
</blockquote>
<p>前一段时间在做电流App H5页面，需求中落地页占比较大，落地页承担的职责就是引流。引流有两种形式，同时也是我们对唤端的定义：引导已下载用户打开APP，引导未下载用户下载APP。  </p>
<p>引导已下载用户打开APP，从数据上说用户停留在APP中的时间更多了，是在提高用户粘性；从体验上说，APP体验是要比H5好的。引导未下载用户下载APP，可以增加我们的用户量。</p>
<p>上面其实分别解释了 什么是<strong>唤端</strong> 以及 <strong>为什么要唤端</strong>，也就是 <strong>3W法则</strong> 中的 What 和 Why，那么接下来我们就要聊一聊 How 了，也就是 如何唤端 。</p>
<p>我们先来看看常见的唤端方式以及他们适用的场景：  </p>
<h2 id="唤端媒介"><a href="#唤端媒介" class="headerlink" title="唤端媒介"></a>唤端媒介</h2><h3 id="URL-Scheme"><a href="#URL-Scheme" class="headerlink" title="URL Scheme"></a>URL Scheme</h3><h4 id="来源"><a href="#来源" class="headerlink" title="来源"></a>来源</h4><p>我们的手机上有许多私密信息，联系方式、照片、银行卡信息…我们不希望这些信息可以被手机应用随意获取到，信息泄露的危害甚大。所以，如何保证个人信息在设备所有者知情并允许的情况下被使用，是智能设备的核心安全问题。  </p>
<p>对此，苹果使用了名为 * 沙盒 * 的机制：应用只能访问它声明可能访问的资源。但沙盒也阻碍了应用间合理的信息共享，某种程度上限制了应用的能力。</p>
<p>因此，我们急需要一个辅助工具来帮助我们实现应用通信， URL Scheme 就是这个工具。</p>
<h4 id="URL-Scheme-是什么"><a href="#URL-Scheme-是什么" class="headerlink" title="URL Scheme 是什么"></a>URL Scheme 是什么</h4><p>我们来看一下 URL 的组成：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[scheme:][//authority][path][?query][#fragment]</span><br></pre></td></tr></table></figure>
<p>我们拿 <code>https://www.baidu.com 来举例</code>，<code>scheme</code> 自然就是<code> https</code> 了。</p>
<p>就像给服务器资源分配一个 URL，以便我们去访问它一样，我们同样也可以给手机APP分配一个特殊格式的 URL，用来访问这个APP或者这个APP中的某个功能(来实现通信)。APP得有一个标识，好让我们可以定位到它，它就是 URL 的 Scheme 部分。</p>
<h4 id="常用APP的-URL-Scheme"><a href="#常用APP的-URL-Scheme" class="headerlink" title="常用APP的 URL Scheme"></a>常用APP的 URL Scheme</h4><table>
<thead>
<tr>
<th>APP</th>
<th>微信</th>
<th>支付宝</th>
<th>淘宝</th>
<th>微博</th>
<th>QQ</th>
<th>知乎</th>
<th>短信</th>
</tr>
</thead>
<tbody><tr>
<td>URL Scheme</td>
<td>weixin://</td>
<td>alipay://</td>
<td>taobao://</td>
<td>sinaweibo://</td>
<td>mqq://</td>
<td>zhihu://</td>
<td>sms://</td>
</tr>
</tbody></table>
<h4 id="URL-Scheme-语法"><a href="#URL-Scheme-语法" class="headerlink" title="URL Scheme 语法"></a>URL Scheme 语法</h4><p>上面表格中都是最简单的用于打开 APP 的 URL Scheme，下面才是我们常用的 URL Scheme 格式：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">     行为(应用的某个功能)    </span><br><span class="line">            |</span><br><span class="line">scheme://[path][?query]</span><br><span class="line">   |               |</span><br><span class="line">应用标识       功能需要的参数</span><br></pre></td></tr></table></figure>

<h4 id="Intent"><a href="#Intent" class="headerlink" title="Intent"></a>Intent</h4><p>安卓的原生谷歌浏览器自从 chrome25 版本开始对于唤端功能做了一些变化，URL Scheme 无法再启动Android应用。 例如，通过 iframe 指向 weixin://，即使用户安装了微信也无法打开。所以，APP需要实现谷歌官方提供的 intent: 语法，或者实现让用户通过自定义手势来打开APP，当然这就是题外话了。</p>
<h4 id="Intent-语法"><a href="#Intent-语法" class="headerlink" title="Intent 语法"></a>Intent 语法</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">intent:</span><br><span class="line">   HOST/URI-path // Optional host </span><br><span class="line">   #Intent; </span><br><span class="line">      package=[string]; </span><br><span class="line">      action=[string]; </span><br><span class="line">      category=[string]; </span><br><span class="line">      component=[string]; </span><br><span class="line">      scheme=[string]; </span><br><span class="line">   end;</span><br></pre></td></tr></table></figure>
<p>如果用户未安装 APP，则会跳转到系统默认商店。当然，如果你想要指定一个唤起失败的跳转地址，添加下面的字符串在 end; 前就可以了:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">S.browser_fallback_url=[encoded_full_url]</span><br></pre></td></tr></table></figure>

<h4 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h4><p>下面是打开 Zxing 二维码扫描 APP 的 intent。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">intent:</span><br><span class="line">   //scan/</span><br><span class="line">   #Intent; </span><br><span class="line">      package=com.google.zxing.client.android; </span><br><span class="line">      scheme=zxing; </span><br><span class="line">   end;</span><br></pre></td></tr></table></figure>
<p>打开这个 APP ，可以通过如下的方式：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;intent://scan/#Intent;scheme=zxing;package=com.google.zxing.client.android;S.browser_fallback_url=http%3A%2F%2Fzxing.org;end&quot;</span>&gt;</span> Take a QR code <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="Universal-Link"><a href="#Universal-Link" class="headerlink" title="Universal Link"></a>Universal Link</h3><h4 id="Universal-Link-是什么"><a href="#Universal-Link-是什么" class="headerlink" title="Universal Link 是什么"></a>Universal Link 是什么</h4><p>Universal Link 是苹果在 WWDC2015 上为 iOS9 引入的新功能，通过传统的 HTTP 链接即可打开 APP。如果用户未安装 APP，则会跳转到该链接所对应的页面。</p>
<h4 id="为什么要使用-Universal-Link"><a href="#为什么要使用-Universal-Link" class="headerlink" title="为什么要使用 Universal Link"></a>为什么要使用 Universal Link</h4><p>传统的 Scheme 链接有以下几个痛点：</p>
<ul>
<li>在 ios 上会有确认弹窗提示用户是否打开，对于用户来说唤端，多出了一步操作。若用户未安装 APP ，也会有一个提示窗，告知我们 “打不开该网页，因为网址无效”</li>
<li>传统 Scheme 跳转无法得知唤端是否成功，Universal Link 唤端失败可以直接打开此链接对应的页面</li>
<li>Scheme 在微信、微博、QQ浏览器、手百中都已经被禁止使用，使用 Universal Link 可以避开它们的屏蔽（ 截止到 18年8月21日，微信和QQ浏览器已经禁止了 Universal Link，其他主流APP未发现有禁止 ）</li>
</ul>
<h4 id="如何让-APP-支持-Universal-Link"><a href="#如何让-APP-支持-Universal-Link" class="headerlink" title="如何让 APP 支持 Universal Link"></a>如何让 APP 支持 Universal Link</h4><p>有大量的文章会详细的告诉我们如何配置，你也可以去看<a target="_blank" rel="noopener" href="https://developer.apple.com/library/archive/documentation/General/Conceptual/AppSearch/UniversalLinks.html#//apple_ref/doc/uid/TP40016308-CH12-SW2">官方文档</a>，我这里简单的写一个12345。  </p>
<ul>
<li>1.拥有一个支持 https 的域名。  </li>
<li>2.在 <a target="_blank" rel="noopener" href="https://developer.apple.com/">开发者中心</a> ，Identifiers 下 AppIDs 找到自己的 App ID，编辑打开 Associated Domains 服务。  </li>
<li>3.打开工程配置中的 Associated Domains ，在其中的 Domains 中填入你想支持的域名，必须以 <code>applinks:</code> 为前缀。  </li>
<li>4.配置 <code>apple-app-site-association</code> 文件，文件名必须为 <code>apple-app-site-association</code> ，不带任何后缀。  </li>
<li>5.上传该文件到你的 HTTPS 服务器的 根目录 或者 <code>.well-known</code> 目录下。  </li>
</ul>
<h4 id="Universal-Link-配置中的坑"><a href="#Universal-Link-配置中的坑" class="headerlink" title="Universal Link 配置中的坑"></a>Universal Link 配置中的坑</h4><p>这里放一下我们在配置过程中遇到的坑，当然首先你在配置过程中必须得严格按照上面的要求去做，尤其是加粗的地方。</p>
<ul>
<li>1.域名问题</li>
</ul>
<p>Universal Link 支持的域名最多只能支持到二级域名，如果你用到了三级域名，Universal Link 唤端是不会生效的。</p>
<ul>
<li>2.跨域问题</li>
</ul>
<p>IOS 9.2 以后，必须要触发跨域才能支持 Universal Link 唤端。</p>
<p>IOS 那边有这样一个判断，如果你要打开的 Universal Link 和 当前页面是同一域名，ios 尊重用户最可能的意图，直接打开链接所对应的页面。如果不在同一域名下，则在你的 APP 中打开链接，也就是执行具体的唤端操作。</p>
<ul>
<li>3.Universal Link 是空页面</li>
</ul>
<p>Universal Link 本质上是个空页面，如果未安装 APP，Universal Link 被当做普通的页面链接，自然会跳到 404 页面，所以我们需要将它绑定到我们的中转页或者下载页。</p>
<h2 id="如何调用三种唤端媒介"><a href="#如何调用三种唤端媒介" class="headerlink" title="如何调用三种唤端媒介"></a>如何调用三种唤端媒介</h2><p>通过前面的介绍，我们可以发现，无论是 URL Scheme 还是 Intent 或者 Universal Link ，他们都算是 URL ，只是 URL Scheme 和 Intent 算是特殊的 URL。所以我们可以拿使用 URL 的方法来使用它们。</p>
<h3 id="iframe"><a href="#iframe" class="headerlink" title="iframe"></a>iframe</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&quot;sinaweibo://qrcode&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>在只有 URL Scheme 的日子里，iframe 是使用最多的了。因为在未安装 app 的情况下，不会去跳转错误页面。但是 iframe 在各个系统以及各个应用中的兼容问题还是挺多的，不能全部使用 URL Scheme。</p>
<h3 id="a-标签"><a href="#a-标签" class="headerlink" title="a 标签"></a>a 标签</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;intent://scan/#Intent;scheme=zxing;package=com.google.zxing.client.android;end&quot;</span>&quot;&gt;</span>扫一扫<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>前面我们提到 Intent 协议，官方给出的用例使用的就是使用的 a 标签，所以我们跟着一起用就可以了。</p>
<h3 id="window-location"><a href="#window-location" class="headerlink" title="window.location"></a>window.location</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.location.href = <span class="string">&#x27;sinaweibo://qrcode&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>URL Scheme 在 ios 9+ 上诸如 safari、UC、QQ浏览器中， iframe 均无法成功唤起 APP，只能通过 window.location 才能成功唤端。</p>
<p>当然，如果我们的 app 支持 Universal Link，ios 9+ 就用不到 URL Scheme 了。而 Universal Link 在使用过程中，我发现在 qq 中，无论是 iframe 导航 还是 a 标签打开 又或者 window.location 都无法成功唤端，一开始我以为是 qq 和微信一样禁止了 Universal Link 唤端的功能，其实不然，百般试验下，通过 top.location 唤端成功了。</p>
<h2 id="判断唤端是否成功"><a href="#判断唤端是否成功" class="headerlink" title="判断唤端是否成功"></a>判断唤端是否成功</h2><p>如果唤端失败（APP 未安装），我们总是要做一些处理的，可以是跳转下载页，可以是 ios 下跳转 App Store… 但是Js 并不能提供给我们获取 APP 唤起状态的能力，Android Intent 以及 Universal Link 倒是不用担心，它们俩的自身机制允许它们唤端失败后直接导航至相应的页面，但是 URL Scheme 并不具备这样的能力，所以我们只能通过一些很 hack 的方式来实现 APP 唤起检测功能。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> initialTime = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line"><span class="keyword">let</span> counter = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">let</span> waitTime = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">const</span> checkOpen = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">   count++;</span><br><span class="line">   waitTime = <span class="keyword">new</span> <span class="built_in">Date</span>() - initialTime;</span><br><span class="line">   <span class="keyword">if</span> (waitTime &gt; <span class="number">2500</span>) &#123;</span><br><span class="line">      <span class="built_in">clearInterval</span>(checkOpen);</span><br><span class="line">      cb();</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">if</span> (counter &lt; <span class="number">100</span>) <span class="keyword">return</span>;</span><br><span class="line">   <span class="keyword">const</span> hide = <span class="built_in">document</span>.hidden || <span class="built_in">document</span>.webkitHidden;</span><br><span class="line">   <span class="keyword">if</span> (!hide) &#123;</span><br><span class="line">      cb(); <span class="comment">// 唤端失败的回调函数</span></span><br><span class="line">   &#125;</span><br><span class="line">&#125;, <span class="number">20</span>);</span><br></pre></td></tr></table></figure>
<p>APP 如果被唤起的话，页面就会进入后台运行，setInterval 在 ios 中不会停止运行，在 android 中停止运行。</p>
<p>每 20ms 执行一次，执行 100次 在页面中实际耗费与 2000 ms 不会相差多少。</p>
<p>我们的判断条件比预期时间多设置了 500ms，所以如果安卓中 setInterval 内的函数执行 100 次以内所费时间超过 2500ms，则说明 APP 唤起成功，反之则代表失败。</p>
<p>我们通过 document.hidden 和 document.webkitHidden 属性来判断 APP 在 ios 中是否被正常唤起，2000ms 内，页面转入后台运行，document.hidden 会返回 true，代表唤端成功，反之则代表失败。</p>
<h2 id="没有完美的方案"><a href="#没有完美的方案" class="headerlink" title="没有完美的方案"></a>没有完美的方案</h2><p>透过上面的几个点，我们可以发现，无论是 唤端媒介 、 调用唤端媒介 还是 判断唤端结果 都没有一个十全十美的方法，我们在代码层上能做的只是在确保最常用的场景（比如 微信、微博、UC 等）唤端无误的情况下，最大化的兼容剩余的场景。</p>
<p>好的，我们接下来扯一些代码以外的，让我们的 APP 能够在更多的平台唤起。</p>
<ul>
<li>微信、微博、手百、QQ浏览器等。</li>
</ul>
<p>这些应用能阻止唤端是因为它们直接屏蔽掉了 URL Scheme 。接下来可能就有看官疑惑了，微信中是可以打开大众点评的呀，微博里面可以打开优酷呀，那是如何实现的呢？</p>
<p>它们都各自维护着一个白名单，如果你的域名在白名单内，那这个域名下所有的页面发起的 URL Scheme 就都会被允许。就像微信，如果你是腾讯的“家属”，你就可以加入白名单了，微信的白名单一般只包含着“家属”，除此外很难申请到白名单资质。但是微博之类的都是可以联系他们的渠道童鞋进行申请的，只是条件各不相同，比如微博的就是在你的 APP 中添加打开微博的入口，三个月内唤起超过 100w 次，就可以加入白名单了。</p>
<ul>
<li>腾讯应用宝直接打开 APP 的某个功能</li>
</ul>
<p>刚刚我们说到，如果你不是微信的家属，那你是很难进入白名单的，所以在安卓中我们一般都是直接打开腾讯应用宝，ios 中 直接打开 App Store。点击腾讯应用宝中的“打开”按钮，可以直接唤起我们的 APP，但是无法打开 APP 中的某个功能（就是无法打开指定页面）。</p>
<p>腾讯应用宝对外开放了一个叫做 APP Link 的申请，只要你申请了 APP Link，就可以通过在打开应用宝的时候在应用宝地址后面添加上<code> &amp;android_schema=&#123;your_scheme&#125;</code> ，来打开指定的页面了。</p>
<h2 id="开箱即用的callapp-lib"><a href="#开箱即用的callapp-lib" class="headerlink" title="开箱即用的callapp-lib"></a>开箱即用的callapp-lib</h2><p>信息量很大！各种问题得自己趟坑验证！内心很崩溃！</p>
<p>不用愁，已经为你准备好了药方，只需照方抓药即可😏 —— npm 包 <a target="_blank" rel="noopener" href="https://www.npmjs.com/package/callapp-lib">callapp-lib</a></p>
<p>它能在大部分的环境中成功唤端，而且炒鸡简单啊，拿过去就可以用啊，还支持很多扩展功能啊，快来瞅瞅它的 文档 啊~~~</p>
<h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><ul>
<li><a target="_blank" rel="noopener" href="https://futu.im/posts/h5-callup-native/">关于通过H5页面唤起Native客户端的介绍</a></li>
<li><a target="_blank" rel="noopener" href="http://web.jobbole.com/86706/">浏览器中唤起 native app，否则跳转到应用商城下载</a></li>
<li><a target="_blank" rel="noopener" href="http://echozq.github.io/echo-blog/2015/11/13/callapp.html">h5唤起app</a></li>
<li><a target="_blank" rel="noopener" href="https://sspai.com/post/31500">URL Schemes 使用详解</a></li>
<li><a target="_blank" rel="noopener" href="https://developer.chrome.com/multidevice/android/intents">Android Intents with Chrome</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/xttxqjfg/article/details/76019824">常用URL Scheme</a></li>
<li><a target="_blank" rel="noopener" href="http://www.cocoachina.com/ios/20170904/20463.html">Universal Link 前端部署采坑记</a></li>
<li><a target="_blank" rel="noopener" href="https://developer.apple.com/library/archive/documentation/General/Conceptual/AppSearch/UniversalLinks.html#//apple_ref/doc/uid/TP40016308-CH12-SW2">Support Universal Links</a></li>
<li><a target="_blank" rel="noopener" href="https://yq.aliyun.com/articles/608583">Universal Link是个骗子</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/08/27/70-%E3%80%90h5%E3%80%91h5%E5%94%A4%E8%B5%B7app%E6%8C%87%E5%8D%97-%E9%99%84%E5%BC%80%E6%BA%90%E5%94%A4%E9%86%92%E5%BA%93/" data-id="ckts3ejvs009y4d9k91zk06rw" data-title="70-【h5】h5唤起app指南(附开源唤醒库)" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/H5/" rel="tag">H5</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" rel="tag">前端开发</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-69-【JavaScript】JS垃圾回收机制和常见内存泄漏的解决方法" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/07/31/69-%E3%80%90JavaScript%E3%80%91JS%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6%E5%92%8C%E5%B8%B8%E8%A7%81%E5%86%85%E5%AD%98%E6%B3%84%E6%BC%8F%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/" class="article-date">
  <time class="dt-published" datetime="2018-07-31T14:38:41.000Z" itemprop="datePublished">2018-07-31</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/07/31/69-%E3%80%90JavaScript%E3%80%91JS%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6%E5%92%8C%E5%B8%B8%E8%A7%81%E5%86%85%E5%AD%98%E6%B3%84%E6%BC%8F%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/">69-【JavaScript】JS垃圾回收机制和常见内存泄漏的解决方法</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <hr>
<table>
<thead>
<tr>
<th>Author</th>
<th>王平安</th>
</tr>
</thead>
<tbody><tr>
<td>E-mail</td>
<td><a href="mailto:&#112;&#105;&#x6e;&#x67;&#x61;&#x6e;&#56;&#55;&#x38;&#55;&#x40;&#x71;&#x71;&#x2e;&#99;&#x6f;&#x6d;">&#112;&#105;&#x6e;&#x67;&#x61;&#x6e;&#56;&#55;&#x38;&#55;&#x40;&#x71;&#x71;&#x2e;&#99;&#x6f;&#x6d;</a></td>
</tr>
<tr>
<td>博  客</td>
<td><a target="_blank" rel="noopener" href="http://www.pingan8787.com/">www.pingan8787.com</a></td>
</tr>
<tr>
<td>微  信</td>
<td>pingan8787</td>
</tr>
<tr>
<td>每日文章</td>
<td><a target="_blank" rel="noopener" href="https://0x9.me/KMrv3">https://0x9.me/KMrv3</a></td>
</tr>
</tbody></table>
<hr>
<blockquote>
<p><a target="_blank" rel="noopener" href="http://obkoro1.com/2018/07/08/JS%E9%AB%98%E7%A8%8B%E4%B8%AD%E7%9A%84%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6%E4%B8%8E%E5%B8%B8%E8%A7%81%E5%86%85%E5%AD%98%E6%B3%84%E9%9C%B2%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/">阅读原文 obkoro1.com</a></p>
</blockquote>
<h3 id="内存的生命周期："><a href="#内存的生命周期：" class="headerlink" title="内存的生命周期："></a>内存的生命周期：</h3><ol>
<li>分配你所需要的内存：   </li>
</ol>
<p>由于字符串、对象等没有固定的大小，js程序在每次创建字符串、对象的时候，程序都会<strong>分配内存来存储那个实体</strong>。  </p>
<ol start="2">
<li><p>使用分配到的内存做点什么。  </p>
</li>
<li><p>不需要时将其释放回归：  </p>
</li>
</ol>
<p>在不需要字符串、对象的时候，需要释放其所占用的内存，否则将会消耗完系统中所有可用的内存，造成系统崩溃，这就是<strong>垃圾回收机制所存在的意义</strong>。  </p>
<p><strong>所谓的内存泄漏</strong>指的是：由于疏忽或错误造成程序未能释放那些已经不再使用的内存，造成内存的浪费。  </p>
<hr>
<h3 id="垃圾回收机制："><a href="#垃圾回收机制：" class="headerlink" title="垃圾回收机制："></a>垃圾回收机制：</h3><p>在C和C++之类的语言中，需要手动来管理内存的，这也是造成许多不必要问题的根源。幸运的是，在编写js的过程中，内存的分配以及内存的回收完全实现了自动管理，我们不用操心这种事情。    </p>
<h3 id="垃圾收集机制的原理："><a href="#垃圾收集机制的原理：" class="headerlink" title="垃圾收集机制的原理："></a>垃圾收集机制的原理：</h3><p>垃圾收集器会按照固定的时间间隔，<strong>周期性的找出不再继续使用的变量，然后释放其占用的内存</strong>。  </p>
<h4 id="什么叫不再继续使用的变量？"><a href="#什么叫不再继续使用的变量？" class="headerlink" title="什么叫不再继续使用的变量？"></a>什么叫不再继续使用的变量？</h4><p>不再使用的变量也就是生命周期结束的变量，是局部变量，局部变量只在函数的执行过程中存在，当函数运行结束，没有其他引用(闭包)，那么该变量会被标记回收。  </p>
<p>全局变量的生命周期直至浏览器卸载页面才会结束，也就是说<strong>全局变量不会被当成垃圾回收</strong>。</p>
<h3 id="标记清除：当前采用的垃圾收集策略"><a href="#标记清除：当前采用的垃圾收集策略" class="headerlink" title="标记清除：当前采用的垃圾收集策略"></a>标记清除：当前采用的垃圾收集策略</h3><p>工作原理：</p>
<p>当变量进入环境时(例如在函数中声明一个变量)，将这个变量标记为“进入环境”，当变量离开环境时，则将其标记为“离开环境”。标记“离开环境”的就回收内存。</p>
<p>工作流程：</p>
<ol>
<li>垃圾收集器会在运行的时候会给存储在内存中的<strong>所有变量都加上标记</strong>。</li>
<li>去掉环境中的变量以及被环境中的变量引用的变量的标记。</li>
<li>那些还存在标记的变量被视为准备删除的变量。</li>
<li>最后垃圾收集器会执行最后一步内存清除的工作，销毁那些带标记的值并回收它们所占用的内存空间。<br>到2008年为止,IE、Chorme、Fireofx、Safari、Opera <strong>都使用标记清除式的垃圾收集策略</strong>，只不过垃圾收集的时间间隔互有不同。</li>
</ol>
<h3 id="引用计数略：被废弃的垃圾收集策"><a href="#引用计数略：被废弃的垃圾收集策" class="headerlink" title="引用计数略：被废弃的垃圾收集策"></a>引用计数略：被废弃的垃圾收集策</h3><p>循环引用：跟踪记录每个值被引用的技术</p>
<p>在老版本的浏览器中(对，又是IE)，IE9以下BOM和DOM对象就是使用C++以COM对象的形式实现的。</p>
<p>COM的垃圾收集机制采用的就是引用计数策略，这种机制在出现循环引用的时候永远都释放不掉内存。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> element = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;something&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> myObject = <span class="keyword">new</span> <span class="built_in">Object</span>();</span><br><span class="line">myObject.element = element; <span class="comment">// element属性指向dom</span></span><br><span class="line">element.someThing = myObject; <span class="comment">// someThing回指myObject 出现循环引用(两个对象一直互相包含 一直存在计数)。</span></span><br></pre></td></tr></table></figure>
<p>解决方式是，当我们不使用它们的时候，手动切断链接：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">myObject.element = <span class="literal">null</span>; </span><br><span class="line">element.someThing = <span class="literal">null</span>;</span><br></pre></td></tr></table></figure>
<h4 id="淘汰："><a href="#淘汰：" class="headerlink" title="淘汰："></a>淘汰：</h4><p>IE9把BOM和DOM对象转为了真正的js对象，避免了使用这种垃圾收集策略，消除了IE9以下常见的内存泄漏的主要原因。</p>
<p>IE7以下有一个声明狼藉的性能问题，大家了解一下：</p>
<ol>
<li>256个变量，4096个对象(或数组)字面或者64KB的字符串，达到任何一个临界值会触发垃圾收集器运行。</li>
<li>如果一个js脚本的生命周期一直保有那么多变量，垃圾收集器会一直频繁的运行，引发严重的性能问题。<br>IE7已修复这个问题。</li>
</ol>
<hr>
<h3 id="哪些情况会引起内存泄漏？"><a href="#哪些情况会引起内存泄漏？" class="headerlink" title="哪些情况会引起内存泄漏？"></a>哪些情况会引起内存泄漏？</h3><p>虽然有垃圾回收机制，但我们在编写代码的时候，有些情况还是会造成内存泄漏，了解这些情况，并在编写程序的时候，注意避免，我们的程序会更具健壮性。  </p>
<h4 id="意外的全局变量："><a href="#意外的全局变量：" class="headerlink" title="意外的全局变量："></a>意外的全局变量：</h4><p>上文我们提到了<strong>全局变量不会被当成垃圾回收</strong>，我们在编码中有时会出现下面这种情况：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"> <span class="built_in">this</span>.bar2 = <span class="string">&#x27;默认绑定this指向全局&#x27;</span> <span class="comment">// 全局变量=&gt; window.bar2</span></span><br><span class="line">  bar = <span class="string">&#x27;全局变量&#x27;</span>; <span class="comment">// 没有声明变量 实际上是全局变量=&gt;window.bar</span></span><br><span class="line">&#125;</span><br><span class="line">foo();</span><br></pre></td></tr></table></figure>
<p>当我们使用<a target="_blank" rel="noopener" href="https://juejin.im/post/5b3715def265da59af40a630#heading-3">默认绑定</a>，this会指向全局，<code>this.something</code>也会创建一个全局变量，这一点可能很多人没有注意到。</p>
<p><strong>解决方法：在函数内使用严格模式or细心一点</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="meta">  &quot;use strict&quot;</span>; </span><br><span class="line">  <span class="built_in">this</span>.bar2 = <span class="string">&quot;严格模式下this指向undefined&quot;</span>; </span><br><span class="line">  bar = <span class="string">&quot;报错&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">foo();</span><br></pre></td></tr></table></figure>
<p>当然我们也可以手动释放全局变量的内存：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.bar = <span class="literal">undefined</span></span><br><span class="line"><span class="keyword">delete</span> <span class="built_in">window</span>.bar2</span><br></pre></td></tr></table></figure>
<h4 id="被遗忘的定时器和回调函数"><a href="#被遗忘的定时器和回调函数" class="headerlink" title="被遗忘的定时器和回调函数"></a>被遗忘的定时器和回调函数</h4><p>当不需要<code>setInterval</code>或者<code>setTimeout</code>时，<strong>定时器没有被clear</strong>，定时器的<strong>回调函数以及内部依赖的变量都不能被回收</strong>，造成内存泄漏。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> someResource = getData();</span><br><span class="line"><span class="built_in">setInterval</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> node = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;Node&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span>(node) &#123;</span><br><span class="line">        node.innerHTML = <span class="built_in">JSON</span>.stringify(someResource));</span><br><span class="line">        <span class="comment">// 定时器也没有清除</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// node、someResource 存储了大量数据 无法回收</span></span><br><span class="line">&#125;, <span class="number">1000</span>);</span><br></pre></td></tr></table></figure>
<p><strong>解决方法</strong>： 在定时器完成工作的时候，手动清除定时器。</p>
<h3 id="闭包："><a href="#闭包：" class="headerlink" title="闭包："></a>闭包：</h3><p><strong>闭包可以维持函数内局部变量，使其得不到释放，造成内存泄漏。</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bindEvent</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> obj = <span class="built_in">document</span>.createElement(<span class="string">&quot;XXX&quot;</span>);</span><br><span class="line">  <span class="keyword">var</span> unused = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(obj,<span class="string">&#x27;闭包内引用obj obj不会被释放&#x27;</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="comment">// obj = null;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>解决方法</strong>：手动解除引用，<code>obj = null</code>。</p>
<h4 id="循环引用问题"><a href="#循环引用问题" class="headerlink" title="循环引用问题"></a>循环引用问题</h4><p>就是IE9以下的循环引用问题，上文讲过了。</p>
<h4 id="没有清理DOM元素引用："><a href="#没有清理DOM元素引用：" class="headerlink" title="没有清理DOM元素引用："></a>没有清理DOM元素引用：</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> refA = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;refA&#x27;</span>);</span><br><span class="line"><span class="built_in">document</span>.body.removeChild(refA); <span class="comment">// dom删除了</span></span><br><span class="line"><span class="built_in">console</span>.log(refA, <span class="string">&quot;refA&quot;</span>);  <span class="comment">// 但是还存在引用 能console出整个div 没有被回收</span></span><br></pre></td></tr></table></figure>
<p>不信的话，可以看下这个<a target="_blank" rel="noopener" href="https://codepen.io/OBKoro1/pen/vroKbg">dom</a>。</p>
<p><strong>解决办法</strong>：<code>refA = null</code>;</p>
<h4 id="console保存大量数据在内存中。"><a href="#console保存大量数据在内存中。" class="headerlink" title="console保存大量数据在内存中。"></a>console保存大量数据在内存中。</h4><p>过多的console，比如定时器的console会导致浏览器卡死。</p>
<p><strong>解决</strong>：合理利用console，线上项目尽量少的使用console，当然如果你要发招聘，除外。</p>
<hr>
<h3 id="如何避免内存泄漏："><a href="#如何避免内存泄漏：" class="headerlink" title="如何避免内存泄漏："></a>如何避免内存泄漏：</h3><p><strong>记住一个原则：不用的东西，及时归还，毕竟你是’借的’嘛。</strong></p>
<ol>
<li><p>减少不必要的全局变量，使用严格模式避免意外创建全局变量。</p>
</li>
<li><p>在你使用完数据后，及时解除引用(闭包中的变量，dom引用，定时器清除)。</p>
</li>
<li><p>组织好你的逻辑，避免死循环等造成浏览器卡顿，崩溃的问题。</p>
<h4 id="关于内存泄漏："><a href="#关于内存泄漏：" class="headerlink" title="关于内存泄漏："></a>关于内存泄漏：</h4></li>
<li><p>即使是1byte的内存，也叫内存泄漏，并不一定是导致浏览器崩溃、卡顿才能叫做内存泄漏。</p>
</li>
<li><p>一般是堆区内存泄漏，栈区不会泄漏。<br>基本类型的值存在内存中，被保存在栈内存中，引用类型的值是<strong>对象，保存在堆内存中。所以对象、数组之类的，才会发生内存泄漏</strong>。</p>
</li>
<li><p>使用chorme监控内存泄漏，可以看一下<a target="_blank" rel="noopener" href="https://jinlong.github.io/2016/05/01/4-Types-of-Memory-Leaks-in-JavaScript-and-How-to-Get-Rid-Of-Them/">这篇文章</a></p>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/07/31/69-%E3%80%90JavaScript%E3%80%91JS%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6%E5%92%8C%E5%B8%B8%E8%A7%81%E5%86%85%E5%AD%98%E6%B3%84%E6%BC%8F%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/" data-id="ckts3ejvq009t4d9kbvz5hlvu" data-title="69-【JavaScript】JS垃圾回收机制和常见内存泄漏的解决方法" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/" rel="tag">JavaScript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" rel="tag">前端开发</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-68-【JavaScript】ES2018新特性" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/06/24/68-%E3%80%90JavaScript%E3%80%91ES2018%E6%96%B0%E7%89%B9%E6%80%A7/" class="article-date">
  <time class="dt-published" datetime="2018-06-24T11:42:11.000Z" itemprop="datePublished">2018-06-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/06/24/68-%E3%80%90JavaScript%E3%80%91ES2018%E6%96%B0%E7%89%B9%E6%80%A7/">68-【JavaScript】ES2018新特性</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <hr>
<table>
<thead>
<tr>
<th>Author</th>
<th>王平安</th>
</tr>
</thead>
<tbody><tr>
<td>E-mail</td>
<td><a href="mailto:&#112;&#105;&#x6e;&#x67;&#x61;&#110;&#x38;&#55;&#x38;&#55;&#x40;&#x71;&#113;&#46;&#x63;&#x6f;&#x6d;">&#112;&#105;&#x6e;&#x67;&#x61;&#110;&#x38;&#55;&#x38;&#55;&#x40;&#x71;&#113;&#46;&#x63;&#x6f;&#x6d;</a></td>
</tr>
<tr>
<td>博  客</td>
<td><a target="_blank" rel="noopener" href="http://www.pingan8787.com/">www.pingan8787.com</a></td>
</tr>
<tr>
<td>微  信</td>
<td>pingan8787</td>
</tr>
<tr>
<td>每日文章</td>
<td><a target="_blank" rel="noopener" href="https://0x9.me/KMrv3">https://0x9.me/KMrv3</a></td>
</tr>
</tbody></table>
<hr>
<p>在这篇文章中，我将介绍ES2018（ES9）的新特性，并介绍如何使用它们。  </p>
<p>JavaScript（ECMAScript）是跨多个平台的许多厂商实施的不断发展的标准。ES6（ECMAScript 2015）花费六年的时间敲定，是一个很大的发行版。新的年度发布流程被制定，以简化流程并更快地添加功能。 ES9（ES2018）是撰写本文时的最新版本。  </p>
<p>TC39由包括浏览器厂商在内的各方组成，他们开会推动JavaScript提案沿着一条严格的发展道路前进:  </p>
<ul>
<li>Stage 0: strawman——最初想法的提交。  </li>
<li>Stage 1: proposal（提案）——由TC39至少一名成员倡导的正式提案文件，该文件包括API事例。  </li>
<li>Stage 2: draft（草案）——功能规范的初始版本，该版本包含功能规范的两个实验实现。  </li>
<li>Stage 3: candidate（候选）——提案规范通过审查并从厂商那里收集反馈  </li>
<li>Stage 4: finished（完成）——提案准备加入ECMAScript，但是到浏览器或者Nodejs中可能需要更长的时间  </li>
</ul>
<h2 id="ES2016"><a href="#ES2016" class="headerlink" title="ES2016"></a>ES2016</h2><p>ES2016添加了两个小的特性来说明标准化过程：  </p>
<ol>
<li><p>数组<code>includes()</code>方法，用来判断一个数组是否包含一个指定的值，根据情况，如果包含则返回<code>true</code>，否则返回<code>false</code>。  </p>
</li>
<li><p><code>a ** b</code>指数运算符，它与 <code>Math.pow(a, b)</code>相同。  </p>
</li>
</ol>
<h2 id="ES2017"><a href="#ES2017" class="headerlink" title="ES2017"></a>ES2017</h2><p>ES2017提供了更多的新特性：  </p>
<ol>
<li><p><code>Async</code> 函数呈现更清晰的 <code>Promise</code> 语法  </p>
</li>
<li><p><code>Object.values</code> 方法返回一个给定对象自己的所有可枚举属性值的数组，值的顺序与使用<code>for...in</code>循环的顺序相同（区别在于<code>for...in</code>循环枚举原型链中的属性）  </p>
</li>
<li><p><code>Object.entries()</code>方法返回一个给定对象自身可枚举属性的键值对数组，其排列与使用<code>for...in</code>循环遍历改对象时返回的顺序一致（区别在于<code>for...in</code>循环也枚举原型链中的属性）  </p>
</li>
<li><p><code>Object.getOwnPropertyDescriptors()</code>返回一个对象的所有自身属性的描述符（<code>.value</code>,<code>.writable</code>,<code>.get</code>,<code>.set</code>,<code>.configurable</code>,<code>enumerable</code>）  </p>
</li>
<li><p><code>padStart()</code>和<code>padEnd()</code>，填充字符串达到当前长度  </p>
</li>
<li><p>结尾逗号，数组定义和函数参数列表  </p>
</li>
<li><p><code>ShareArrayBuffer</code>和<code>Atomics</code>用于从共享内存位置读取和写入  </p>
</li>
</ol>
<p>关于ES2017的更多信息请<a target="_blank" rel="noopener" href="https://www.sitepoint.com/es2017-whats-new/">参阅</a></p>
<h2 id="ES2018"><a href="#ES2018" class="headerlink" title="ES2018"></a>ES2018</h2><p>ECMAScript 2018（或者叫ES9）现在已经可用了。以下功能已经到达 stage 4，但是在撰写本文时在各个浏览器的实现还不完整。  </p>
<h3 id="异步迭代"><a href="#异步迭代" class="headerlink" title="异步迭代"></a>异步迭代</h3><p>在<code>async/await</code>的某些时刻，你可能尝试在同步循环中调用异步函数。例如：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">process</span>(<span class="params">array</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">of</span> array) &#123;</span><br><span class="line">    <span class="keyword">await</span> doSomething(i);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这段代码不会正常运行，下面这段同样也不会：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">process</span>(<span class="params">array</span>) </span>&#123;</span><br><span class="line">  array.forEach(<span class="keyword">async</span> i =&gt; &#123;</span><br><span class="line">    <span class="keyword">await</span> doSomething(i);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这段代码中，循环本身依旧保持同步，并在在内部异步函数之前全部调用完成。<br>ES2018引入异步迭代器（asynchronous iterators），这就像常规迭代器，除了<code>next()</code>方法返回一个<code>Promise</code>。因此<code>await</code>可以和<code>for...of</code>循环一起使用，以串行的方式运行异步操作。例如：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">process</span>(<span class="params">array</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> <span class="keyword">await</span> (<span class="keyword">let</span> i <span class="keyword">of</span> array) &#123;</span><br><span class="line">    doSomething(i);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Promise-finally"><a href="#Promise-finally" class="headerlink" title="Promise.finally()"></a>Promise.finally()</h3><p>一个<code>Promise</code>调用链要么成功到达最后一个<code>.then()</code>，要么失败触发<code>.catch()</code>。在某些情况下，你想要在无论<code>Promise</code>运行成功还是失败，运行相同的代码，例如清除，删除对话，关闭数据库连接等。<br><code>.finally()</code>允许你指定最终的逻辑：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">doSomething</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  doSomething1()</span><br><span class="line">  .then(doSomething2)</span><br><span class="line">  .then(doSomething3)</span><br><span class="line">  .catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(err);</span><br><span class="line">  &#125;)</span><br><span class="line">  .finally(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// finish here!</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Rest-Spread-属性"><a href="#Rest-Spread-属性" class="headerlink" title="Rest/Spread 属性"></a>Rest/Spread 属性</h2><p>ES2015引入了<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Functions/Rest_parameters">Rest参数</a>和<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/Spread_syntax">扩展运算符</a>。三个点（…）仅用于数组。Rest参数语法允许我们将一个布丁数量的参数表示为一个数组。  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">restParam(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">restParam</span>(<span class="params">p1, p2, ...p3</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// p1 = 1</span></span><br><span class="line">  <span class="comment">// p2 = 2</span></span><br><span class="line">  <span class="comment">// p3 = [3, 4, 5]</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>展开操作符以相反的方式工作，将数组转换成可传递给函数的单独参数。例如<code>Math.max()</code>返回给定数字中的最大值：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> values = [<span class="number">99</span>, <span class="number">100</span>, -<span class="number">1</span>, <span class="number">48</span>, <span class="number">16</span>];</span><br><span class="line"><span class="built_in">console</span>.log( <span class="built_in">Math</span>.max(...values) ); <span class="comment">// 100</span></span><br></pre></td></tr></table></figure>

<p>ES2018为对象解构提供了和数组一样的Rest参数（）和展开操作符，一个简单的例子：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> myObject = &#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">b</span>: <span class="number">2</span>,</span><br><span class="line">  <span class="attr">c</span>: <span class="number">3</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; a, ...x &#125; = myObject;</span><br><span class="line"><span class="comment">// a = 1</span></span><br><span class="line"><span class="comment">// x = &#123; b: 2, c: 3 &#125;</span></span><br></pre></td></tr></table></figure>

<p>或者你可以使用它给函数传递参数：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">restParam(&#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">b</span>: <span class="number">2</span>,</span><br><span class="line">  <span class="attr">c</span>: <span class="number">3</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">restParam</span>(<span class="params">&#123; a, ...x &#125;</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// a = 1</span></span><br><span class="line">  <span class="comment">// x = &#123; b: 2, c: 3 &#125;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>跟数组一样，Rest参数只能在声明的结尾处使用。此外，它只适用于每个对象的顶层，如果对象中嵌套对象则无法适用。<br>扩展运算符可以在其他对象内使用，例如：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj1 = &#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>, <span class="attr">c</span>: <span class="number">3</span> &#125;;</span><br><span class="line"><span class="keyword">const</span> obj2 = &#123; ...obj1, <span class="attr">z</span>: <span class="number">26</span> &#125;;</span><br><span class="line"><span class="comment">// obj2 is &#123; a: 1, b: 2, c: 3, z: 26 &#125;</span></span><br></pre></td></tr></table></figure>

<p>可以使用扩展运算符拷贝一个对象，像是这样<code>obj2 = &#123;...obj1&#125;</code>，但是 这只是一个对象的浅拷贝。另外，如果一个对象A的属性是对象B，那么在克隆后的对象cloneB中，该属性指向对象B。  </p>
<h3 id="正则表达式命名捕获组（Regular-Expression-Named-Capture-Groups）"><a href="#正则表达式命名捕获组（Regular-Expression-Named-Capture-Groups）" class="headerlink" title="正则表达式命名捕获组（Regular Expression Named Capture Groups）"></a>正则表达式命名捕获组（Regular Expression Named Capture Groups）</h3><p>JavaScript正则表达式可以返回一个匹配的对象——一个包含匹配字符串的类数组，例如：以YYYY-MM-DD的格式解析日期：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span></span><br><span class="line">  reDate = <span class="regexp">/([0-9]&#123;4&#125;)-([0-9]&#123;2&#125;)-([0-9]&#123;2&#125;)/</span>,</span><br><span class="line">  match  = reDate.exec(<span class="string">&#x27;2018-04-30&#x27;</span>),</span><br><span class="line">  year   = match[<span class="number">1</span>], <span class="comment">// 2018</span></span><br><span class="line">  month  = match[<span class="number">2</span>], <span class="comment">// 04</span></span><br><span class="line">  day    = match[<span class="number">3</span>]; <span class="comment">// 30</span></span><br></pre></td></tr></table></figure>

<p>这样的代码很难读懂，并且改变正则表达式的结构有可能改变匹配对象的索引。<br>ES2018允许命名捕获组使用符号<code>?&lt;name&gt;</code>，在打开捕获括号(后立即命名，示例如下：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span></span><br><span class="line">  reDate = <span class="regexp">/(?&lt;year&gt;[0-9]&#123;4&#125;)-(?&lt;month&gt;[0-9]&#123;2&#125;)-(?&lt;day&gt;[0-9]&#123;2&#125;)/</span>,</span><br><span class="line">  match  = reDate.exec(<span class="string">&#x27;2018-04-30&#x27;</span>),</span><br><span class="line">  year   = match.groups.year,  <span class="comment">// 2018</span></span><br><span class="line">  month  = match.groups.month, <span class="comment">// 04</span></span><br><span class="line">  day    = match.groups.day;   <span class="comment">// 30</span></span><br></pre></td></tr></table></figure>
<p>任何匹配失败的命名组都将返回<code>undefined</code>。<br>命名捕获也可以使用在<code>replace()</code>方法中。例如将日期转换为美国的 MM-DD-YYYY 格式：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span></span><br><span class="line">  reDate = <span class="regexp">/(?&lt;year&gt;[0-9]&#123;4&#125;)-(?&lt;month&gt;[0-9]&#123;2&#125;)-(?&lt;day&gt;[0-9]&#123;2&#125;)/</span>,</span><br><span class="line">  d      = <span class="string">&#x27;2018-04-30&#x27;</span>,</span><br><span class="line">  usDate = d.replace(reDate, <span class="string">&#x27;$&lt;month&gt;-$&lt;day&gt;-$&lt;year&gt;&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="正则表达式反向断言（lookbehind）"><a href="#正则表达式反向断言（lookbehind）" class="headerlink" title="正则表达式反向断言（lookbehind）"></a>正则表达式反向断言（lookbehind）</h3><p>目前JavaScript在正则表达式中支持先行断言（lookahead）。这意味着匹配会发生，但不会有任何捕获，并且断言没有包含在整个匹配字段中。例如从价格中捕获货币符号：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span></span><br><span class="line">  reLookahead = <span class="regexp">/\D(?=\d+)/</span>,</span><br><span class="line">  match       = reLookahead.exec(<span class="string">&#x27;$123.89&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log( match[<span class="number">0</span>] ); <span class="comment">// $</span></span><br></pre></td></tr></table></figure>

<p>ES2018引入以相同方式工作但是匹配前面的反向断言（lookbehind），这样我就可以忽略货币符号，单纯的捕获价格的数字：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span></span><br><span class="line">  reLookbehind = <span class="regexp">/(?&lt;=\D)\d+/</span>,</span><br><span class="line">  match        = reLookbehind.exec(<span class="string">&#x27;$123.89&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log( match[<span class="number">0</span>] ); <span class="comment">// 123.89</span></span><br></pre></td></tr></table></figure>

<p>以上是 肯定反向断言，非数字<code>\D</code>必须存在。同样的，还存在 否定反向断言，表示一个值必须不存在，例如：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span></span><br><span class="line">  reLookbehindNeg = <span class="regexp">/(?&lt;!\D)\d+/</span>,</span><br><span class="line">  match           = reLookbehind.exec(<span class="string">&#x27;$123.89&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log( match[<span class="number">0</span>] ); <span class="comment">// null</span></span><br></pre></td></tr></table></figure>

<h3 id="正则表达式dotAll模式"><a href="#正则表达式dotAll模式" class="headerlink" title="正则表达式dotAll模式"></a>正则表达式<code>dotAll</code>模式</h3><p>正则表达式中点.匹配除回车外的任何单字符，标记s改变这种行为，允许行终止符的出现，例如：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/hello.world/.test(<span class="string">&#x27;hello\nworld&#x27;</span>);  <span class="comment">// false</span></span><br><span class="line"><span class="regexp">/hello.world/</span>s.test(<span class="string">&#x27;hello\nworld&#x27;</span>); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<h3 id="正则表达式-Unicode-转义"><a href="#正则表达式-Unicode-转义" class="headerlink" title="正则表达式 Unicode 转义"></a>正则表达式 Unicode 转义</h3><p>到目前为止，在正则表达式中本地访问 Unicode 字符属性是不被允许的。ES2018添加了 Unicode 属性转义——形式为<code>\p&#123;...&#125;</code>和<code>\P&#123;...&#125;</code>，在正则表达式中使用标记 <code>u</code> (unicode) 设置，在<code>\p</code>块儿内，可以以键值对的方式设置需要匹配的属性而非具体内容。例如：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> reGreekSymbol = <span class="regexp">/\p&#123;Script=Greek&#125;/u</span>;</span><br><span class="line">reGreekSymbol.test(<span class="string">&#x27;π&#x27;</span>); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p>此特性可以避免使用特定 Unicode 区间来进行内容类型判断，提升可读性和可维护性。   </p>
<h3 id="非转义序列的模板字符串"><a href="#非转义序列的模板字符串" class="headerlink" title="非转义序列的模板字符串"></a>非转义序列的模板字符串</h3><p>最后，ES2018 移除对 ECMAScript 在带标签的模版字符串中转义序列的语法限制。<br>之前，<code>\u</code>开始一个 unicode 转义，<code>\x</code>开始一个十六进制转义，<code>\</code>后跟一个数字开始一个八进制转义。这使得创建特定的字符串变得不可能，例如Windows文件路径 <code>C:\uuu\xxx\111</code>。更多细节参考<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/template_strings">模板字符串</a>。<br>这是所有的ES2018的新特性，ES2019已经开始，你有什么期待的功能想在明年看到吗？  </p>
<h2 id="译者参考"><a href="#译者参考" class="headerlink" title="译者参考"></a>译者参考</h2><ul>
<li><a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000006824133">javascript正则断言的理解</a>   </li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/33353980">【RPU-A】正则 Unicode 转义提案进入 ES2018</a>   </li>
<li><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/template_strings">模板字符串——ES2018关于非法转义序列的修订</a>   </li>
<li><a target="_blank" rel="noopener" href="http://esnext.justjavac.com/proposal/template-literal-revision.html">非转义序列的模板字符串 </a>  </li>
<li><a target="_blank" rel="noopener" href="http://esnext.justjavac.com/proposal/regexp-named-groups.html">正则表达式命名捕获组</a>   </li>
</ul>
<p>原文链接：<a target="_blank" rel="noopener" href="https://juejin.im/post/5b2a186cf265da596d04a648">打开原文</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/06/24/68-%E3%80%90JavaScript%E3%80%91ES2018%E6%96%B0%E7%89%B9%E6%80%A7/" data-id="ckts3ejvp009r4d9kcy4d75pb" data-title="68-【JavaScript】ES2018新特性" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/" rel="tag">JavaScript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" rel="tag">前端开发</a></li></ul>

    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/15/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/14/">14</a><a class="page-number" href="/page/15/">15</a><span class="page-number current">16</span><a class="page-number" href="/page/17/">17</a><a class="page-number" href="/page/18/">18</a><span class="space">&hellip;</span><a class="page-number" href="/page/23/">23</a><a class="extend next" rel="next" href="/page/17/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Angular/" rel="tag">Angular</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CSS/" rel="tag">CSS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CSS%E5%8A%A8%E7%94%BB/" rel="tag">CSS动画</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Chrome/" rel="tag">Chrome</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ES6-ES7-ES8/" rel="tag">ES6/ES7/ES8</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Eslint/" rel="tag">Eslint</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Express/" rel="tag">Express</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GraphQL/" rel="tag">GraphQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/H5/" rel="tag">H5</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTML/" rel="tag">HTML</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTTP/" rel="tag">HTTP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTTP%E5%8D%8F%E8%AE%AE/" rel="tag">HTTP协议</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hybrid/" rel="tag">Hybrid</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaScript/" rel="tag">JavaScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NPM/" rel="tag">NPM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nodejs/" rel="tag">Nodejs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Numpy/" rel="tag">Numpy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/" rel="tag">Python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/React/" rel="tag">React</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Tensorflow/" rel="tag">Tensorflow</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TyeScript/" rel="tag">TyeScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TypeScript/" rel="tag">TypeScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vuejs/" rel="tag">Vuejs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WebSocket/" rel="tag">WebSocket</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Webpack/" rel="tag">Webpack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/demo/" rel="tag">demo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%AD%E9%97%B4%E4%BB%B6/" rel="tag">中间件</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/" rel="tag">人工智能</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91/" rel="tag">全栈开发</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" rel="tag">前端开发</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E6%8E%A2%E7%B4%A2/" rel="tag">前端探索</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E7%9F%A5%E4%B9%8E%E7%B3%BB%E5%88%97/" rel="tag">前端知乎系列</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8E%9F%E5%88%9B/" rel="tag">原创</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B8%B8%E7%94%A8%E6%8A%80%E6%9C%AF/" rel="tag">常用技术</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BE%AE%E5%89%8D%E7%AB%AF/" rel="tag">微前端</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%80%BB%E7%BB%93/" rel="tag">总结</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" rel="tag">数据结构</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" rel="tag">机器学习</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/" rel="tag">构建工具</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" rel="tag">正则表达式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%BA%90%E7%A0%81/" rel="tag">源码</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%BA%90%E7%A0%81%E7%B2%BE%E8%AF%BB/" rel="tag">源码精读</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%83%AD%E9%97%A8/" rel="tag">热门</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%94%9F%E6%B4%BB%E6%9D%82%E8%AE%B0/" rel="tag">生活杂记</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/" rel="tag">编译原理</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82/" rel="tag">网络请求</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" rel="tag">设计模式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" rel="tag">读书笔记</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%87%8D%E6%B8%A9%E5%9F%BA%E7%A1%80/" rel="tag">重温基础</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9D%A2%E8%AF%95%E9%A2%98/" rel="tag">面试题</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Angular/" style="font-size: 11.88px;">Angular</a> <a href="/tags/CSS/" style="font-size: 18.13px;">CSS</a> <a href="/tags/CSS%E5%8A%A8%E7%94%BB/" style="font-size: 12.5px;">CSS动画</a> <a href="/tags/Chrome/" style="font-size: 10px;">Chrome</a> <a href="/tags/ES6-ES7-ES8/" style="font-size: 10.63px;">ES6/ES7/ES8</a> <a href="/tags/Eslint/" style="font-size: 10px;">Eslint</a> <a href="/tags/Express/" style="font-size: 10px;">Express</a> <a href="/tags/GraphQL/" style="font-size: 10px;">GraphQL</a> <a href="/tags/H5/" style="font-size: 10px;">H5</a> <a href="/tags/HTML/" style="font-size: 10px;">HTML</a> <a href="/tags/HTTP/" style="font-size: 11.88px;">HTTP</a> <a href="/tags/HTTP%E5%8D%8F%E8%AE%AE/" style="font-size: 11.25px;">HTTP协议</a> <a href="/tags/Hybrid/" style="font-size: 10.63px;">Hybrid</a> <a href="/tags/JavaScript/" style="font-size: 19.38px;">JavaScript</a> <a href="/tags/NPM/" style="font-size: 10px;">NPM</a> <a href="/tags/Nodejs/" style="font-size: 11.25px;">Nodejs</a> <a href="/tags/Numpy/" style="font-size: 10.63px;">Numpy</a> <a href="/tags/Python/" style="font-size: 17.5px;">Python</a> <a href="/tags/React/" style="font-size: 12.5px;">React</a> <a href="/tags/Tensorflow/" style="font-size: 10.63px;">Tensorflow</a> <a href="/tags/TyeScript/" style="font-size: 10px;">TyeScript</a> <a href="/tags/TypeScript/" style="font-size: 11.25px;">TypeScript</a> <a href="/tags/Vuejs/" style="font-size: 14.38px;">Vuejs</a> <a href="/tags/WebSocket/" style="font-size: 10px;">WebSocket</a> <a href="/tags/Webpack/" style="font-size: 15.63px;">Webpack</a> <a href="/tags/demo/" style="font-size: 10.63px;">demo</a> <a href="/tags/%E4%B8%AD%E9%97%B4%E4%BB%B6/" style="font-size: 10px;">中间件</a> <a href="/tags/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/" style="font-size: 16.25px;">人工智能</a> <a href="/tags/%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91/" style="font-size: 11.25px;">全栈开发</a> <a href="/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" style="font-size: 20px;">前端开发</a> <a href="/tags/%E5%89%8D%E7%AB%AF%E6%8E%A2%E7%B4%A2/" style="font-size: 11.25px;">前端探索</a> <a href="/tags/%E5%89%8D%E7%AB%AF%E7%9F%A5%E4%B9%8E%E7%B3%BB%E5%88%97/" style="font-size: 10.63px;">前端知乎系列</a> <a href="/tags/%E5%8E%9F%E5%88%9B/" style="font-size: 18.75px;">原创</a> <a href="/tags/%E5%B8%B8%E7%94%A8%E6%8A%80%E6%9C%AF/" style="font-size: 10.63px;">常用技术</a> <a href="/tags/%E5%BE%AE%E5%89%8D%E7%AB%AF/" style="font-size: 10px;">微前端</a> <a href="/tags/%E6%80%BB%E7%BB%93/" style="font-size: 13.75px;">总结</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" style="font-size: 10px;">数据结构</a> <a href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" style="font-size: 15px;">机器学习</a> <a href="/tags/%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/" style="font-size: 10.63px;">构建工具</a> <a href="/tags/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" style="font-size: 10.63px;">正则表达式</a> <a href="/tags/%E6%BA%90%E7%A0%81/" style="font-size: 10px;">源码</a> <a href="/tags/%E6%BA%90%E7%A0%81%E7%B2%BE%E8%AF%BB/" style="font-size: 10px;">源码精读</a> <a href="/tags/%E7%83%AD%E9%97%A8/" style="font-size: 10px;">热门</a> <a href="/tags/%E7%94%9F%E6%B4%BB%E6%9D%82%E8%AE%B0/" style="font-size: 10px;">生活杂记</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 13.13px;">算法</a> <a href="/tags/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/" style="font-size: 10px;">编译原理</a> <a href="/tags/%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82/" style="font-size: 10px;">网络请求</a> <a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" style="font-size: 15px;">设计模式</a> <a href="/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" style="font-size: 14.38px;">读书笔记</a> <a href="/tags/%E9%87%8D%E6%B8%A9%E5%9F%BA%E7%A1%80/" style="font-size: 16.88px;">重温基础</a> <a href="/tags/%E9%9D%A2%E8%AF%95%E9%A2%98/" style="font-size: 10px;">面试题</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">May 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">March 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">September 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">June 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">May 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">April 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/07/28/227-%E3%80%90%E6%80%BB%E7%BB%93%E3%80%91%E5%A6%82%E4%BD%95%E4%BC%98%E9%9B%85%E7%9A%84%E5%9C%A8%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E4%BD%BF%E7%94%A8SVG%E5%AD%97%E4%BD%93%E5%9B%BE%E6%A0%87/">227-【总结】如何优雅的在微信小程序使用SVG字体图标</a>
          </li>
        
          <li>
            <a href="/2021/07/28/226-%E3%80%90HTTP%E3%80%91%E5%A6%82%E4%BD%95%E4%BC%98%E9%9B%85%E7%9A%84%E7%AE%A1%E7%90%86HTTP%E8%AF%B7%E6%B1%82%E5%92%8C%E5%93%8D%E5%BA%94%E6%8B%A6%E6%88%AA%E5%99%A8%EF%BC%9F/">226-【HTTP】如何优雅的管理HTTP请求和响应拦截器？</a>
          </li>
        
          <li>
            <a href="/2021/07/28/225-%E3%80%90Vue%E3%80%91%E4%BB%8E%E6%89%8B%E5%86%99Vue3%E7%9A%84Reactivity%E5%BC%80%E5%A7%8B%E6%B7%B1%E5%85%A5Vue3%E6%BA%90%E7%A0%81/">225-【Vue】从手写Vue3的Reactivity开始深入Vue3源码</a>
          </li>
        
          <li>
            <a href="/2021/05/30/224-%E3%80%90Chrome%E3%80%915%E4%B8%AAChrome%E8%B0%83%E8%AF%95%E6%B7%B7%E5%90%88%E5%BA%94%E7%94%A8%E7%9A%84%E6%8A%80%E5%B7%A7/">224-【Chrome】5个Chrome调试混合应用的技巧</a>
          </li>
        
          <li>
            <a href="/2021/03/19/223-%E3%80%90%E5%89%8D%E7%AB%AF%E6%8E%A2%E7%B4%A2%E3%80%91%E6%8E%A2%E7%B4%A2Snabbdom%E6%A8%A1%E5%9D%97%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86/">223-【前端探索】探索Snabbdom模块系统原理</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>