<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/page/17/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-67-【CSS】REM的各种适配介绍" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/06/20/67-%E3%80%90CSS%E3%80%91REM%E7%9A%84%E5%90%84%E7%A7%8D%E9%80%82%E9%85%8D%E4%BB%8B%E7%BB%8D/" class="article-date">
  <time class="dt-published" datetime="2018-06-20T15:00:00.000Z" itemprop="datePublished">2018-06-20</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/06/20/67-%E3%80%90CSS%E3%80%91REM%E7%9A%84%E5%90%84%E7%A7%8D%E9%80%82%E9%85%8D%E4%BB%8B%E7%BB%8D/">67-【CSS】REM的各种适配介绍</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <hr>
<table>
<thead>
<tr>
<th>Author</th>
<th>王平安</th>
</tr>
</thead>
<tbody><tr>
<td>E-mail</td>
<td><a href="mailto:&#112;&#x69;&#110;&#x67;&#97;&#x6e;&#x38;&#x37;&#x38;&#55;&#x40;&#x71;&#x71;&#x2e;&#x63;&#111;&#109;">&#112;&#x69;&#110;&#x67;&#97;&#x6e;&#x38;&#x37;&#x38;&#55;&#x40;&#x71;&#x71;&#x2e;&#x63;&#111;&#109;</a></td>
</tr>
<tr>
<td>博  客</td>
<td><a target="_blank" rel="noopener" href="http://www.pingan8787.com/">www.pingan8787.com</a></td>
</tr>
<tr>
<td>微  信</td>
<td>pingan8787</td>
</tr>
<tr>
<td>每日文章</td>
<td><a target="_blank" rel="noopener" href="https://0x9.me/KMrv3">https://0x9.me/KMrv3</a></td>
</tr>
</tbody></table>
<hr>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>移动端的崛起，给了我们前端更大的舞台，与此同时，也给我们带来了一系列头疼的问题，移动端适配就是其中之一，目前市面上最常用的方案即是REM适配。  </p>
<p>为什么说她是一个磨人的小妖精？因为她确实让人又爱又恨，灵活的自适应布局再搭配上css单位转换工具，让人爱不释手；另一方面，由于移动端的机型和表现千奇百怪，想要达到完美的兼容又让人头疼。  </p>
<p>即使如此，依然阻止不了笔者对于她的痴迷。本文将会围绕REM适配这一话题进行讨论，同时也会将笔者个人的经验以及自己目前在用的一套代码分享给大家。另外，如今移动端的兼容性越来越好，因此衍生出了一些其他的适配方案，这点不在本文的讨论范围之内。  </p>
<h2 id="实例解析"><a href="#实例解析" class="headerlink" title="实例解析"></a>实例解析</h2><h3 id="全局变量"><a href="#全局变量" class="headerlink" title="全局变量"></a>全局变量</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> docEl = <span class="built_in">document</span>.documentElement</span><br><span class="line"><span class="keyword">const</span> metaEl = <span class="built_in">document</span>.querySelector(<span class="string">&#x27;meta[name=&quot;viewport&quot;]&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> maxWidth = <span class="built_in">window</span>.__MAX_WIDTH__ || <span class="number">750</span></span><br><span class="line"><span class="keyword">const</span> divPart = <span class="built_in">window</span>.__DIV_PART__ || <span class="number">15</span></span><br><span class="line"><span class="keyword">const</span> bodySize = <span class="built_in">window</span>.__BODY_SIZE__ || <span class="number">12</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> scale = <span class="number">1</span></span><br><span class="line"><span class="keyword">let</span> dpr = <span class="number">1</span></span><br><span class="line"><span class="keyword">let</span> timer = <span class="literal">null</span></span><br></pre></td></tr></table></figure>

<blockquote>
<ul>
<li>metaEl：抓取现有viewport，以支持使用者自定义页面实际缩放比例，通过设置viewport可以实现视觉上的实际物理像素。例如<code>initial-scale=0.5</code>，即二倍屏，假设根节点的<code>font-size=100px</code>，那么<code>0.01rem</code>就是物理像素<code>1px</code>；而<code>initial-scale=1.0</code>，虽然在css单位中，<code>0.01rem=1px</code>，但我们知道，在二倍屏中，1px实际有4个物理像素。  </li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>maxWidth：UI稿宽度，一般以iphone6为基准，即750。   </li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>divPart：将设备宽度划分为多少份，上述代码中，<code>750/15=50</code>，意思是750宽度的屏幕，<code>1rem=50px</code>，划分多少份实际上没有固定规定，看个人习惯。   </li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>bodySize：初始化时，设置body的字体大小。   </li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>scale、dpr分别是页面缩放比例、设备像素比。   </li>
</ul>
</blockquote>
<h3 id="初始化设置"><a href="#初始化设置" class="headerlink" title="初始化设置"></a>初始化设置</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (metaEl) &#123;</span><br><span class="line">  <span class="built_in">console</span>.warn(<span class="string">&#x27;根据已有的meta标签来设置缩放比例&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> match = metaEl.getAttribute(<span class="string">&#x27;content&#x27;</span>).match(<span class="regexp">/initial-scale=([\d.]+)/</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (match) &#123;</span><br><span class="line">    scale = <span class="built_in">parseFloat</span>(match[<span class="number">1</span>])</span><br><span class="line">    dpr = <span class="built_in">parseInt</span>(<span class="number">1</span> / scale)</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">window</span>.navigator.appVersion.match(<span class="regexp">/iphone/gi</span>)) &#123;</span><br><span class="line">    dpr = <span class="built_in">parseInt</span>(<span class="built_in">window</span>.devicePixelRatio) || <span class="number">1</span></span><br><span class="line">    scale = <span class="number">1</span> / dpr</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> newMetaEl = <span class="built_in">document</span>.createElement(<span class="string">&#x27;meta&#x27;</span>)</span><br><span class="line">  newMetaEl.setAttribute(<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;viewport&#x27;</span>)</span><br><span class="line">  newMetaEl.setAttribute(<span class="string">&#x27;content&#x27;</span>, <span class="string">`width=device-width, initial-scale=<span class="subst">$&#123;scale&#125;</span>, maximum-scale=<span class="subst">$&#123;scale&#125;</span>, minimum-scale=<span class="subst">$&#123;scale&#125;</span>, user-scalable=no`</span>)</span><br><span class="line">  docEl.firstElementChild.appendChild(newMetaEl)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置根节点dpr</span></span><br><span class="line">docEl.setAttribute(<span class="string">&#x27;data-dpr&#x27;</span>, dpr)</span><br><span class="line"><span class="string">``</span><span class="string">`  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">这里要重点将一下为什么要区分安卓和IOS设备，很多人可能会说因为IOS有多倍屏。实际上，安卓也有多倍屏，那为什么我们不考虑呢？   </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">有些安卓机的设备像素比很奇怪，比如2.5、3.8等一些奇怪的数字；   </span></span><br><span class="line"><span class="string">部分安卓机表现很奇怪，比如页面宽度比屏幕宽度多一点，出现横向滚动条（具体原因不详，已排除所有css干扰），兼容起来成本太高。   </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">### 核心代码</span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>js</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bodyLoaded</span> (<span class="params">cb</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">document</span>.body) &#123;</span><br><span class="line">    cb &amp;&amp; cb()</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">document</span>.addEventListener(<span class="string">&#x27;DOMContentLoaded&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      cb &amp;&amp; cb()</span><br><span class="line">    &#125;, <span class="literal">false</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 窗口宽度改变时，刷新rem</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">refreshRem</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> width = docEl.clientWidth</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (width / dpr &gt; maxWidth) &#123;</span><br><span class="line">    width = maxWidth * dpr</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 设置根节点font-size</span></span><br><span class="line">  <span class="built_in">window</span>.remUnit = width / divPart</span><br><span class="line">  docEl.style.fontSize = <span class="built_in">window</span>.remUnit + <span class="string">&#x27;px&#x27;</span></span><br><span class="line"></span><br><span class="line">  bodyLoaded(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 测试rem的准确性，如果和预期不一样，则进行缩放</span></span><br><span class="line">    <span class="keyword">let</span> noEl = <span class="built_in">document</span>.createElement(<span class="string">&#x27;div&#x27;</span>)</span><br><span class="line">    noEl.style.width = <span class="string">&#x27;1rem&#x27;</span></span><br><span class="line">    noEl.style.height = <span class="string">&#x27;0&#x27;</span></span><br><span class="line">    <span class="built_in">document</span>.body.appendChild(noEl)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> rate = noEl.clientWidth / <span class="built_in">window</span>.remUnit</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">Math</span>.abs(rate - <span class="number">1</span>) &gt;= <span class="number">0.01</span>) &#123;</span><br><span class="line">      docEl.style.fontSize = (<span class="built_in">window</span>.remUnit / rate) + <span class="string">&#x27;px&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">document</span>.body.removeChild(noEl)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 初始化</span></span><br><span class="line">refreshRem()</span><br><span class="line"></span><br><span class="line">bodyLoaded(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">document</span>.body.style.fontSize = bodySize * dpr + <span class="string">&#x27;px&#x27;</span></span><br><span class="line">  <span class="built_in">document</span>.body.style.maxWidth = maxWidth * dpr + <span class="string">&#x27;px&#x27;</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><code>refreshRem</code>函数是整个rem适配的核心，每次需要更新都会调用此函数，我们还限定了页面的最大宽度，可以保证在pc端打开也能看到不错的视觉效果。<br>但是有一部分的安卓机，1rem并不等于根节点的font-size，举个例子：html的<code>font-size=20px</code>，正常情况下1rem也应该是20px，但在部分机型中，它可能是22px或18px等等（笔者怀疑上文中提到的页面宽度溢出也是这个问题）。因此，笔者加上了bodyLoaded这段代码，在rem设置完成后，再与实际视觉上的1rem进行比较，若偏差超过1%，则认为需要重新定义rem，这样就能100%保证1rem就是我们期望的大小。   </p>
<h3 id="页面宽度监听"><a href="#页面宽度监听" class="headerlink" title="页面宽度监听"></a>页面宽度监听</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">&#x27;resize&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">clearTimeout</span>(timer)</span><br><span class="line">  timer = <span class="built_in">setTimeout</span>(refreshRem, <span class="number">200</span>)</span><br><span class="line">&#125;, <span class="literal">false</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// window.addEventListener(&#x27;pageshow&#x27;, function (e) &#123;</span></span><br><span class="line"><span class="comment">//   if (e.persisted) &#123;</span></span><br><span class="line"><span class="comment">//     refreshRem()</span></span><br><span class="line"><span class="comment">//   &#125;</span></span><br><span class="line"><span class="comment">// &#125;, false)</span></span><br></pre></td></tr></table></figure>
<p>这段代码用于监听<code>resize</code>事件，以此来重新计算根节点的<code>font-size</code>，定时器用来防止频繁计算（实际上在手机中，也不会有频繁触发<code>resize</code>的机会，因此定时器也可以不加）。有些读者可能会问题，为什么不监听横竖屏事件（onorientationchange），其实没有必要，横竖屏切换本质也是<code>resize</code>的一种，我们已经监听了<code>resize</code>事件，这里就没有必要再次监听了。  </p>
<p>那注释掉的这段代码是什么意思呢？它是用来监听浏览器返回，但是这段代码在iPhone8、iPhoneX上会有问题，在返回的时候，我们拿到的<code>document.documentElement.clientWidth</code>是其实际的大小（没有乘上设备像素比），因此整个页面布局都乱了。笔者经过深思熟虑，决定删掉这段代码，因为在返回的时候，会保留和离开时一摸一样的状态，没有必要重新再计算一遍。  </p>
<h3 id="工具函数"><a href="#工具函数" class="headerlink" title="工具函数"></a>工具函数</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.px2rem = <span class="function"><span class="keyword">function</span> (<span class="params">d</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> val = <span class="built_in">parseFloat</span>(d) / <span class="built_in">window</span>.remUnit</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> d === <span class="string">&#x27;string&#x27;</span> &amp;&amp; d.match(<span class="regexp">/px$/</span>)) &#123;</span><br><span class="line">    val += <span class="string">&#x27;rem&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> val</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">window</span>.rem2px = <span class="function"><span class="keyword">function</span> (<span class="params">d</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> val = <span class="built_in">parseFloat</span>(d) * <span class="built_in">window</span>.remUnit</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> d === <span class="string">&#x27;string&#x27;</span> &amp;&amp; d.match(<span class="regexp">/rem$/</span>)) &#123;</span><br><span class="line">    val += <span class="string">&#x27;px&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> val</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>暴露全局函数，方便使用js来控制尺寸大小。   </p>
<h3 id="CSS重置样式"><a href="#CSS重置样式" class="headerlink" title="CSS重置样式"></a>CSS重置样式</h3><p>篇幅所限，样式代码就不在这里贴了，感兴趣可以在这里看：<a target="_blank" rel="noopener" href="https://github.com/ansenhuang/axe/blob/master/packages/rem-resize/src/common/reset.css">reset.css</a>  </p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>这一套rem适配代码是笔者日常开发中总结提炼出来，不能说是100%完美，但是也足够适配市面上的主流机型了。再配合构建工具，自动转换为rem单位，省心又省力。  </p>
<p>最后推荐一个好用的全局构建工具fle-cli，帮你从复杂繁琐的构建配置中解放出来。  </p>
<p>本文源码地址：<a target="_blank" rel="noopener" href="https://github.com/ansenhuang/axe/blob/master/packages/rem-resize/README.md">github.com/ansenhuang/…</a>  </p>
<ul>
<li>阅读原文 <a target="_blank" rel="noopener" href="https://juejin.im/post/5b28b36af265da59a36e351e">REM，你这磨人的小妖精！</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/06/20/67-%E3%80%90CSS%E3%80%91REM%E7%9A%84%E5%90%84%E7%A7%8D%E9%80%82%E9%85%8D%E4%BB%8B%E7%BB%8D/" data-id="ckts3ejvo009o4d9k1g0bfsqg" data-title="67-【CSS】REM的各种适配介绍" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CSS/" rel="tag">CSS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" rel="tag">前端开发</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-66-【CSS】CSS实现宽高等比例自适应矩形" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/05/26/66-%E3%80%90CSS%E3%80%91CSS%E5%AE%9E%E7%8E%B0%E5%AE%BD%E9%AB%98%E7%AD%89%E6%AF%94%E4%BE%8B%E8%87%AA%E9%80%82%E5%BA%94%E7%9F%A9%E5%BD%A2/" class="article-date">
  <time class="dt-published" datetime="2018-05-26T13:15:27.000Z" itemprop="datePublished">2018-05-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/05/26/66-%E3%80%90CSS%E3%80%91CSS%E5%AE%9E%E7%8E%B0%E5%AE%BD%E9%AB%98%E7%AD%89%E6%AF%94%E4%BE%8B%E8%87%AA%E9%80%82%E5%BA%94%E7%9F%A9%E5%BD%A2/">66-【CSS】CSS实现宽高等比例自适应矩形</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <hr>
<table>
<thead>
<tr>
<th>Author</th>
<th>王平安</th>
</tr>
</thead>
<tbody><tr>
<td>E-mail</td>
<td><a href="mailto:&#112;&#105;&#x6e;&#103;&#x61;&#110;&#56;&#55;&#56;&#55;&#64;&#x71;&#113;&#46;&#x63;&#x6f;&#x6d;">&#112;&#105;&#x6e;&#103;&#x61;&#110;&#56;&#55;&#56;&#55;&#64;&#x71;&#113;&#46;&#x63;&#x6f;&#x6d;</a></td>
</tr>
<tr>
<td>博  客</td>
<td><a target="_blank" rel="noopener" href="http://www.pingan8787.com/">www.pingan8787.com</a></td>
</tr>
<tr>
<td>微  信</td>
<td>pingan8787</td>
</tr>
<tr>
<td>每日文章</td>
<td><a target="_blank" rel="noopener" href="https://0x9.me/KMrv3">https://0x9.me/KMrv3</a></td>
</tr>
</tbody></table>
<hr>
<p>本文首发于<a target="_blank" rel="noopener" href="https://blog.mrcxt.com/2018/05/25/CSS%E5%AE%9E%E7%8E%B0%E5%AE%BD%E9%AB%98%E7%AD%89%E6%AF%94%E4%BE%8B%E8%87%AA%E9%80%82%E5%BA%94%E7%9F%A9%E5%BD%A2/">虾哔哔的Blog</a></p>
<h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>今天遇到一个很有趣的问题：<strong>如何实现一个宽度自适应，高度为宽度的一半的矩形</strong>。<br>经过搜索引擎的筛选和自己的反复试验,发现使用<code>padding-bottom</code>是最完美的解决方案。  </p>
<h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2><p>首先我们要明白，padding和margin都是相对于父元素的宽度来计算的，我们可以利用这一属性来实现我们的需求。<br>代码如下：  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;scale&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.scale</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">height</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">padding-bottom</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这其中的关键点就是<code>height: 0;</code>和<code>padding-bottom: 50%;</code>。<br>我们将元素的高度由<code>padding</code>撑开，由于<code>padding</code>是根据父元素宽度计算的，所以高度也就变成了相对父元素宽度，同时要将<code>height</code>设置为 0，这是为了将元素高度完全交给<code>padding</code>负责。<br>最后<code>padding-bottom</code>的值设为<code>width</code>的值一半，就可以实现高度是宽度的一半且自适应啦。  </p>
<h2 id="改进"><a href="#改进" class="headerlink" title="改进"></a>改进</h2><p>光是这样写还是不够的，因为元素的<code>height</code>为 0，导致该元素里面再有子元素的时候，就无法正常设置高度。所以我们需要用到<code>position: absolute;</code>。<br>代码如下：  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;scale&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">        这里是所有子元素的容器</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.scale</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">padding-bottom</span>: <span class="number">56.25%</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">height</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">position</span>: relative; //</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.item</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">background-color</span>: aquamarine;</span></span><br><span class="line"><span class="css">        <span class="attribute">position</span>: absolute; //</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="继续改进"><a href="#继续改进" class="headerlink" title="继续改进"></a>继续改进</h2><p>解决了子元素的问题，那么我们再来看看元素本身。由于我们一开始的需求是宽高比 <code>2:1</code>,这种比较好实现，但是后来需求又想要 <code>16:9</code> 的宽高比，而且宽度不是 <code>100%</code>，那这样计算 <code>padding-bottom</code> 的时候就很麻烦了。如何解决呢？<br>这时候我们需要在外层再套一个父元素，将宽度的控制交给这个父元素来做。<br>代码如下：  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;scale&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">                item</span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">    <span class="comment">/* box 用来控制宽度 */</span></span></span><br><span class="line"><span class="css">    <span class="selector-class">.box</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">width</span>: <span class="number">80%</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">    <span class="comment">/* scale 用来实现宽高等比例 */</span></span></span><br><span class="line"><span class="css">    <span class="selector-class">.scale</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">padding-bottom</span>: <span class="number">56.25%</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">height</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">    <span class="comment">/* item 用来放置全部的子元素 */</span></span></span><br><span class="line"><span class="css">    <span class="selector-class">.item</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">background-color</span>: aquamarine;</span></span><br><span class="line"><span class="css">        <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>如此，就可以完美解决。  </p>
<p><a target="_blank" rel="noopener" href="http://jsrun.net/ymZKp/edit">在线演示</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/05/26/66-%E3%80%90CSS%E3%80%91CSS%E5%AE%9E%E7%8E%B0%E5%AE%BD%E9%AB%98%E7%AD%89%E6%AF%94%E4%BE%8B%E8%87%AA%E9%80%82%E5%BA%94%E7%9F%A9%E5%BD%A2/" data-id="ckts3ejvo009m4d9k4zyj12nj" data-title="66-【CSS】CSS实现宽高等比例自适应矩形" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CSS/" rel="tag">CSS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/demo/" rel="tag">demo</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" rel="tag">前端开发</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-65-【Vuejs】解密VueSSR" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/05/21/65-%E3%80%90Vuejs%E3%80%91%E8%A7%A3%E5%AF%86VueSSR/" class="article-date">
  <time class="dt-published" datetime="2018-05-21T15:26:16.000Z" itemprop="datePublished">2018-05-21</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/05/21/65-%E3%80%90Vuejs%E3%80%91%E8%A7%A3%E5%AF%86VueSSR/">65-【Vuejs】解密VueSSR</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <hr>
<table>
<thead>
<tr>
<th>Author</th>
<th>王平安</th>
</tr>
</thead>
<tbody><tr>
<td>E-mail</td>
<td><a href="mailto:&#112;&#x69;&#x6e;&#x67;&#97;&#110;&#x38;&#55;&#56;&#55;&#x40;&#x71;&#x71;&#46;&#x63;&#111;&#x6d;">&#112;&#x69;&#x6e;&#x67;&#97;&#110;&#x38;&#55;&#56;&#55;&#x40;&#x71;&#x71;&#46;&#x63;&#111;&#x6d;</a></td>
</tr>
<tr>
<td>博  客</td>
<td><a target="_blank" rel="noopener" href="http://www.pingan8787.com/">www.pingan8787.com</a></td>
</tr>
<tr>
<td>微  信</td>
<td>pingan8787</td>
</tr>
<tr>
<td>每日文章</td>
<td><a target="_blank" rel="noopener" href="https://0x9.me/KMrv3">https://0x9.me/KMrv3</a></td>
</tr>
</tbody></table>
<hr>
<h2 id="1-引言"><a href="#1-引言" class="headerlink" title="1.引言"></a>1.引言</h2><p>最近笔者和小伙伴在研究Vue SSR，但是市面上充斥了太多的从0到1的文章，对大家理解这其中的原理帮助并不是很大，因此，本文将从 <em>Vue SSR的构建流程、运行流程、SSR的特点和利弊</em> 这几方面对Vue SSR有一个较为详细的介绍。最后还将附上一个笔者实现的 <em>去除Vue全家桶的Demo案例</em> 。  </p>
<h2 id="2-剖析构建流程"><a href="#2-剖析构建流程" class="headerlink" title="2.剖析构建流程"></a>2.剖析构建流程</h2><p>首先我们镇上一张官网给出的构建图：<br><img src="https://pic3.zhimg.com/80/v2-8f5dc75e94e8cfe49416e460f6bd2a0e_hd.jpg" alt="Vue SSR构建流程">  </p>
<h3 id="app-js入口文件"><a href="#app-js入口文件" class="headerlink" title="app.js入口文件"></a>app.js入口文件</h3><p><code>app.js</code> 是我们的通用<code>entry</code>，它的作用就是构建一个Vue的实例以供服务端和客户端使用，注意一下，在纯客户端的程序中我们的<code>app.js</code>将会挂载实例到<code>dom</code>中，而在<code>ssr</code>中这一部分的功能放到了<code>Client entry</code>中去做了。  </p>
<h3 id="两个entry"><a href="#两个entry" class="headerlink" title="两个entry"></a>两个entry</h3><p>接下里我们来看<code>Client entry</code>和<code>Server entry</code>，这两者分别是客户端的入口和服务端的入口。<em>Client entry的功能很简单，就是挂载我们的Vue实例到指定的dom元素上</em>；<code>Server entry</code>是一个使用<code>export</code>导出的函数。主要负责调用组件内定义的获取数据的方法，获取到SSR渲染所需数据，并存储到上下文环境中。<em>这个函数会在每一次的渲染中重复的调用</em>。  </p>
<h3 id="webpack打包构建"><a href="#webpack打包构建" class="headerlink" title="webpack打包构建"></a>webpack打包构建</h3><p>然后我们的服务端代码和客户端代码通过<code>webpack</code>分别打包，生成<code>Server Bundle</code>和<code>Client Bundle</code>，前者会运行在服务器上通过node生成预渲染的<code>HTML字符串</code>，发送到我们的客户端以便完成初始化渲染；而客户端bundle就自由了，初始化渲染完全不依赖它了。客户端拿到服务端返回的HTML字符串后，会去“激活”这些静态HTML，是其变成由<code>Vue动态管理</code>的DOM，以便响应后续数据的变化。  </p>
<h2 id="3-剖析运行流程"><a href="#3-剖析运行流程" class="headerlink" title="3.剖析运行流程"></a>3.剖析运行流程</h2><p>到这里我们该谈谈<code>ssr</code>的程序是怎么跑起来的了。首先我们得去构建一个vue的实例，也就是我们前面构建流程中说到的<code>app.js</code>做的事情，但是这里不同于传统的客户端渲染的程序，我们<em>需要用一个工厂函数去封装它，以便每一个用户的请求都能够返回一个新的实例，也就是官网说到的避免交叉污染了</em>。  </p>
<p>然后我们可以暂时移步到服务端的<code>entry</code>中了，这里要做的就是拿到当前路由匹配的组件，调用组件里定义的一个方法（官网取名叫<code>asyncData</code>）拿到初始化渲染的数据，而这个方法要做的也很简单，就是去调用我们<code>vuex store</code>中的方法去异步获取数据。  </p>
<p>接下来<code>node服务器</code>如期启动了，跑的是我们刚写好的服务端<code>entry</code>里的函数。在这里还要做的就是将我们刚刚构建好的Vue实例渲染成<code>HTML字符串</code>，然后将拿到的数据混入我们的<code>HTML字符串</code>中，最后发送到我们客户端。  </p>
<p>打开浏览器的network，我们看到了初始化渲染的HTML，并且是我们想要初始化的结构，且完全不依赖于客户端的js文件了。再仔细研究研究，里面有初始化的dom结构，有css，还有一个script标签。script标签里把我们在服务端<code>entry</code>拿到的数据挂载了<code>window</code>上。原来只是一个纯静态的HTML页面啊，没有任何的交互逻辑，所以啊，现在知道为啥子需要服务端跑一个<code>vue客户端</code>再跑一个<code>vue</code>了，服务端的<code>vue</code>只是混入了个数据渲染了个静态页面，客户端的<code>vue</code>才是去实现交互的！<br><img src="https://pic1.zhimg.com/80/v2-8354c78be3249def1cfc6b40d795c3a4_hd.jpg" alt="chrome network">   </p>
<p>顺着前面的思路，我们该看客户端的<code>entry</code>了。在这里客户端拿到存在<code>window</code>中的数据混入我们客户端的<code>vuex</code>中，然后分析数据去执行我们熟悉的其余客户端操作了。  </p>
<h2 id="4-SSR独特之处"><a href="#4-SSR独特之处" class="headerlink" title="4.SSR独特之处"></a>4.SSR独特之处</h2><p>在SSR中，创建<code>Vue实例</code>、创建<code>store</code>和创建<code>router</code>都是套了一层<code>工厂函数</code>的，目的就是<code>避免数据的交叉污染</code>。  </p>
<p>在服务端只能执行生命周期中的<code>created</code>和<code>beforeCreate</code>，原因是在服务端是无法操纵dom的，所以可想而知其他的周期也就是不能执行的了。  </p>
<p>服务端渲染和客户端渲染不同，需要创建两个<code>entry</code>分别跑在<code>服务端</code>和<code>客户端</code>，并且需要<em>webpack对其分别打包</em>；  </p>
<p>SSR服务端请求不带<code>cookie</code>，需要手动拿到浏览器的<code>cookie</code>传给服务端的请求。<a target="_blank" rel="noopener" href="https://www.mmxiaowu.com/article/596cbb2d436eb550a5423c30">实现方式戳这里</a>。  </p>
<p>SSR要求dom结构规范，因为浏览器会自动给HTML添加一些结构比如tbody，但是客户端进行混淆服务端放回的HTML时，不会添加这些标签，导致混淆后的HTML和浏览器渲染的HTML不匹配。    </p>
<p><em>性能问题需要多加关注</em>。  </p>
<ul>
<li>vue.mixin、axios拦截请求使用不当，会内存泄漏。<a target="_blank" rel="noopener" href="https://github.com/vuejs/vue/issues/5089">原因戳这里</a>  </li>
<li>lru-cache向内存中缓存数据，需要合理缓存改动不频繁的资源。  </li>
</ul>
<h2 id="5-可能是把双刃剑"><a href="#5-可能是把双刃剑" class="headerlink" title="5.可能是把双刃剑"></a>5.可能是把双刃剑</h2><h3 id="SSR的优点"><a href="#SSR的优点" class="headerlink" title="SSR的优点"></a>SSR的优点</h3><ul>
<li>更利于SEO。</li>
</ul>
<p>不同爬虫工作原理类似，只会爬取源码，不会执行网站的任何脚本（Google除外，据说Googlebot可以运行javaScript）。<br>使用了<code>Vue</code>或者其它<code>MVVM框架</code>之后，页面大多数DOM元素都是在客户端根据js动态生成，可供爬虫抓取分析的内容大大减少。<br>另外，浏览器爬虫不会等待我们的数据完成之后再去抓取我们的页面数据。服务端渲染返回给客户端的是已经获取了异步数据并执行JavaScript脚本的最终HTML，网络爬中就可以抓取到完整页面的信息。  </p>
<ul>
<li>更利于首屏渲染<br>首屏的渲染是node发送过来的html字符串，并不依赖于js文件了，这就会使用户更快的看到页面的内容。尤其是针对大型单页应用，打包后文件体积比较大，普通客户端渲染加载所有所需文件时间较长，首页就会有一个很长的白屏等待时间。  </li>
</ul>
<h2 id="6-SSR的局限"><a href="#6-SSR的局限" class="headerlink" title="6.SSR的局限"></a>6.SSR的局限</h2><ul>
<li><p>服务端压力较大<br>本来是通过客户端完成渲染，现在统一到服务端node服务去做。尤其是高并发访问的情况，会大量占用服务端CPU资源；  </p>
</li>
<li><p>开发条件受限<br>在服务端渲染中，<code>created</code>和<code>beforeCreate</code>之外的生命周期钩子不可用，因此项目引用的第三方的库也不可用其它生命周期钩子，这对引用库的选择产生了很大的限制；  </p>
</li>
<li><p>学习成本相对较高<br>除了对<code>webpack</code>、<code>Vue</code>要熟悉，还需要掌握<code>node</code>、<code>Express</code>相关技术。相对于客户端渲染，项目构建、部署过程更加复杂。  </p>
</li>
</ul>
<h2 id="6-去除VUEX的SSR实践"><a href="#6-去除VUEX的SSR实践" class="headerlink" title="6.去除VUEX的SSR实践"></a>6.去除VUEX的SSR实践</h2><p>先附上demo地址，<a target="_blank" rel="noopener" href="https://github.com/LNoe-lzy/vue-ssr-demo/tree/vue-ssr-without-vuex">戳这里</a>！  </p>
<p>说在前面：  </p>
<ul>
<li>vue-router不是必须的，不用router其实做个vue的<a target="_blank" rel="noopener" href="https://github.com/chrisvfritz/prerender-spa-plugin">preRender</a>就可以了，完全没必要做ssr；  </li>
<li>vuex不是必须的，vuex是实现我们客户端和服务端的状态共享的关键，我们可以不使用vuex，但是我们得去实现一套数据预取的逻辑；  </li>
</ul>
<p>官网的demo大而全，集成了<code>vue-router</code>和<code>vuex</code>，想想我们的项目如果没有使用到这两者，光引入就又需要改造成本，这并不是我们想搞的“丝滑般”过渡，接下来笔者将带领大家一步一步的做个“啥都没有的”demo。   </p>
<p>在此笔者的思路是：<em>构造一个Vue的实例，那么我们可以用这个实例的data来存储我们的预取数据，而用methods中的方法去做数据的异步获取，这样我们只在需要预取数据的组件中去调用这个方法就可以了</em>。   </p>
<p>首先我们需要让我们的组件“共享”这个EventBus，为此笔者简单的封装了一个plugin：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line"> install (Vue) &#123;</span><br><span class="line">   <span class="keyword">const</span> EventBus = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">     data () &#123;</span><br><span class="line">       <span class="keyword">return</span> &#123;</span><br><span class="line">	      <span class="attr">list</span>: [],</span><br><span class="line">	      <span class="attr">nav</span>: []</span><br><span class="line">       &#125;</span><br><span class="line">     &#125;,</span><br><span class="line">     <span class="attr">methods</span>: &#123;</span><br><span class="line">       getList () &#123;</span><br><span class="line">	      <span class="comment">// get list</span></span><br><span class="line">		&#125;,</span><br><span class="line">       getNav () &#123;</span><br><span class="line">         <span class="comment">// get nav</span></span><br><span class="line">       &#125;</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;)</span><br><span class="line">   </span><br><span class="line">   Vue.prototype.$events = EventBus</span><br><span class="line">   Vue.$events = EventBus</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后我们需要在<code>main.js</code>中<code>export</code>出我们的<code>EventBus</code>以便两个<code>entry</code>使用。这样我们的<code>main.js</code>就像下面这样：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">&#x27;./App&#x27;</span></span><br><span class="line"><span class="keyword">import</span> EventBus <span class="keyword">from</span> <span class="string">&#x27;./event&#x27;</span></span><br><span class="line"></span><br><span class="line">Vue.use(EventBus)</span><br><span class="line">Vue.config.devtools = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">createApp</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line"> <span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">   <span class="comment">// 注入 router 到根 Vue 实例</span></span><br><span class="line">   router,</span><br><span class="line">   <span class="attr">render</span>: <span class="function"><span class="params">h</span> =&gt;</span> h(App)</span><br><span class="line"> &#125;)</span><br><span class="line"> </span><br><span class="line"> <span class="keyword">return</span> &#123; app, router, <span class="attr">eventBus</span>: app.$events &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>接下来是我们的两个<code>entry</code>了。<code>server</code>用来匹配我们的组件并调用组件的<code>asyncData</code>方法去获取数据，<code>client</code>用来将预渲染的数据存储到我们<code>eventBus</code>中的<code>data</code>中。  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// server</span></span><br><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&#x27;./main&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> context =&gt; &#123;</span><br><span class="line"> <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">   <span class="keyword">const</span> &#123; app, eventBus, App &#125; = createApp()</span><br><span class="line">   <span class="comment">// 这里笔者的demo比较简单，仅app组件需要预取数据，复杂业务可以递归遍历哈；</span></span><br><span class="line">   <span class="keyword">const</span> matchedComponents = [App]</span><br><span class="line"></span><br><span class="line">   <span class="built_in">Promise</span>.all(matchedComponents.map(<span class="function">(<span class="params">&#123; asyncData &#125;</span>) =&gt;</span> asyncData &amp;&amp; asyncData(&#123;</span><br><span class="line">     eventBus</span><br><span class="line">   &#125;))).then(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">     context.state = eventBus._data</span><br><span class="line">     resolve(app)</span><br><span class="line">   &#125;).catch(reject)</span><br><span class="line"> &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// client</span></span><br><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&#x27;./main&#x27;</span></span><br><span class="line"><span class="keyword">const</span> &#123; app, eventBus &#125; = createApp()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">window</span>.__INITIAL_STATE__) &#123;</span><br><span class="line"> eventBus._data = <span class="built_in">window</span>.__INITIAL_STATE__</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">app.$mount(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>然后我们需要改造我们的组件了，只需要定义一个<code>async</code>方法去调用<code>EventBus</code>中的方法获取，考虑到服务端只会执行<code>beforeCreate</code>和<code>created</code>两个生命周期而<code>beforeCreate</code>不能拿到<code>data</code>，所以我们需要在<code>created</code>中去做数据的获取。  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 服务端渲染数据预取；</span></span><br><span class="line">asyncData (&#123; store, eventBus &#125;) &#123;</span><br><span class="line"> <span class="keyword">return</span> eventBus.getNav()</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 将服务端拿到的数据混入vue组件中；</span></span><br><span class="line">created () &#123;</span><br><span class="line"> <span class="built_in">this</span>.nav = <span class="built_in">this</span>.$events.nav</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后是<code>webpack</code>的改造了，<code>webpack</code>的配置其实和纯客户端应用类似，为了区分客户端和服务端两个环境我们将配置分为<code>base</code>、<code>client</code>和<code>server</code>三部分，<code>base</code>就是我们的通用基础配置，而<code>client</code>和<code>server</code>分别用来打包我们的客户端和服务端代码。  </p>
<p>首先是<code>webpack.server.conf.js</code>，用于生成<code>server bundle</code>来传递给<code>createBundleRenderer函数</code>在node服务器上调用，入口文件是我们的<code>entry-server</code>：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">&#x27;webpack&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> merge = <span class="built_in">require</span>(<span class="string">&#x27;webpack-merge&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> nodeExternals = <span class="built_in">require</span>(<span class="string">&#x27;webpack-node-externals&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> baseConfig = <span class="built_in">require</span>(<span class="string">&#x27;./webpack.base.conf.js&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> VueSSRServerPlugin = <span class="built_in">require</span>(<span class="string">&#x27;vue-server-renderer/server-plugin&#x27;</span>)</span><br><span class="line"><span class="comment">// 去除打包css的配置</span></span><br><span class="line">baseConfig.module.rules[<span class="number">1</span>].options = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = merge(baseConfig, &#123;</span><br><span class="line"> <span class="attr">entry</span>: <span class="string">&#x27;./src/entry-server.js&#x27;</span>,</span><br><span class="line"> <span class="comment">// 以 Node 适用方式导入</span></span><br><span class="line"> <span class="attr">target</span>: <span class="string">&#x27;node&#x27;</span>,</span><br><span class="line"> <span class="comment">// 对 bundle renderer 提供 source map 支持</span></span><br><span class="line"> <span class="attr">devtool</span>: <span class="string">&#x27;#source-map&#x27;</span>,</span><br><span class="line"> <span class="attr">output</span>: &#123;</span><br><span class="line">   <span class="attr">filename</span>: <span class="string">&#x27;server-bundle.js&#x27;</span>,</span><br><span class="line">   <span class="attr">libraryTarget</span>: <span class="string">&#x27;commonjs2&#x27;</span></span><br><span class="line"> &#125;,</span><br><span class="line"> <span class="attr">externals</span>: nodeExternals(&#123;</span><br><span class="line">   <span class="attr">whitelist</span>: <span class="regexp">/\.css$/</span></span><br><span class="line"> &#125;),</span><br><span class="line"> <span class="attr">plugins</span>: [</span><br><span class="line">   <span class="keyword">new</span> webpack.DefinePlugin(&#123;</span><br><span class="line">     <span class="string">&#x27;process.env.NODE_ENV&#x27;</span>: <span class="built_in">JSON</span>.stringify(process.env.NODE_ENV || <span class="string">&#x27;development&#x27;</span>),</span><br><span class="line">     <span class="string">&#x27;process.env.VUE_ENV&#x27;</span>: <span class="string">&#x27;&quot;server&quot;&#x27;</span></span><br><span class="line">   &#125;),</span><br><span class="line">   <span class="comment">// 这是将服务器的整个输出</span></span><br><span class="line">   <span class="comment">// 构建为单个 JSON 文件的插件。</span></span><br><span class="line">   <span class="comment">// 默认文件名为 `vue-ssr-server-bundle.json`</span></span><br><span class="line">   <span class="keyword">new</span> VueSSRServerPlugin()</span><br><span class="line"> ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>其次是<code>webpack.client.conf.js</code>，这里我们可以根据官方的配置生成<code>clientManifest</code>，自动推断和注入资源预加载，以及 css 链接 / script 标签到所渲染的 HTML。入口是我们的<code>client-server</code>:  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">&#x27;webpack&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> merge = <span class="built_in">require</span>(<span class="string">&#x27;webpack-merge&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> base = <span class="built_in">require</span>(<span class="string">&#x27;./webpack.base.conf&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> VueSSRClientPlugin = <span class="built_in">require</span>(<span class="string">&#x27;vue-server-renderer/client-plugin&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> config = merge(base, &#123;</span><br><span class="line"> <span class="attr">entry</span>: &#123;</span><br><span class="line">   <span class="attr">app</span>: <span class="string">&#x27;./src/entry-client.js&#x27;</span></span><br><span class="line"> &#125;,</span><br><span class="line"> <span class="attr">plugins</span>: [</span><br><span class="line">   <span class="keyword">new</span> webpack.DefinePlugin(&#123;</span><br><span class="line">     <span class="string">&#x27;process.env.NODE_ENV&#x27;</span>: <span class="built_in">JSON</span>.stringify(process.env.NODE_ENV || <span class="string">&#x27;development&#x27;</span>),</span><br><span class="line">     <span class="string">&#x27;process.env.VUE_ENV&#x27;</span>: <span class="string">&#x27;&quot;client&quot;&#x27;</span></span><br><span class="line">   &#125;),</span><br><span class="line">   <span class="keyword">new</span> webpack.optimize.CommonsChunkPlugin(&#123;</span><br><span class="line">     <span class="attr">name</span>: <span class="string">&#x27;vendor&#x27;</span>,</span><br><span class="line">     <span class="attr">minChunks</span>: <span class="function"><span class="keyword">function</span> (<span class="params"><span class="built_in">module</span></span>) </span>&#123;</span><br><span class="line">       <span class="keyword">return</span> (</span><br><span class="line">         <span class="regexp">/node_modules/</span>.test(<span class="built_in">module</span>.context) &amp;&amp;</span><br><span class="line">         !<span class="regexp">/\.css$/</span>.test(<span class="built_in">module</span>.request)</span><br><span class="line">       )</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;),</span><br><span class="line">   <span class="comment">// 这将 webpack 运行时分离到一个引导 chunk 中，</span></span><br><span class="line">   <span class="comment">// 以便可以在之后正确注入异步 chunk。</span></span><br><span class="line">   <span class="comment">// 这也为你的 应用程序/vendor 代码提供了更好的缓存。</span></span><br><span class="line">   <span class="keyword">new</span> webpack.optimize.CommonsChunkPlugin(&#123;</span><br><span class="line">     <span class="attr">name</span>: <span class="string">&#x27;manifest&#x27;</span></span><br><span class="line">   &#125;),</span><br><span class="line">   <span class="keyword">new</span> VueSSRClientPlugin()</span><br><span class="line"> ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>从<code>localhost</code>中我们看到<code>ssr</code>预取的数据已经成功出来了，大功告成！<br><img src="https://pic1.zhimg.com/80/v2-8354c78be3249def1cfc6b40d795c3a4_hd.jpg" alt="localhost">  </p>
<h2 id="7-结语"><a href="#7-结语" class="headerlink" title="7.结语"></a>7.结语</h2><p>本文介绍了Vue的SSR的构建和运行流程，也分析了SSR的特点和利弊，希望对大家了解SSR有一定的帮助。最后针对不使用vuex的SSR实现方案进行了介绍，如果感兴趣或者有疑问，欢迎大家留言交流。  </p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/35871344">阅读原文</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/05/21/65-%E3%80%90Vuejs%E3%80%91%E8%A7%A3%E5%AF%86VueSSR/" data-id="ckts3ejvm009j4d9k3t7maacd" data-title="65-【Vuejs】解密VueSSR" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Vuejs/" rel="tag">Vuejs</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-64-【前端开发】作为前端开发需要了解的开源协议知识" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/05/21/64-%E3%80%90%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91%E3%80%91%E4%BD%9C%E4%B8%BA%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91%E9%9C%80%E8%A6%81%E4%BA%86%E8%A7%A3%E7%9A%84%E5%BC%80%E6%BA%90%E5%8D%8F%E8%AE%AE%E7%9F%A5%E8%AF%86/" class="article-date">
  <time class="dt-published" datetime="2018-05-21T15:24:48.000Z" itemprop="datePublished">2018-05-21</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/05/21/64-%E3%80%90%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91%E3%80%91%E4%BD%9C%E4%B8%BA%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91%E9%9C%80%E8%A6%81%E4%BA%86%E8%A7%A3%E7%9A%84%E5%BC%80%E6%BA%90%E5%8D%8F%E8%AE%AE%E7%9F%A5%E8%AF%86/">64-【前端开发】作为前端开发需要了解的开源协议知识</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <hr>
<table>
<thead>
<tr>
<th>Author</th>
<th>王平安</th>
</tr>
</thead>
<tbody><tr>
<td>E-mail</td>
<td><a href="mailto:&#112;&#x69;&#x6e;&#103;&#x61;&#x6e;&#x38;&#x37;&#x38;&#x37;&#64;&#x71;&#113;&#x2e;&#x63;&#x6f;&#109;">&#112;&#x69;&#x6e;&#103;&#x61;&#x6e;&#x38;&#x37;&#x38;&#x37;&#64;&#x71;&#113;&#x2e;&#x63;&#x6f;&#109;</a></td>
</tr>
<tr>
<td>博  客</td>
<td><a target="_blank" rel="noopener" href="http://www.pingan8787.com/">www.pingan8787.com</a></td>
</tr>
<tr>
<td>微  信</td>
<td>pingan8787</td>
</tr>
<tr>
<td>每日文章</td>
<td><a target="_blank" rel="noopener" href="https://0x9.me/KMrv3">https://0x9.me/KMrv3</a></td>
</tr>
</tbody></table>
<hr>
<ul>
<li>作为前端工程师，开发中在所难免会用到一些开源框架，而每个框架都有自己的开源协议，每个开源协议之间有什么差别呢？ 如果你要开源一个项目，又应该选择哪种开源协议呢？  </li>
<li>许多开发者，对于开源协议的认知很少，本文从这些常用的前端框架入手，介绍开源常用开源协议的基础知识。  </li>
</ul>
<h3 id="什么是开源协议？"><a href="#什么是开源协议？" class="headerlink" title="什么是开源协议？"></a>什么是开源协议？</h3><p>根据 <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Open-source_license">开源协议</a> 在维基百科的定义：  </p>
<blockquote>
<p>开源许可是一种计算机软件和其他产品的许可类型，允许使用、修改或在定义的条款和条件下使用、修改或共享的源代码、蓝图和设计。<br>这允许终端用户和商业公司对源代码、图纸或设计进行审查和修改，以满足自己的定制、好奇心或故障排除的需要。<br>开源许可的软件大多是免费的，尽管这并不一定是必须的。许可证只允许非商业的重新分配或修改个人使用的源代码，通常不被认为是开源许可。<br>然而,开源许可可能会有一些限制,尤其是对软件的起源的表达,比如要求保留作者的名字和代码中的版权声明,或要求重新分配授权软件只有在相同的许可(如copyleft许可证)。<br>一组流行的开源软件许可证是由开源计划(OSI)根据其开源定义(OSD)批准的。  </p>
</blockquote>
<h3 id="为什么要选用开源协议？"><a href="#为什么要选用开源协议？" class="headerlink" title="为什么要选用开源协议？"></a>为什么要选用开源协议？</h3><p>在 <a target="_blank" rel="noopener" href="http://www.gcssloop.com/">GcsSloop</a> 写的文章 <a target="_blank" rel="noopener" href="http://www.gcssloop.com/tips/choose-license">程序员不可不知的版权协议</a> 中给出了很好的概括。</p>
<ul>
<li>首先是对作者的保护，防止知识成果被恶意利用。开源协议中一般都包含免责声明(禁止代码的作者承担代码被使用后产生的风险及后果)，比如你开源了一个破解智能锁的代码，如果有人利用这个去盗窃导致他人损失，你是无需承担责任的。   </li>
<li>其次是对使用者的保护，方便使用者。使用者一看就知道自己允许进行哪些操作，不允许进行哪些操作。未添加协议的代码默认是作者保留所有权利的(对此不同国家的法律可能稍微存在区别)，这就像一颗定时炸弹，如果你在项目中使用了这一份没有协议的代码，原作者只要能证明你未经许可使用了他的代码，是能够起诉你的。  </li>
</ul>
<h3 id="当前主流开源许可证-GPL、BSD、MIT、Mozilla、Apache、LGPL-和它们的异同？"><a href="#当前主流开源许可证-GPL、BSD、MIT、Mozilla、Apache、LGPL-和它们的异同？" class="headerlink" title="当前主流开源许可证(GPL、BSD、MIT、Mozilla、Apache、LGPL)和它们的异同？"></a>当前主流开源许可证(GPL、BSD、MIT、Mozilla、Apache、LGPL)和它们的异同？</h3><p><img src="https://pic2.zhimg.com/80/v2-1c76c3c63f4db1727ebe07815423f3b7_hd.jpg" alt="当前主流开源许可证"><br>相关概念解析：  </p>
<blockquote>
<ul>
<li>协议和版权信息(License and copyright notice)：在代码中保留作者提供的协议和版权信息  </li>
<li>声明变更(State Changes)：在代码中声明对原来代码的重大修改及变更  </li>
<li>公开源码(Disclose Source)：代码必需公开。如果是基于LGPL协议 下，则只需使用的开源代码公开，不必将整个软件源码公开  </li>
<li>库引用(Library usage)：该库可以用于商业软件中  </li>
<li>责任承担(Hold Liable)：代码的作者承担代码使用后的风险及产生的后果  </li>
<li>商标使用(Use Trademark)：可以使用作者的姓名，作品的Logo，或商标  </li>
<li>附加协议(Sublicensing)：允许在软件分发传播过程中附加上原来没有的协议条款等  </li>
</ul>
</blockquote>
<h3 id="当前前端主流框架选取的开源协议"><a href="#当前前端主流框架选取的开源协议" class="headerlink" title="当前前端主流框架选取的开源协议"></a>当前前端主流框架选取的开源协议</h3><p>纵观比较常用的前端框架，用的最广泛的便是 MIT 开源协议。  </p>
<blockquote>
<ul>
<li>Vue： MIT <a target="_blank" rel="noopener" href="https://github.com/vuejs/vue/blob/dev/LICENSE">点击阅读</a>  </li>
<li>React：MIT <a target="_blank" rel="noopener" href="https://github.com/facebook/react/blob/master/LICENSE">点击阅读</a>  </li>
<li>Element： MIT <a target="_blank" rel="noopener" href="https://github.com/ElemeFE/element/blob/master/LICENSE">点击阅读</a>  </li>
<li>Ant Design：MIT <a target="_blank" rel="noopener" href="https://github.com/ant-design/ant-design/blob/master/LICENSE">点击阅读</a>   </li>
</ul>
</blockquote>
<p>列举的框架开源协议都是 MIT 。那么为什么选择 MIT 呢？<br>MIT是一种简短而简单的许可，只需要保留版权和许可通知。许可的作品、修改和更大的作品可以在不同的条件下分发，并且没有源代码。MIT允许别人用作者的代码做任何事情，但必须保证作者的所有权，并且作者无须承担代码使用产生的风险。<br>其中，要重点说一下 React 的开源协议，从 github 的提交历史来看，React 的开源协议经历了一个动荡的过程。从 LICENCE 的提交历史看，Facebook 对专利的重视程度可见一斑。<br><img src="https://pic2.zhimg.com/80/v2-3d9fea33d17605fefe04d121b0a55b4d_hd.jpg" alt="React的开源协议"><br>去年知乎上一个《如何看待百度要求内部全面停止使用 React / React Native?》的文章引起了前端界的热议，事情的起因是大家发现了 Facebook 专利许可证上的描述暗藏玄机。在技术开源的世界，对于开发者而言，许可证就是他们使用开源软件的 “用户协议”。而 Facebook 的开源方式跟其他家都不太一样，别家一般用的都是开源社区公认通用的许可证，而 Facebook 使用的是两个许可证，第一个是通用的 BSD 许可证，第二个是自己写的专利许可证 (patent grant)。<br>而在 React 的开源协议中这么写到：<br><img src="https://pic4.zhimg.com/80/v2-a04b940e9f42b1c9801b2612d04a6bee_hd.jpg" alt=" React 的开源协议"><br>意思就是：<br>当发生下列情况时，facebook 有权益吊销你的 React 使用权：  </p>
<blockquote>
<ul>
<li>与 facebook 及其附属机构发生利益冲突  </li>
<li>同任何一个和 facebook 有关的组织发生了法律纠纷  </li>
<li>同任何与 React 有关的组织发生利益冲突  </li>
</ul>
</blockquote>
<p>翻译成大白话就是：如果你觉得 Facebook 侵犯了你的知识产权，同时你的核心产品是基于 React 实现，如果你想起诉 Facebook，就要权衡一下了，因为根据条款它有权利吊销你的 React 使用权。或者说你用 React 做了一个产品并且在某些领域对 Facebook 构成了利益冲突，那么它就可以强制你的产品下线。  </p>
<p>可以说，一旦你开始使用 React 去构建你的核心产品，你的公司就被 facebook 埋下了一颗定时炸弹，并且，炸弹的引爆按钮就握在 facebook 手中。  </p>
<p>其实这种事情，从去年就在前端技术圈开吵，后来愈演愈烈，形势每况日下：开源社区在更多 Facebook 开源的热门项目中发现了相同的许可证模式和条款。开发者认为 Facebook 的这种许可证模式正在毒害社区，污染开源精神。而且 Apache 软件基金会宣布所有使用 Apache 开源协议的软件都不得使用带有 Facebook BSD + 专利许可证模式的组件。  </p>
<p>不过 Facebook 最后还是意识到了这些问题，修改了开源协议。<br><img src="https://pic2.zhimg.com/80/v2-6809df1f7f8a7915a3f8909a5b9cff5d_hd.jpg" alt="Facebook开源协议">  </p>
<h3 id="如何为我们的项目选择一个开源协议？"><a href="#如何为我们的项目选择一个开源协议？" class="headerlink" title="如何为我们的项目选择一个开源协议？"></a>如何为我们的项目选择一个开源协议？</h3><p>首先，我们要清楚我们选择开源的目的是什么？<br>作为个人，在开源的情况下，我们可以帮助他人，也可以获得他人的帮助，还是一个提升个人代码质量的好方法，同样，也是一个展示自己能力的好方法。世界上开源软件协议的种类非常之多，并且同一款协议有很多变种，协议太宽松会导致作者丧失对作品的很多权利，太严格又不便于使用者使用及作品的传播，所以开源作者要考虑自己对作品想保留哪些权利，放开哪些限制。<br>作为公司，代码开源后，会提升公司的地位，树立一个良好的品牌形象，也可以帮助公司发掘潜在员工。<br>那么，我们如何选择适合我们的开源许可证呢？  </p>
<p>由一张图直观了解如何选取所需要的开源许可证。（原著：乌克兰程序员Paul Bagwell，翻译：阮一峰）<br><img src="https://pic4.zhimg.com/80/v2-253a7b1819e2af555ed0a7e0f11a0b59_hd.jpg" alt="开源许可证">  </p>
<p>举例来说：<br>如果我只是想专心的写代码，那么可以选择 MIT ，MIT在保证了作者的所有权的前提下允许别人使用作者的代码，且作者不需要承担使用时的风险。如果我想保护我的代码、专利，那么可以选择 Apache ，Apache 与 MIT 的区别就是提供了专利贡献者的授权，使用者需要明确这一点。  </p>
<p>Github 专门发布了一个网站 <a target="_blank" rel="noopener" href="https://choosealicense.com/">Choosing an OSS license doesn’t need to be scary</a> 来帮助开源项目开发者。  </p>
<blockquote>
<ul>
<li>我想要一个简单宽松的许可证建议： MIT 许可证。这是一个宽松的、简明扼要的许可证，只要用户在项目副本中包含了版权声明和许可声明，他们就可以拿你的代码做任何想做的事情，你也无需承担任何责任。<br>使用该许可证的项目：jQuery、Rails  </li>
<li>我比较关心专利<br>建议： Apache许可证。这类似于 MIT 许可证，但它同时还包含了贡献者向用户提供专利授权相关的条款。<br>使用该许可证的项目：Apache、SVN和NuGet  </li>
<li>我关心项目的共享改进<br>建议：GPL（ V2或 V3）许可证。这是一种 copyleft 许可证，要求修改项目代码的用户再次分发源码或二进制代码时，必须公布他的相关修改。V3版本与V2类&gt;似，但其进一步约束了在某些限制软件更改的硬件上的使用范围。<br>使用该许可证的项目：Linux、Git  </li>
<li>我的开源项目不是代码<br>建议： Creative Commons。这是一个相对宽松的版权协议。它只保留几种了权利（some rights reserved）。使用者可以明确知道所有者的权利，不容易侵犯对&gt;方的版权，作品可以得到有效传播。作为作者，你可以选择以下1~4种权利组合:  <ol>
<li>署名（Attribution，简写为BY）：必须提到原作者。  </li>
<li>非商业用途（Noncommercial，简写为NC）：不得用于盈利性目的。  </li>
<li>禁止演绎（No Derivative Works，简写为ND）：不得修改原作品, 不得再创作。  </li>
<li>相同方式共享（Share Alike，简写为SA）：允许修改原作品，但必须使用相同的许可证发布。  </li>
</ol>
</li>
<li>更多选择<br>Licenses - <a target="_blank" rel="noopener" href="https://choosealicense.com/">http://ChooseALicense.com</a>，这里提供了Apache/ GPL/ MIT/ Artistic/ Eclipse/ BSD/ LGPL/ Mozilla/ No License/ Public Domain &gt;Dedication 协议的适用情形、许可内容、禁止内容，及协议全文。  </li>
</ul>
</blockquote>
<h3 id="如何为代码添加开源协议？"><a href="#如何为代码添加开源协议？" class="headerlink" title="如何为代码添加开源协议？"></a>如何为代码添加开源协议？</h3><h4 id="GitHub"><a href="#GitHub" class="headerlink" title="GitHub"></a>GitHub</h4><ol>
<li><p>首先需要注册一个 GitHub 账号，并登录  </p>
</li>
<li><p>在 GitHub 上选择创建一个新的 repository<br><img src="https://pic4.zhimg.com/80/v2-5ab3d4f220e6524d445135c029014fe6_hd.jpg" alt="GitHub">  </p>
</li>
<li><p>进入创建 repository 页面后，输入基本信息后，点击右下角的 Add a license 选择开源协议，默认是 none。对应的 license 可以直接选择，也可以输入自己想要的 license<br><img src="https://pic4.zhimg.com/80/v2-fb3c51c8d10b9767792603877e32ec65_hd.jpg" alt="GitHub"><br><img src="https://pic1.zhimg.com/80/v2-209460d2fa43ea984f1f19de8606be3e_hd.jpg" alt="GitHub">  </p>
</li>
<li><p>点击最下方 Create repository，就创建成功了。</p>
</li>
<li><p>创建成功后，代码库中就可以看到自动生成了一个 LICENSE 文件。</p>
</li>
</ol>
<h3 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h3><blockquote>
<p><a target="_blank" rel="noopener" href="http://choosealicense.online/">选择一个开源软件协议</a><br><a target="_blank" rel="noopener" href="http://www.gcssloop.com/tips/choose-license">程序员不可不知的版权协议</a><br><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/28292322">开源许可证都有什么区别,一般开源项目用什么许可证?</a><br><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/29492362">都在封杀 React/React Native ，那我到底还该不该继续学呢？</a><br><a target="_blank" rel="noopener" href="https://cauu.github.io/2017/09/React-Opensource-license/">React开源协议之争知多少?</a><br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/Wayou/p/how_to_choose_a_license.html">how to choose a license</a>  </p>
</blockquote>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/35876146">原文地址</a></p>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/05/21/64-%E3%80%90%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91%E3%80%91%E4%BD%9C%E4%B8%BA%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91%E9%9C%80%E8%A6%81%E4%BA%86%E8%A7%A3%E7%9A%84%E5%BC%80%E6%BA%90%E5%8D%8F%E8%AE%AE%E7%9F%A5%E8%AF%86/" data-id="ckts3ejvm009h4d9k4gnu5ghr" data-title="64-【前端开发】作为前端开发需要了解的开源协议知识" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" rel="tag">前端开发</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-63-【JavaScript】JavaScript中常见设计模式" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/05/18/63-%E3%80%90JavaScript%E3%80%91JavaScript%E4%B8%AD%E5%B8%B8%E8%A7%81%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" class="article-date">
  <time class="dt-published" datetime="2018-05-18T15:36:36.000Z" itemprop="datePublished">2018-05-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/05/18/63-%E3%80%90JavaScript%E3%80%91JavaScript%E4%B8%AD%E5%B8%B8%E8%A7%81%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">63-【JavaScript】JavaScript中常见设计模式</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <hr>
<table>
<thead>
<tr>
<th>Author</th>
<th>王平安</th>
</tr>
</thead>
<tbody><tr>
<td>E-mail</td>
<td><a href="mailto:&#x70;&#x69;&#x6e;&#x67;&#97;&#x6e;&#56;&#x37;&#56;&#55;&#64;&#x71;&#x71;&#x2e;&#x63;&#x6f;&#109;">&#x70;&#x69;&#x6e;&#x67;&#97;&#x6e;&#56;&#x37;&#56;&#55;&#64;&#x71;&#x71;&#x2e;&#x63;&#x6f;&#109;</a></td>
</tr>
<tr>
<td>博  客</td>
<td><a target="_blank" rel="noopener" href="http://www.pingan8787.com/">www.pingan8787.com</a></td>
</tr>
<tr>
<td>微  信</td>
<td>pingan8787</td>
</tr>
<tr>
<td>每日文章</td>
<td><a target="_blank" rel="noopener" href="https://0x9.me/KMrv3">https://0x9.me/KMrv3</a></td>
</tr>
</tbody></table>
<hr>
<p>开发中，我们或多或少地接触了设计模式，但是很多时候不知道自己使用了哪种设计模式或者说该使用何种设计模式。本文意在梳理常见设计模式的特点，从而对它们有比较清晰的认知。   </p>
<h3 id="JavaScript-中常见设计模式"><a href="#JavaScript-中常见设计模式" class="headerlink" title="JavaScript 中常见设计模式"></a>JavaScript 中常见设计模式</h3><ul>
<li><a href="#单例模式">单例模式</a></li>
<li><a href="#策略模式">策略模式</a></li>
<li><a href="#代理模式">代理模式</a></li>
<li><a href="#迭代器模式">迭代器模式</a></li>
<li><a href="#发布-订阅模式">发布-订阅模式</a></li>
<li><a href="#命令模式">命令模式</a></li>
<li><a href="#组合模式">组合模式</a></li>
<li><a href="#模板方法模式">模板方法模式</a></li>
<li><a href="#享元模式">享元模式</a></li>
<li><a href="#职责链模式">职责链模式</a></li>
<li><a href="#中介者模式">中介者模式</a></li>
<li><a href="#装饰者模式">装饰者模式</a></li>
<li><a href="#状态模式">状态模式</a></li>
<li><a href="#适配者模式">适配者模式</a></li>
</ul>
<h3 id="各设计模式关键词"><a href="#各设计模式关键词" class="headerlink" title="各设计模式关键词"></a>各设计模式关键词</h3><p>看完了上述设计模式后，把它们的关键词特点罗列出来，以后提到某种设计模式，进而联想相应的关键词和例子，从而心中有数。   </p>
<table>
<thead>
<tr>
<th>设计模式</th>
<th>特点</th>
<th>案例</th>
</tr>
</thead>
<tbody><tr>
<td>单例模式</td>
<td>一个类只能构造出唯一实例</td>
<td>创建菜单对象</td>
</tr>
<tr>
<td>策略模式</td>
<td>根据不同参数可以命中不同的策略</td>
<td>动画库里的算法函数</td>
</tr>
<tr>
<td>代理模式</td>
<td>代理对象和本体对象具有一致的接口</td>
<td>图片预加载</td>
</tr>
<tr>
<td>迭代器模式</td>
<td>能获取聚合对象的顺序和元素</td>
<td>each([1, 2, 3], cb)</td>
</tr>
<tr>
<td>发布-订阅模式</td>
<td>PubSub</td>
<td>瀑布流库</td>
</tr>
<tr>
<td>命令模式</td>
<td>不同对象间约定好相应的接口</td>
<td>按钮和命令的分离</td>
</tr>
<tr>
<td>组合模式</td>
<td>组合模式在对象间形成一致对待的树形结构</td>
<td>扫描文件夹</td>
</tr>
<tr>
<td>模板方法模式</td>
<td>父类中定好执行顺序</td>
<td>咖啡和茶</td>
</tr>
<tr>
<td>享元模式</td>
<td>减少创建实例的个数</td>
<td>男女模具试装</td>
</tr>
<tr>
<td>职责链模式</td>
<td>通过请求第一个条件，会持续执行后续的条件，直到返回结果为止</td>
<td>if else 优化</td>
</tr>
<tr>
<td>中介者模式</td>
<td>对象和对象之间借助第三方中介者进行通信</td>
<td>测试结束告知结果</td>
</tr>
<tr>
<td>装饰者模式</td>
<td>动态地给函数赋能</td>
<td>天冷了穿衣服，热了脱衣服</td>
</tr>
<tr>
<td>状态模式</td>
<td>每个状态建立一个类，状态改变会产生不同行为</td>
<td>电灯换挡</td>
</tr>
<tr>
<td>适配者模式</td>
<td>一种数据结构改成另一种数据结构</td>
<td>枚举值接口变更</td>
</tr>
</tbody></table>
<h2 id="1-单例模式"><a href="#1-单例模式" class="headerlink" title="1.单例模式 "></a><a name="单例模式">1.单例模式 </a></h2><h3 id="两个条件"><a href="#两个条件" class="headerlink" title="两个条件"></a>两个条件</h3><ul>
<li>确保只有一个实例</li>
<li>可以全局访问</li>
</ul>
<h3 id="适用"><a href="#适用" class="headerlink" title="适用"></a>适用</h3><p>适用于弹框的实现，全局缓存  </p>
<h3 id="实现单例模式"><a href="#实现单例模式" class="headerlink" title="实现单例模式"></a>实现单例模式</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> singleton = <span class="function"><span class="keyword">function</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.name = name</span><br><span class="line">  <span class="built_in">this</span>.instance = <span class="literal">null</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">singleton.prototype.getName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">this</span>.name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">singleton.getInstance = <span class="function"><span class="keyword">function</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!<span class="built_in">this</span>.instance) &#123; <span class="comment">// 关键语句</span></span><br><span class="line">    <span class="built_in">this</span>.instance = <span class="keyword">new</span> singleton(name)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">this</span>.instance</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// test</span></span><br><span class="line"><span class="keyword">const</span> a = singleton.getInstance(<span class="string">&#x27;a&#x27;</span>) <span class="comment">// 通过 getInstance 来获取实例</span></span><br><span class="line"><span class="keyword">const</span> b = singleton.getInstance(<span class="string">&#x27;b&#x27;</span>)</span><br><span class="line"><span class="built_in">console</span>.log(a === b)</span><br></pre></td></tr></table></figure>
<h3 id="JavaScript-中的单例模式"><a href="#JavaScript-中的单例模式" class="headerlink" title="JavaScript 中的单例模式"></a>JavaScript 中的单例模式</h3><p>因为 JavaScript 是无类的语言，而且 JS 中的全局对象符合单例模式两个条件。很多时候我们把全局对象当成单例模式来使用，  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;&#125;</span><br></pre></td></tr></table></figure>
<h3 id="弹框层的实践"><a href="#弹框层的实践" class="headerlink" title="弹框层的实践"></a>弹框层的实践</h3><p>实现弹框的一种做法是先创建好弹框，然后使之隐藏，这样子的话会浪费部分不必要的 DOM 开销，我们可以在需要弹框的时候再进行创建，同时结合单例模式实现只有一个实例，从而节省部分 DOM 开销。下列为登入框部分代码：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> createLoginLayer = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> div = <span class="built_in">document</span>.createElement(<span class="string">&#x27;div&#x27;</span>)</span><br><span class="line">  div.innerHTML = <span class="string">&#x27;登入浮框&#x27;</span></span><br><span class="line">  div.style.display = <span class="string">&#x27;none&#x27;</span></span><br><span class="line">  <span class="built_in">document</span>.appendChild(div)</span><br><span class="line">  <span class="keyword">return</span> div</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使单例模式和创建弹框代码解耦  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> getSingle = <span class="function"><span class="keyword">function</span>(<span class="params">fn</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> result</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> result || result = fn.apply(<span class="built_in">this</span>, <span class="built_in">arguments</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> createSingleLoginLayer = getSingle(createLoginLayer)</span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">&#x27;loginBtn&#x27;</span>).onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  createSingleLoginLayer()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="2-策略模式"><a href="#2-策略模式" class="headerlink" title="2.策略模式"></a><a name="策略模式">2.策略模式</a></h2><blockquote>
<p>定义：根据不同参数可以命中不同的策略 </p>
</blockquote>
<h3 id="JavaScript-中的策略模式"><a href="#JavaScript-中的策略模式" class="headerlink" title="JavaScript 中的策略模式"></a>JavaScript 中的策略模式</h3><p>观察如下获取年终奖的 demo，根据不同的参数（level）获得不同策略方法(规则)，这是策略模式在 JS 比较经典的运用之一。  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> strategy = &#123;</span><br><span class="line">  <span class="string">&#x27;S&#x27;</span>: <span class="function"><span class="keyword">function</span>(<span class="params">salary</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> salary * <span class="number">4</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&#x27;A&#x27;</span>: <span class="function"><span class="keyword">function</span>(<span class="params">salary</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> salary * <span class="number">3</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&#x27;B&#x27;</span>: <span class="function"><span class="keyword">function</span>(<span class="params">salary</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> salary * <span class="number">2</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> calculateBonus = <span class="function"><span class="keyword">function</span>(<span class="params">level, salary</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> strategy[level](salary)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">calculateBonus(<span class="string">&#x27;A&#x27;</span>, <span class="number">10000</span>) <span class="comment">// 30000</span></span><br></pre></td></tr></table></figure>
<p>在函数是一等公民的 JS 中，策略模式的使用常常隐藏在高阶函数中，稍微变换下上述 demo 的形式如下，可以发现我们平时已经在使用它了，恭喜我们又掌握了一种设计模式。  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> S = <span class="function"><span class="keyword">function</span>(<span class="params">salary</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> salary * <span class="number">4</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> A = <span class="function"><span class="keyword">function</span>(<span class="params">salary</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> salary * <span class="number">3</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> B = <span class="function"><span class="keyword">function</span>(<span class="params">salary</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> salary * <span class="number">2</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> calculateBonus = <span class="function"><span class="keyword">function</span>(<span class="params">func, salary</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> func(salary)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">calculateBonus(A, <span class="number">10000</span>) <span class="comment">// 30000</span></span><br></pre></td></tr></table></figure>
<h3 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h3><ul>
<li>能减少大量的 if 语句</li>
<li>复用性好</li>
</ul>
<hr>
<h2 id="3-代理模式"><a href="#3-代理模式" class="headerlink" title="3.代理模式"></a><a name="代理模式">3.代理模式</a></h2><p>情景：小明追女生 A  </p>
<ul>
<li>非代理模式：小明 =花=&gt; 女生A  </li>
<li>代理模式：小明 =花=&gt; 让女生A的好友B帮忙 =花=&gt; 女生A  </li>
</ul>
<h3 id="代理模式的特点"><a href="#代理模式的特点" class="headerlink" title="代理模式的特点"></a>代理模式的特点</h3><ul>
<li>代理对象和本体对象具有一致的接口，对使用者友好  </li>
</ul>
<p>代理模式的种类有很多，在 JS 中最常用的为虚拟代理和缓存代理。  </p>
<h4 id="虚拟代理实现图片预加载"><a href="#虚拟代理实现图片预加载" class="headerlink" title="虚拟代理实现图片预加载"></a>虚拟代理实现图片预加载</h4><p>下面这段代码运用代理模式来实现图片预加载，可以看到通过代理模式巧妙地将创建图片与预加载逻辑分离，并且在未来如果不需要预加载，只要改成请求本体代替请求代理对象就行。  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> myImage = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> imgNode = <span class="built_in">document</span>.createElement(<span class="string">&#x27;img&#x27;</span>)</span><br><span class="line">  <span class="built_in">document</span>.body.appendChild(imgNode)</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">setSrc</span>: <span class="function"><span class="keyword">function</span>(<span class="params">src</span>) </span>&#123;</span><br><span class="line">      imgNode.src = src</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)()</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> proxyImage = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> img = <span class="keyword">new</span> Image()</span><br><span class="line">  img.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// http 图片加载完毕后才会执行</span></span><br><span class="line">    myImage.setSrc(<span class="built_in">this</span>.src)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">setSrc</span>: <span class="function"><span class="keyword">function</span>(<span class="params">src</span>) </span>&#123;</span><br><span class="line">      myImage.setSrc(<span class="string">&#x27;loading.jpg&#x27;</span>) <span class="comment">// 本地 loading 图片</span></span><br><span class="line">      img.src = src</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)()</span><br><span class="line"></span><br><span class="line">proxyImage.setSrc(<span class="string">&#x27;http://loaded.jpg&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>缓存代理实现乘积计算  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mult = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> a = <span class="number">1</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>, l; l = <span class="built_in">arguments</span>[i++];) &#123;</span><br><span class="line">    a = a * l</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> a</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> proxyMult = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> cache = &#123;&#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> tag = <span class="built_in">Array</span>.prototype.join.call(<span class="built_in">arguments</span>, <span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> (cache[tag]) &#123;</span><br><span class="line">      <span class="keyword">return</span> cache[tag]</span><br><span class="line">    &#125;</span><br><span class="line">    cache[tag] = mult.apply(<span class="built_in">this</span>, <span class="built_in">arguments</span>)</span><br><span class="line">    <span class="keyword">return</span> cache[tag]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)()</span><br><span class="line"></span><br><span class="line">proxyMult(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>) <span class="comment">// 24</span></span><br></pre></td></tr></table></figure>

<h3 id="小-tip"><a href="#小-tip" class="headerlink" title="小 tip"></a>小 tip</h3><p>在开发时候不要先去猜测是否需要使用代理模式，如果发现直接使用某个对象不方便时，再来优化不迟。  </p>
<hr>
<h2 id="4-迭代器模式"><a href="#4-迭代器模式" class="headerlink" title="4.迭代器模式"></a><a name="迭代器模式">4.迭代器模式</a></h2><blockquote>
<p>定义：能访问到聚合对象的顺序与元素  </p>
</blockquote>
<h3 id="实现一个内部迭代器"><a href="#实现一个内部迭代器" class="headerlink" title="实现一个内部迭代器"></a>实现一个内部迭代器</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">each</span>(<span class="params">arr, fn</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">    fn(i, arr[i])</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">each([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], <span class="function"><span class="keyword">function</span>(<span class="params">i, n</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(i) <span class="comment">// 0 1 2</span></span><br><span class="line">  <span class="built_in">console</span>.log(n) <span class="comment">// 1 2 3</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>可以看出内部迭代器在调用的时候非常简单，使用者不用关心迭代器内部实现的细节，但这也是内部迭代器的缺点。比如要比较两数组是否相等，只能在其回调函数中作文章了，代码如下：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> compare = <span class="function"><span class="keyword">function</span>(<span class="params">arr1, arr2</span>) </span>&#123;</span><br><span class="line">  each(arr1, <span class="function"><span class="keyword">function</span>(<span class="params">i, n</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (arr2[i] !== n) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;两数组不等&#x27;</span>)</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;两数组相等&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> arr1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="keyword">const</span> arr2 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">compare(arr1, arr2) <span class="comment">// 两数组相等</span></span><br></pre></td></tr></table></figure>
<h3 id="实现一个外部迭代器"><a href="#实现一个外部迭代器" class="headerlink" title="实现一个外部迭代器"></a>实现一个外部迭代器</h3><p>相较于内部迭代器，外部迭代器将遍历的权利转移到外部，因此在调用的时候拥有了更多的自由性，不过缺点是调用方式较复杂。  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> iterator = <span class="function"><span class="keyword">function</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> current = <span class="number">0</span></span><br><span class="line">  <span class="keyword">const</span> next = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    current = current + <span class="number">1</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> done = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> current &gt;= arr.length</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> value = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> arr[current]</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    next,</span><br><span class="line">    done,</span><br><span class="line">    value,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> arr1 = [<span class="number">1</span>, <span class="number">2</span> ,<span class="number">3</span>]</span><br><span class="line"><span class="keyword">const</span> arr2 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="keyword">const</span> iterator1 = iterator(arr1)</span><br><span class="line"><span class="keyword">const</span> iterator2 = iterator(arr2)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> compare = <span class="function"><span class="keyword">function</span>(<span class="params">iterator1, iterator2</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">while</span> (!iterator1.done() &amp;&amp; !iterator2.done()) &#123;</span><br><span class="line">    <span class="keyword">if</span> (iterator1.value() !== iterator2.value()) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;两数组不等&#x27;</span>)</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    iterator1.next() <span class="comment">// 外部迭代器将遍历的权利转移到外部</span></span><br><span class="line">    iterator2.next()</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;两数组相等&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">compare(iterator1, iterator2)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="5-发布订阅模式"><a href="#5-发布订阅模式" class="headerlink" title="5.发布订阅模式"></a><a name="发布订阅模式">5.发布订阅模式</a></h2><p>事件发布/订阅模式 (PubSub) 在异步编程中帮助我们完成更松的解耦，甚至在 MVC、MVVC 的架构中以及设计模式中也少不了发布-订阅模式的参与。<br>优点：在异步编程中实现更深的解耦<br>缺点：如果过多的使用发布订阅模式，会增加维护的难度  </p>
<h3 id="实现一个发布订阅模式"><a href="#实现一个发布订阅模式" class="headerlink" title="实现一个发布订阅模式"></a>实现一个发布订阅模式</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Event = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.obj = &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Event.prototype.on = <span class="function"><span class="keyword">function</span>(<span class="params">eventType, fn</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!<span class="built_in">this</span>.obj[eventType]) &#123;</span><br><span class="line">    <span class="built_in">this</span>.obj[eventType] = []</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">this</span>.obj[eventType].push(fn)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Event.prototype.emit = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> eventType = <span class="built_in">Array</span>.prototype.shift.call(<span class="built_in">arguments</span>)</span><br><span class="line">  <span class="keyword">var</span> arr = <span class="built_in">this</span>.obj[eventType]</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">    arr[i].apply(arr[i], <span class="built_in">arguments</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ev = <span class="keyword">new</span> Event()</span><br><span class="line"></span><br><span class="line">ev.on(<span class="string">&#x27;click&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">a</span>) </span>&#123; <span class="comment">// 订阅函数</span></span><br><span class="line">  <span class="built_in">console</span>.log(a) <span class="comment">// 1</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">ev.emit(<span class="string">&#x27;click&#x27;</span>, <span class="number">1</span>)          <span class="comment">// 发布函数</span></span><br></pre></td></tr></table></figure>

<h3 id="订阅函数逻辑一定要优先于发布函数吗"><a href="#订阅函数逻辑一定要优先于发布函数吗" class="headerlink" title="订阅函数逻辑一定要优先于发布函数吗"></a>订阅函数逻辑一定要优先于发布函数吗</h3><p>考虑以下场景：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$.ajax(<span class="string">&#x27;&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 异步订阅函数逻辑</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 在其他地方执行发布函数，此时并不能保证执行发布函数的时候，订阅函数已经执行</span></span><br></pre></td></tr></table></figure>
<p>我们需要实现这样的逻辑：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ev = <span class="keyword">new</span> Event()</span><br><span class="line">ev.emit(<span class="string">&#x27;click&#x27;</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">ev.on(<span class="string">&#x27;click&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">a</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(a) <span class="comment">// 1</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>目标明确后，来着手实现它：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Event = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.obj = &#123;&#125;</span><br><span class="line">  <span class="built_in">this</span>.cacheList = []</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Event.prototype.on = <span class="function"><span class="keyword">function</span>(<span class="params">eventType, fn</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!<span class="built_in">this</span>.obj[eventType]) &#123;</span><br><span class="line">    <span class="built_in">this</span>.obj[eventType] = []</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">this</span>.obj[eventType].push(fn)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="built_in">this</span>.cacheList.length; i++) &#123;</span><br><span class="line">    <span class="built_in">this</span>.cacheList[i]()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Event.prototype.emit = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> arg = <span class="built_in">arguments</span></span><br><span class="line">  <span class="keyword">const</span> that = <span class="built_in">this</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">cache</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> eventType = <span class="built_in">Array</span>.prototype.shift.call(arg)</span><br><span class="line">    <span class="keyword">var</span> arr = that.obj[eventType]</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">      arr[i].apply(arr[i], arg)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">this</span>.cacheList.push(cache)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>以上代码实现思路就是把原本在 <code>emit</code> 里触发的函数存到 <code>cacheList</code>，再转交到 <code>on</code> 中触发。从而实现了发布函数先于订阅函数执行。  </p>
<hr>
<h2 id="6-命令模式"><a href="#6-命令模式" class="headerlink" title="6.命令模式"></a><a name="命令模式">6.命令模式</a></h2><p>命令模式与策略模式有些类似，在 JavaScript 中它们都是隐式的。<br>重要性：较低  </p>
<h3 id="JavaScript-中的命令模式"><a href="#JavaScript-中的命令模式" class="headerlink" title="JavaScript 中的命令模式"></a>JavaScript 中的命令模式</h3><p>命令模式在 JavaScript 中也比较简单，下面代码中对按钮和命令进行了抽离，因此可以复杂项目中可以使用命令模式将界面的代码和功能的代码交付给不同的人去写。  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> setCommand = <span class="function"><span class="keyword">function</span>(<span class="params">button, command</span>) </span>&#123;</span><br><span class="line">  button.onClick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    command.excute()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// --------------------  上面的界面逻辑由A完成，下面的由B完成</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> menu = &#123;</span><br><span class="line">  <span class="attr">updateMenu</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;更新菜单&#x27;</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> UpdateCommand = <span class="function"><span class="keyword">function</span>(<span class="params">receive</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">excute</span>: receive.updateMenu,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> updateCommand = UpdateCommand(menu) <span class="comment">// 创建命令</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> button1 = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;button1&#x27;</span>)</span><br><span class="line">setCommand(button1, updateCommand)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="7-组合模式"><a href="#7-组合模式" class="headerlink" title="7.组合模式"></a><a name="组合模式">7.组合模式</a></h2><ul>
<li>组合模式在对象间形成树形结构;  </li>
<li>组合模式中基本对象和组合对象被一致对待;  </li>
<li>无须关心对象有多少层，调用时只需在根部进行调用;  </li>
</ul>
<h3 id="demo1-——-宏命令"><a href="#demo1-——-宏命令" class="headerlink" title="demo1 —— 宏命令"></a>demo1 —— 宏命令</h3><p>想象我们现在手上有个万能遥控器，当我们回家，按一下开关，下列事情将被执行:  </p>
<ol>
<li>煮咖啡</li>
<li>打开电视、打开音响</li>
<li>打开空调、打开电脑</li>
</ol>
<p>我们把任务划分为 3 类，效果图如下：<br><img src="https://camo.githubusercontent.com/a44e97b789bd6e25d1aa13b15b12239c0566b015/687474703a2f2f6f71687473637573302e626b742e636c6f7564646e2e636f6d2f39633837636538333535313566336439623630613836613066323838393764392e6a70672d343030" alt="任务划分"><br>接着看看结合了命令模式和组合模式的具体实现：    </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> MacroCommand = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">lists</span>: [],</span><br><span class="line">    <span class="attr">add</span>: <span class="function"><span class="keyword">function</span>(<span class="params">task</span>) </span>&#123;</span><br><span class="line">      <span class="built_in">this</span>.lists.push(task)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">excute</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// ①：组合对象调用这里的 excute，</span></span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="built_in">this</span>.lists.length; i++) &#123;</span><br><span class="line">        <span class="built_in">this</span>.lists[i].excute()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> command1 = MacroCommand() <span class="comment">// 基本对象</span></span><br><span class="line"></span><br><span class="line">command1.add(&#123;</span><br><span class="line">  <span class="attr">excute</span>: <span class="function">() =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&#x27;煮咖啡&#x27;</span>) <span class="comment">// ②：基本对象调用这里的 excute，</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> command2 = MacroCommand() <span class="comment">// 组合对象</span></span><br><span class="line"></span><br><span class="line">command2.add(&#123;</span><br><span class="line">  <span class="attr">excute</span>: <span class="function">() =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&#x27;打开电视&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">command2.add(&#123;</span><br><span class="line">  <span class="attr">excute</span>: <span class="function">() =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&#x27;打开音响&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> command3 = MacroCommand()</span><br><span class="line"></span><br><span class="line">command3.add(&#123;</span><br><span class="line">  <span class="attr">excute</span>: <span class="function">() =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&#x27;打开空调&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">command3.add(&#123;</span><br><span class="line">  <span class="attr">excute</span>: <span class="function">() =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&#x27;打开电脑&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> macroCommand = MacroCommand()</span><br><span class="line">macroCommand.add(command1)</span><br><span class="line">macroCommand.add(command2)</span><br><span class="line">macroCommand.add(command3)</span><br><span class="line"></span><br><span class="line">macroCommand.excute()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 煮咖啡</span></span><br><span class="line"><span class="comment">// 打开电视</span></span><br><span class="line"><span class="comment">// 打开音响</span></span><br><span class="line"><span class="comment">// 打开空调</span></span><br><span class="line"><span class="comment">// 打开电脑</span></span><br></pre></td></tr></table></figure>

<p>可以看出在组合模式中基本对象和组合对象被一致对待，所以要保证基本对象(叶对象)和组合对象具有一致方法。  </p>
<h3 id="demo2-——-扫描文件夹"><a href="#demo2-——-扫描文件夹" class="headerlink" title="demo2 —— 扫描文件夹"></a>demo2 —— 扫描文件夹</h3><p>扫描文件夹时，文件夹下面可以为另一个文件夹也可以为文件，我们希望统一对待这些文件夹和文件，这种情形适合使用组合模式。  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Folder = <span class="function"><span class="keyword">function</span>(<span class="params">folder</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.folder = folder</span><br><span class="line">  <span class="built_in">this</span>.lists = []</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Folder.prototype.add = <span class="function"><span class="keyword">function</span>(<span class="params">resource</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.lists.push(resource)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Folder.prototype.scan = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;开始扫描文件夹：&#x27;</span>, <span class="built_in">this</span>.folder)</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>, folder; folder = <span class="built_in">this</span>.lists[i++];) &#123;</span><br><span class="line">    folder.scan()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> File = <span class="function"><span class="keyword">function</span>(<span class="params">file</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.file = file</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">File.prototype.add = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">throw</span> <span class="built_in">Error</span>(<span class="string">&#x27;文件下不能添加其它文件夹或文件&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">File.prototype.scan = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;开始扫描文件：&#x27;</span>, <span class="built_in">this</span>.file)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> folder = <span class="keyword">new</span> Folder(<span class="string">&#x27;根文件夹&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> folder1 = <span class="keyword">new</span> Folder(<span class="string">&#x27;JS&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> folder2 = <span class="keyword">new</span> Folder(<span class="string">&#x27;life&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> file1 = <span class="keyword">new</span> File(<span class="string">&#x27;深入React技术栈.pdf&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> file2 = <span class="keyword">new</span> File(<span class="string">&#x27;JavaScript权威指南.pdf&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> file3 = <span class="keyword">new</span> File(<span class="string">&#x27;小王子.pdf&#x27;</span>)</span><br><span class="line"></span><br><span class="line">folder1.add(file1)</span><br><span class="line">folder1.add(file2)</span><br><span class="line"></span><br><span class="line">folder2.add(file3)</span><br><span class="line"></span><br><span class="line">folder.add(folder1)</span><br><span class="line">folder.add(folder2)</span><br><span class="line"></span><br><span class="line">folder.scan()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 开始扫描文件夹： 根文件夹</span></span><br><span class="line"><span class="comment">// 开始扫描文件夹： JS</span></span><br><span class="line"><span class="comment">// 开始扫描文件： 深入React技术栈.pdf</span></span><br><span class="line"><span class="comment">// 开始扫描文件： JavaScript权威指南.pdf</span></span><br><span class="line"><span class="comment">// 开始扫描文件夹： life</span></span><br><span class="line"><span class="comment">// 开始扫描文件： 小王子.pdf</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="8-模板方法模式"><a href="#8-模板方法模式" class="headerlink" title="8.模板方法模式"></a><a name="模板方法模式">8.模板方法模式</a></h2><blockquote>
<p>定义：在继承的基础上，在父类中定义好执行的算法。  </p>
</blockquote>
<h3 id="泡茶和泡咖啡"><a href="#泡茶和泡咖啡" class="headerlink" title="泡茶和泡咖啡"></a>泡茶和泡咖啡</h3><p>来对比下泡茶和泡咖啡过程中的异同   </p>
<table>
<thead>
<tr>
<th>步骤</th>
<th>泡茶</th>
<th>泡咖啡</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>烧开水</td>
<td>烧开水</td>
</tr>
<tr>
<td>2</td>
<td>浸泡茶叶</td>
<td>冲泡咖啡</td>
</tr>
<tr>
<td>3</td>
<td>倒入杯子</td>
<td>倒入杯子</td>
</tr>
<tr>
<td>4</td>
<td>加柠檬</td>
<td>加糖</td>
</tr>
</tbody></table>
<p>可以清晰地看出仅仅在步骤 2 和 4 上有细微的差别，下面着手实现：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Drinks = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">Drinks.prototype.firstStep = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;烧开水&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Drinks.prototype.secondStep = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">Drinks.prototype.thirdStep = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;倒入杯子&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Drinks.prototype.fourthStep = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">Drinks.prototype.init = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// 模板方法模式核心：在父类上定义好执行算法</span></span><br><span class="line">  <span class="built_in">this</span>.firstStep()</span><br><span class="line">  <span class="built_in">this</span>.secondStep()</span><br><span class="line">  <span class="built_in">this</span>.thirdStep()</span><br><span class="line">  <span class="built_in">this</span>.fourthStep()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Tea = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">Tea.prototype = <span class="keyword">new</span> Drinks</span><br><span class="line"></span><br><span class="line">Tea.prototype.secondStep = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;浸泡茶叶&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Tea.prototype.fourthStep = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;加柠檬&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Coffee = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">Coffee.prototype = <span class="keyword">new</span> Drinks</span><br><span class="line"></span><br><span class="line">Coffee.prototype.secondStep = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;冲泡咖啡&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Coffee.prototype.fourthStep = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;加糖&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> tea = <span class="keyword">new</span> Tea()</span><br><span class="line">tea.init()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 烧开水</span></span><br><span class="line"><span class="comment">// 浸泡茶叶</span></span><br><span class="line"><span class="comment">// 倒入杯子</span></span><br><span class="line"><span class="comment">// 加柠檬</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> coffee = <span class="keyword">new</span> Coffee()</span><br><span class="line">coffee.init()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 烧开水</span></span><br><span class="line"><span class="comment">// 冲泡咖啡</span></span><br><span class="line"><span class="comment">// 倒入杯子</span></span><br><span class="line"><span class="comment">// 加糖</span></span><br></pre></td></tr></table></figure>

<h3 id="钩子"><a href="#钩子" class="headerlink" title="钩子"></a>钩子</h3><p>假如客人不想加佐料(糖、柠檬)怎么办，这时可以引人钩子来实现之，实现逻辑如下：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">Drinks.prototype.ifNeedFlavour = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// 加上钩子</span></span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Drinks.prototype.init = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// 模板方法模式核心：在父类上定义好执行算法</span></span><br><span class="line">  <span class="built_in">this</span>.firstStep()</span><br><span class="line">  <span class="built_in">this</span>.secondStep()</span><br><span class="line">  <span class="built_in">this</span>.thirdStep()</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">this</span>.ifNeedFlavour()) &#123; <span class="comment">// 默认是 true，也就是要加调料</span></span><br><span class="line">    <span class="built_in">this</span>.fourthStep()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="keyword">const</span> Coffee = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">Coffee.prototype = <span class="keyword">new</span> Drinks()</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">Coffee.prototype.ifNeedFlavour = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">window</span>.confirm(<span class="string">&#x27;是否需要佐料吗？&#x27;</span>) <span class="comment">// 弹框选择是否佐料</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="9-享元模式"><a href="#9-享元模式" class="headerlink" title="9.享元模式"></a><a name="享元模式">9.享元模式</a></h2><p>享元模式是一种优化程序性能的模式，本质为减少对象创建的个数。  </p>
<p>以下情况可以使用享元模式：  </p>
<ul>
<li>有大量相似的对象，占用了大量内存  </li>
<li>对象中大部分状态可以抽离为外部状态  </li>
</ul>
<h3 id="demo"><a href="#demo" class="headerlink" title="demo"></a>demo</h3><p>某商家有 50 种男款内衣和 50 种款女款内衣，要展示它们  </p>
<p>方案一：造 50 个塑料男模和 50 个塑料女模，让他们穿上展示，代码如下：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Model = <span class="function"><span class="keyword">function</span>(<span class="params">gender, underwear</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.gender = gender</span><br><span class="line">  <span class="built_in">this</span>.underwear = underwear</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Model.prototype.takephoto = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;<span class="built_in">this</span>.gender&#125;</span>穿着<span class="subst">$&#123;<span class="built_in">this</span>.underwear&#125;</span>`</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt; <span class="number">51</span>; i++) &#123;</span><br><span class="line">  <span class="keyword">const</span> maleModel = <span class="keyword">new</span> Model(<span class="string">&#x27;male&#x27;</span>, <span class="string">`第<span class="subst">$&#123;i&#125;</span>款衣服`</span>)</span><br><span class="line">  maleModel.takephoto()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt; <span class="number">51</span>; i++) &#123;</span><br><span class="line">  <span class="keyword">const</span> female = <span class="keyword">new</span> Model(<span class="string">&#x27;female&#x27;</span>, <span class="string">`第<span class="subst">$&#123;i&#125;</span>款衣服`</span>)</span><br><span class="line">  female.takephoto()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>方案二：造 1 个塑料男模特 1 个塑料女模特，分别试穿 50 款内衣  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Model = <span class="function"><span class="keyword">function</span>(<span class="params">gender</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.gender = gender</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Model.prototype.takephoto = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;<span class="built_in">this</span>.sex&#125;</span>穿着<span class="subst">$&#123;<span class="built_in">this</span>.underwear&#125;</span>`</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> maleModel = <span class="keyword">new</span> Model(<span class="string">&#x27;male&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> femaleModel = <span class="keyword">new</span> Model(<span class="string">&#x27;female&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt; <span class="number">51</span>; i++) &#123;</span><br><span class="line">  maleModel.underwear = <span class="string">`第<span class="subst">$&#123;i&#125;</span>款衣服`</span></span><br><span class="line">  maleModel.takephoto()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt; <span class="number">51</span>; i++) &#123;</span><br><span class="line">  femaleModel.underwear = <span class="string">`第<span class="subst">$&#123;i&#125;</span>款衣服`</span></span><br><span class="line">  femaleModel.takephoto()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>对比发现：方案一创建了 100 个对象，方案二只创建了 2 个对象，在该 demo 中，gender(性别) 是内部对象，underwear(穿着) 是外部对象。  </p>
<p>当然在方案二的 demo 中，还可以进一步改善：  </p>
<ul>
<li>一开始就通过构造函数显示地创建实例，可用工场模式将其升级成可控生成</li>
<li>在实例上手动添加 underwear 不是很优雅，可以在外部单独在写个 manager 函数<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Model = <span class="function"><span class="keyword">function</span>(<span class="params">gender</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.gender = gender</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Model.prototype.takephoto = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;<span class="built_in">this</span>.gender&#125;</span>穿着<span class="subst">$&#123;<span class="built_in">this</span>.underwear&#125;</span>`</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> modelFactory = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// 优化第一点</span></span><br><span class="line">  <span class="keyword">const</span> modelGender = &#123;&#125;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">createModel</span>: <span class="function"><span class="keyword">function</span>(<span class="params">gender</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (modelGender[gender]) &#123;</span><br><span class="line">        <span class="keyword">return</span> modelGender[gender]</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> modelGender[gender] = <span class="keyword">new</span> Model(gender)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;())</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> modelManager = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> modelObj = &#123;&#125;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">add</span>: <span class="function"><span class="keyword">function</span>(<span class="params">gender, i</span>) </span>&#123;</span><br><span class="line">      modelObj[i] = &#123;</span><br><span class="line">        <span class="attr">underwear</span>: <span class="string">`第<span class="subst">$&#123;i&#125;</span>款衣服`</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> modelFactory.createModel(gender)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">copy</span>: <span class="function"><span class="keyword">function</span>(<span class="params">model, i</span>) </span>&#123; <span class="comment">// 优化第二点</span></span><br><span class="line">      model.underwear = modelObj[i].underwear</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;())</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt; <span class="number">51</span>; i++) &#123;</span><br><span class="line">  <span class="keyword">const</span> maleModel = modelManager.add(<span class="string">&#x27;male&#x27;</span>, i)</span><br><span class="line">  modelManager.copy(maleModel, i)</span><br><span class="line">  maleModel.takephoto()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt; <span class="number">51</span>; i++) &#123;</span><br><span class="line">  <span class="keyword">const</span> femaleModel = modelManager.add(<span class="string">&#x27;female&#x27;</span>, i)</span><br><span class="line">  modelManager.copy(femaleModel, i)</span><br><span class="line">  femaleModel.takephoto()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<h2 id="10-职责链模式"><a href="#10-职责链模式" class="headerlink" title="10.职责链模式"></a><a name="职责链模式">10.职责链模式</a></h2><p>职责链模式：类似多米诺骨牌，通过请求第一个条件，会持续执行后续的条件，直到返回结果为止。<br><img src="https://camo.githubusercontent.com/cb2073f5e9c165843754e0b5984652c3291e88a6/687474703a2f2f6f71687473637573302e626b742e636c6f7564646e2e636f6d2f63626338633130626261653230326263643234336636623037303464653362612e6a70672d333030" alt="职责链模式"><br>重要性：4 星，在项目中能对 if-else 语句进行优化   </p>
<h3 id="场景-demo"><a href="#场景-demo" class="headerlink" title="场景 demo"></a>场景 demo</h3><p>场景：某电商针对已付过定金的用户有优惠政策，在正式购买后，已经支付过 500 元定金的用户会收到 100 元的优惠券，200 元定金的用户可以收到 50 元优惠券，没有支付过定金的用户只能正常购买。   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// orderType: 表示订单类型，1：500 元定金用户；2：200 元定金用户；3：普通购买用户</span></span><br><span class="line"><span class="comment">// pay：表示用户是否已经支付定金，true: 已支付；false：未支付</span></span><br><span class="line"><span class="comment">// stock: 表示当前用于普通购买的手机库存数量，已支付过定金的用户不受此限制</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> order = <span class="function"><span class="keyword">function</span>(<span class="params"> orderType, pay, stock </span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> ( orderType === <span class="number">1</span> ) &#123;</span><br><span class="line">    <span class="keyword">if</span> ( pay === <span class="literal">true</span> ) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;500 元定金预购，得到 100 元优惠券&#x27;</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (stock &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;普通购买，无优惠券&#x27;</span>)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;库存不够，无法购买&#x27;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> ( orderType === <span class="number">2</span> ) &#123;</span><br><span class="line">    <span class="keyword">if</span> ( pay === <span class="literal">true</span> ) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;200 元定金预购，得到 50 元优惠券&#x27;</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (stock &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;普通购买，无优惠券&#x27;</span>)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;库存不够，无法购买&#x27;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> ( orderType === <span class="number">3</span> ) &#123;</span><br><span class="line">    <span class="keyword">if</span> (stock &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;普通购买，无优惠券&#x27;</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;库存不够，无法购买&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">order( <span class="number">3</span>, <span class="literal">true</span>, <span class="number">500</span> ) <span class="comment">// 普通购买，无优惠券</span></span><br></pre></td></tr></table></figure>

<p>下面用职责链模式改造代码：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> order500 = <span class="function"><span class="keyword">function</span>(<span class="params">orderType, pay, stock</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> ( orderType === <span class="number">1</span> &amp;&amp; pay === <span class="literal">true</span> ) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;500 元定金预购，得到 100 元优惠券&#x27;</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    order200(orderType, pay, stock)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> order200 = <span class="function"><span class="keyword">function</span>(<span class="params">orderType, pay, stock</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> ( orderType === <span class="number">2</span> &amp;&amp; pay === <span class="literal">true</span> ) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;200 元定金预购，得到 50 元优惠券&#x27;</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    orderCommon(orderType, pay, stock)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> orderCommon = <span class="function"><span class="keyword">function</span>(<span class="params">orderType, pay, stock</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (orderType === <span class="number">3</span> &amp;&amp; stock &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;普通购买，无优惠券&#x27;</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;库存不够，无法购买&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">order500( <span class="number">3</span>, <span class="literal">true</span>, <span class="number">500</span> ) <span class="comment">// 普通购买，无优惠券</span></span><br></pre></td></tr></table></figure>

<p>改造后可以发现代码相对清晰了，但是链路代码和业务代码依然耦合在一起，进一步优化：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 业务代码</span></span><br><span class="line"><span class="keyword">const</span> order500 = <span class="function"><span class="keyword">function</span>(<span class="params">orderType, pay, stock</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> ( orderType === <span class="number">1</span> &amp;&amp; pay === <span class="literal">true</span> ) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;500 元定金预购，得到 100 元优惠券&#x27;</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;nextSuccess&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> order200 = <span class="function"><span class="keyword">function</span>(<span class="params">orderType, pay, stock</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> ( orderType === <span class="number">2</span> &amp;&amp; pay === <span class="literal">true</span> ) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;200 元定金预购，得到 50 元优惠券&#x27;</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;nextSuccess&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> orderCommon = <span class="function"><span class="keyword">function</span>(<span class="params">orderType, pay, stock</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (orderType === <span class="number">3</span> &amp;&amp; stock &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;普通购买，无优惠券&#x27;</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;库存不够，无法购买&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 链路代码</span></span><br><span class="line"><span class="keyword">const</span> chain = <span class="function"><span class="keyword">function</span>(<span class="params">fn</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.fn = fn</span><br><span class="line">  <span class="built_in">this</span>.sucessor = <span class="literal">null</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">chain.prototype.setNext = <span class="function"><span class="keyword">function</span>(<span class="params">sucessor</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.sucessor = sucessor</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">chain.prototype.init = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> result = <span class="built_in">this</span>.fn.apply(<span class="built_in">this</span>, <span class="built_in">arguments</span>)</span><br><span class="line">  <span class="keyword">if</span> (result === <span class="string">&#x27;nextSuccess&#x27;</span>) &#123;</span><br><span class="line">    <span class="built_in">this</span>.sucessor.init.apply(<span class="built_in">this</span>.sucessor, <span class="built_in">arguments</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> order500New = <span class="keyword">new</span> chain(order500)</span><br><span class="line"><span class="keyword">const</span> order200New = <span class="keyword">new</span> chain(order200)</span><br><span class="line"><span class="keyword">const</span> orderCommonNew = <span class="keyword">new</span> chain(orderCommon)</span><br><span class="line"></span><br><span class="line">order500New.setNext(order200New)</span><br><span class="line">order200New.setNext(orderCommonNew)</span><br><span class="line"></span><br><span class="line">order500New.init( <span class="number">3</span>, <span class="literal">true</span>, <span class="number">500</span> ) <span class="comment">// 普通购买，无优惠券</span></span><br></pre></td></tr></table></figure>

<p>重构后，链路代码和业务代码彻底地分离。假如未来需要新增 order300，那只需新增与其相关的函数而不必改动原有业务代码。<br>另外结合 AOP 还能简化上述链路代码：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 业务代码</span></span><br><span class="line"><span class="keyword">const</span> order500 = <span class="function"><span class="keyword">function</span>(<span class="params">orderType, pay, stock</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> ( orderType === <span class="number">1</span> &amp;&amp; pay === <span class="literal">true</span> ) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;500 元定金预购，得到 100 元优惠券&#x27;</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;nextSuccess&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> order200 = <span class="function"><span class="keyword">function</span>(<span class="params">orderType, pay, stock</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> ( orderType === <span class="number">2</span> &amp;&amp; pay === <span class="literal">true</span> ) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;200 元定金预购，得到 50 元优惠券&#x27;</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;nextSuccess&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> orderCommon = <span class="function"><span class="keyword">function</span>(<span class="params">orderType, pay, stock</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (orderType === <span class="number">3</span> &amp;&amp; stock &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;普通购买，无优惠券&#x27;</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;库存不够，无法购买&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 链路代码</span></span><br><span class="line"><span class="built_in">Function</span>.prototype.after = <span class="function"><span class="keyword">function</span>(<span class="params">fn</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> self = <span class="built_in">this</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> result = self.apply(self, <span class="built_in">arguments</span>)</span><br><span class="line">    <span class="keyword">if</span> (result === <span class="string">&#x27;nextSuccess&#x27;</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> fn.apply(self, <span class="built_in">arguments</span>) <span class="comment">// 这里 return 别忘记了~</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> order = order500.after(order200).after(orderCommon)</span><br><span class="line"></span><br><span class="line">order( <span class="number">3</span>, <span class="literal">true</span>, <span class="number">500</span> ) <span class="comment">// 普通购买，无优惠券</span></span><br></pre></td></tr></table></figure>
<p>职责链模式比较重要，项目中能用到它的地方会有很多，用上它能解耦 1 个请求对象和 n 个目标对象的关系。   </p>
<hr>
<h2 id="11-中介者模式"><a href="#11-中介者模式" class="headerlink" title="11.中介者模式"></a><a name="中介者模式">11.中介者模式</a></h2><p>中介者模式：对象和对象之间借助第三方中介者进行通信。<br><img src="https://camo.githubusercontent.com/8411d6ad7b3c4e4f4fa3a14115f33428f5e4ab0f/687474703a2f2f6f71687473637573302e626b742e636c6f7564646e2e636f6d2f61653039353866383539393039373863343862336136616132636137366561312e6a70672d343030" alt="中介者模式">  </p>
<h3 id="场景-demo-1"><a href="#场景-demo-1" class="headerlink" title="场景 demo"></a>场景 demo</h3><p>一场测试结束后，公布结果：告知解答出题目的人挑战成功，否则挑战失败。    </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> player = <span class="function"><span class="keyword">function</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.name = name</span><br><span class="line">  playerMiddle.add(name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">player.prototype.win = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  playerMiddle.win(<span class="built_in">this</span>.name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">player.prototype.lose = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  playerMiddle.lose(<span class="built_in">this</span>.name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> playerMiddle = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// 将就用下这个 demo，这个函数当成中介者</span></span><br><span class="line">  <span class="keyword">const</span> players = []</span><br><span class="line">  <span class="keyword">const</span> winArr = []</span><br><span class="line">  <span class="keyword">const</span> loseArr = []</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">add</span>: <span class="function"><span class="keyword">function</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">      players.push(name)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">win</span>: <span class="function"><span class="keyword">function</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">      winArr.push(name)</span><br><span class="line">      <span class="keyword">if</span> (winArr.length + loseArr.length === players.length) &#123;</span><br><span class="line">        <span class="built_in">this</span>.show()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">lose</span>: <span class="function"><span class="keyword">function</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">      loseArr.push(name)</span><br><span class="line">      <span class="keyword">if</span> (winArr.length + loseArr.length === players.length) &#123;</span><br><span class="line">        <span class="built_in">this</span>.show()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">show</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> winner <span class="keyword">of</span> winArr) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(winner + <span class="string">&#x27;挑战成功;&#x27;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> loser <span class="keyword">of</span> loseArr) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(loser + <span class="string">&#x27;挑战失败;&#x27;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;())</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> a = <span class="keyword">new</span> player(<span class="string">&#x27;A 选手&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> b = <span class="keyword">new</span> player(<span class="string">&#x27;B 选手&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> c = <span class="keyword">new</span> player(<span class="string">&#x27;C 选手&#x27;</span>)</span><br><span class="line"></span><br><span class="line">a.win()</span><br><span class="line">b.win()</span><br><span class="line">c.lose()</span><br><span class="line"></span><br><span class="line"><span class="comment">// A 选手挑战成功;</span></span><br><span class="line"><span class="comment">// B 选手挑战成功;</span></span><br><span class="line"><span class="comment">// C 选手挑战失败;</span></span><br></pre></td></tr></table></figure>
<p>在这段代码中 A、B、C 之间没有直接发生关系，而是通过另外的 playerMiddle 对象建立链接，姑且将之当成是中介者模式了。  </p>
<hr>
<h2 id="12-装饰者模式"><a href="#12-装饰者模式" class="headerlink" title="12.装饰者模式"></a><a name="装饰者模式">12.装饰者模式</a></h2><p>装饰器模式：动态地给函数赋能。  </p>
<h3 id="JavaScript-的装饰者模式"><a href="#JavaScript-的装饰者模式" class="headerlink" title="JavaScript 的装饰者模式"></a>JavaScript 的装饰者模式</h3><p>生活中的例子：天气冷了，就添加衣服来保暖；天气热了，就将外套脱下；这个例子很形象地含盖了装饰器的神韵，随着天气的冷暖变化，衣服可以动态的穿上脱下。  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> wear = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;穿上第一件衣服&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> _wear1 = wear</span><br><span class="line"></span><br><span class="line">wear = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  _wear1()</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;穿上第二件衣服&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> _wear2 = wear</span><br><span class="line"></span><br><span class="line">wear = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  _wear2()</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;穿上第三件衣服&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">wear()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 穿上第一件衣服</span></span><br><span class="line"><span class="comment">// 穿上第二件衣服</span></span><br><span class="line"><span class="comment">// 穿上第三件衣服</span></span><br></pre></td></tr></table></figure>

<p>这种方式有以下缺点：1：临时变量会变得越来越多；2：this 指向有时会出错  </p>
<h3 id="AOP-装饰函数"><a href="#AOP-装饰函数" class="headerlink" title="AOP 装饰函数"></a>AOP 装饰函数</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 前置代码</span></span><br><span class="line"><span class="built_in">Function</span>.prototype.before = <span class="function"><span class="keyword">function</span>(<span class="params">fn</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> self = <span class="built_in">this</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    fn.apply(<span class="built_in">this</span>, <span class="built_in">arguments</span>)</span><br><span class="line">    <span class="keyword">return</span> self.apply(<span class="built_in">this</span>, <span class="built_in">arguments</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 后置代码</span></span><br><span class="line"><span class="built_in">Function</span>.prototype.after = <span class="function"><span class="keyword">function</span>(<span class="params">fn</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> self = <span class="built_in">this</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    self.apply(<span class="built_in">this</span>, <span class="built_in">arguments</span>)</span><br><span class="line">    <span class="keyword">return</span> fn.apply(<span class="built_in">this</span>, <span class="built_in">arguments</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>用后置代码来实验下上面穿衣服的 demo，  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> wear1 = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;穿上第一件衣服&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> wear2 = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;穿上第二件衣服&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> wear3 = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;穿上第三件衣服&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> wear = wear1.after(wear2).after(wear3)</span><br><span class="line">wear()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 穿上第一件衣服</span></span><br><span class="line"><span class="comment">// 穿上第二件衣服</span></span><br><span class="line"><span class="comment">// 穿上第三件衣服</span></span><br></pre></td></tr></table></figure>

<p>但这样子有时会污染原生函数，可以做点通变  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> after = <span class="function"><span class="keyword">function</span>(<span class="params">fn, afterFn</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    fn.apply(<span class="built_in">this</span>, <span class="built_in">arguments</span>)</span><br><span class="line">    afterFn.apply(<span class="built_in">this</span>, <span class="built_in">arguments</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> wear = after(after(wear1, wear2), wear3)</span><br><span class="line">wear()</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="13-状态模式"><a href="#13-状态模式" class="headerlink" title="13.状态模式"></a><a name="状态模式">13.状态模式</a></h2><p>状态模式：将事物内部的每个状态分别封装成类，内部状态改变会产生不同行为。  </p>
<p>优点：用对象代替字符串记录当前状态，状态易维护<br>缺点：需编写大量状态类对象  </p>
<h3 id="场景-demo-2"><a href="#场景-demo-2" class="headerlink" title="场景 demo"></a>场景 demo</h3><p>某某牌电灯，按一下按钮打开弱光，按两下按钮打开强光，按三下按钮关闭灯光。  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 将状态封装成不同类</span></span><br><span class="line"><span class="keyword">const</span> weakLight = <span class="function"><span class="keyword">function</span>(<span class="params">light</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.light = light</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">weakLight.prototype.press = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;打开强光&#x27;</span>)</span><br><span class="line">  <span class="built_in">this</span>.light.setState(<span class="built_in">this</span>.light.strongLight)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> strongLight = <span class="function"><span class="keyword">function</span>(<span class="params">light</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.light = light</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">strongLight.prototype.press = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;关灯&#x27;</span>)</span><br><span class="line">  <span class="built_in">this</span>.light.setState(<span class="built_in">this</span>.light.offLight)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> offLight = <span class="function"><span class="keyword">function</span>(<span class="params">light</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.light = light</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">offLight.prototype.press = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;打开弱光&#x27;</span>)</span><br><span class="line">  <span class="built_in">this</span>.light.setState(<span class="built_in">this</span>.light.weakLight)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Light = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.weakLight = <span class="keyword">new</span> weakLight(<span class="built_in">this</span>)</span><br><span class="line">  <span class="built_in">this</span>.strongLight = <span class="keyword">new</span> strongLight(<span class="built_in">this</span>)</span><br><span class="line">  <span class="built_in">this</span>.offLight = <span class="keyword">new</span> offLight(<span class="built_in">this</span>)</span><br><span class="line">  <span class="built_in">this</span>.currentState = <span class="built_in">this</span>.offLight          <span class="comment">// 初始状态</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Light.prototype.init = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> btn = <span class="built_in">document</span>.createElement(<span class="string">&#x27;button&#x27;</span>)</span><br><span class="line">  btn.innerHTML = <span class="string">&#x27;按钮&#x27;</span></span><br><span class="line">  <span class="built_in">document</span>.body.append(btn)</span><br><span class="line">  <span class="keyword">const</span> self = <span class="built_in">this</span></span><br><span class="line">  btn.addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    self.currentState.press()</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Light.prototype.setState = <span class="function"><span class="keyword">function</span>(<span class="params">state</span>) </span>&#123; <span class="comment">// 改变当前状态</span></span><br><span class="line">  <span class="built_in">this</span>.currentState = state</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> light = <span class="keyword">new</span> Light()</span><br><span class="line">light.init()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 打开弱光</span></span><br><span class="line"><span class="comment">// 打开强光</span></span><br><span class="line"><span class="comment">// 关灯</span></span><br></pre></td></tr></table></figure>

<h3 id="非面向对象实现的状态模式"><a href="#非面向对象实现的状态模式" class="headerlink" title="非面向对象实现的状态模式"></a>非面向对象实现的状态模式</h3><p>借助于 JavaScript 的委托机制，可以像如下实现状态模式：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  <span class="string">&#x27;weakLight&#x27;</span>: &#123;</span><br><span class="line">    <span class="attr">press</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;打开强光&#x27;</span>)</span><br><span class="line">      <span class="built_in">this</span>.currentState = obj.strongLight</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&#x27;strongLight&#x27;</span>: &#123;</span><br><span class="line">    <span class="attr">press</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;关灯&#x27;</span>)</span><br><span class="line">      <span class="built_in">this</span>.currentState = obj.offLight</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&#x27;offLight&#x27;</span>: &#123;</span><br><span class="line">    <span class="attr">press</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;打开弱光&#x27;</span>)</span><br><span class="line">      <span class="built_in">this</span>.currentState = obj.weakLight</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Light = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.currentState = obj.offLight</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Light.prototype.init = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> btn = <span class="built_in">document</span>.createElement(<span class="string">&#x27;button&#x27;</span>)</span><br><span class="line">  btn.innerHTML = <span class="string">&#x27;按钮&#x27;</span></span><br><span class="line">  <span class="built_in">document</span>.body.append(btn)</span><br><span class="line">  <span class="keyword">const</span> self = <span class="built_in">this</span></span><br><span class="line">  btn.addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    self.currentState.press.call(self) <span class="comment">// 通过 call 完成委托</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> light = <span class="keyword">new</span> Light()</span><br><span class="line">light.init()</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="14-适配者模式"><a href="#14-适配者模式" class="headerlink" title="14.适配者模式"></a><a name="适配者模式">14.适配者模式</a></h2><p>适配者模式：主要用于解决两个接口之间不匹配的问题。  </p>
<h3 id="demo-1"><a href="#demo-1" class="headerlink" title="demo"></a>demo</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 老接口</span></span><br><span class="line"><span class="keyword">const</span> zhejiangCityOld = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;hangzhou&#x27;</span>,</span><br><span class="line">      <span class="attr">id</span>: <span class="number">11</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;jinhua&#x27;</span>,</span><br><span class="line">      <span class="attr">id</span>: <span class="number">12</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;())</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(getZhejiangCityOld())</span><br><span class="line"></span><br><span class="line"><span class="comment">// 新接口希望是下面形式</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">hangzhou</span>: <span class="number">11</span>,</span><br><span class="line">  <span class="attr">jinhua</span>: <span class="number">12</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 这时候就可采用适配者模式</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">const</span> adaptor = (<span class="function"><span class="keyword">function</span>(<span class="params">oldCity</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> obj = &#123;&#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> city <span class="keyword">of</span> zhejiangCityOld) &#123;</span><br><span class="line">    obj[city.name] = city.id</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> obj</span><br><span class="line">&#125;())</span><br></pre></td></tr></table></figure>


<blockquote>
<p>原文地址 <a target="_blank" rel="noopener" href="https://juejin.im/post/5afe6430518825428630bc4d">JavaScript 中常见设计模式整理</a></p>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/05/18/63-%E3%80%90JavaScript%E3%80%91JavaScript%E4%B8%AD%E5%B8%B8%E8%A7%81%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" data-id="ckts3ejzs00r64d9kg34i2yds" data-title="63-【JavaScript】JavaScript中常见设计模式" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/" rel="tag">JavaScript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" rel="tag">前端开发</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-62-【CSS】CSS美化单选框复选框和开关按钮" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/05/17/62-%E3%80%90CSS%E3%80%91CSS%E7%BE%8E%E5%8C%96%E5%8D%95%E9%80%89%E6%A1%86%E5%A4%8D%E9%80%89%E6%A1%86%E5%92%8C%E5%BC%80%E5%85%B3%E6%8C%89%E9%92%AE/" class="article-date">
  <time class="dt-published" datetime="2018-05-17T15:37:03.000Z" itemprop="datePublished">2018-05-17</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/05/17/62-%E3%80%90CSS%E3%80%91CSS%E7%BE%8E%E5%8C%96%E5%8D%95%E9%80%89%E6%A1%86%E5%A4%8D%E9%80%89%E6%A1%86%E5%92%8C%E5%BC%80%E5%85%B3%E6%8C%89%E9%92%AE/">62-【CSS】CSS美化单选框复选框和开关按钮</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <hr>
<table>
<thead>
<tr>
<th>Author</th>
<th>王平安</th>
</tr>
</thead>
<tbody><tr>
<td>E-mail</td>
<td><a href="mailto:&#x70;&#105;&#110;&#103;&#97;&#110;&#x38;&#55;&#x38;&#55;&#64;&#x71;&#x71;&#x2e;&#99;&#111;&#x6d;">&#x70;&#105;&#110;&#103;&#97;&#110;&#x38;&#55;&#x38;&#55;&#64;&#x71;&#x71;&#x2e;&#99;&#111;&#x6d;</a></td>
</tr>
<tr>
<td>博  客</td>
<td><a target="_blank" rel="noopener" href="http://www.pingan8787.com/">www.pingan8787.com</a></td>
</tr>
<tr>
<td>微  信</td>
<td>pingan8787</td>
</tr>
<tr>
<td>每日文章</td>
<td><a target="_blank" rel="noopener" href="https://0x9.me/KMrv3">https://0x9.me/KMrv3</a></td>
</tr>
</tbody></table>
<hr>
<p><img src="http://images.pingan8787.com/1.png" alt="美化 radio"></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--有简单的背景动画：--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;bui-radios-label bui-radios-anim&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sex&quot;</span>/&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;bui-radios&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> 男</span><br><span class="line"><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;bui-radios-label bui-radios-anim&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">checked</span>=<span class="string">&quot;&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sex&quot;</span>/&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;bui-radios&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> 女</span><br><span class="line"><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--无动画：--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;bui-radios-label&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sex&quot;</span>/&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;bui-radios&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> 男</span><br><span class="line"><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;bui-radios-label&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sex&quot;</span>/&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;bui-radios&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> 女</span><br><span class="line"><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--禁用状态（disabled）：--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;bui-radios-label&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">disabled</span>=<span class="string">&quot;&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sex&quot;</span>/&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;bui-radios&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> 不男不女</span><br><span class="line"><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;bui-radios-label&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">checked</span>=<span class="string">&quot;&quot;</span> <span class="attr">disabled</span>=<span class="string">&quot;&quot;</span> <span class="attr">name</span>=<span class="string">&quot;ddd&quot;</span>/&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;bui-radios&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> 不男不女</span><br><span class="line"><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="http://images.pingan8787.com/2.png" alt="美化 checkbox"></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--有简单的背景动画：--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;bui-checkbox-label  bui-checkbox-anim&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">checked</span>=<span class="string">&quot;&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sex&quot;</span>/&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;bui-checkbox&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> 男</span><br><span class="line"><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;bui-checkbox-label  bui-checkbox-anim&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sex&quot;</span>/&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;bui-checkbox&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> 女</span><br><span class="line"><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--无动画：--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;bui-checkbox-label&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">checked</span>=<span class="string">&quot;&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sex&quot;</span>/&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;bui-checkbox&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> 男</span><br><span class="line"><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;bui-checkbox-label&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sex&quot;</span>/&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;bui-checkbox&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> 女</span><br><span class="line"><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--禁用状态（disabled）：--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;bui-checkbox-label&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">disabled</span>=<span class="string">&quot;&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sex&quot;</span>/&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;bui-checkbox&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> 不男不女</span><br><span class="line"><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;bui-checkbox-label&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">checked</span>=<span class="string">&quot;&quot;</span> <span class="attr">disabled</span>=<span class="string">&quot;&quot;</span> <span class="attr">name</span>=<span class="string">&quot;ddd&quot;</span>/&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;bui-checkbox&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> 不男不女</span><br><span class="line"><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="http://images.pingan8787.com/3.png" alt="用 checkbox 模拟 switch"></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--简单的过渡动画：--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;bui-switch-label bui-switch-anim&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;s&quot;</span>/&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;bui-switch&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;bui-switch-label bui-switch-anim&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">checked</span>=<span class="string">&quot;&quot;</span> <span class="attr">name</span>=<span class="string">&quot;s&quot;</span>/&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;bui-switch&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--简单的背景动画：--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;bui-switch-label bui-switch-animbg&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;s&quot;</span>/&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;bui-switch&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;bui-switch-label bui-switch-animbg&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">checked</span>=<span class="string">&quot;&quot;</span> <span class="attr">name</span>=<span class="string">&quot;s&quot;</span>/&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;bui-switch&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--无动画：--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;bui-switch-label &quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;s&quot;</span>/&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;bui-switch&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;bui-switch-label &quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">checked</span>=<span class="string">&quot;&quot;</span> <span class="attr">name</span>=<span class="string">&quot;s&quot;</span>/&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;bui-switch&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--禁用状态（disabled）：--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;bui-switch-label&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">disabled</span>=<span class="string">&quot;&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sex&quot;</span>/&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;bui-switch&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> 不男不女</span><br><span class="line"><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;bui-switch-label&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">checked</span>=<span class="string">&quot;&quot;</span> <span class="attr">disabled</span>=<span class="string">&quot;&quot;</span> <span class="attr">name</span>=<span class="string">&quot;ddd&quot;</span>/&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;bui-switch&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> 不男不女</span><br><span class="line"><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="SCSS代码"><a href="#SCSS代码" class="headerlink" title="SCSS代码"></a>SCSS代码</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* radio */</span></span><br><span class="line"><span class="selector-tag">label</span><span class="selector-class">.bui-radios-label</span> &#123;</span><br><span class="line">  <span class="selector-tag">input</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">visibility</span>: hidden;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.bui-radios</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">13px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">13px</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#FFFFFF</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#979797</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">vertical-align</span>: -<span class="number">2px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">input</span><span class="selector-pseudo">:checked</span> + <span class="selector-class">.bui-radios</span>:after &#123;</span><br><span class="line">    position: absolute;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">7px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">7px</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#fff</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">3px</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">3px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">input</span><span class="selector-pseudo">:checked</span> + <span class="selector-class">.bui-radios</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#00B066</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#00B066</span>;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">input</span><span class="selector-pseudo">:disabled</span> + <span class="selector-class">.bui-radios</span> &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#e8e8e8</span>;</span><br><span class="line">    <span class="attribute">border</span>: solid <span class="number">1px</span> <span class="number">#979797</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">input</span><span class="selector-pseudo">:disabled</span><span class="selector-pseudo">:checked</span> + <span class="selector-class">.bui-radios</span>:after &#123;</span><br><span class="line">    background-color: <span class="number">#c1c1c1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  &amp;<span class="selector-class">.bui-radios-anim</span> <span class="selector-class">.bui-radios</span> &#123;</span><br><span class="line">    -webkit-<span class="attribute">transition</span>: background-color ease-out .<span class="number">3s</span>;</span><br><span class="line">    <span class="attribute">transition</span>: background-color ease-out .<span class="number">3s</span>;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/* checkbox */</span></span><br><span class="line"><span class="selector-tag">label</span><span class="selector-class">.bui-checkbox-label</span> &#123;</span><br><span class="line">  <span class="selector-tag">input</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">visibility</span>: hidden;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.bui-checkbox</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">13px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">13px</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#FFFFFF</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#979797</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">2px</span>;</span><br><span class="line">    <span class="attribute">vertical-align</span>: -<span class="number">2px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">input</span><span class="selector-pseudo">:checked</span> + <span class="selector-class">.bui-checkbox</span>:after &#123;</span><br><span class="line">    color: <span class="number">#FFFFFF</span>;</span><br><span class="line">    <span class="attribute">font-family</span>: iconfont;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&quot;\e600&quot;</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">13px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">13px</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">13px</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">13px</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">1px</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">input</span><span class="selector-pseudo">:checked</span> + <span class="selector-class">.bui-checkbox</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#00B066</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#00B066</span>;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">input</span><span class="selector-pseudo">:disabled</span> + <span class="selector-class">.bui-checkbox</span> &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#e8e8e8</span>;</span><br><span class="line">    <span class="attribute">border</span>: solid <span class="number">1px</span> <span class="number">#979797</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">input</span><span class="selector-pseudo">:disabled</span><span class="selector-pseudo">:checked</span> + <span class="selector-class">.bui-checkbox</span>:after &#123;</span><br><span class="line">    color: <span class="number">#c1c1c1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  &amp;<span class="selector-class">.bui-checkbox-anim</span> <span class="selector-class">.bui-checkbox</span> &#123;</span><br><span class="line">    -webkit-<span class="attribute">transition</span>: background-color ease-out .<span class="number">3s</span>;</span><br><span class="line">    <span class="attribute">transition</span>: background-color ease-out .<span class="number">3s</span>;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@mixin</span> borderRadius($<span class="attribute">radius</span>:<span class="number">20px</span>) &#123;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">border-radius</span>: $radius;</span><br><span class="line">  <span class="attribute">border-top-left-radius</span>: $radius;</span><br><span class="line">  <span class="attribute">border-top-right-radius</span>: $radius;</span><br><span class="line">  <span class="attribute">border-bottom-left-radius</span>: $radius;</span><br><span class="line">  <span class="attribute">border-bottom-right-radius</span>: $radius;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$duration: .<span class="number">4s</span>;</span><br><span class="line">$checkedColor: <span class="number">#64bd63</span>;</span><br><span class="line"><span class="selector-tag">label</span><span class="selector-class">.bui-switch-label</span> &#123;</span><br><span class="line">  <span class="selector-tag">input</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">visibility</span>: hidden;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">input</span><span class="selector-pseudo">:checked</span> &#123;</span><br><span class="line">    <span class="attribute">border-color</span>: $checkedColor;</span><br><span class="line">    <span class="attribute">box-shadow</span>: $checkedColor <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">16px</span> inset;</span><br><span class="line">    <span class="attribute">background-color</span>: $checkedColor;</span><br><span class="line">    &amp;:before &#123;</span><br><span class="line">      left: <span class="number">27px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">input</span><span class="selector-pseudo">:disabled</span> + <span class="selector-class">.bui-switch</span> &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#e8e8e8</span>;</span><br><span class="line">    <span class="attribute">border</span>: solid <span class="number">1px</span> <span class="number">#dfdfdf</span>;</span><br><span class="line">    &amp;:before &#123;</span><br><span class="line">      background-color: <span class="number">#c1c1c1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">input</span><span class="selector-pseudo">:disabled</span><span class="selector-pseudo">:checked</span> + <span class="selector-class">.bui-switch</span> &#123;</span><br><span class="line">      <span class="attribute">background-color</span>: <span class="number">#e8e8e8</span>;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">#e8e8e8</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">16px</span> inset;</span><br><span class="line">      <span class="attribute">border</span>: solid <span class="number">1px</span> <span class="number">#dfdfdf</span>;</span><br><span class="line">      &amp;:before &#123;</span><br><span class="line">        background-color: <span class="number">#c1c1c1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="selector-class">.bui-switch</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">50px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">25px</span>;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#dfdfdf</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#fdfdfd</span>;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">#dfdfdf</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> inset;</span><br><span class="line">    <span class="keyword">@include</span> borderRadius();</span><br><span class="line">    <span class="attribute">background-clip</span>: content-box;</span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">    -webkit-appearance: none;</span><br><span class="line">    -webkit-user-select: none;</span><br><span class="line">    -moz-user-select: none;</span><br><span class="line">    -ms-user-select: none;</span><br><span class="line">    user-select: none;</span><br><span class="line">    <span class="attribute">outline</span>: none;</span><br><span class="line">    &amp;:before &#123;</span><br><span class="line">      content: <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">      <span class="attribute">width</span>: <span class="number">23px</span>;</span><br><span class="line">      <span class="attribute">height</span>: <span class="number">23px</span>;</span><br><span class="line">      <span class="attribute">position</span>: absolute;</span><br><span class="line">      <span class="attribute">top</span>: <span class="number">1px</span>;</span><br><span class="line">      <span class="attribute">left</span>: <span class="number">1px</span>;</span><br><span class="line">      <span class="keyword">@include</span> borderRadius();</span><br><span class="line">      <span class="attribute">background-color</span>: <span class="number">#fff</span>;</span><br><span class="line">      <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">1px</span> <span class="number">3px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.4</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">input</span><span class="selector-pseudo">:checked</span> + <span class="selector-class">.bui-switch</span> &#123;</span><br><span class="line">    <span class="attribute">border-color</span>: $checkedColor;</span><br><span class="line">    <span class="attribute">box-shadow</span>: $checkedColor <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">16px</span> inset;</span><br><span class="line">    <span class="attribute">background-color</span>: $checkedColor;</span><br><span class="line">    &amp;:before &#123;</span><br><span class="line">      left: <span class="number">27px</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">  &amp;<span class="selector-class">.bui-switch-anim</span> &#123;</span><br><span class="line">    -webkit-<span class="attribute">transition</span>: border <span class="built_in">cubic-bezier</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>) $duration, box-shadow <span class="built_in">cubic-bezier</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>) $duration;</span><br><span class="line">    <span class="attribute">transition</span>: border <span class="built_in">cubic-bezier</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>) $duration, box-shadow <span class="built_in">cubic-bezier</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>) $duration;</span><br><span class="line">    <span class="selector-class">.bui-switch</span>:before &#123;</span><br><span class="line">      -webkit-transition: left <span class="number">0.3s</span>;</span><br><span class="line">      <span class="attribute">transition</span>: left <span class="number">0.3s</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-tag">input</span><span class="selector-pseudo">:checked</span> + <span class="selector-class">.bui-switch</span> &#123;</span><br><span class="line">      <span class="attribute">box-shadow</span>: $checkedColor <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">16px</span> inset;</span><br><span class="line">      <span class="attribute">background-color</span>: $checkedColor;</span><br><span class="line">      -webkit-<span class="attribute">transition</span>: border ease $duration, box-shadow ease $duration, background-color ease $duration*<span class="number">3</span>;</span><br><span class="line">      <span class="attribute">transition</span>: border ease $duration, box-shadow ease $duration, background-color ease $duration*<span class="number">3</span>;</span><br><span class="line">      &amp;:before &#123;</span><br><span class="line">        -webkit-transition: left <span class="number">0.3s</span>;</span><br><span class="line">        <span class="attribute">transition</span>: left <span class="number">0.3s</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  &amp;<span class="selector-class">.bui-switch-animbg</span> &#123;</span><br><span class="line">    -webkit-<span class="attribute">transition</span>: background-color ease $duration;</span><br><span class="line">    <span class="attribute">transition</span>: background-color ease $duration;</span><br><span class="line">    <span class="selector-class">.bui-switch</span>:before &#123;</span><br><span class="line">      -webkit-transition: left <span class="number">0.3s</span>;</span><br><span class="line">      <span class="attribute">transition</span>: left <span class="number">0.3s</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-tag">input</span><span class="selector-pseudo">:checked</span> + <span class="selector-class">.bui-switch</span> &#123;</span><br><span class="line">      <span class="attribute">box-shadow</span>: <span class="number">#dfdfdf</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> inset;</span><br><span class="line">      <span class="attribute">background-color</span>: $checkedColor;</span><br><span class="line">      -webkit-<span class="attribute">transition</span>: border-color $duration, background-color ease $duration;</span><br><span class="line">      <span class="attribute">transition</span>: border-color $duration, background-color ease $duration;</span><br><span class="line">      &amp;:before &#123;</span><br><span class="line">        -webkit-transition: left <span class="number">0.3s</span>;</span><br><span class="line">        <span class="attribute">transition</span>: left <span class="number">0.3s</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>参考文章 <a target="_blank" rel="noopener" href="http://www.css88.com/archives/9274">用CSS3美化单选框 radio 、多选框 checkbox 和 switch开关按钮</a></p>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/05/17/62-%E3%80%90CSS%E3%80%91CSS%E7%BE%8E%E5%8C%96%E5%8D%95%E9%80%89%E6%A1%86%E5%A4%8D%E9%80%89%E6%A1%86%E5%92%8C%E5%BC%80%E5%85%B3%E6%8C%89%E9%92%AE/" data-id="ckts3ejvk009e4d9kej5w244t" data-title="62-【CSS】CSS美化单选框复选框和开关按钮" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CSS/" rel="tag">CSS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" rel="tag">前端开发</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-61-【CSS】实现背景透明但文字不透明且兼容所有浏览器" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/05/16/61-%E3%80%90CSS%E3%80%91%E5%AE%9E%E7%8E%B0%E8%83%8C%E6%99%AF%E9%80%8F%E6%98%8E%E4%BD%86%E6%96%87%E5%AD%97%E4%B8%8D%E9%80%8F%E6%98%8E%E4%B8%94%E5%85%BC%E5%AE%B9%E6%89%80%E6%9C%89%E6%B5%8F%E8%A7%88%E5%99%A8/" class="article-date">
  <time class="dt-published" datetime="2018-05-16T14:18:40.000Z" itemprop="datePublished">2018-05-16</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/05/16/61-%E3%80%90CSS%E3%80%91%E5%AE%9E%E7%8E%B0%E8%83%8C%E6%99%AF%E9%80%8F%E6%98%8E%E4%BD%86%E6%96%87%E5%AD%97%E4%B8%8D%E9%80%8F%E6%98%8E%E4%B8%94%E5%85%BC%E5%AE%B9%E6%89%80%E6%9C%89%E6%B5%8F%E8%A7%88%E5%99%A8/">61-【CSS】实现背景透明但文字不透明且兼容所有浏览器</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <hr>
<table>
<thead>
<tr>
<th>Author</th>
<th>王平安</th>
</tr>
</thead>
<tbody><tr>
<td>E-mail</td>
<td><a href="mailto:&#x70;&#x69;&#x6e;&#x67;&#97;&#x6e;&#56;&#x37;&#x38;&#55;&#x40;&#x71;&#113;&#46;&#99;&#111;&#x6d;">&#x70;&#x69;&#x6e;&#x67;&#97;&#x6e;&#56;&#x37;&#x38;&#55;&#x40;&#x71;&#113;&#46;&#99;&#111;&#x6d;</a></td>
</tr>
<tr>
<td>博  客</td>
<td><a target="_blank" rel="noopener" href="http://www.pingan8787.com/">www.pingan8787.com</a></td>
</tr>
<tr>
<td>微  信</td>
<td>pingan8787</td>
</tr>
<tr>
<td>每日文章</td>
<td><a target="_blank" rel="noopener" href="https://0x9.me/KMrv3">https://0x9.me/KMrv3</a></td>
</tr>
</tbody></table>
<hr>
<h3 id="demo1"><a href="#demo1" class="headerlink" title="demo1"></a>demo1</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>背景透明，文字不透明<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">*&#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">padding</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">margin</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css"><span class="selector-tag">body</span>&#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">padding</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">background</span>: <span class="built_in">url</span>(<span class="string">img/bg.png</span>) <span class="number">0</span> <span class="number">0</span> repeat;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css"><span class="selector-class">.demo</span>&#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">padding</span>: <span class="number">25px</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0.5</span>);<span class="comment">/* IE9、标准浏览器、IE6和部分IE7内核的浏览器(如QQ浏览器)会读懂 */</span></span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"><span class="selector-class">.demo</span> <span class="selector-tag">p</span>&#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">color</span>: <span class="number">#FFFFFF</span>;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"><span class="keyword">@media</span> \<span class="number">0s</span>creen\,screen\<span class="number">9</span> &#123;<span class="comment">/* 只支持IE6、7、8 */</span></span></span><br><span class="line"><span class="css">  <span class="selector-class">.demo</span>&#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">background-color</span>:<span class="number">#000000</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">filter</span>:<span class="built_in">Alpha</span>(opacity=<span class="number">50</span>);</span></span><br><span class="line"><span class="css">    <span class="attribute">position</span>:static; <span class="comment">/* IE6、7、8只能设置position:static(默认属性) ，否则会导致子元素继承Alpha值 */</span></span></span><br><span class="line"><span class="css">    *zoom:<span class="number">1</span>; <span class="comment">/* 激活IE6、7的haslayout属性，让它读懂Alpha */</span></span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css">  <span class="selector-class">.demo</span> <span class="selector-tag">p</span>&#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">position</span>: relative;<span class="comment">/* 设置子元素为相对定位，可让子元素不继承Alpha值 */</span></span></span><br><span class="line"><span class="css">  &#125;  </span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span>    </span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;demo&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>背景透明，文字不透明<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="demo2"><a href="#demo2" class="headerlink" title="demo2"></a>demo2</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>opacity<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">*&#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">padding</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">margin</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"><span class="selector-tag">body</span>&#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">padding</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">background</span>: <span class="built_in">url</span>(<span class="string">http://static.cnblogs.com/images/logo_small.gif</span>) <span class="number">0</span> <span class="number">0</span> repeat;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"> </span></span><br><span class="line"><span class="css"><span class="selector-class">.demo</span>&#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">width</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">height</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"><span class="selector-class">.demo-bg</span>&#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="css">    <span class="attribute">left</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">top</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">z-index</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">width</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">height</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">background-color</span>:<span class="number">#000000</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">filter</span>:<span class="built_in">Alpha</span>(opacity=<span class="number">50</span>);</span></span><br><span class="line"><span class="css">    <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0.5</span>);</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"><span class="selector-class">.demo-txt</span>&#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="css">    <span class="attribute">z-index</span>: <span class="number">1</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">color</span>: <span class="number">#FFFFFF</span>;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span>   </span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;demo&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;demo-bg&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!-- 透明背景 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;demo-txt&quot;</span>&gt;</span>测测<span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!-- 不透明文字 --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/05/16/61-%E3%80%90CSS%E3%80%91%E5%AE%9E%E7%8E%B0%E8%83%8C%E6%99%AF%E9%80%8F%E6%98%8E%E4%BD%86%E6%96%87%E5%AD%97%E4%B8%8D%E9%80%8F%E6%98%8E%E4%B8%94%E5%85%BC%E5%AE%B9%E6%89%80%E6%9C%89%E6%B5%8F%E8%A7%88%E5%99%A8/" data-id="ckts3ejvk009c4d9k9ge6d89v" data-title="61-【CSS】实现背景透明但文字不透明且兼容所有浏览器" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CSS/" rel="tag">CSS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" rel="tag">前端开发</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-60-【CSS】隐藏滚动条的三种方法" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/05/16/60-%E3%80%90CSS%E3%80%91%E9%9A%90%E8%97%8F%E6%BB%9A%E5%8A%A8%E6%9D%A1%E7%9A%84%E4%B8%89%E7%A7%8D%E6%96%B9%E6%B3%95/" class="article-date">
  <time class="dt-published" datetime="2018-05-16T14:07:53.000Z" itemprop="datePublished">2018-05-16</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/05/16/60-%E3%80%90CSS%E3%80%91%E9%9A%90%E8%97%8F%E6%BB%9A%E5%8A%A8%E6%9D%A1%E7%9A%84%E4%B8%89%E7%A7%8D%E6%96%B9%E6%B3%95/">60-【CSS】隐藏滚动条的三种方法</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <blockquote>
<p><a target="_blank" rel="noopener" href="http://www.jb51.net/css/401123.html">阅读原文</a></p>
</blockquote>
<hr>
<table>
<thead>
<tr>
<th>Author</th>
<th>王平安</th>
</tr>
</thead>
<tbody><tr>
<td>E-mail</td>
<td><a href="mailto:&#x70;&#x69;&#x6e;&#x67;&#x61;&#x6e;&#x38;&#x37;&#56;&#55;&#x40;&#x71;&#113;&#46;&#99;&#x6f;&#109;">&#x70;&#x69;&#x6e;&#x67;&#x61;&#x6e;&#x38;&#x37;&#56;&#55;&#x40;&#x71;&#113;&#46;&#99;&#x6f;&#109;</a></td>
</tr>
<tr>
<td>博  客</td>
<td><a target="_blank" rel="noopener" href="http://www.pingan8787.com/">www.pingan8787.com</a></td>
</tr>
<tr>
<td>微  信</td>
<td>pingan8787</td>
</tr>
<tr>
<td>每日文章</td>
<td><a target="_blank" rel="noopener" href="https://0x9.me/KMrv3">https://0x9.me/KMrv3</a></td>
</tr>
</tbody></table>
<hr>
<h2 id="方法1："><a href="#方法1：" class="headerlink" title="方法1："></a>方法1：</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">html</span> &#123; <span class="attribute">overflow-y</span>: scroll; &#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>原理：强制显示ie的垂直滚动条，而忽略水平滚动条<br>优点：完全解决了这个问题, 允许你保持完整的XHTML doctype<br>缺点：即使页面不需要垂直滚动条的时候也会出现垂直滚动条  </p>
</blockquote>
<h2 id="方法2：-推荐"><a href="#方法2：-推荐" class="headerlink" title="方法2： (推荐)"></a>方法2： (推荐)</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">html</span> &#123; <span class="attribute">overflow-x</span>: hidden; <span class="attribute">overflow-y</span>: auto; &#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>原理：隐藏横向滚动，垂直滚动根据内容自适应<br>优点：在视觉上解决了这个问题.在不必要的时候, 未强制垂直滚动条出现<br>缺点：只是隐藏了水平滚动条，如果页面真正需要水平滚动条的时候<br>屏幕以外的内容会因为用户无法水平滚动，而看不到  </p>
</blockquote>
<h2 id="方法3："><a href="#方法3：" class="headerlink" title="方法3："></a>方法3：</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123; <span class="attribute">margin-right</span>: -<span class="number">15px</span>; <span class="attribute">margin-bottom</span>: -<span class="number">15px</span>; &#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>原理：这会在margin的水平和垂直方向上添加一个负值, IE添加了该精确数值后, 便会去除对滚动条的需求假象<br>优点：在视觉上解决了这个问题.，垂直滚动根据内容自适应<br>缺点：由于”人为创建”了15px的外边距(margin), 所以无法使用该填充过的屏幕区域  </p>
</blockquote>
<h2 id="也可以定义滚动条的样式"><a href="#也可以定义滚动条的样式" class="headerlink" title="也可以定义滚动条的样式"></a>也可以定义滚动条的样式</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">*&#123;</span><br><span class="line">    scrollbar-<span class="number">3</span>dlight-<span class="attribute">color</span>:<span class="number">#D4D0C8</span>;    <span class="comment">/*- 最外左 -*/</span></span><br><span class="line">    scrollbar-highlight-<span class="attribute">color</span>:<span class="number">#fff</span>;     <span class="comment">/*- 左二 -*/</span></span><br><span class="line">    scrollbar-face-<span class="attribute">color</span>:<span class="number">#E4E4E4</span>;       <span class="comment">/*- 面子 -*/</span></span><br><span class="line">    scrollbar-arrow-<span class="attribute">color</span>:<span class="number">#666</span>;         <span class="comment">/*- 箭头 -*/</span></span><br><span class="line">    scrollbar-shadow-<span class="attribute">color</span>:<span class="number">#808080</span>;     <span class="comment">/*- 右二 -*/</span></span><br><span class="line">    scrollbar-darkshadow-<span class="attribute">color</span>:<span class="number">#D7DCE0</span>; <span class="comment">/*- 右一 -*/</span></span><br><span class="line">    scrollbar-base-<span class="attribute">color</span>:<span class="number">#D7DCE0</span>;       <span class="comment">/*- 基色 -*/</span></span><br><span class="line">    scrollbar-track-<span class="attribute">color</span>:#;            <span class="comment">/*- 滑道 -*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/05/16/60-%E3%80%90CSS%E3%80%91%E9%9A%90%E8%97%8F%E6%BB%9A%E5%8A%A8%E6%9D%A1%E7%9A%84%E4%B8%89%E7%A7%8D%E6%96%B9%E6%B3%95/" data-id="ckts3ejvj00994d9k0zil4kn5" data-title="60-【CSS】隐藏滚动条的三种方法" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CSS/" rel="tag">CSS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" rel="tag">前端开发</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-59-【常用技术】Mac终端命令大全" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/04/24/59-%E3%80%90%E5%B8%B8%E7%94%A8%E6%8A%80%E6%9C%AF%E3%80%91Mac%E7%BB%88%E7%AB%AF%E5%91%BD%E4%BB%A4%E5%A4%A7%E5%85%A8/" class="article-date">
  <time class="dt-published" datetime="2018-04-23T16:02:06.000Z" itemprop="datePublished">2018-04-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/04/24/59-%E3%80%90%E5%B8%B8%E7%94%A8%E6%8A%80%E6%9C%AF%E3%80%91Mac%E7%BB%88%E7%AB%AF%E5%91%BD%E4%BB%A4%E5%A4%A7%E5%85%A8/">59-【常用技术】Mac终端命令大全</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <hr>
<table>
<thead>
<tr>
<th>Author</th>
<th>王平安</th>
</tr>
</thead>
<tbody><tr>
<td>E-mail</td>
<td><a href="mailto:&#x70;&#x69;&#x6e;&#103;&#x61;&#110;&#x38;&#55;&#x38;&#55;&#x40;&#x71;&#113;&#x2e;&#x63;&#x6f;&#x6d;">&#x70;&#x69;&#x6e;&#103;&#x61;&#110;&#x38;&#55;&#x38;&#55;&#x40;&#x71;&#113;&#x2e;&#x63;&#x6f;&#x6d;</a></td>
</tr>
<tr>
<td>博  客</td>
<td><a target="_blank" rel="noopener" href="http://www.pingan8787.com/">www.pingan8787.com</a></td>
</tr>
<tr>
<td>微  信</td>
<td>pingan8787</td>
</tr>
<tr>
<td>每日文章</td>
<td><a target="_blank" rel="noopener" href="https://0x9.me/KMrv3">https://0x9.me/KMrv3</a></td>
</tr>
</tbody></table>
<hr>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/3291de46f3ff">阅读原文</a></p>
</blockquote>
<h2 id="目录操作"><a href="#目录操作" class="headerlink" title="目录操作"></a>目录操作</h2><table>
<thead>
<tr>
<th>命令名</th>
<th>功能描述</th>
<th>使用举例</th>
</tr>
</thead>
<tbody><tr>
<td>mkdir</td>
<td>创建一个目录</td>
<td>mkdir dirname</td>
</tr>
<tr>
<td>rmdir</td>
<td>删除一个目录</td>
<td>rmdir dirname</td>
</tr>
<tr>
<td>mvdir</td>
<td>移动或重命名一个目录</td>
<td>mvdir dir1 dir2</td>
</tr>
<tr>
<td>cd</td>
<td>改变当前目录</td>
<td>cd dirname</td>
</tr>
<tr>
<td>pwd</td>
<td>显示当前目录的路径名</td>
<td>pwd</td>
</tr>
<tr>
<td>ls</td>
<td>显示当前目录的内容</td>
<td>ls -la</td>
</tr>
<tr>
<td>dircmp</td>
<td>比较两个目录的内容</td>
<td>dircmp dir1 dir2</td>
</tr>
</tbody></table>
<h2 id="文件操作"><a href="#文件操作" class="headerlink" title="文件操作"></a>文件操作</h2><table>
<thead>
<tr>
<th>命令名</th>
<th>功能描述</th>
<th>使用举例</th>
</tr>
</thead>
<tbody><tr>
<td>cat</td>
<td>显示或连接文件</td>
<td>cat filename</td>
</tr>
<tr>
<td>pg</td>
<td>分页格式化显示文件内容</td>
<td>pg filename</td>
</tr>
<tr>
<td>more</td>
<td>分屏显示文件内容</td>
<td>more filename</td>
</tr>
<tr>
<td>od</td>
<td>显示非文本文件的内容</td>
<td>od -c filename</td>
</tr>
<tr>
<td>cp</td>
<td>复制文件或目录</td>
<td>cp file1 file2</td>
</tr>
<tr>
<td>rm</td>
<td>删除文件或目录</td>
<td>rm filename</td>
</tr>
<tr>
<td>mv</td>
<td>改变文件名或所在目录</td>
<td>mv file1 file2</td>
</tr>
<tr>
<td>ln</td>
<td>联接文件</td>
<td>ln -s file1 file2</td>
</tr>
<tr>
<td>find</td>
<td>使用匹配表达式查找文件</td>
<td>find . -name “*.c” -print</td>
</tr>
<tr>
<td>file</td>
<td>显示文件类型</td>
<td>file filename</td>
</tr>
<tr>
<td>open</td>
<td>使用默认的程序打开文件</td>
<td>open filename</td>
</tr>
</tbody></table>
<h2 id="选择操作"><a href="#选择操作" class="headerlink" title="选择操作"></a>选择操作</h2><table>
<thead>
<tr>
<th>命令名</th>
<th>功能描述</th>
<th>使用举例</th>
</tr>
</thead>
<tbody><tr>
<td>head</td>
<td>显示文件的最初几行</td>
<td>head -20 filename</td>
</tr>
<tr>
<td>tail</td>
<td>显示文件的最后几行</td>
<td>tail -15 filename</td>
</tr>
<tr>
<td>cut</td>
<td>显示文件每行中的某些域</td>
<td>cut -f1,7 -d: /etc/passwd</td>
</tr>
<tr>
<td>colrm</td>
<td>从标准输入中删除若干列</td>
<td>colrm 8 20 file2</td>
</tr>
<tr>
<td>paste</td>
<td>横向连接文件</td>
<td>paste file1 file2</td>
</tr>
<tr>
<td>diff</td>
<td>比较并显示两个文件的差异</td>
<td>diff file1 file2</td>
</tr>
<tr>
<td>sed</td>
<td>非交互方式流编辑器</td>
<td>sed “s/red/green/g” filename</td>
</tr>
<tr>
<td>grep</td>
<td>在文件中按模式查找</td>
<td>grep “^[a-zA-Z]” filename</td>
</tr>
<tr>
<td>awk</td>
<td>在文件中查找并处理模式</td>
<td>awk ‘{print $1 $1}’ filename</td>
</tr>
<tr>
<td>sort</td>
<td>排序或归并文件</td>
<td>sort -d -f -u file1</td>
</tr>
<tr>
<td>uniq</td>
<td>去掉文件中的重复行</td>
<td>uniq file1 file2</td>
</tr>
<tr>
<td>comm</td>
<td>显示两有序文件的公共和非公共行</td>
<td>comm file1 file2</td>
</tr>
<tr>
<td>wc</td>
<td>统计文件的字符数、词数和行数</td>
<td>wc filename</td>
</tr>
<tr>
<td>nl</td>
<td>给文件加上行号</td>
<td>nl file1 &gt;file2</td>
</tr>
</tbody></table>
<h2 id="安全操作"><a href="#安全操作" class="headerlink" title="安全操作"></a>安全操作</h2><table>
<thead>
<tr>
<th>命令名</th>
<th>功能描述</th>
<th>使用举例</th>
</tr>
</thead>
<tbody><tr>
<td>passwd</td>
<td>修改用户密码</td>
<td>passwd</td>
</tr>
<tr>
<td>chmod</td>
<td>改变文件或目录的权限</td>
<td>chmod ug+x filename</td>
</tr>
<tr>
<td>umask</td>
<td>定义创建文件的权限掩码</td>
<td>umask 027</td>
</tr>
<tr>
<td>chown</td>
<td>改变文件或目录的属主</td>
<td>chown newowner filename</td>
</tr>
<tr>
<td>chgrp</td>
<td>改变文件或目录的所属组</td>
<td>chgrp staff filename</td>
</tr>
<tr>
<td>xlock</td>
<td>给终端上锁</td>
<td>xlock -remote</td>
</tr>
</tbody></table>
<h2 id="编程操作"><a href="#编程操作" class="headerlink" title="编程操作"></a>编程操作</h2><table>
<thead>
<tr>
<th>命令名</th>
<th>功能描述</th>
<th>使用举例</th>
</tr>
</thead>
<tbody><tr>
<td>make</td>
<td>维护可执行程序的最新版本</td>
<td>make</td>
</tr>
<tr>
<td>touch</td>
<td>更新文件的访问和修改时间</td>
<td>touch -m 05202400 filename</td>
</tr>
<tr>
<td>dbx</td>
<td>命令行界面调试工具</td>
<td>dbx a.out</td>
</tr>
<tr>
<td>xde</td>
<td>图形用户界面调试工具</td>
<td>xde a.out</td>
</tr>
</tbody></table>
<h2 id="进程操作"><a href="#进程操作" class="headerlink" title="进程操作"></a>进程操作</h2><table>
<thead>
<tr>
<th>命令名</th>
<th>功能描述</th>
<th>使用举例</th>
</tr>
</thead>
<tbody><tr>
<td>ps</td>
<td>显示进程当前状态</td>
<td>ps u</td>
</tr>
<tr>
<td>kill</td>
<td>终止进程</td>
<td>kill -9 30142</td>
</tr>
<tr>
<td>nice</td>
<td>改变待执行命令的优先级</td>
<td>nice cc -c *.c</td>
</tr>
<tr>
<td>renice</td>
<td>改变已运行进程的优先级</td>
<td>renice +20 32768</td>
</tr>
</tbody></table>
<h2 id="时间操作"><a href="#时间操作" class="headerlink" title="时间操作"></a>时间操作</h2><table>
<thead>
<tr>
<th>命令名</th>
<th>功能描述</th>
<th>使用举例</th>
</tr>
</thead>
<tbody><tr>
<td>date</td>
<td>显示系统的当前日期和时间</td>
<td>date</td>
</tr>
<tr>
<td>cal</td>
<td>显示日历</td>
<td>cal 8 1996</td>
</tr>
<tr>
<td>time</td>
<td>统计程序的执行时间</td>
<td>time a.out</td>
</tr>
</tbody></table>
<h2 id="网络与通信操作"><a href="#网络与通信操作" class="headerlink" title="网络与通信操作"></a>网络与通信操作</h2><table>
<thead>
<tr>
<th>命令名</th>
<th>功能描述</th>
<th>使用举例</th>
</tr>
</thead>
<tbody><tr>
<td>telnet</td>
<td>远程登录</td>
<td>telnet hpc.sp.net.edu.cn</td>
</tr>
<tr>
<td>rlogin</td>
<td>远程登录</td>
<td>rlogin hostname -l username</td>
</tr>
<tr>
<td>rsh</td>
<td>在远程主机执行指定命令</td>
<td>rsh f01n03 date</td>
</tr>
<tr>
<td>ftp</td>
<td>在本地主机与远程主机之间传输文件</td>
<td>ftp ftp.sp.net.edu.cn</td>
</tr>
<tr>
<td>rcp</td>
<td>在本地主机与远程主机 之间复制文件</td>
<td>rcp file1 host1:file2</td>
</tr>
<tr>
<td>ping</td>
<td>给一个网络主机发送 回应请求</td>
<td>ping hpc.sp.net.edu.cn</td>
</tr>
<tr>
<td>mail</td>
<td>阅读和发送电子邮件</td>
<td>mail</td>
</tr>
<tr>
<td>write</td>
<td>给另一用户发送报文</td>
<td>write username pts/1</td>
</tr>
<tr>
<td>mesg</td>
<td>允许或拒绝接收报文</td>
<td>mesg n</td>
</tr>
</tbody></table>
<h2 id="Korn-Shell-命令"><a href="#Korn-Shell-命令" class="headerlink" title="Korn Shell 命令"></a>Korn Shell 命令</h2><table>
<thead>
<tr>
<th>命令名</th>
<th>功能描述</th>
<th>使用举例</th>
</tr>
</thead>
<tbody><tr>
<td>history</td>
<td>列出最近执行过的 几条命令及编号</td>
<td>history</td>
</tr>
<tr>
<td>r</td>
<td>重复执行最近执行过的 某条命令</td>
<td>r -2</td>
</tr>
<tr>
<td>alias</td>
<td>给某个命令定义别名</td>
<td>alias del=rm -i</td>
</tr>
<tr>
<td>unalias</td>
<td>取消对某个别名的定义</td>
<td>unalias del</td>
</tr>
</tbody></table>
<h2 id="其它命令"><a href="#其它命令" class="headerlink" title="其它命令"></a>其它命令</h2><table>
<thead>
<tr>
<th>命令名</th>
<th>功能描述</th>
<th>使用举例</th>
</tr>
</thead>
<tbody><tr>
<td>uname</td>
<td>显示操作系统的有关信息</td>
<td>uname -a</td>
</tr>
<tr>
<td>clear</td>
<td>清除屏幕或窗口内容</td>
<td>clear</td>
</tr>
<tr>
<td>env</td>
<td>显示当前所有设置过的环境变量</td>
<td>env</td>
</tr>
<tr>
<td>who</td>
<td>列出当前登录的所有用户</td>
<td>who</td>
</tr>
<tr>
<td>whoami</td>
<td>显示当前正进行操作的用户名</td>
<td>whoami</td>
</tr>
<tr>
<td>tty</td>
<td>显示终端或伪终端的名称</td>
<td>tty</td>
</tr>
<tr>
<td>stty</td>
<td>显示或重置控制键定义</td>
<td>stty -a</td>
</tr>
<tr>
<td>du</td>
<td>查询磁盘使用情况</td>
<td>du -k subdir</td>
</tr>
<tr>
<td>df</td>
<td>显示文件系统的总空间和可用空间</td>
<td>df /tmp</td>
</tr>
<tr>
<td>w</td>
<td>显示当前系统活动的总信息</td>
<td>w</td>
</tr>
</tbody></table>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/04/24/59-%E3%80%90%E5%B8%B8%E7%94%A8%E6%8A%80%E6%9C%AF%E3%80%91Mac%E7%BB%88%E7%AB%AF%E5%91%BD%E4%BB%A4%E5%A4%A7%E5%85%A8/" data-id="ckts3ejvh00944d9k2axf3wks" data-title="59-【常用技术】Mac终端命令大全" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%B8%B8%E7%94%A8%E6%8A%80%E6%9C%AF/" rel="tag">常用技术</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-58-【JavaScript】JS中的事件委托详解" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/04/16/58-%E3%80%90JavaScript%E3%80%91JS%E4%B8%AD%E7%9A%84%E4%BA%8B%E4%BB%B6%E5%A7%94%E6%89%98%E8%AF%A6%E8%A7%A3/" class="article-date">
  <time class="dt-published" datetime="2018-04-16T14:50:38.000Z" itemprop="datePublished">2018-04-16</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/04/16/58-%E3%80%90JavaScript%E3%80%91JS%E4%B8%AD%E7%9A%84%E4%BA%8B%E4%BB%B6%E5%A7%94%E6%89%98%E8%AF%A6%E8%A7%A3/">58-【JavaScript】JS中的事件委托详解</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <hr>
<table>
<thead>
<tr>
<th>Author</th>
<th>王平安</th>
</tr>
</thead>
<tbody><tr>
<td>E-mail</td>
<td><a href="mailto:&#112;&#105;&#110;&#103;&#x61;&#x6e;&#x38;&#x37;&#x38;&#x37;&#x40;&#113;&#x71;&#46;&#99;&#111;&#109;">&#112;&#105;&#110;&#103;&#x61;&#x6e;&#x38;&#x37;&#x38;&#x37;&#x40;&#113;&#x71;&#46;&#99;&#111;&#109;</a></td>
</tr>
<tr>
<td>博  客</td>
<td><a target="_blank" rel="noopener" href="http://www.pingan8787.com/">www.pingan8787.com</a></td>
</tr>
<tr>
<td>微  信</td>
<td>pingan8787</td>
</tr>
<tr>
<td>每日文章</td>
<td><a target="_blank" rel="noopener" href="https://0x9.me/KMrv3">https://0x9.me/KMrv3</a></td>
</tr>
</tbody></table>
<hr>
<blockquote>
<p><a target="_blank" rel="noopener" href="http://www.codeceo.com/javascript-event-commission.html">阅读原文</a>  </p>
</blockquote>
<h2 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h2><p>事件委托，通俗地来讲，就是把一个元素响应事件（click、focus……）的函数委托到另一个元素；  </p>
<p>一般来讲，会把一个或者一组元素的事件委托到它的父层或者更外层元素上，真正绑定事件的是外层元素，当事件响应到需要绑定的元素上时，会通过事件冒泡机制从而触发它的外层元素的绑定事件上，然后在外层元素上去执行函数。  </p>
<p>举个例子，比如一个宿舍的同学同时快递到了，一种方法就是他们都傻傻地一个个去领取，还有一种方法就是把这件事情委托给宿舍长，让一个人出去拿好所有快递，然后再根据收件人一一分发给每个宿舍同学；  </p>
<p>在这里，取快递就是一个事件，每个同学指的是需要响应事件的 DOM 元素，而出去统一领取快递的宿舍长就是代理的元素，所以真正绑定事件的是这个元素，按照收件人分发快递的过程就是在事件执行中，需要判断当前响应的事件应该匹配到被代理元素中的哪一个或者哪几个。  </p>
<h2 id="事件冒泡"><a href="#事件冒泡" class="headerlink" title="事件冒泡"></a>事件冒泡</h2><p>前面提到 DOM 中事件委托的实现是利用事件冒泡的机制，那么事件冒泡是什么呢？  </p>
<p>在 <code>document.addEventListener</code> 的时候我们可以设置事件模型：事件冒泡、事件捕获，一般来说都是用事件冒泡的模型；<br><img src="http://static.codeceo.com/images/2017/04/v2-716a278ff4bcc2aca259d4ca7018cba3_b.png" alt="事件冒泡"><br>如上图所示，事件模型是指分为三个阶段：  </p>
<blockquote>
<p>捕获阶段：在事件冒泡的模型中，捕获阶段不会响应任何事件；<br>目标阶段：目标阶段就是指事件响应到触发事件的最底层元素上；<br>冒泡阶段：冒泡阶段就是事件的触发响应会从最底层目标一层层地向外到最外层（根节点），事件代理即是利用事件冒泡的机制把里层所需要响应的事件绑定到外层；</p>
</blockquote>
<h2 id="事件委托的优点"><a href="#事件委托的优点" class="headerlink" title="事件委托的优点"></a>事件委托的优点</h2><h3 id="1-减少内存消耗"><a href="#1-减少内存消耗" class="headerlink" title="1. 减少内存消耗"></a>1. 减少内存消耗</h3><p>试想一下，若果我们有一个列表，列表之中有大量的列表项，我们需要在点击列表项的时候响应一个事件；  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">&quot;list&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>item 1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>item 2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>item 3<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  ......</span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>item n<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">// ...... 代表中间还有未知数个 li</span><br></pre></td></tr></table></figure>
<p>如果给每个列表项一一都绑定一个函数，那对于内存消耗是非常大的，效率上需要消耗很多性能；  </p>
<p>因此，比较好的方法就是把这个点击事件绑定到他的父层，也就是 <code>ul</code> 上，然后在执行事件的时候再去匹配判断目标元素；  </p>
<p>所以事件委托可以减少大量的内存消耗，节约效率。  </p>
<h3 id="2-动态绑定事件"><a href="#2-动态绑定事件" class="headerlink" title="2. 动态绑定事件"></a>2. 动态绑定事件</h3><p>比如上述的例子中列表项就几个，我们给每个列表项都绑定了事件；  </p>
<p>在很多时候，我们需要通过 AJAX 或者用户操作动态的增加或者去除列表项元素，那么在每一次改变的时候都需要重新给新增的元素绑定事件，给即将删去的元素解绑事件；  </p>
<p>如果用了事件委托就没有这种麻烦了，因为事件是绑定在父层的，和目标元素的增减是没有关系的，执行到目标元素是在真正响应执行事件函数的过程中去匹配的；  </p>
<p>所以使用事件在动态绑定事件的情况下是可以减少很多重复工作的。  </p>
<h2 id="jQuery-中的事件委托"><a href="#jQuery-中的事件委托" class="headerlink" title="jQuery 中的事件委托"></a>jQuery 中的事件委托</h2><p>jQuery 中的事件委托相信很多人都用过，它主要这几种方法来实现：  </p>
<blockquote>
<p>$.on: 基本用法: $(‘.parent’).on(‘click’, ‘a’, function () { console.log(‘click event on tag a’); })，它是 .parent 元素之下的 a 元素的事件代理到 $(‘.parent’) 之上，只要在这个元素上有点击事件，就会自动寻找到 .parent 元素下的 a 元素，然后响应事件；<br>$.delegate: 基本用法: $(‘.parent’).delegate(‘a’, ‘click’, function () { console.log(‘click event on tag a’); })，同上，并且还有相对应的 $.delegate 来删除代理的事件；<br>$.live: 基本使用方法: $(‘a’, $(‘.parent’)).live(‘click’, function () { console.log(‘click event on tag a’); })，同上，然而如果没有传入父层元素 $(.parent)，那事件会默认委托到 $(document) 上；(已废除)  </p>
</blockquote>
<h2 id="实现功能"><a href="#实现功能" class="headerlink" title="实现功能"></a>实现功能</h2><h3 id="基本实现"><a href="#基本实现" class="headerlink" title="基本实现"></a>基本实现</h3><p>比如我们有这样的一个 <code>HTML</code> 片段：  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">&quot;list&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>item 1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>item 2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>item 3<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  ......</span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>item n<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">// ...... 代表中间还有未知数个 li</span><br></pre></td></tr></table></figure>
<p>我们来实现把 #list 下的 li 元素的事件代理委托到它的父层元素也就是 <code>#list</code> 上：  </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 给父层元素绑定事件</span></span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">&#x27;list&#x27;</span>).addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 兼容性处理</span></span><br><span class="line">  <span class="keyword">var</span> event = e || <span class="built_in">window</span>.event;</span><br><span class="line">  <span class="keyword">var</span> target = event.target || event.srcElement;</span><br><span class="line">  <span class="comment">// 判断是否匹配目标元素</span></span><br><span class="line">  <span class="keyword">if</span> (target.nodeName.toLocaleLowerCase === <span class="string">&#x27;LI&#x27;</span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;the content is: &#x27;</span>, target.innerHTML);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>在上述代码中， <code>target</code> 元素则是在 <code>#list</code> 元素之下具体被点击的元素，然后通过判断 <code>target</code> 的一些属性（比如：<code>nodeName</code>，<code>id</code> 等等）可以更精确地匹配到某一类 <code>#list li</code> 元素之上；  </p>
<h3 id="使用-Element-matches-精确匹配"><a href="#使用-Element-matches-精确匹配" class="headerlink" title="使用 Element.matches 精确匹配"></a>使用 Element.matches 精确匹配</h3><p>如果改变下 <code>HTML</code> 成：  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">&quot;list&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span> <span class="attr">className</span>=<span class="string">&quot;class-1&quot;</span>&gt;</span>item 1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>item 2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span> <span class="attr">className</span>=<span class="string">&quot;class-1&quot;</span>&gt;</span>item 3<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  ......</span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>item n<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">// ...... 代表中间还有未知数个 li</span><br></pre></td></tr></table></figure>

<p>这里，我们想把<code> #list</code> 元素下的 <code>li</code> 元素（并且它的 <code>class</code> 为 <code>class-1</code>）的点击事件委托代理到 <code>#list</code> 之上；  </p>
<p>如果通过上述的方法我们还需要在 <code>if (target.nodeName.toLocaleLowerCase === &quot;li&quot;)</code> 判断之中在加入一个判断 <code>target.nodeName.className === &quot;class-1&quot;</code>；  </p>
<p>但是如果想像 <code>CSS</code> 选择其般做更加灵活的匹配的话，上面的判断未免就太多了，并且很难做到灵活性，这里可以使用 <code>Element.matches </code>API 来匹配；  </p>
<p><code>Element.matches</code> API 的基本使用方法: <code>Element.matches(selectorString)</code>，<code>selectorString</code> 既是 <code>CSS</code> 那样的选择器规则，比如本例中可以使用 <code>target.matches(&#39;li.class-1&#39;)</code>，他会返回一个布尔值，如果 <code>target</code> 元素是标签 <code>li</code> 并且它的类是 <code>class-1</code> ，那么就会返回 <code>true</code>，否则返回 <code>false</code>；  </p>
<p>当然它的兼容性还有一些问题，需要 <code>IE9</code> 及以上的现代化浏览器版本；  </p>
<p>我们可以使用 <code>Polyfill</code> 来解决兼容性上的问题：  </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!Element.prototype.matches) &#123;</span><br><span class="line">  Element.prototype.matches =</span><br><span class="line">    Element.prototype.matchesSelector ||</span><br><span class="line">    Element.prototype.mozMatchesSelector ||</span><br><span class="line">    Element.prototype.msMatchesSelector ||</span><br><span class="line">    Element.prototype.oMatchesSelector ||</span><br><span class="line">    Element.prototype.webkitMatchesSelector ||</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params">s</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> matches = (<span class="built_in">this</span>.document || <span class="built_in">this</span>.ownerDocument).querySelectorAll(s),</span><br><span class="line">        i = matches.length;</span><br><span class="line">      <span class="keyword">while</span> (--i &gt;= <span class="number">0</span> &amp;&amp; matches.item(i) !== <span class="built_in">this</span>) &#123;&#125;</span><br><span class="line">      <span class="keyword">return</span> i &gt; -<span class="number">1</span>;            </span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>加上 <code>Element.matches</code> 之后就可以来实现我们的需求了：  </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!Element.prototype.matches) &#123;</span><br><span class="line">  Element.prototype.matches =</span><br><span class="line">    Element.prototype.matchesSelector ||</span><br><span class="line">    Element.prototype.mozMatchesSelector ||</span><br><span class="line">    Element.prototype.msMatchesSelector ||</span><br><span class="line">    Element.prototype.oMatchesSelector ||</span><br><span class="line">    Element.prototype.webkitMatchesSelector ||</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params">s</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">var</span> matches = (<span class="built_in">this</span>.document || <span class="built_in">this</span>.ownerDocument).querySelectorAll(s),</span><br><span class="line">        i = matches.length;</span><br><span class="line">      <span class="keyword">while</span> (--i &gt;= <span class="number">0</span> &amp;&amp; matches.item(i) !== <span class="built_in">this</span>) &#123;&#125;</span><br><span class="line">      <span class="keyword">return</span> i &gt; -<span class="number">1</span>;            </span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">&#x27;list&#x27;</span>).addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 兼容性处理</span></span><br><span class="line">  <span class="keyword">var</span> event = e || <span class="built_in">window</span>.event;</span><br><span class="line">  <span class="keyword">var</span> target = event.target || event.srcElement;</span><br><span class="line">  <span class="keyword">if</span> (target.matches(<span class="string">&#x27;li.class-1&#x27;</span>)) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;the content is: &#x27;</span>, target.innerHTML);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="函数封装"><a href="#函数封装" class="headerlink" title="函数封装"></a>函数封装</h2><p>在应对更多场景上我们可以把事件代理的功能封装成一个公用函数，这样就可以重复利用了。  </p>
<p>结合上面的例子来实现一个函数 <code>eventDelegate</code>，它接受四个参数：  </p>
<blockquote>
<p><code>[String]</code> 一个选择器字符串用于过滤需要实现代理的父层元素，既事件需要被真正绑定之上；<br><code>[String]</code> 一个选择器字符串用于过滤触发事件的选择器元素的后代，既我们需要被代理事件的元素；<br><code>[String]</code> 一个或多个用空格分隔的事件类型和可选的命名空间，如 <code>click</code> 或<code> keydown.click</code> ;<br><code>[Function]</code> 需要代理事件响应的函数；</p>
</blockquote>
<p>这里就有几个关键点：  </p>
<blockquote>
<p>对于父层代理的元素可能有多个，需要一一绑定事件；<br>对于绑定的事件类型可能有多个，需要一一绑定事件；<br>在处理匹配被代理的元素之中需要考虑到兼容性问题；<br>在执行所绑定的函数的时候需要传入正确的参数以及考虑到 this 的问题；  </p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">eventDelegate</span> (<span class="params">parentSelector, targetSelector, events, foo</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 触发执行的函数</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">triFunction</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 兼容性处理</span></span><br><span class="line">    <span class="keyword">var</span> event = e || <span class="built_in">window</span>.event;</span><br><span class="line">    <span class="keyword">var</span> target = event.target || event.srcElement;</span><br><span class="line">    <span class="comment">// 处理 matches 的兼容性</span></span><br><span class="line">    <span class="keyword">if</span> (!Element.prototype.matches) &#123;</span><br><span class="line">      Element.prototype.matches =</span><br><span class="line">        Element.prototype.matchesSelector ||</span><br><span class="line">        Element.prototype.mozMatchesSelector ||</span><br><span class="line">        Element.prototype.msMatchesSelector ||</span><br><span class="line">        Element.prototype.oMatchesSelector ||</span><br><span class="line">        Element.prototype.webkitMatchesSelector ||</span><br><span class="line">        <span class="function"><span class="keyword">function</span>(<span class="params">s</span>) </span>&#123;</span><br><span class="line">          <span class="keyword">var</span> matches = (<span class="built_in">this</span>.document || <span class="built_in">this</span>.ownerDocument).querySelectorAll(s),</span><br><span class="line">            i = matches.length;</span><br><span class="line">          <span class="keyword">while</span> (--i &gt;= <span class="number">0</span> &amp;&amp; matches.item(i) !== <span class="built_in">this</span>) &#123;&#125;</span><br><span class="line">          <span class="keyword">return</span> i &gt; -<span class="number">1</span>;            </span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 判断是否匹配到我们所需要的元素上</span></span><br><span class="line">    <span class="keyword">if</span> (target.matches(targetSelector)) &#123;</span><br><span class="line">      <span class="comment">// 执行绑定的函数，注意 this</span></span><br><span class="line">      foo.call(target, <span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">arguments</span>));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 如果有多个事件的话需要全部一一绑定事件</span></span><br><span class="line">  events.split(<span class="string">&#x27;.&#x27;</span>).forEach(<span class="function"><span class="keyword">function</span> (<span class="params">evt</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 多个父层元素的话也需要一一绑定</span></span><br><span class="line">    <span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">document</span>.querySelectorAll(parentSelector)).forEach(<span class="function"><span class="keyword">function</span> (<span class="params">$p</span>) </span>&#123;</span><br><span class="line">      $p.addEventListener(evt, triFunction);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/04/16/58-%E3%80%90JavaScript%E3%80%91JS%E4%B8%AD%E7%9A%84%E4%BA%8B%E4%BB%B6%E5%A7%94%E6%89%98%E8%AF%A6%E8%A7%A3/" data-id="ckts3ejvg00924d9kd5sw1sgi" data-title="58-【JavaScript】JS中的事件委托详解" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/" rel="tag">JavaScript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" rel="tag">前端开发</a></li></ul>

    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/16/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/15/">15</a><a class="page-number" href="/page/16/">16</a><span class="page-number current">17</span><a class="page-number" href="/page/18/">18</a><a class="page-number" href="/page/19/">19</a><span class="space">&hellip;</span><a class="page-number" href="/page/23/">23</a><a class="extend next" rel="next" href="/page/18/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Angular/" rel="tag">Angular</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CSS/" rel="tag">CSS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CSS%E5%8A%A8%E7%94%BB/" rel="tag">CSS动画</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Chrome/" rel="tag">Chrome</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ES6-ES7-ES8/" rel="tag">ES6/ES7/ES8</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Eslint/" rel="tag">Eslint</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Express/" rel="tag">Express</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GraphQL/" rel="tag">GraphQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/H5/" rel="tag">H5</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTML/" rel="tag">HTML</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTTP/" rel="tag">HTTP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTTP%E5%8D%8F%E8%AE%AE/" rel="tag">HTTP协议</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hybrid/" rel="tag">Hybrid</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaScript/" rel="tag">JavaScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NPM/" rel="tag">NPM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nodejs/" rel="tag">Nodejs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Numpy/" rel="tag">Numpy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/" rel="tag">Python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/React/" rel="tag">React</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Tensorflow/" rel="tag">Tensorflow</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TyeScript/" rel="tag">TyeScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TypeScript/" rel="tag">TypeScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vuejs/" rel="tag">Vuejs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WebSocket/" rel="tag">WebSocket</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Webpack/" rel="tag">Webpack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/demo/" rel="tag">demo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%AD%E9%97%B4%E4%BB%B6/" rel="tag">中间件</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/" rel="tag">人工智能</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91/" rel="tag">全栈开发</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" rel="tag">前端开发</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E6%8E%A2%E7%B4%A2/" rel="tag">前端探索</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E7%9F%A5%E4%B9%8E%E7%B3%BB%E5%88%97/" rel="tag">前端知乎系列</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8E%9F%E5%88%9B/" rel="tag">原创</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B8%B8%E7%94%A8%E6%8A%80%E6%9C%AF/" rel="tag">常用技术</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BE%AE%E5%89%8D%E7%AB%AF/" rel="tag">微前端</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%80%BB%E7%BB%93/" rel="tag">总结</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" rel="tag">数据结构</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" rel="tag">机器学习</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/" rel="tag">构建工具</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" rel="tag">正则表达式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%BA%90%E7%A0%81/" rel="tag">源码</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%BA%90%E7%A0%81%E7%B2%BE%E8%AF%BB/" rel="tag">源码精读</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%83%AD%E9%97%A8/" rel="tag">热门</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%94%9F%E6%B4%BB%E6%9D%82%E8%AE%B0/" rel="tag">生活杂记</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/" rel="tag">编译原理</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82/" rel="tag">网络请求</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" rel="tag">设计模式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" rel="tag">读书笔记</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%87%8D%E6%B8%A9%E5%9F%BA%E7%A1%80/" rel="tag">重温基础</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9D%A2%E8%AF%95%E9%A2%98/" rel="tag">面试题</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Angular/" style="font-size: 11.88px;">Angular</a> <a href="/tags/CSS/" style="font-size: 18.13px;">CSS</a> <a href="/tags/CSS%E5%8A%A8%E7%94%BB/" style="font-size: 12.5px;">CSS动画</a> <a href="/tags/Chrome/" style="font-size: 10px;">Chrome</a> <a href="/tags/ES6-ES7-ES8/" style="font-size: 10.63px;">ES6/ES7/ES8</a> <a href="/tags/Eslint/" style="font-size: 10px;">Eslint</a> <a href="/tags/Express/" style="font-size: 10px;">Express</a> <a href="/tags/GraphQL/" style="font-size: 10px;">GraphQL</a> <a href="/tags/H5/" style="font-size: 10px;">H5</a> <a href="/tags/HTML/" style="font-size: 10px;">HTML</a> <a href="/tags/HTTP/" style="font-size: 11.88px;">HTTP</a> <a href="/tags/HTTP%E5%8D%8F%E8%AE%AE/" style="font-size: 11.25px;">HTTP协议</a> <a href="/tags/Hybrid/" style="font-size: 10.63px;">Hybrid</a> <a href="/tags/JavaScript/" style="font-size: 19.38px;">JavaScript</a> <a href="/tags/NPM/" style="font-size: 10px;">NPM</a> <a href="/tags/Nodejs/" style="font-size: 11.25px;">Nodejs</a> <a href="/tags/Numpy/" style="font-size: 10.63px;">Numpy</a> <a href="/tags/Python/" style="font-size: 17.5px;">Python</a> <a href="/tags/React/" style="font-size: 12.5px;">React</a> <a href="/tags/Tensorflow/" style="font-size: 10.63px;">Tensorflow</a> <a href="/tags/TyeScript/" style="font-size: 10px;">TyeScript</a> <a href="/tags/TypeScript/" style="font-size: 11.25px;">TypeScript</a> <a href="/tags/Vuejs/" style="font-size: 14.38px;">Vuejs</a> <a href="/tags/WebSocket/" style="font-size: 10px;">WebSocket</a> <a href="/tags/Webpack/" style="font-size: 15.63px;">Webpack</a> <a href="/tags/demo/" style="font-size: 10.63px;">demo</a> <a href="/tags/%E4%B8%AD%E9%97%B4%E4%BB%B6/" style="font-size: 10px;">中间件</a> <a href="/tags/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/" style="font-size: 16.25px;">人工智能</a> <a href="/tags/%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91/" style="font-size: 11.25px;">全栈开发</a> <a href="/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" style="font-size: 20px;">前端开发</a> <a href="/tags/%E5%89%8D%E7%AB%AF%E6%8E%A2%E7%B4%A2/" style="font-size: 11.25px;">前端探索</a> <a href="/tags/%E5%89%8D%E7%AB%AF%E7%9F%A5%E4%B9%8E%E7%B3%BB%E5%88%97/" style="font-size: 10.63px;">前端知乎系列</a> <a href="/tags/%E5%8E%9F%E5%88%9B/" style="font-size: 18.75px;">原创</a> <a href="/tags/%E5%B8%B8%E7%94%A8%E6%8A%80%E6%9C%AF/" style="font-size: 10.63px;">常用技术</a> <a href="/tags/%E5%BE%AE%E5%89%8D%E7%AB%AF/" style="font-size: 10px;">微前端</a> <a href="/tags/%E6%80%BB%E7%BB%93/" style="font-size: 13.75px;">总结</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" style="font-size: 10px;">数据结构</a> <a href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" style="font-size: 15px;">机器学习</a> <a href="/tags/%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/" style="font-size: 10.63px;">构建工具</a> <a href="/tags/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" style="font-size: 10.63px;">正则表达式</a> <a href="/tags/%E6%BA%90%E7%A0%81/" style="font-size: 10px;">源码</a> <a href="/tags/%E6%BA%90%E7%A0%81%E7%B2%BE%E8%AF%BB/" style="font-size: 10px;">源码精读</a> <a href="/tags/%E7%83%AD%E9%97%A8/" style="font-size: 10px;">热门</a> <a href="/tags/%E7%94%9F%E6%B4%BB%E6%9D%82%E8%AE%B0/" style="font-size: 10px;">生活杂记</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 13.13px;">算法</a> <a href="/tags/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/" style="font-size: 10px;">编译原理</a> <a href="/tags/%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82/" style="font-size: 10px;">网络请求</a> <a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" style="font-size: 15px;">设计模式</a> <a href="/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" style="font-size: 14.38px;">读书笔记</a> <a href="/tags/%E9%87%8D%E6%B8%A9%E5%9F%BA%E7%A1%80/" style="font-size: 16.88px;">重温基础</a> <a href="/tags/%E9%9D%A2%E8%AF%95%E9%A2%98/" style="font-size: 10px;">面试题</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">May 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">March 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">September 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">June 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">May 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">April 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/07/28/227-%E3%80%90%E6%80%BB%E7%BB%93%E3%80%91%E5%A6%82%E4%BD%95%E4%BC%98%E9%9B%85%E7%9A%84%E5%9C%A8%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E4%BD%BF%E7%94%A8SVG%E5%AD%97%E4%BD%93%E5%9B%BE%E6%A0%87/">227-【总结】如何优雅的在微信小程序使用SVG字体图标</a>
          </li>
        
          <li>
            <a href="/2021/07/28/226-%E3%80%90HTTP%E3%80%91%E5%A6%82%E4%BD%95%E4%BC%98%E9%9B%85%E7%9A%84%E7%AE%A1%E7%90%86HTTP%E8%AF%B7%E6%B1%82%E5%92%8C%E5%93%8D%E5%BA%94%E6%8B%A6%E6%88%AA%E5%99%A8%EF%BC%9F/">226-【HTTP】如何优雅的管理HTTP请求和响应拦截器？</a>
          </li>
        
          <li>
            <a href="/2021/07/28/225-%E3%80%90Vue%E3%80%91%E4%BB%8E%E6%89%8B%E5%86%99Vue3%E7%9A%84Reactivity%E5%BC%80%E5%A7%8B%E6%B7%B1%E5%85%A5Vue3%E6%BA%90%E7%A0%81/">225-【Vue】从手写Vue3的Reactivity开始深入Vue3源码</a>
          </li>
        
          <li>
            <a href="/2021/05/30/224-%E3%80%90Chrome%E3%80%915%E4%B8%AAChrome%E8%B0%83%E8%AF%95%E6%B7%B7%E5%90%88%E5%BA%94%E7%94%A8%E7%9A%84%E6%8A%80%E5%B7%A7/">224-【Chrome】5个Chrome调试混合应用的技巧</a>
          </li>
        
          <li>
            <a href="/2021/03/19/223-%E3%80%90%E5%89%8D%E7%AB%AF%E6%8E%A2%E7%B4%A2%E3%80%91%E6%8E%A2%E7%B4%A2Snabbdom%E6%A8%A1%E5%9D%97%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86/">223-【前端探索】探索Snabbdom模块系统原理</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>