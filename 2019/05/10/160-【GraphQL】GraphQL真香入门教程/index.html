<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>160-【GraphQL】GraphQL真香入门教程 | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="Author 王平安    E-mail &amp;#x70;&amp;#x69;&amp;#x6e;&amp;#103;&amp;#x61;&amp;#110;&amp;#x38;&amp;#55;&amp;#x38;&amp;#x37;&amp;#x40;&amp;#113;&amp;#113;&amp;#46;&amp;#99;&amp;#111;&amp;#109;   博  客 www.pingan8787.com   微  信 pingan8787   每日文章推荐 https:&#x2F;&#x2F;github.com&#x2F;pin">
<meta property="og:type" content="article">
<meta property="og:title" content="160-【GraphQL】GraphQL真香入门教程">
<meta property="og:url" content="http://example.com/2019/05/10/160-%E3%80%90GraphQL%E3%80%91GraphQL%E7%9C%9F%E9%A6%99%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="Author 王平安    E-mail &amp;#x70;&amp;#x69;&amp;#x6e;&amp;#103;&amp;#x61;&amp;#110;&amp;#x38;&amp;#55;&amp;#x38;&amp;#x37;&amp;#x40;&amp;#113;&amp;#113;&amp;#46;&amp;#99;&amp;#111;&amp;#109;   博  客 www.pingan8787.com   微  信 pingan8787   每日文章推荐 https:&#x2F;&#x2F;github.com&#x2F;pin">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://images.pingan8787.com/graph_demo.png">
<meta property="og:image" content="http://images.pingan8787.com/iron_man1.jpg">
<meta property="og:image" content="http://images.pingan8787.com/graphql_1.png">
<meta property="og:image" content="http://images.pingan8787.com/graphql_2.png">
<meta property="og:image" content="http://images.pingan8787.com/graphql_3.png">
<meta property="og:image" content="http://images.pingan8787.com/graphql_6.png">
<meta property="og:image" content="http://images.pingan8787.com/graphql_8.png">
<meta property="og:image" content="http://images.pingan8787.com/graphql_10.png">
<meta property="og:image" content="http://images.pingan8787.com/graphql_11.png">
<meta property="og:image" content="http://images.pingan8787.com/graphql_12.png">
<meta property="article:published_time" content="2019-05-10T12:13:08.000Z">
<meta property="article:modified_time" content="2021-09-20T03:31:47.602Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="前端开发">
<meta property="article:tag" content="JavaScript">
<meta property="article:tag" content="GraphQL">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://images.pingan8787.com/graph_demo.png">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-160-【GraphQL】GraphQL真香入门教程" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/05/10/160-%E3%80%90GraphQL%E3%80%91GraphQL%E7%9C%9F%E9%A6%99%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/" class="article-date">
  <time class="dt-published" datetime="2019-05-10T12:13:08.000Z" itemprop="datePublished">2019-05-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      160-【GraphQL】GraphQL真香入门教程
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <hr>
<table>
<thead>
<tr>
<th>Author</th>
<th>王平安</th>
</tr>
</thead>
<tbody><tr>
<td>E-mail</td>
<td><a href="mailto:&#x70;&#x69;&#x6e;&#103;&#x61;&#110;&#x38;&#55;&#x38;&#x37;&#x40;&#113;&#113;&#46;&#99;&#111;&#109;">&#x70;&#x69;&#x6e;&#103;&#x61;&#110;&#x38;&#55;&#x38;&#x37;&#x40;&#113;&#113;&#46;&#99;&#111;&#109;</a></td>
</tr>
<tr>
<td>博  客</td>
<td><a target="_blank" rel="noopener" href="http://www.pingan8787.com/">www.pingan8787.com</a></td>
</tr>
<tr>
<td>微  信</td>
<td>pingan8787</td>
</tr>
<tr>
<td>每日文章推荐</td>
<td><a target="_blank" rel="noopener" href="https://github.com/pingan8787/Leo_Reading/issues">https://github.com/pingan8787/Leo_Reading/issues</a></td>
</tr>
<tr>
<td>微信公众号</td>
<td>前端自习课</td>
</tr>
</tbody></table>
<p><img src="http://images.pingan8787.com/graph_demo.png" alt="封面"></p>
<p>看完复联四，我整理了这份 GraphQL 入门教程</p>
<blockquote>
<p>欢迎关注我的 <a target="_blank" rel="noopener" href="https://github.com/pingan8787">个人主页</a> &amp;&amp;  <a target="_blank" rel="noopener" href="http://www.pingan8787.com/">个人博客</a> &amp;&amp; <a target="_blank" rel="noopener" href="http://js.pingan8787.com/">个人知识库</a> &amp;&amp; 微信公众号“前端自习课”</p>
</blockquote>
<p>首先有请阿爸镇贴！哈哈哈，需要高清原图的小伙伴可以 <a target="_blank" rel="noopener" href="http://images.pingan8787.com/iron_man1.jpg">点我下载 阿爸无敌</a> 。   </p>
<p><img src="http://images.pingan8787.com/iron_man1.jpg" alt="iron_man">   </p>
<p>下面开始本文内容：   </p>
<h2 id="一、GraphQL介绍"><a href="#一、GraphQL介绍" class="headerlink" title="一、GraphQL介绍"></a>一、GraphQL介绍</h2><p><code>GraphQL</code> 是 Facebook 开发的一种 <strong>API 的查询语言</strong>，与 2015 年公开发布，是 REST API 的替代品。      </p>
<p><code>GraphQL</code> 既是一种用于 API 的<strong>查询语言</strong>也是一个满足你数据查询的<strong>运行时</strong>。 <code>GraphQL</code> 对你的 API 中的数据提供了一套易于理解的完整描述，使得客户端能够准确地获得它需要的数据，而且<strong>没有任何冗余</strong>，也让 API 更容易地随着时间推移而演进，还能用于构建强大的开发者工具。    </p>
<p>官网： <a target="_blank" rel="noopener" href="http://graphql.org/">http://graphql.org/</a><br>中文网： <a target="_blank" rel="noopener" href="http://graphql.cn/">http://graphql.cn/</a></p>
<h3 id="1-特点"><a href="#1-特点" class="headerlink" title="1. 特点"></a>1. 特点</h3><ul>
<li>请求你所要的数据，不多不少；   </li>
</ul>
<p>如：<code>hero</code> 中有 <code>name</code>, <code>age</code>, <code>sex</code> 等，可以只取得需要的字段。</p>
<ul>
<li>获取多个资源，只用一个请求；   </li>
</ul>
<p>典型的 <code>REST API</code> 请求多个资源时得载入多个 URL，而 <code>GraphQL</code> 可以通过一次请求就获取你应用所需的所有数据。这样也能保证在较慢的移动网络连接下，使用 <code>GraphQL</code> 的应用也能表现得足够迅速。   </p>
<ul>
<li>描述所有可能类型的系统。便于维护，根据需求平滑演进，添加或隐藏字段；    </li>
</ul>
<p><code>GraphQL</code> 使用类型来保证应用只请求可能的数据，还提供了清晰的辅助性错误信息。应用可以使用类型，而避免编写手动解析代码。</p>
<h3 id="2-简单案例"><a href="#2-简单案例" class="headerlink" title="2. 简单案例"></a>2. 简单案例</h3><p>这里先看下简单案例，体验下 <code>GraphQL</code> 的神奇之处（后面详细介绍）。<br>我们这样定义查询语句：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">query &#123;</span><br><span class="line">    hero</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后得到的就是我们所要查询的 <code>hero</code> 字段：    </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;data&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;hero&quot;</span>: <span class="string">&quot;I&#x27;m iron man&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这样用起来，是不是更舒服呢？</p>
<h2 id="二、GraphQL与restful对比"><a href="#二、GraphQL与restful对比" class="headerlink" title="二、GraphQL与restful对比"></a>二、GraphQL与restful对比</h2><h3 id="1-restful介绍"><a href="#1-restful介绍" class="headerlink" title="1. restful介绍"></a>1. restful介绍</h3><p>全称：<code>Representational State Transfer</code> 表属性状态转移。<br>本质上就是定义 uri ，通过 API 接口来取得资源。通用系统架构，不受语言限制。    </p>
<p>例子： 饿了吗接口。<br>如：接口 <code>restapi/shopping/v3/restaurants?latitude=13</code> 就是个典型的 <code>restful</code> 接口，定义资源 + 查询条件。   </p>
<h3 id="2-与-GraphQL-比较"><a href="#2-与-GraphQL-比较" class="headerlink" title="2. 与 GraphQL 比较"></a>2. 与 GraphQL 比较</h3><ul>
<li><p><code>restful</code> 一个接口只能返回一个资源，<code>GraphQL </code>一次可以获取多个资源。    </p>
</li>
<li><p><code>restful</code> 用不同 url 来区分资源，<code>GraphQL</code> 用类型区分资源。   </p>
</li>
</ul>
<h2 id="三、使用express构建基本helloworld"><a href="#三、使用express构建基本helloworld" class="headerlink" title="三、使用express构建基本helloworld"></a>三、使用express构建基本helloworld</h2><h3 id="1-简单案例"><a href="#1-简单案例" class="headerlink" title="1. 简单案例"></a>1. 简单案例</h3><p>首先创建一个文件夹 <code>demo</code> ，并初始化一个 <code>package.json</code>，安装 <code>express</code> / <code>graphql</code> / <code>express-graphql</code> 依赖包：   </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm init -y</span><br><span class="line">npm install express graphql express-graphql -S</span><br></pre></td></tr></table></figure>

<p>新建一个 <code>hello.js</code>，引入文件：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> &#123; buildSchema &#125; = <span class="built_in">require</span>(<span class="string">&#x27;graphql&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> graphqlHTTP = <span class="built_in">require</span>(<span class="string">&#x27;express-graphql&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>创建一个 <code>schema</code> 来定义查询语句和类型，<code>buildSchema()</code> 方法需要传入的参数是<strong>字符串</strong>类型，如下面的 <code>hero</code> 查询字段，后面的 <code>String</code> 类型表示字段返回的数据类型：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> schema = buildSchema(<span class="string">`</span></span><br><span class="line"><span class="string">    type Query &#123;</span></span><br><span class="line"><span class="string">        hero: String</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">`</span>)</span><br></pre></td></tr></table></figure>

<p>创建一个 <code>root</code> 处理器，处理对应的查询，这里的 <code>hello</code> 处理器对应的是 <code>schema</code> 中的 <code>hero</code> 字段查询的处理，这里直接返回 <code>I&#39;m iron man</code> 的结果：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> root = &#123;</span><br><span class="line">    <span class="attr">hero</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;I&#x27;m iron man&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当然，处理器中也可以是其他复杂操作，后面会介绍。   </p>
<p>然后实例化 <code>express</code> ，并且将路由转发给 <code>graphqlHTTP</code> 处理：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> app = express()</span><br><span class="line">app.use(<span class="string">&#x27;/graphql&#x27;</span>, graphqlHTTP(&#123;</span><br><span class="line">    schema,</span><br><span class="line">    <span class="attr">rootValue</span>: root,</span><br><span class="line">    <span class="attr">graphiql</span>: <span class="literal">true</span></span><br><span class="line">&#125;))</span><br><span class="line">app.listen(<span class="number">3000</span>)</span><br></pre></td></tr></table></figure>
<p><code>graphqlHTTP</code> 中的三个参数介绍：   </p>
<ul>
<li><code>schema</code>：定义的查询语句和类型   </li>
<li><code>rootValue</code>：处理对应查询的处理器    </li>
<li><code>graphiql</code>：是否开启调试窗口，开发阶段开启，生产阶段关闭</li>
</ul>
<p>接下来运行项目，在命令行中执行 <code>node hello.js</code>，这里可以在 <code>graphiql</code> 上做调试，打开地址 <code>localhost:3000/graphiql</code> 就可以愉快的查询了。     </p>
<p><img src="http://images.pingan8787.com/graphql_1.png" alt="1">    </p>
<p>另外我们可以在 <code>graphiql</code> 界面右侧打开 <strong>Docs</strong> 查看我们定义的所有字段和描述信息。   </p>
<p><img src="http://images.pingan8787.com/graphql_2.png" alt="2">    </p>
<p><img src="http://images.pingan8787.com/graphql_3.png" alt="3">    </p>
<p>最终代码：    </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> &#123; buildSchema &#125; = <span class="built_in">require</span>(<span class="string">&#x27;graphql&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> graphqlHTTP = <span class="built_in">require</span>(<span class="string">&#x27;express-graphql&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 构建schema，这里定义查询的语句和类型</span></span><br><span class="line"><span class="keyword">const</span> schema = buildSchema(<span class="string">`</span></span><br><span class="line"><span class="string">    type Query &#123;</span></span><br><span class="line"><span class="string">        hero: String</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">`</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义查询所对应的 resolver，也就是查询对应的处理器</span></span><br><span class="line"><span class="keyword">const</span> root = &#123;</span><br><span class="line">    <span class="attr">hero</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;I&#x27;m iron man&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = express()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将路由转发给 graphqlHTTP 处理</span></span><br><span class="line">app.use(<span class="string">&#x27;/graphql&#x27;</span>, graphqlHTTP(&#123;</span><br><span class="line">    <span class="attr">schema</span>: schema,</span><br><span class="line">    <span class="attr">rootValue</span>: root,</span><br><span class="line">    <span class="attr">graphiql</span>: <span class="literal">true</span></span><br><span class="line">&#125;))</span><br><span class="line"></span><br><span class="line">app.listen(<span class="number">3000</span>)</span><br></pre></td></tr></table></figure>

<h3 id="2-自定义类型查询"><a href="#2-自定义类型查询" class="headerlink" title="2. 自定义类型查询"></a>2. 自定义类型查询</h3><p>我们前面的查询中，已经将 <code>hero</code> 字段定义为 <code>String</code> 类型，但是常常开发中，我们又会碰到字段是多个类型，即<strong>字段也能指代对象类型（Object）</strong>，比如一个 <code>user</code> 字段会有 <code>name</code> 、<code>age</code> 等字段，而 <code>name</code> 返回字符串类型，<code>age</code> 返回数值类型。    </p>
<p>这时候，我们可以对这个对象的字段进行<strong>次级选择（sub-selection）</strong>。GraphQL 查询能够遍历相关对象及其字段，使得客户端可以一次请求查询大量相关数据，而不像传统 REST 架构中那样需要多次往返查询。</p>
<p>我们可以新建一个查询类型来定义 <code>user</code> 字段返回的类型：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> schema = buildSchema(<span class="string">`</span></span><br><span class="line"><span class="string">    type User &#123;</span></span><br><span class="line"><span class="string">        # 查询可以有备注！</span></span><br><span class="line"><span class="string">        name: String</span></span><br><span class="line"><span class="string">        age: Int</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    type Query &#123;</span></span><br><span class="line"><span class="string">        hero: String</span></span><br><span class="line"><span class="string">        user: User</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">`</span>)</span><br></pre></td></tr></table></figure>

<p>在处理器中我们也要加上：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = &#123;</span><br><span class="line">    <span class="attr">hero</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;I&#x27;m iron man&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">user</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&#x27;leo&#x27;</span>,</span><br><span class="line">            <span class="attr">age</span>: <span class="number">18</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>这边 Int/String 参数类型的问题，下一章介绍</strong>    </p>
<h2 id="四、参数类型和参数传递"><a href="#四、参数类型和参数传递" class="headerlink" title="四、参数类型和参数传递"></a>四、参数类型和参数传递</h2><h3 id="1-基本参数类型"><a href="#1-基本参数类型" class="headerlink" title="1. 基本参数类型"></a>1. 基本参数类型</h3><p><code>String</code>, <code>Int</code>, <code>Float</code>, <code>Boolean</code> 和 <code>ID</code>，这些基本参数类型可以在 <code>schema</code> 声明中直接使用。   </p>
<ul>
<li><code>Int</code>：有符号 32 位整数。  </li>
<li><code>Float</code>：有符号双精度浮点值。  </li>
<li><code>String</code>：<code>UTF‐8</code> 字符序列。   </li>
<li><code>Boolean</code>：<code>true</code> 或者 <code>false</code>。   </li>
<li><code>ID</code>：<code>ID</code> 标量类型表示一个<strong>唯一标识符</strong>，通常用以重新获取对象或者作为缓存中的键。<code>ID</code> 类型使用和 <code>String</code> 一样的方式序列化；然而将其定义为 <code>ID</code> 意味着并<strong>不需要人类可读型</strong>。</li>
</ul>
<p>另外，我们可以使用 <code>[类型]</code> 来表示一类数组，如：   </p>
<ul>
<li><code>[Int]</code> 表示整型数组；    </li>
<li><code>[String]</code> 表示字符串型数组；   </li>
</ul>
<h3 id="2-参数传递"><a href="#2-参数传递" class="headerlink" title="2. 参数传递"></a>2. 参数传递</h3><p>使用方式和 JS 参数传递一样，小括号内定义形参，但是<strong>参数需要定义类型</strong>。    </p>
<p>使用 <code>!</code> 代表参数不能为空。  </p>
<p>下面案例：参数 <code>teamName</code> 是 <code>String</code> 类型，必须传递，而 <code>number</code> 参数也是 <code>Int</code> 类型，但是是非必须传递，最后输出的结果也是 <code>String</code> 类型。   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">type Query &#123;</span><br><span class="line">    getHero(teamName: <span class="built_in">String</span>!, number: Int): [<span class="built_in">String</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>下面一个案例：    </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//...省略其他</span></span><br><span class="line"><span class="keyword">const</span> schema = buildSchema(<span class="string">`</span></span><br><span class="line"><span class="string">    type Query &#123;</span></span><br><span class="line"><span class="string">        getHero(teamName: String!): [String]</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">`</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = &#123;</span><br><span class="line">    <span class="attr">getHero</span>: <span class="function">(<span class="params">&#123;teamName&#125;</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 这里的操作 实际开发中常常用在请求数据库</span></span><br><span class="line">        <span class="keyword">const</span> hero = &#123;</span><br><span class="line">            <span class="string">&#x27;三国&#x27;</span>: [<span class="string">&#x27;张飞&#x27;</span>, <span class="string">&#x27;刘备&#x27;</span>, <span class="string">&#x27;关羽&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;复仇者联盟&#x27;</span>: [<span class="string">&#x27;钢铁侠&#x27;</span>, <span class="string">&#x27;美国队长&#x27;</span>, <span class="string">&#x27;绿巨人&#x27;</span>]</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> hero[teamName]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//...省略其他</span></span><br></pre></td></tr></table></figure>
<p>这时候我们在 <strong>GraphiQL</strong> 上输入查询，就会得到 <strong>复仇者联盟</strong> 的英雄数据了。    </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 查询</span></span><br><span class="line">query &#123;</span><br><span class="line">	getHero(teamName:<span class="string">&quot;复仇者联盟&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 结果</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;data&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;getHero&quot;</span>: [</span><br><span class="line">            <span class="string">&quot;钢铁侠&quot;</span>,</span><br><span class="line">            <span class="string">&quot;美国队长&quot;</span>,</span><br><span class="line">            <span class="string">&quot;绿巨人&quot;</span></span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-自定义返回类型"><a href="#3-自定义返回类型" class="headerlink" title="3. 自定义返回类型"></a>3. 自定义返回类型</h3><p>在实际开发中，我们返回的数据类型可能是一个对象，对象中可能既有 <code>Int</code> 类型的属性，也有 <code>String</code> 类型的值，等等，这里我们可以使用 <strong>自定义返回类型</strong> 来处理：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//...省略其他</span></span><br><span class="line"><span class="keyword">const</span> schema = buildSchema(<span class="string">`</span></span><br><span class="line"><span class="string">    type Hero &#123;</span></span><br><span class="line"><span class="string">        name: String</span></span><br><span class="line"><span class="string">        age: Int</span></span><br><span class="line"><span class="string">        doSomething(thing: String): String</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    type Query &#123;</span></span><br><span class="line"><span class="string">        getSuperHero(heroName: String!): Hero</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">`</span>)</span><br><span class="line"><span class="keyword">const</span> root = &#123;</span><br><span class="line">    <span class="attr">getSuperHero</span>: <span class="function">(<span class="params">&#123;heroName&#125;</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 这里的操作 实际开发中常常用在请求数据库</span></span><br><span class="line">        <span class="keyword">const</span> name = heroName</span><br><span class="line">        <span class="keyword">const</span> age = <span class="number">18</span></span><br><span class="line">        <span class="keyword">const</span> doSomething = <span class="function">(<span class="params">&#123;thing&#125;</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">`I&#x27;m <span class="subst">$&#123;name&#125;</span>, I&#x27;m <span class="subst">$&#123;thing&#125;</span> now`</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> &#123; name, age, doSomething &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//...省略其他</span></span><br></pre></td></tr></table></figure>

<p>这里指定了 <code>getSuperHero</code> 字段的返回类型是 <code>Hero</code> 类型，随后在上面定义了 <code>Hero</code>。    </p>
<p>其中 <code>Hero</code> 类型中的 <code>doSomething</code>也是可以传递指定类型参数，并且指定返回类型。   </p>
<p>下面看下输出情况：    </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 查询</span></span><br><span class="line">query &#123;</span><br><span class="line">	<span class="function"><span class="title">getSuperHero</span>(<span class="params">heroName:<span class="string">&quot;IronMan&quot;</span></span>)</span> &#123;</span><br><span class="line">        name</span><br><span class="line">        age</span><br><span class="line">        doSomething</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 结果</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;data&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;getSuperHero&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;name&quot;</span>: <span class="string">&quot;IronMan&quot;</span>,</span><br><span class="line">            <span class="string">&quot;age&quot;</span>: <span class="number">46</span>,</span><br><span class="line">            <span class="string">&quot;doSomething&quot;</span>: <span class="string">&quot;I&#x27;m IronMan, I&#x27;m undefined now&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里也可以给 <code>doSomething</code> 传递参数，就会获取到不同结果：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 查询</span></span><br><span class="line">query &#123;</span><br><span class="line">	<span class="function"><span class="title">getSuperHero</span>(<span class="params">heroName:<span class="string">&quot;IronMan&quot;</span></span>)</span> &#123;</span><br><span class="line">        name</span><br><span class="line">        age</span><br><span class="line">	    doSomething(thing:<span class="string">&quot;watching TV&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 结果</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;data&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;getSuperHero&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;name&quot;</span>: <span class="string">&quot;IronMan&quot;</span>,</span><br><span class="line">            <span class="string">&quot;age&quot;</span>: <span class="number">46</span>,</span><br><span class="line">            <span class="string">&quot;doSomething&quot;</span>: <span class="string">&quot;I&#x27;m IronMan, I&#x27;m watching TV now&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="五、GraphQL客户端"><a href="#五、GraphQL客户端" class="headerlink" title="五、GraphQL客户端"></a>五、GraphQL客户端</h2><p>这一节我们学习如何在客户端中访问 <code>graphql</code> 的接口。     </p>
<h3 id="1-后端定义接口"><a href="#1-后端定义接口" class="headerlink" title="1. 后端定义接口"></a>1. 后端定义接口</h3><p>我们先在后端将接口开发完成，这里跟前面差不多，但需要多一步，使用 <code>express</code> 向外暴露一个文件夹，供用户访问静态资源文件：   </p>
<p><strong>这里直接使用前一节的代码啦~</strong>    </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.js  开发 graphql 接口</span></span><br><span class="line"><span class="comment">//...省略其他</span></span><br><span class="line"><span class="keyword">const</span> schema = buildSchema(<span class="string">`</span></span><br><span class="line"><span class="string">    type Hero &#123;</span></span><br><span class="line"><span class="string">        name: String</span></span><br><span class="line"><span class="string">        age: Int</span></span><br><span class="line"><span class="string">        doSomething(thing: String): String</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    type Query &#123;</span></span><br><span class="line"><span class="string">        getSuperHero(heroName: String!): Hero</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">`</span>)</span><br><span class="line"><span class="keyword">const</span> root = &#123;</span><br><span class="line">    <span class="attr">getSuperHero</span>: <span class="function">(<span class="params">&#123;heroName&#125;</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 这里的操作 实际开发中常常用在请求数据库</span></span><br><span class="line">        <span class="keyword">const</span> name = heroName</span><br><span class="line">        <span class="keyword">const</span> age = <span class="number">46</span></span><br><span class="line">        <span class="keyword">const</span> doSomething = <span class="function">(<span class="params">&#123;thing&#125;</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">`I&#x27;m <span class="subst">$&#123;name&#125;</span>, I&#x27;m <span class="subst">$&#123;thing&#125;</span> now`</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> &#123; name, age, doSomething &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> app = express()</span><br><span class="line">app.use(<span class="string">&#x27;/graphql&#x27;</span>, graphqlHTTP(&#123;</span><br><span class="line">    schema, <span class="attr">rootValue</span>: root, <span class="attr">graphiql</span>: <span class="literal">true</span></span><br><span class="line">&#125;))</span><br><span class="line"><span class="comment">// 公开文件夹 使用户访问静态资源</span></span><br><span class="line">app.use(express.static(<span class="string">&#x27;public&#x27;</span>))</span><br><span class="line">app.listen(<span class="number">3000</span>)</span><br></pre></td></tr></table></figure>
<p>这样我们就给前端页面提供一个可以访问静态资源的功能。   </p>
<p>这里还需要在根目录创建一个 <strong>public</strong> 文件夹，并在文件夹中添加 <code>index.html</code> 文件，此时的目录结构：   </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">|-node_modules</span><br><span class="line">|-public</span><br><span class="line">|---index.html</span><br><span class="line">|-index.js</span><br><span class="line">|-package.json</span><br></pre></td></tr></table></figure>

<h3 id="2-前端页面请求"><a href="#2-前端页面请求" class="headerlink" title="2. 前端页面请求"></a>2. 前端页面请求</h3><p>然后给 <code>index.html</code> 添加按钮和事件绑定：    </p>
<p>这里的变量 <code>query</code> 是个<strong>字符串类型</strong>，定义查询条件，在条件 <code>GetSuperHero</code> 中的参数，需要用 <code>$</code> 符号来标识，并在实际查询 <code>getSuperHero</code> 中，作为参数的参数类型设置进来。    </p>
<p>然后定义变量 <code>variables</code> ，指定属性的值，之后通过 <code>fetch</code> 发起请求：   </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">&quot;getData()&quot;</span>&gt;</span>获取数据<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">getData</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">const</span> query = <span class="string">`</span></span></span><br><span class="line"><span class="string"><span class="javascript">        query GetSuperHero($heroName: String, $thing: String)&#123;</span></span></span><br><span class="line"><span class="string"><span class="javascript">            getSuperHero(heroName: $heroName)&#123;</span></span></span><br><span class="line"><span class="string"><span class="javascript">                name</span></span></span><br><span class="line"><span class="string"><span class="javascript">                    age</span></span></span><br><span class="line"><span class="string"><span class="javascript">                    doSomething(thing: $thing)</span></span></span><br><span class="line"><span class="string"><span class="javascript">            &#125;</span></span></span><br><span class="line"><span class="string"><span class="javascript">        &#125;</span></span></span><br><span class="line"><span class="string"><span class="javascript">    `</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 如果不需要其他参数 至少要传一个参数 否则会报错</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">// const query = `</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">//     query GetSuperHero($heroName: String)&#123;</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">//         getSuperHero(heroName: $heroName)&#123;</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">//              name</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">//         &#125;</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">//     &#125;</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">// `    </span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">const</span> variables = &#123;<span class="attr">heroName</span>: <span class="string">&#x27;钢铁侠&#x27;</span>, <span class="attr">thing</span>: <span class="string">&#x27;watching TV&#x27;</span>&#125;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">    fetch(<span class="string">&#x27;./graphql&#x27;</span>, &#123;</span></span><br><span class="line"><span class="javascript">        <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span></span><br><span class="line"><span class="javascript">        <span class="attr">headers</span>: &#123;</span></span><br><span class="line"><span class="javascript">            <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span>,</span></span><br><span class="line"><span class="javascript">            <span class="string">&#x27;Accept&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span></span></span><br><span class="line"><span class="javascript">        &#125;,</span></span><br><span class="line"><span class="javascript">        <span class="attr">body</span>: <span class="built_in">JSON</span>.stringify(&#123;</span></span><br><span class="line"><span class="javascript">            query, variables</span></span><br><span class="line"><span class="javascript">        &#125;)</span></span><br><span class="line"><span class="javascript">    &#125;)</span></span><br><span class="line"><span class="javascript">    .then(<span class="function"><span class="params">res</span> =&gt;</span> res.json())</span></span><br><span class="line"><span class="javascript">    .then(<span class="function"><span class="params">json</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(json)</span></span><br><span class="line"><span class="javascript">    &#125;)</span></span><br><span class="line"><span class="javascript">&#125;</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>当我们写完以后，点击 <strong>获取数据</strong> 就会在控制台打印下面的数据：    </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;data&quot;</span>:&#123;</span><br><span class="line">        <span class="string">&quot;getSuperHero&quot;</span>:&#123;</span><br><span class="line">            <span class="string">&quot;name&quot;</span>:<span class="string">&quot;钢铁侠&quot;</span>,</span><br><span class="line">            <span class="string">&quot;age&quot;</span>:<span class="number">46</span>,</span><br><span class="line">            <span class="string">&quot;doSomething&quot;</span>: <span class="string">&quot;I&#x27;m 钢铁侠, I&#x27;m watching TV now&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-注意点"><a href="#3-注意点" class="headerlink" title="3. 注意点"></a>3. 注意点</h3><ul>
<li>请求中的 <code>query</code> 参数需要对照好有 <code>$</code> 符号的变量。   </li>
</ul>
<p>查询语句 <code>query GetSuperHero($heroName: String)</code> 里参数 <code>$heroName</code> 中的 <code>heroName</code> ；<br>查询语句 <code>getSuperHero(heroName: $heroName)</code>  里类型 <code>$heroName</code> 中的 <code>heroName</code> ；<br>变量 <code>variables</code> 中的 <code>heroName</code> 属性；   </p>
<p><strong>这三个名称需要一样</strong>。   </p>
<ul>
<li>请求中需要将数据<strong>序列化操作</strong>。   </li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">body: <span class="built_in">JSON</span>.stringify(&#123; query, variables &#125;)</span><br></pre></td></tr></table></figure>

<h2 id="六、使用Mutations修改数据"><a href="#六、使用Mutations修改数据" class="headerlink" title="六、使用Mutations修改数据"></a>六、使用Mutations修改数据</h2><h3 id="1-Mutation-使用"><a href="#1-Mutation-使用" class="headerlink" title="1. Mutation 使用"></a>1. Mutation 使用</h3><p>根据前面的学习，我们知道，要做查询操作，需要使用 <code>Query</code> 来声明:    </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">type Query &#123;</span><br><span class="line">    queryHero(heroName: <span class="built_in">String</span>): <span class="built_in">String</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当我们要做<strong>修改操作</strong>，需要用到的是 <code>Mutation</code> :   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">type Mutation &#123;</span><br><span class="line">    createHero(heroName: <span class="built_in">String</span>): <span class="built_in">String</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果 <code>Mutation</code> 中字段的形参是<strong>自定义类型</strong>，则类型需要用 <code>input</code> 标识：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> schema = buildSchema(<span class="string">`</span></span><br><span class="line"><span class="string">    # 输入类型 用 input 标识</span></span><br><span class="line"><span class="string">    input HeroInput &#123;</span></span><br><span class="line"><span class="string">        name: String</span></span><br><span class="line"><span class="string">        age: Int</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    # 查询类型</span></span><br><span class="line"><span class="string">    type Hero &#123;</span></span><br><span class="line"><span class="string">        name: String</span></span><br><span class="line"><span class="string">        age: Int</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    type Mutation &#123;</span></span><br><span class="line"><span class="string">        createHero(heroName: String): Hero</span></span><br><span class="line"><span class="string">        updateHero(heroName: String, hero: HeroInput): Hero</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">`</span>)</span><br></pre></td></tr></table></figure>
<p>注意下：这里需要至少定义一个 <code>Query</code> 不然<code> GraphiQL</code> 会不显示查询：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">type Query &#123;</span><br><span class="line">    <span class="attr">hero</span>: [Hero]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-Mutation-使用案例"><a href="#2-Mutation-使用案例" class="headerlink" title="2. Mutation 使用案例"></a>2. Mutation 使用案例</h3><p>先创建一个 <code>schema</code> ，内容为上一步【1. Mutation 使用】中定义的内容，这里不重复写。<br>然后模拟创建一个本地数据库 <code>localDb</code>， 用于模拟存放添加的超级英雄数据:    </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> localDb = &#123;&#125;</span><br></pre></td></tr></table></figure>
<p>接下来声明 <code>root</code> 实现 <code>schema</code> 中的字段方法：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> root = &#123;</span><br><span class="line">    <span class="function"><span class="title">hero</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="comment">// 这里需要转成数组 因为前面定义了返回值是  [Hero]  类型</span></span><br><span class="line">        <span class="keyword">let</span> arr = []</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">const</span> key <span class="keyword">in</span> localDb)&#123;</span><br><span class="line">            arr.push(localDb[key])</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> arr</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="title">createHero</span>(<span class="params">&#123; input &#125;</span>)</span> &#123;</span><br><span class="line">        <span class="comment">// 相当于数据库的添加操作</span></span><br><span class="line">        localDb[input.name] = input</span><br><span class="line">        <span class="keyword">return</span> localDb[input.name]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="title">updateHero</span>(<span class="params">&#123; id, input &#125;</span>)</span> &#123;</span><br><span class="line">        <span class="comment">// 相当于数据库的更新操作</span></span><br><span class="line">        <span class="keyword">const</span> update = <span class="built_in">Object</span>.assign(&#123;&#125;, localDb[id], input)</span><br><span class="line">        localDb[id] = update</span><br><span class="line">        <span class="keyword">return</span> update</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最后配置 <code>graphqlHTTP</code> 方法和启动服务器，这里就不多重复咯。    </p>
<p>最终代码：    </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//...省略其他</span></span><br><span class="line"><span class="keyword">const</span> schema = buildSchema(<span class="string">`</span></span><br><span class="line"><span class="string">    # 输入类型 用 input 标识</span></span><br><span class="line"><span class="string">    input HeroInput &#123;</span></span><br><span class="line"><span class="string">        name: String</span></span><br><span class="line"><span class="string">        age: Int</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    # 查询类型</span></span><br><span class="line"><span class="string">    type Hero &#123;</span></span><br><span class="line"><span class="string">        name: String</span></span><br><span class="line"><span class="string">        age: Int</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    type Mutation &#123;</span></span><br><span class="line"><span class="string">        createHero(input: HeroInput): Hero </span></span><br><span class="line"><span class="string">        updateHero(id: ID!, input: HeroInput): Hero</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    # 需要至少定义一个 Query 不要GraphiQL会不显示查询</span></span><br><span class="line"><span class="string">    type Query &#123;</span></span><br><span class="line"><span class="string">        hero: [Hero]</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">`</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> localDb = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = &#123;</span><br><span class="line">    <span class="function"><span class="title">hero</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="comment">// 这里需要转成数组 因为前面定义了返回值是  [Hero]  类型</span></span><br><span class="line">        <span class="keyword">let</span> arr = []</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">const</span> key <span class="keyword">in</span> localDb)&#123;</span><br><span class="line">            arr.push(localDb[key])</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> arr</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="title">createHero</span>(<span class="params">&#123; input &#125;</span>)</span> &#123;</span><br><span class="line">        <span class="comment">// 相当于数据库的添加操作</span></span><br><span class="line">        localDb[input.name] = input</span><br><span class="line">        <span class="keyword">return</span> localDb[input.name]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="title">updateHero</span>(<span class="params">&#123; id, input &#125;</span>)</span> &#123;</span><br><span class="line">        <span class="comment">// 相当于数据库的更新操作</span></span><br><span class="line">        <span class="keyword">const</span> update = <span class="built_in">Object</span>.assign(&#123;&#125;, localDb[id], input)</span><br><span class="line">        localDb[id] = update</span><br><span class="line">        <span class="keyword">return</span> update</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//...省略其他</span></span><br></pre></td></tr></table></figure>

<p>现在我们可以启动服务器，在 <code>GraphiQL</code> 上测试下效果了。    </p>
<p>我们是使用 <code>mutation</code> 的 <code>createHero</code> 字段添加两条数据：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mutation &#123;</span><br><span class="line">    <span class="function"><span class="title">createHero</span>(<span class="params">input: &#123;</span></span></span><br><span class="line"><span class="params"><span class="function">        name: <span class="string">&quot;钢铁侠&quot;</span></span></span></span><br><span class="line"><span class="params"><span class="function">        age: <span class="number">40</span></span></span></span><br><span class="line"><span class="params"><span class="function">    &#125;</span>)</span>&#123;</span><br><span class="line">        name</span><br><span class="line">        age</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mutation &#123;</span><br><span class="line">    <span class="function"><span class="title">createHero</span>(<span class="params">input: &#123;</span></span></span><br><span class="line"><span class="params"><span class="function">        name: <span class="string">&quot;美国队长&quot;</span></span></span></span><br><span class="line"><span class="params"><span class="function">        age: <span class="number">41</span></span></span></span><br><span class="line"><span class="params"><span class="function">    &#125;</span>)</span>&#123;</span><br><span class="line">        name</span><br><span class="line">        age</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后使用 <code>query</code> 的 <code>hero</code> 字段查询添加的结果：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">query &#123;</span><br><span class="line">    hero &#123;</span><br><span class="line">        name</span><br><span class="line">        age</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样我们就获取到刚才的添加结果：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;data&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;hero&quot;</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="string">&quot;name&quot;</span>: <span class="string">&quot;钢铁侠&quot;</span>,</span><br><span class="line">                <span class="string">&quot;age&quot;</span>: <span class="number">40</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="string">&quot;name&quot;</span>: <span class="string">&quot;美国队长&quot;</span>,</span><br><span class="line">                <span class="string">&quot;age&quot;</span>: <span class="number">41</span></span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后我们开始更新数据，使用 <code>mutation</code> 的 <code>updateHero</code> 字段将 <strong>美国队长</strong> 的 <code>age</code> 值修改为 18：    </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mutation &#123;</span><br><span class="line">    <span class="function"><span class="title">updateHero</span>(<span class="params">id: <span class="string">&quot;美国队长&quot;</span>, input: &#123;</span></span></span><br><span class="line"><span class="params"><span class="function">        age: <span class="number">18</span></span></span></span><br><span class="line"><span class="params"><span class="function">    &#125;</span>)</span>&#123;</span><br><span class="line">        age</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>再使用 <code>query</code> 的 <code>hero</code> 字段查询下新的数据，会发现 <strong>美国队长</strong> 的 <code>age</code> 值已经更新为 18：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;data&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;hero&quot;</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="string">&quot;name&quot;</span>: <span class="string">&quot;钢铁侠&quot;</span>,</span><br><span class="line">                <span class="string">&quot;age&quot;</span>: <span class="number">40</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="string">&quot;name&quot;</span>: <span class="string">&quot;美国队长&quot;</span>,</span><br><span class="line">                <span class="string">&quot;age&quot;</span>: <span class="number">18</span></span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="七、认证和中间件"><a href="#七、认证和中间件" class="headerlink" title="七、认证和中间件"></a>七、认证和中间件</h2><p>我们知道，修改数据的接口不能让所有人随意访问，所以需要添加权限认证，让有权限的人才可以访问。<br>在 <code>express</code> 中，可以很简单的使用<strong>中间件</strong>来将请求进行拦截，将没有权限的请求过滤并返回错误提示。</p>
<p>中间件实际上是一个函数，在接口执行之前，先拦截请求，再决定我们是否接着往下走，还是返回错误提示。   </p>
<p>这在【六、使用Mutations修改数据】的最终代码上，在添加这个中间件：    </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//... 省略其他</span></span><br><span class="line"><span class="keyword">const</span> app = express()</span><br><span class="line"><span class="keyword">const</span> middleWare = <span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 这里是简单模拟权限</span></span><br><span class="line">    <span class="comment">// 实际开发中 更多的是和后端进行 token 交换来判断权限</span></span><br><span class="line">    <span class="keyword">if</span>(req.url.indexOf(<span class="string">&#x27;/graphql&#x27;</span>) !== -<span class="number">1</span> &amp;&amp; req.headers.cookie.indexOf(<span class="string">&#x27;auth&#x27;</span>) === -<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="comment">// 向客户端返回一个错误信息</span></span><br><span class="line">        res.send(<span class="built_in">JSON</span>.stringify(&#123;</span><br><span class="line">            <span class="attr">err</span>: <span class="string">&#x27;暂无权限&#x27;</span></span><br><span class="line">        &#125;))</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    next() <span class="comment">// 正常下一步</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 注册中间件</span></span><br><span class="line">app.use(middleWare)</span><br><span class="line"></span><br><span class="line"><span class="comment">//... 省略其他</span></span><br></pre></td></tr></table></figure>

<p>这里的权限判断，只是简单模拟，实际开发中，更多的是和后端进行 <code>token</code> 交换来判断权限（或者其他形式）。<br>我们重启服务器，打开 <code>http://localhost:3000/graphql</code> ，发现页面提示错误了，因为 <code>cookies</code> 中没有含有 <code>auth</code> 字符串。    </p>
<p>如果这里提示 <code>TypeError: Cannot read property &#39;indexOf&#39; of undefined</code> ，可以先不用管，因为浏览器中没有 <code>cookies</code> 的原因，其实前面的权限判断逻辑需要根据具体业务场景判断。   </p>
<p>为了方便测试，我们在 chrome 浏览器控制台的 <code>application</code> 下，手动设置一个含有 <code>auth</code> 字符串的一个 <code>cookies</code> ，只是测试使用哦。   </p>
<p>设置完成后，我们就能正常进入页面。    </p>
<h2 id="八、ConstructingTypes"><a href="#八、ConstructingTypes" class="headerlink" title="八、ConstructingTypes"></a>八、ConstructingTypes</h2><p>在前面的介绍中，我们要创建一个 <code>schema</code> 都是使用 <code>buildSchema</code> 方法来定义，但我们也可以使用另外一种定义方式。<br>就是这里要学习使用的构造函数 <code>graphql.GraphQLObjectType</code> 定义，它有这么几个优点和缺点：    </p>
<ul>
<li><strong>优点</strong>：报错提醒更直观，结构更清晰，更便于维护。   </li>
<li><strong>缺点</strong>：代码量上升。   </li>
</ul>
<h3 id="1-定义type（类型）"><a href="#1-定义type（类型）" class="headerlink" title="1. 定义type（类型）"></a>1. 定义type（类型）</h3><p>这里先将前面定义的 <code>Hero</code> 类型进行改造：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> graphql = <span class="built_in">require</span>(<span class="string">&#x27;graphql&#x27;</span>) <span class="comment">// 需要引入</span></span><br><span class="line"><span class="keyword">const</span> HeroType = <span class="keyword">new</span> graphql.GraphQLObjectType(&#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Hero&#x27;</span>,</span><br><span class="line">    <span class="attr">fields</span>: &#123;</span><br><span class="line">        <span class="attr">name</span>:&#123; <span class="attr">type</span>: graphql.GraphQLString &#125;,</span><br><span class="line">        <span class="attr">age</span>:&#123; <span class="attr">type</span>: graphql.GraphQLInt &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><img src="http://images.pingan8787.com/graphql_6.png" alt="graphql6">   </p>
<p>两者区别在于：    </p>
<table>
<thead>
<tr>
<th align="center">区别</th>
<th align="center"><code>buildSchema</code></th>
<th align="center"><code>graphql.GraphQLObjectType</code></th>
</tr>
</thead>
<tbody><tr>
<td align="center">参数类型</td>
<td align="center">字符串</td>
<td align="center">对象</td>
</tr>
<tr>
<td align="center">类名</td>
<td align="center">跟在 <code>type</code> 字符后面，这里是 <code>type Hero</code></td>
<td align="center">在参数对象的 <code>name</code> 属性上</td>
</tr>
<tr>
<td align="center">属性定义</td>
<td align="center">定义在类型后，<strong>键值对</strong>形式</td>
<td align="center">定义在参数对象 <code>fields</code> 属性中，值为对象，每个属性名为键名，值也是对象，其中 <code>type</code> 属性的值为 <code>graphql</code> 中的属性，下面会补充</td>
</tr>
</tbody></table>
<p>补充：<br><code>fields</code> 属性中的子属性的类型通常有：    </p>
<ul>
<li><code>graphql.GraphQLString</code>  </li>
<li><code>graphql.GraphQLInt</code></li>
<li><code>graphql.GraphQLBoolean</code><br>….</li>
</ul>
<p>即在 <code>GraphQL</code>后面跟上基本类型名称。    </p>
<h3 id="2-定义query（查询）"><a href="#2-定义query（查询）" class="headerlink" title="2. 定义query（查询）"></a>2. 定义query（查询）</h3><p>定义查询的时候，跟之前类似，可以参照下面对比图理解，这里比较不同的是，多了个 <code>resolve</code> 的方法，这个方法是用来执行处理查询的逻辑，其实就是之前的 <code>root</code> 中的方法。    </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> QueryType = <span class="keyword">new</span> graphql.GraphQLObjectType(&#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;Query&#x27;</span>,</span><br><span class="line">    <span class="attr">fields</span>: &#123;</span><br><span class="line">        <span class="comment">// 一个个查询方法</span></span><br><span class="line">        <span class="attr">getSuperHero</span>: &#123;</span><br><span class="line">            <span class="attr">type</span>: HeroType,</span><br><span class="line">            <span class="attr">args</span>: &#123;</span><br><span class="line">                <span class="attr">heroName</span>: &#123; <span class="attr">type</span>: graphql.GraphQLString &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">// 方法实现 查询的处理函数</span></span><br><span class="line">            <span class="attr">resolve</span>: <span class="function"><span class="keyword">function</span>(<span class="params">_, &#123; heroName &#125;</span>)</span>&#123;</span><br><span class="line">                <span class="keyword">const</span> name = heroName</span><br><span class="line">                <span class="keyword">const</span> age = <span class="number">18</span></span><br><span class="line">                <span class="keyword">return</span> &#123; name, age &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><img src="http://images.pingan8787.com/graphql_8.png" alt="graphql8">   </p>
<h3 id="3-创建-schema"><a href="#3-创建-schema" class="headerlink" title="3. 创建 schema"></a>3. 创建 schema</h3><p>创建的时候只需实例化并且将参数传入即可：  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// step3 构造 schema</span></span><br><span class="line"><span class="keyword">const</span> schema = <span class="keyword">new</span> graphql.GraphQLSchema(&#123; <span class="attr">query</span>: QueryType&#125;)</span><br></pre></td></tr></table></figure>

<p>最后使用也是和前面一样：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> app = express()</span><br><span class="line"></span><br><span class="line">app.use(<span class="string">&#x27;/graphql&#x27;</span>, graphqlHTTP(&#123;</span><br><span class="line">    schema,</span><br><span class="line">    <span class="attr">graphiql</span>: <span class="literal">true</span></span><br><span class="line">&#125;))</span><br><span class="line">app.listen(<span class="number">3000</span>)</span><br></pre></td></tr></table></figure>


<h2 id="九、与数据库结合实战"><a href="#九、与数据库结合实战" class="headerlink" title="九、与数据库结合实战"></a>九、与数据库结合实战</h2><p>我们试着使用前面所学的内容，开发一个简单的实践项目：<br>通过 <code>GraphiQL</code> 页面，往 <code>Mongodb</code> 中插入和更新数据，主要用到【六、使用Mutations修改数据】章节的操作。    </p>
<h3 id="1-搭建并启动本地-Mongodb-数据库"><a href="#1-搭建并启动本地-Mongodb-数据库" class="headerlink" title="1. 搭建并启动本地 Mongodb 数据库"></a>1. 搭建并启动本地 Mongodb 数据库</h3><p>首先我们可以到 <a target="_blank" rel="noopener" href="https://www.mongodb.com/download-center">Mongodb 官网</a> 选择对应平台和版本下载安装。    </p>
<blockquote>
<p>下载安装步骤，可以参考 <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_43288085/article/details/83187440">mongoDB下载、安装和配置</a>，这里就不多介绍哟~~   </p>
</blockquote>
<p>安装完成后，我们打开两个终端，分别执行下面两行命令：   </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 终端1  启动数据库</span><br><span class="line">mongod --dbpath c:\leo\app\mongodb\data\db</span><br><span class="line"></span><br><span class="line">// 终端2  进入数据库命令行操作模式</span><br><span class="line">mongo</span><br></pre></td></tr></table></figure>

<h3 id="2-连接数据库，创建-Schema-和-Model"><a href="#2-连接数据库，创建-Schema-和-Model" class="headerlink" title="2. 连接数据库，创建 Schema 和 Model"></a>2. 连接数据库，创建 Schema 和 Model</h3><p>首先我们新建一个文件 <code>db.js</code> ，并 <code>npm install mongoose</code> 安装 <code>mongoose</code> ，然后写入下面代码，实现<strong>连接数据库</strong>：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> &#123; buildSchema &#125; = <span class="built_in">require</span>(<span class="string">&#x27;graphql&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> graphqlHTTP = <span class="built_in">require</span>(<span class="string">&#x27;express-graphql&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> mongoose = <span class="built_in">require</span>(<span class="string">&#x27;mongoose&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> DB_PATH = <span class="string">&#x27;mongodb://127.0.0.1:27017/hero_table&#x27;</span></span><br><span class="line"><span class="keyword">const</span> connect = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 连接数据库</span></span><br><span class="line">    mongoose.connect(DB_PATH)</span><br><span class="line">    <span class="comment">// 连接断开</span></span><br><span class="line">    mongoose.connection.on(<span class="string">&#x27;disconnected&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        mongoose.connect(DB_PATH)</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// 连接失败</span></span><br><span class="line">    mongoose.connection.on(<span class="string">&#x27;error&#x27;</span>, <span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.error(err)</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// 连接成功</span></span><br><span class="line">    mongoose.connection.on(<span class="string">&#x27;connected&#x27;</span>, <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;Connected to MongoDB connected&#x27;</span>, DB_PATH)</span><br><span class="line">    &#125;)  </span><br><span class="line">&#125;</span><br><span class="line">connect()</span><br></pre></td></tr></table></figure>

<p>然后创建 <code>Schema</code> 和 <code>Model</code>：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> HeroSchema = <span class="keyword">new</span> mongoose.Schema(&#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">String</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="built_in">Number</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">let</span> HeroModel = mongoose.model(<span class="string">&#x27;hero&#x27;</span>,HeroSchema, <span class="string">&#x27;hero_table&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="3-声明查询语句"><a href="#3-声明查询语句" class="headerlink" title="3. 声明查询语句"></a>3. 声明查询语句</h3><p>这一步，还是先使用【六、使用Mutations修改数据】章节的操作逻辑，也就是先用<strong>字符串创建查询</strong>，而不使用 <code>GraphQLObjectType</code> 创建：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> schema = buildSchema(<span class="string">`</span></span><br><span class="line"><span class="string">    # 输入类型 用 input 标识</span></span><br><span class="line"><span class="string">    input HeroInput &#123;</span></span><br><span class="line"><span class="string">        name: String</span></span><br><span class="line"><span class="string">        age: Int</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    # 查询类型</span></span><br><span class="line"><span class="string">    type Hero &#123;</span></span><br><span class="line"><span class="string">        name: String</span></span><br><span class="line"><span class="string">        age: Int</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    type Mutation &#123;</span></span><br><span class="line"><span class="string">        createHero(input: HeroInput): Hero </span></span><br><span class="line"><span class="string">        updateHero(hero: String!, input: HeroInput): Hero</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    # 需要至少定义一个 Query 不要GraphiQL会不显示查询</span></span><br><span class="line"><span class="string">    type Query &#123;</span></span><br><span class="line"><span class="string">        hero: [Hero]</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">`</span>)</span><br></pre></td></tr></table></figure>
<p><strong>这边案例有稍作修改</strong>   </p>
<h3 id="4-实现添加数据和更新数据的逻辑"><a href="#4-实现添加数据和更新数据的逻辑" class="headerlink" title="4. 实现添加数据和更新数据的逻辑"></a>4. 实现添加数据和更新数据的逻辑</h3><p>这边处理添加数据和更新数据的逻辑，就要修改之前声明的 <code>root</code> 的操作内容了：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> root = &#123;</span><br><span class="line">    <span class="function"><span class="title">hero</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>( <span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">            HeroModel.find(<span class="function">(<span class="params">err, res</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span>(err) &#123;</span><br><span class="line">                    reject(err)</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line">                &#125;</span><br><span class="line">                resolve(res)</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="title">createHero</span>(<span class="params">&#123; input &#125;</span>)</span> &#123;</span><br><span class="line">        <span class="comment">// 实例化一个Model</span></span><br><span class="line">        <span class="keyword">const</span> &#123; name, age &#125; = input</span><br><span class="line">        <span class="keyword">const</span> params = <span class="keyword">new</span> HeroModel(&#123; name, age &#125;)</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>( <span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">            params.save(<span class="function">(<span class="params">err, res</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span>(err) &#123;</span><br><span class="line">                    reject(err)</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line">                &#125;</span><br><span class="line">                resolve(res)</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="title">updateHero</span>(<span class="params">&#123; hero, input &#125;</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; age &#125; = input</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span> (<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">            HeroModel.update(&#123;<span class="attr">name</span>: hero&#125;, &#123;age&#125;, <span class="function">(<span class="params">err, res</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span>(err) &#123;</span><br><span class="line">                    reject(err)</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line">                &#125;</span><br><span class="line">                resolve(res)</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-模拟测试"><a href="#5-模拟测试" class="headerlink" title="5. 模拟测试"></a>5. 模拟测试</h3><p>最后我们在 <code>GraphiQL</code> 页面上模拟测试一下，首先添加两个英雄，钢铁侠和美国队长，并设置他们的 <code>age / name</code> 属性：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mutation &#123;</span><br><span class="line">    <span class="function"><span class="title">createHero</span>(<span class="params">input: &#123;</span></span></span><br><span class="line"><span class="params"><span class="function">        name: <span class="string">&quot;钢铁侠&quot;</span></span></span></span><br><span class="line"><span class="params"><span class="function">        age: <span class="number">40</span></span></span></span><br><span class="line"><span class="params"><span class="function">    &#125;</span>)</span>&#123;</span><br><span class="line">        name</span><br><span class="line">        age</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mutation &#123;</span><br><span class="line">    <span class="function"><span class="title">createHero</span>(<span class="params">input: &#123;</span></span></span><br><span class="line"><span class="params"><span class="function">        name: <span class="string">&quot;美国队长&quot;</span></span></span></span><br><span class="line"><span class="params"><span class="function">        age: <span class="number">20</span></span></span></span><br><span class="line"><span class="params"><span class="function">    &#125;</span>)</span>&#123;</span><br><span class="line">        name</span><br><span class="line">        age</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>页面和接口没有报错，说明我们添加成功，数据库中也有这两条数据了：   </p>
<p><img src="http://images.pingan8787.com/graphql_10.png" alt="graphql10">     </p>
<p>在测试下查询：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">query &#123;</span><br><span class="line">    hero &#123;</span><br><span class="line">        name</span><br><span class="line">        age</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="http://images.pingan8787.com/graphql_11.png" alt="graphql11">   </p>
<p>查询也正常，接下来测试下更新，将美国队长的 <code>age</code> 修改为 60：      </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mutation &#123;</span><br><span class="line">    <span class="function"><span class="title">updateHero</span>(<span class="params">hero: <span class="string">&quot;美国队长&quot;</span>, input: &#123;</span></span></span><br><span class="line"><span class="params"><span class="function">        age: <span class="number">60</span></span></span></span><br><span class="line"><span class="params"><span class="function">    &#125;</span>)</span>&#123;</span><br><span class="line">        age</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="http://images.pingan8787.com/graphql_12.png" alt="graphql12">   </p>
<p>到这一步，我们也算是将这个练习做完了。    </p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ul>
<li><p><code>GraphQL</code> 是一种 <strong>API 的查询语言</strong>，是 REST API 的替代品。 </p>
</li>
<li><p><code>GraphQL</code> 可以使用一个请求，获取所有想要的数据。    </p>
</li>
<li><p>创建查询的方式有两种：使用 <code>buildSchema</code> 或者 <code>GraphQLObjectType</code>。   </p>
</li>
<li><p>查询操作用 <code>Query</code>，修改操作用 <code>Mutations</code>。   </p>
</li>
<li><p>查询类型用 <code>type</code> ，输入类型用 <code>input</code>。  </p>
</li>
</ul>
<p>其实 <code>GraphQL</code> 还是很简单好用的呢~~~</p>
<hr>
<blockquote>
<p>本文首发在 <a target="_blank" rel="noopener" href="http://www.pingan8787.com/">pingan8787个人博客</a>，如需转载请保留个人介绍</p>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/05/10/160-%E3%80%90GraphQL%E3%80%91GraphQL%E7%9C%9F%E9%A6%99%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/" data-id="ckts3ejy400m04d9kb7an3nb1" data-title="160-【GraphQL】GraphQL真香入门教程" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/GraphQL/" rel="tag">GraphQL</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/" rel="tag">JavaScript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" rel="tag">前端开发</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2019/05/20/161-%E3%80%90%E7%AE%97%E6%B3%95%E3%80%91%E6%AF%8F%E5%91%A8%E4%B8%80%E7%BB%83%E4%B9%8B%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%EF%BC%88Dictionary%E5%92%8CHashTable%EF%BC%89/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          161-【算法】每周一练之数据结构与算法（Dictionary和HashTable）
        
      </div>
    </a>
  
  
    <a href="/2019/05/06/159-%E3%80%90%E7%AE%97%E6%B3%95%E3%80%91%E6%AF%8F%E5%91%A8%E4%B8%80%E7%BB%83%E4%B9%8B%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%EF%BC%88Set%EF%BC%89/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">159-【算法】每周一练之数据结构与算法（Set）</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Angular/" rel="tag">Angular</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CSS/" rel="tag">CSS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CSS%E5%8A%A8%E7%94%BB/" rel="tag">CSS动画</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Chrome/" rel="tag">Chrome</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ES6-ES7-ES8/" rel="tag">ES6/ES7/ES8</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Eslint/" rel="tag">Eslint</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Express/" rel="tag">Express</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GraphQL/" rel="tag">GraphQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/H5/" rel="tag">H5</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTML/" rel="tag">HTML</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTTP/" rel="tag">HTTP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTTP%E5%8D%8F%E8%AE%AE/" rel="tag">HTTP协议</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hybrid/" rel="tag">Hybrid</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaScript/" rel="tag">JavaScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NPM/" rel="tag">NPM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nodejs/" rel="tag">Nodejs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Numpy/" rel="tag">Numpy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/" rel="tag">Python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/React/" rel="tag">React</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Tensorflow/" rel="tag">Tensorflow</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TyeScript/" rel="tag">TyeScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TypeScript/" rel="tag">TypeScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vuejs/" rel="tag">Vuejs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WebSocket/" rel="tag">WebSocket</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Webpack/" rel="tag">Webpack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/demo/" rel="tag">demo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%AD%E9%97%B4%E4%BB%B6/" rel="tag">中间件</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/" rel="tag">人工智能</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91/" rel="tag">全栈开发</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" rel="tag">前端开发</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E6%8E%A2%E7%B4%A2/" rel="tag">前端探索</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF%E7%9F%A5%E4%B9%8E%E7%B3%BB%E5%88%97/" rel="tag">前端知乎系列</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8E%9F%E5%88%9B/" rel="tag">原创</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B8%B8%E7%94%A8%E6%8A%80%E6%9C%AF/" rel="tag">常用技术</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BE%AE%E5%89%8D%E7%AB%AF/" rel="tag">微前端</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%80%BB%E7%BB%93/" rel="tag">总结</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" rel="tag">数据结构</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" rel="tag">机器学习</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/" rel="tag">构建工具</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" rel="tag">正则表达式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%BA%90%E7%A0%81/" rel="tag">源码</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%BA%90%E7%A0%81%E7%B2%BE%E8%AF%BB/" rel="tag">源码精读</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%83%AD%E9%97%A8/" rel="tag">热门</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%94%9F%E6%B4%BB%E6%9D%82%E8%AE%B0/" rel="tag">生活杂记</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/" rel="tag">编译原理</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82/" rel="tag">网络请求</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" rel="tag">设计模式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" rel="tag">读书笔记</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%87%8D%E6%B8%A9%E5%9F%BA%E7%A1%80/" rel="tag">重温基础</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9D%A2%E8%AF%95%E9%A2%98/" rel="tag">面试题</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Angular/" style="font-size: 11.88px;">Angular</a> <a href="/tags/CSS/" style="font-size: 18.13px;">CSS</a> <a href="/tags/CSS%E5%8A%A8%E7%94%BB/" style="font-size: 12.5px;">CSS动画</a> <a href="/tags/Chrome/" style="font-size: 10px;">Chrome</a> <a href="/tags/ES6-ES7-ES8/" style="font-size: 10.63px;">ES6/ES7/ES8</a> <a href="/tags/Eslint/" style="font-size: 10px;">Eslint</a> <a href="/tags/Express/" style="font-size: 10px;">Express</a> <a href="/tags/GraphQL/" style="font-size: 10px;">GraphQL</a> <a href="/tags/H5/" style="font-size: 10px;">H5</a> <a href="/tags/HTML/" style="font-size: 10px;">HTML</a> <a href="/tags/HTTP/" style="font-size: 11.88px;">HTTP</a> <a href="/tags/HTTP%E5%8D%8F%E8%AE%AE/" style="font-size: 11.25px;">HTTP协议</a> <a href="/tags/Hybrid/" style="font-size: 10.63px;">Hybrid</a> <a href="/tags/JavaScript/" style="font-size: 19.38px;">JavaScript</a> <a href="/tags/NPM/" style="font-size: 10px;">NPM</a> <a href="/tags/Nodejs/" style="font-size: 11.25px;">Nodejs</a> <a href="/tags/Numpy/" style="font-size: 10.63px;">Numpy</a> <a href="/tags/Python/" style="font-size: 17.5px;">Python</a> <a href="/tags/React/" style="font-size: 12.5px;">React</a> <a href="/tags/Tensorflow/" style="font-size: 10.63px;">Tensorflow</a> <a href="/tags/TyeScript/" style="font-size: 10px;">TyeScript</a> <a href="/tags/TypeScript/" style="font-size: 11.25px;">TypeScript</a> <a href="/tags/Vuejs/" style="font-size: 14.38px;">Vuejs</a> <a href="/tags/WebSocket/" style="font-size: 10px;">WebSocket</a> <a href="/tags/Webpack/" style="font-size: 15.63px;">Webpack</a> <a href="/tags/demo/" style="font-size: 10.63px;">demo</a> <a href="/tags/%E4%B8%AD%E9%97%B4%E4%BB%B6/" style="font-size: 10px;">中间件</a> <a href="/tags/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/" style="font-size: 16.25px;">人工智能</a> <a href="/tags/%E5%85%A8%E6%A0%88%E5%BC%80%E5%8F%91/" style="font-size: 11.25px;">全栈开发</a> <a href="/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" style="font-size: 20px;">前端开发</a> <a href="/tags/%E5%89%8D%E7%AB%AF%E6%8E%A2%E7%B4%A2/" style="font-size: 11.25px;">前端探索</a> <a href="/tags/%E5%89%8D%E7%AB%AF%E7%9F%A5%E4%B9%8E%E7%B3%BB%E5%88%97/" style="font-size: 10.63px;">前端知乎系列</a> <a href="/tags/%E5%8E%9F%E5%88%9B/" style="font-size: 18.75px;">原创</a> <a href="/tags/%E5%B8%B8%E7%94%A8%E6%8A%80%E6%9C%AF/" style="font-size: 10.63px;">常用技术</a> <a href="/tags/%E5%BE%AE%E5%89%8D%E7%AB%AF/" style="font-size: 10px;">微前端</a> <a href="/tags/%E6%80%BB%E7%BB%93/" style="font-size: 13.75px;">总结</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" style="font-size: 10px;">数据结构</a> <a href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" style="font-size: 15px;">机器学习</a> <a href="/tags/%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/" style="font-size: 10.63px;">构建工具</a> <a href="/tags/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" style="font-size: 10.63px;">正则表达式</a> <a href="/tags/%E6%BA%90%E7%A0%81/" style="font-size: 10px;">源码</a> <a href="/tags/%E6%BA%90%E7%A0%81%E7%B2%BE%E8%AF%BB/" style="font-size: 10px;">源码精读</a> <a href="/tags/%E7%83%AD%E9%97%A8/" style="font-size: 10px;">热门</a> <a href="/tags/%E7%94%9F%E6%B4%BB%E6%9D%82%E8%AE%B0/" style="font-size: 10px;">生活杂记</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 13.13px;">算法</a> <a href="/tags/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/" style="font-size: 10px;">编译原理</a> <a href="/tags/%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82/" style="font-size: 10px;">网络请求</a> <a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" style="font-size: 15px;">设计模式</a> <a href="/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" style="font-size: 14.38px;">读书笔记</a> <a href="/tags/%E9%87%8D%E6%B8%A9%E5%9F%BA%E7%A1%80/" style="font-size: 16.88px;">重温基础</a> <a href="/tags/%E9%9D%A2%E8%AF%95%E9%A2%98/" style="font-size: 10px;">面试题</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">May 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">March 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">September 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">June 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">May 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">April 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/07/28/227-%E3%80%90%E6%80%BB%E7%BB%93%E3%80%91%E5%A6%82%E4%BD%95%E4%BC%98%E9%9B%85%E7%9A%84%E5%9C%A8%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E4%BD%BF%E7%94%A8SVG%E5%AD%97%E4%BD%93%E5%9B%BE%E6%A0%87/">227-【总结】如何优雅的在微信小程序使用SVG字体图标</a>
          </li>
        
          <li>
            <a href="/2021/07/28/226-%E3%80%90HTTP%E3%80%91%E5%A6%82%E4%BD%95%E4%BC%98%E9%9B%85%E7%9A%84%E7%AE%A1%E7%90%86HTTP%E8%AF%B7%E6%B1%82%E5%92%8C%E5%93%8D%E5%BA%94%E6%8B%A6%E6%88%AA%E5%99%A8%EF%BC%9F/">226-【HTTP】如何优雅的管理HTTP请求和响应拦截器？</a>
          </li>
        
          <li>
            <a href="/2021/07/28/225-%E3%80%90Vue%E3%80%91%E4%BB%8E%E6%89%8B%E5%86%99Vue3%E7%9A%84Reactivity%E5%BC%80%E5%A7%8B%E6%B7%B1%E5%85%A5Vue3%E6%BA%90%E7%A0%81/">225-【Vue】从手写Vue3的Reactivity开始深入Vue3源码</a>
          </li>
        
          <li>
            <a href="/2021/05/30/224-%E3%80%90Chrome%E3%80%915%E4%B8%AAChrome%E8%B0%83%E8%AF%95%E6%B7%B7%E5%90%88%E5%BA%94%E7%94%A8%E7%9A%84%E6%8A%80%E5%B7%A7/">224-【Chrome】5个Chrome调试混合应用的技巧</a>
          </li>
        
          <li>
            <a href="/2021/03/19/223-%E3%80%90%E5%89%8D%E7%AB%AF%E6%8E%A2%E7%B4%A2%E3%80%91%E6%8E%A2%E7%B4%A2Snabbdom%E6%A8%A1%E5%9D%97%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86/">223-【前端探索】探索Snabbdom模块系统原理</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>