<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author"><meta name="description" content="王平安个人博客,pingan8787,前端开发,人工智能,AI,深度学习,前端框架vue,angular,react,nodejs,python,numpy,pandas,anaconda,Tensorflow,高等数学,概率论,统计学神经网络,"><title>144-【CuteJavaScript】Angular6入门项目（3.编写服务和引入RxJS） · pingan8787</title><meta name="description" content="Author
王平安



E-mail
&amp;#x70;&amp;#105;&amp;#x6e;&amp;#103;&amp;#97;&amp;#110;&amp;#56;&amp;#55;&amp;#56;&amp;#x37;&amp;#64;&amp;#x71;&amp;#113;&amp;#x2e;&amp;#x63;&amp;#x6f;&amp;#x6d;


博  客
www.pingan8787.com


微  "><meta name="keywords"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="/images/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"><script type="text/javascript" src="http://tjs.sjs.sinajs.cn/open/api/js/wb.js"></script><script type="text/javascript" src="https://hm.baidu.com/hm.js?de7c89214c05d551ef3ec12341cd0b9e"></script><meta name="generator" content="Hexo 5.4.0"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/images/logo@2x.png" style="width:127px;border-radius:15px;"><h3 title=""><a href="/">pingan8787</a></h3></div></div><ul class="my_tages_ul clearfix"><li class="my_tages_li next pagbuttons"><a class="btn" target="_blank" rel="noopener" href="http://www.pingan8787.com/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/"> 前端开发</a></li><li class="my_tages_li next pagbuttons"><a class="btn btn" target="_blank" rel="noopener" href="http://www.pingan8787.com/tags/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/"> 人工智能</a></li><li class="my_tages_li next pagbuttons"><a class="btn btn" target="_blank" rel="noopener" href="http://www.pingan8787.com/tags/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/"> 深度学习</a></li></ul><ul class="my_icon"><li class="my_icon_li"><a target="_blank" rel="noopener" href="https://github.com/pingan8787" title="github"><img src="http://images.pingan8787.com/assets/icon_26_github.png" alt="github"></a></li><li class="my_icon_li"><a target="_blank" rel="noopener" href="https://www.yuque.com/wangpingan/cute-frontend" title="语雀"><img src="http://images.pingan8787.com/assets/icon_26_yuque.png" alt="语雀"></a></li><li class="my_icon_li"><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/cute-javascript" title="知乎"><img src="http://images.pingan8787.com/icon_zhihu.png" alt="知乎"></a></li><li class="my_icon_li"><a target="_blank" rel="noopener" href="https://juejin.im/user/586fc337a22b9d0058807d53/posts" title="掘金"><img src="http://images.pingan8787.com/icon_juejin.png" alt="掘金"></a></li><li class="my_icon_li"><a target="_blank" rel="noopener" href="https://segmentfault.com/blog/pingan8787" title="思否"><img src="http://images.pingan8787.com/icon_sf.png" alt="思否"></a></li><li class="my_icon_li"><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_36380426" title="CSDN"><img src="http://images.pingan8787.com/icon_csdn.png" alt="CSDN"></a></li><li class="my_icon_li"><a target="_blank" rel="noopener" href="https://www.jianshu.com/u/2ec5d94afd60" title="简书"><img src="http://images.pingan8787.com/icon_jianshu.png" alt="简书"></a></li></ul><div style="text-align:center;"><wb:follow-button uid="1689651205" type="red_1" style="margin-top:10px;width:67px;height:24px;display: inline-block;"></wb:follow-button></div><ul class="social-links"></ul><div class="footer"><a target="_blank" href="/"><span>博客作者：</span></a><a href="https://github.com/pingan8787" target="_blank"> pingan8787（leo）</a><div class="by_farbox"> <a href="https://beian.miit.gov.cn/" target="_blank">备案编号：闽ICP备17012095号-1</a></div></div></div><s></s><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="/">Home</a></li><li><a href="/leo">关于Leo</a></li><li><a href="/production">作品</a></li><li><a href="/Catalog">目录</a></li><li><a href="http://js.pingan8787.com" target="_blank">Cute-JavaScript</a></li><li><a href="https://github.com/pingan8787" target="_blank">Github</a></li></div><!--.information//.back_btn
  //li
    //if is_post()
      //a.fa.fa-chevron-left(onclick="window.history.go(-1)") 
    //else
      //a.fa.fa-chevron-left(onclick="window.history.go(-1)",style="display:none;") 
//.avatar
//  img(src= url_for('images/logo@2x.png'))--></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>144-【CuteJavaScript】Angular6入门项目（3.编写服务和引入RxJS）</a></h3></div><div class="post-content"><p><img src="http://images.pingan8787.com/angular%E7%B3%BB%E5%88%97%E5%B0%81%E9%9D%A2.png" alt="Angular封面"></p>
<hr>
<table>
<thead>
<tr>
<th>Author</th>
<th>王平安</th>
</tr>
</thead>
<tbody><tr>
<td>E-mail</td>
<td><a href="mailto:&#x70;&#105;&#x6e;&#103;&#97;&#110;&#56;&#55;&#56;&#x37;&#64;&#x71;&#113;&#x2e;&#x63;&#x6f;&#x6d;">&#x70;&#105;&#x6e;&#103;&#97;&#110;&#56;&#55;&#56;&#x37;&#64;&#x71;&#113;&#x2e;&#x63;&#x6f;&#x6d;</a></td>
</tr>
<tr>
<td>博  客</td>
<td><a target="_blank" rel="noopener" href="http://www.pingan8787.com/">www.pingan8787.com</a></td>
</tr>
<tr>
<td>微  信</td>
<td>pingan8787</td>
</tr>
<tr>
<td>每日文章推荐</td>
<td><a target="_blank" rel="noopener" href="https://github.com/pingan8787/Leo_Reading/issues">https://github.com/pingan8787/Leo_Reading/issues</a></td>
</tr>
<tr>
<td>微信公众号</td>
<td>前端自习课</td>
</tr>
</tbody></table>
<h2 id="本文目录"><a href="#本文目录" class="headerlink" title="本文目录"></a>本文目录</h2><ul>
<li>一、<a target="_blank" rel="noopener" href="https://juejin.im/post/5c70ae586fb9a049c64476a0">项目起步</a></li>
<li>二、<a target="_blank" rel="noopener" href="https://juejin.im/post/5c70ae586fb9a049c64476a0">编写路由组件</a></li>
<li>三、<a target="_blank" rel="noopener" href="https://juejin.im/post/5c70b48d6fb9a04a0b22cbce">编写页面组件</a>   <ul>
<li>1.<a target="_blank" rel="noopener" href="https://juejin.im/post/5c70b48d6fb9a04a0b22cbce">编写单一组件</a></li>
<li>2.<a target="_blank" rel="noopener" href="https://juejin.im/post/5c70b48d6fb9a04a0b22cbce">模拟数据</a></li>
<li>3.<a target="_blank" rel="noopener" href="https://juejin.im/post/5c70b48d6fb9a04a0b22cbce">编写主从组件</a></li>
</ul>
</li>
<li>四、<strong>编写服务</strong><ul>
<li>1.<strong>为什么需要服务</strong></li>
<li>2.<strong>编写服务</strong></li>
</ul>
</li>
<li>五、<strong>引入RxJS</strong><ul>
<li>1.<strong>关于RxJS</strong></li>
<li>2.<strong>引入RxJS</strong></li>
<li>3.<strong>改造数据获取方式</strong></li>
</ul>
</li>
<li>六、改造组件<ul>
<li>1.添加历史记录组件</li>
<li>2.添加和删除历史记录</li>
</ul>
</li>
<li>七、HTTP改造<ul>
<li>1.引入HTTP</li>
<li>2.通过HTTP请求数据</li>
<li>3.通过HTTP修改数据</li>
<li>4.通过HTTP增加数据</li>
<li>5.通过HTTP删除数据</li>
<li>6.通过HTTP查找数据</li>
</ul>
</li>
</ul>
<h2 id="四、编写服务"><a href="#四、编写服务" class="headerlink" title="四、编写服务"></a>四、编写服务</h2><p>截止到这部分，我们的<code>BooksComponent</code>组件获取和显示的都是本地模拟的数据。<br>接下来我们要开始对这些进行重构，让聚焦于为它的视图提供支持，这也让它更容易使用模拟服务进行单元测试。    </p>
<h3 id="1-为什么需要服务"><a href="#1-为什么需要服务" class="headerlink" title="1.为什么需要服务"></a>1.为什么需要服务</h3><p>我们不应该让组件来直接获取或保存数据，它们应该聚焦于展示数据，而数据访问的工作交给其他服务来做。<br>这里我们需要创建一个名为<code>BooksService</code>的服务，让我们应用中所有的类都使用它来获取书本列表的数据，使用的时候，只需要将它通过Angular的<strong>依赖注入机制</strong>注入到需要用的组件的构造函数中。    </p>
<p><strong>知识点：</strong><br>服务可以实现多个不同组件之间信息共享，后面我们还会将它注入到两个地方：<br><code>BooksService</code>中，使用该服务发送消息。<br><code>IndexService</code>中，使用该服务来展示消息。   </p>
<p>接下来我们使用命令行，创建<code>BooksService </code>：  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ng g service books</span><br></pre></td></tr></table></figure>
<p>在生成的<code>books.service.ts</code>文件中：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// books.service.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; Injectable &#125; <span class="keyword">from</span> <span class="string">&#x27;@angular/core&#x27;</span>;</span><br><span class="line">@Injectable(&#123;</span><br><span class="line">  <span class="attr">providedIn</span>: <span class="string">&#x27;root&#x27;</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>新导入了<code>@Injectable</code>装饰器，是为了让<code>BooksService</code>提供一个可注入的服务，并且它还可以拥有自己的待注入的依赖，简单理解就是<strong>如果你的服务需要依赖，那么你就需要导入它</strong>。<br>并且它接收该服务的元数据对象。    </p>
<h3 id="2-编写服务"><a href="#2-编写服务" class="headerlink" title="2.编写服务"></a>2.编写服务</h3><p>接下来我们开始编写<code>books.service.ts</code>服务。    </p>
<ul>
<li>导入服务所需组件</li>
</ul>
<p>这里我们导入<code>Books</code>和<code>BookList</code>，并添加一个<code>getBooks</code>方法来返回所有书本的数据，并且还需要添加一个<code>getBooks</code>方法来返回指定id的书本信息:   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.component.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; Books &#125; <span class="keyword">from</span> <span class="string">&#x27;./books&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; BookList &#125; <span class="keyword">from</span> <span class="string">&#x27;./mock-books&#x27;</span>;</span><br><span class="line">@Injectable(&#123;</span><br><span class="line">  <span class="attr">providedIn</span>: <span class="string">&#x27;root&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">BooksService</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span> &#123; &#125;</span><br><span class="line">  getBookList(): Books[] &#123;</span><br><span class="line">    <span class="keyword">return</span> BookList;</span><br><span class="line">  &#125;</span><br><span class="line">  getBook(id: number): Books&#123;</span><br><span class="line">    <span class="keyword">return</span> BookList.find(<span class="function"><span class="params">book</span> =&gt;</span> book.id === id)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在我们使用这个服务之前，需要先注册该服务，因为我们在使用<code>ng g service books</code>命令创建服务时，CLI已经默认为我们添加了注册了，这是方法就是上面代码中的：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">providedIn: <span class="string">&#x27;root&#x27;</span></span><br></pre></td></tr></table></figure>
<p>表示将我们的服务注册在<strong>根注入器</strong>上，这样我们就可以把这个服务注入到任何享用的类上了。   </p>
<ul>
<li>修改<code>IndexComponent</code>   </li>
</ul>
<p>先删除<code>BookList</code>的引入，并修改<code>books</code>属性的定义：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.component.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; BooksService &#125; <span class="keyword">from</span> <span class="string">&#x27;../books.service&#x27;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">IndexComponent</span> <span class="title">implements</span> <span class="title">OnInit</span> </span>&#123;</span><br><span class="line">  <span class="attr">books</span> : Books[];</span><br><span class="line">  <span class="function"><span class="title">ngOnInit</span>(<span class="params"></span>)</span> &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后注入我们的<code>BooksService</code>服务，需要先往构造函数中添加一个私有的<code>booksservice</code>，使用注入的<code>BooksService</code>作为类型，理解成一个注入点：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.component.ts</span></span><br><span class="line"><span class="function"><span class="title">constructor</span>(<span class="params">private booksservice: BooksService</span>)</span> &#123; &#125;</span><br></pre></td></tr></table></figure>

<p>之后我们需要添加一个<code>getBooks</code>方法来获取这些书本数据，并在生命周期函数<code>ngOnInit</code>中调用：    </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">IndexComponent</span> <span class="title">implements</span> <span class="title">OnInit</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">ngOnInit</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.getBooks();</span><br><span class="line">  &#125;</span><br><span class="line">  getBooks(): <span class="keyword">void</span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.books = <span class="built_in">this</span>.booksservice.getBookList();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>修改<code>DetailComponent</code><br>我们先改造书本详情页的HTML结构：   <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- detail.component.html --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> *<span class="attr">ngIf</span>=<span class="string">&quot;books&quot;</span> <span class="attr">class</span>=<span class="string">&quot;detail&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h3</span>&gt;</span>《&#123;&#123;books.title&#125;&#125;》介绍<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;&#123;&#123;books.url&#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>书本标题: &#123;&#123;books.title&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>书本作者: &#123;&#123;books.author&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>书本id: &#123;&#123;books.id&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> *<span class="attr">ngIf</span>=<span class="string">&quot;!books&quot;</span> <span class="attr">class</span>=<span class="string">&quot;detail&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h3</span>&gt;</span>暂无信息<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>*知识点**：<br>这里使用了<code>*ngIf</code>指令，当条件为<code>true</code>则显示其HTML内容。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// detail.component.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; Books &#125; <span class="keyword">from</span> <span class="string">&#x27;../books&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; BooksService &#125; <span class="keyword">from</span> <span class="string">&#x27;../books.service&#x27;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">DetailComponent</span> <span class="title">implements</span> <span class="title">OnInit</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="function">    private route: ActivatedRoute,</span></span></span><br><span class="line"><span class="params"><span class="function">    private location: Location,</span></span></span><br><span class="line"><span class="params"><span class="function">    private booksservice: BooksService  <span class="comment">// 引入BooksService服务</span></span></span></span><br><span class="line"><span class="params"><span class="function">  </span>)</span> &#123; &#125;</span><br><span class="line"></span><br><span class="line">  <span class="attr">books</span>: Books;  <span class="comment">// 定义books类型</span></span><br><span class="line">  <span class="function"><span class="title">ngOnInit</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.getDetail()</span><br><span class="line">  &#125;</span><br><span class="line">  getDetail(): <span class="keyword">void</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> id = +<span class="built_in">this</span>.route.snapshot.paramMap.get(<span class="string">&#x27;id&#x27;</span>);</span><br><span class="line">    <span class="built_in">this</span>.getBooks(id);</span><br><span class="line">  &#125;</span><br><span class="line">  getBooks(id: number): <span class="keyword">void</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.books = <span class="built_in">this</span>.booksservice.getBook(id);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这段代码，主要定义了<code>getBooks</code>方法，当刚进入页面时，将书本<code>id</code>传入<code>getBooks</code>方法，去<code>BooksService</code>去获取对应id的书本信息，并复制给变量<code>books</code>，然后展示到页面。   </p>
<p>改造之后，我们的页面显示依旧正常。   </p>
<p><img src="http://images.pingan8787.com/angular_books_3_2.png" alt="图片3-2"></p>
<p>但是我们要知道，这背后的逻辑已经改变了。   </p>
<h2 id="五、引入RxJS改造项目"><a href="#五、引入RxJS改造项目" class="headerlink" title="五、引入RxJS改造项目"></a>五、引入RxJS改造项目</h2><h3 id="1-关于RxJS"><a href="#1-关于RxJS" class="headerlink" title="1.关于RxJS"></a>1.关于RxJS</h3><p>这里简单介绍关键概念，具体可以查看 <a target="_blank" rel="noopener" href="https://rxjs.dev/">RxJS 官网</a>，也可以参考 <a target="_blank" rel="noopener" href="https://www.jianshu.com/p/36d85f8cafdd">浅析Angular之RxJS</a>。    </p>
<h4 id="什么是RxJS"><a href="#什么是RxJS" class="headerlink" title="什么是RxJS"></a>什么是RxJS</h4><p>RxJS全称<code>Reactive Extensions for JavaScript</code>，中文意思: JavaScript的响应式扩展。<br>RxJS主要是提供一种更加强大和优雅的方式，来利用响应式编程的模式，实现JavaScript的异步编程。   </p>
<h4 id="RxJS优点"><a href="#RxJS优点" class="headerlink" title="RxJS优点"></a>RxJS优点</h4><ul>
<li>纯净性；   </li>
<li>流动性；    </li>
</ul>
<h4 id="RxJS核心概念"><a href="#RxJS核心概念" class="headerlink" title="RxJS核心概念"></a>RxJS核心概念</h4><p>RxJS 是基于观察者模式和迭代器模式以函数式编程思维来实现的。RxJS 中含有两个基本概念：<code>Observables</code> 与 <code>Observer</code>。<br><code>Observables</code> 作为被观察者，是一个值或事件的流集合；而 <code>Observer</code> 则作为观察者，根据 <code>Observables</code> 进行处理。它们之间的订阅发布关系(观察者模式) 如下：<br><strong>订阅</strong>：<code>Observer</code> 通过 <code>Observable</code> 提供的 <code>subscribe()</code> 方法订阅 <code>Observable</code>。<br><strong>发布</strong>：<code>Observable</code> 通过回调 <code>next</code> 方法向 <code>Observer</code> 发布事件。   </p>
<p>———— 来源<a target="_blank" rel="noopener" href="http://www.semlinker.com/rxjs-observable/">Angular修仙之路 RxJS Observable</a> </p>
<p>另外这里列出来一些核心，具体还是看官网咯，并且下面使用到的时候会具体介绍。   </p>
<ul>
<li><code>Observable</code> (可观察对象): 表示一个概念，这个概念是一个可调用的未来值或事件的集合。   </li>
<li><code>Observer</code>(观察者): 一个回调函数的集合，它知道如何去监听由 <code>Observable</code> 提供的值。    </li>
<li><code>Subscription</code> (订阅): 表示 <code>Observable</code> 的执行，主要用于取消 <code>Observable</code> 的执行。    </li>
<li><code>Operators</code> (操作符): 采用函数式编程风格的纯函数 (<code>pure function</code>)，使用像 <code>map</code>、<code>filter</code>、<code>concat</code>、<code>flatMap</code> 等这样的操作符来处理集合。   </li>
<li><code>Subject</code> (主体): 相当于 <code>EventEmitter</code>，并且是将值或事件多路推送给多个 <code>Observer</code> 的唯一方式。   </li>
<li><code>Schedulers</code> (调度器): 用来控制并发并且是中央集权的调度员，允许我们在发生计算时进行协调，例如 <code>setTimeout</code> 或<code>requestAnimationFrame</code>或其他。   </li>
</ul>
<h3 id="2-引入RxJS"><a href="#2-引入RxJS" class="headerlink" title="2.引入RxJS"></a>2.引入RxJS</h3><p>在我们的真实应用中，我们必须要等到服务器响应后，我们才能获取到数据，因此这天生就需要用异步思维来操作。   </p>
<p>由于Angular中已经自带RxJS，所以我们只要在需要使用的时候，引入即可使用：   </p>
<h3 id="3-改造数据获取方式"><a href="#3-改造数据获取方式" class="headerlink" title="3.改造数据获取方式"></a>3.改造数据获取方式</h3><p>了解完RxJS的一些概念后，我们开始改造下这些书本的数据获取方式。   </p>
<ul>
<li>改造<code>BooksService</code>   </li>
</ul>
<p>首先我们从 RxJS 中导入 <code>Observable</code> 和 <code>of</code> 符号：   </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// books.service.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; Observable, <span class="keyword">of</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;rxjs&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p><strong>知识点</strong>：<br><code>Observable</code>:  观察者模式中的观察者，具体可以参考 <a target="_blank" rel="noopener" href="http://www.semlinker.com/rxjs-observable/">Angular修仙之路 RxJS Observable</a><br><code>of</code>:  用来获取观察者拿到的数据，通常是一个<code>Observable</code>。   </p>
<p>然后修改<code>getBookList</code>方法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// books.service.ts</span></span><br><span class="line">getBookList(): Observable&lt;Books[]&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">of</span>(BookList);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里 <code>of(BookList)</code> 返回一个<code> Observable&lt;Books[]&gt;</code>，它会发出单个值，这个值就是这些模拟书本的数组。   </p>
<ul>
<li>改造<code>IndexComponent</code>   </li>
</ul>
<p>这里也要修改<code>getBooks</code>方法，使用<code>subscribe</code>去订阅服务返回回来的值：    </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.component.ts</span></span><br><span class="line">getBooks(): <span class="keyword">void</span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.booksservice.getBookList()</span><br><span class="line">    .subscribe(<span class="function"><span class="params">books</span> =&gt;</span> <span class="built_in">this</span>.books = books);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>由于原本直接赋值数据，在实际场景中是不可能这样同步的，所以这里<code>subscribe</code>函数，会在<code>Observable</code>发出数据以后，再把书本列表传到里面的回调函数，再复制给<code>books</code>属性。<br>使用这种异步方式，当 <code>BooksService</code> 从远端服务器获取英雄数据时，不用担心还没拿到数据就执行后面。   </p>
<p>下一步，我们就要改造一下项目了。   </p>
<p><strong>本部分内容到这结束</strong></p>
<table>
<thead>
<tr>
<th>Author</th>
<th>王平安</th>
</tr>
</thead>
<tbody><tr>
<td>E-mail</td>
<td><a href="mailto:&#x70;&#105;&#110;&#103;&#97;&#x6e;&#x38;&#x37;&#56;&#55;&#64;&#113;&#113;&#x2e;&#x63;&#111;&#109;">&#x70;&#105;&#110;&#103;&#97;&#x6e;&#x38;&#x37;&#56;&#55;&#64;&#113;&#113;&#x2e;&#x63;&#111;&#109;</a></td>
</tr>
<tr>
<td>博  客</td>
<td><a target="_blank" rel="noopener" href="http://www.pingan8787.com/">www.pingan8787.com</a></td>
</tr>
<tr>
<td>微  信</td>
<td>pingan8787</td>
</tr>
<tr>
<td>每日文章推荐</td>
<td><a target="_blank" rel="noopener" href="https://github.com/pingan8787/Leo_Reading/issues">https://github.com/pingan8787/Leo_Reading/issues</a></td>
</tr>
<tr>
<td>JS小册</td>
<td>js.pingan8787.com</td>
</tr>
<tr>
<td>微信公众号</td>
<td>前端自习课</td>
</tr>
</tbody></table>
<p><img src="http://images.pingan8787.com/2019_07_12guild_page.png" alt="bg">  </p>
</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2019-02-23</span><i class="fa fa-tag"></i><a class="tag" href="/tags/前端开发/" title="前端开发">前端开发 </a><a class="tag" href="/tags/JavaScript/" title="JavaScript">JavaScript </a><a class="tag" href="/tags/原创/" title="原创">原创 </a><a class="tag" href="/tags/Angular/" title="Angular">Angular </a></div></div></div></div><div class="share"><div class="evernote"><a class="fa fa-bookmark" href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title);}})();" ref="nofollow" target="_blank"></a></div><div class="weibo"><a class="fa fa-weibo" href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));"></a></div><div class="twitter"><a class="fa fa-twitter" target="_blank" rel="noopener" href="http://twitter.com/home?status=,https://pingan8787.github.io/2019/02/23/144-【CuteJavaScript】Angular6入门项目（3-编写服务和引入RxJS）/,pingan8787,144-【CuteJavaScript】Angular6入门项目（3.编写服务和引入RxJS）,;"></a></div></div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a class="btn" role="navigation" href="/2019/02/23/145-%E3%80%90CuteJavaScript%E3%80%91Angular6%E5%85%A5%E9%97%A8%E9%A1%B9%E7%9B%AE%EF%BC%884-%E6%94%B9%E9%80%A0%E7%BB%84%E4%BB%B6%E5%92%8C%E6%B7%BB%E5%8A%A0HTTP%E6%9C%8D%E5%8A%A1%EF%BC%89/" title="145-【CuteJavaScript】Angular6入门项目（4.改造组件和添加HTTP服务）">Post Anterior</a></li><li class="next pagbuttons"><a class="btn" role="navigation" href="/2019/02/23/143-%E3%80%90CuteJavaScript%E3%80%91Angular6%E5%85%A5%E9%97%A8%E9%A1%B9%E7%9B%AE%EF%BC%882-%E6%9E%84%E5%BB%BA%E9%A1%B9%E7%9B%AE%E9%A1%B5%E9%9D%A2%E5%92%8C%E7%BB%84%E4%BB%B6%EF%BC%89/" title="143-【CuteJavaScript】Angular6入门项目（2.构建项目页面和组件）">Próximo post</a></li></ul></div></div></div></div></div><script src="/js/jquery.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script></body></html>