<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author"><meta name="description" content="王平安个人博客,pingan8787,前端开发,人工智能,AI,深度学习,前端框架vue,angular,react,nodejs,python,numpy,pandas,anaconda,Tensorflow,高等数学,概率论,统计学神经网络,"><title>227-【总结】如何优雅的在微信小程序使用SVG字体图标 · pingan8787</title><meta name="description" content="本文思路来自实际项目的重构总结，欢迎纠正和交流。如果对你有帮助，还请点赞👍收藏支持一下啦。

最近在重构一个项目，主要是做 H5 端和小程序端，这次打算开始多做总结啦，之前已经总结一篇《如何优雅的管理 HTTP 请求和响应拦截器？》 。
如果大家还有其他方案，欢迎一起探讨哈~ 喜欢本文的朋友给个赞"><meta name="keywords"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="/images/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"><script type="text/javascript" src="http://tjs.sjs.sinajs.cn/open/api/js/wb.js"></script><script type="text/javascript" src="https://hm.baidu.com/hm.js?de7c89214c05d551ef3ec12341cd0b9e"></script><meta name="generator" content="Hexo 5.4.0"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/images/logo@2x.png" style="width:127px;border-radius:15px;"><h3 title=""><a href="/">pingan8787</a></h3></div></div><ul class="my_tages_ul clearfix"><li class="my_tages_li next pagbuttons"><a class="btn" target="_blank" rel="noopener" href="http://www.pingan8787.com/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/"> 前端开发</a></li><li class="my_tages_li next pagbuttons"><a class="btn btn" target="_blank" rel="noopener" href="http://www.pingan8787.com/tags/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/"> 人工智能</a></li><li class="my_tages_li next pagbuttons"><a class="btn btn" target="_blank" rel="noopener" href="http://www.pingan8787.com/tags/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/"> 深度学习</a></li></ul><ul class="my_icon"><li class="my_icon_li"><a target="_blank" rel="noopener" href="https://github.com/pingan8787" title="github"><img src="http://images.pingan8787.com/assets/icon_26_github.png" alt="github"></a></li><li class="my_icon_li"><a target="_blank" rel="noopener" href="https://www.yuque.com/wangpingan/cute-frontend" title="语雀"><img src="http://images.pingan8787.com/assets/icon_26_yuque.png" alt="语雀"></a></li><li class="my_icon_li"><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/cute-javascript" title="知乎"><img src="http://images.pingan8787.com/icon_zhihu.png" alt="知乎"></a></li><li class="my_icon_li"><a target="_blank" rel="noopener" href="https://juejin.im/user/586fc337a22b9d0058807d53/posts" title="掘金"><img src="http://images.pingan8787.com/icon_juejin.png" alt="掘金"></a></li><li class="my_icon_li"><a target="_blank" rel="noopener" href="https://segmentfault.com/blog/pingan8787" title="思否"><img src="http://images.pingan8787.com/icon_sf.png" alt="思否"></a></li><li class="my_icon_li"><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_36380426" title="CSDN"><img src="http://images.pingan8787.com/icon_csdn.png" alt="CSDN"></a></li><li class="my_icon_li"><a target="_blank" rel="noopener" href="https://www.jianshu.com/u/2ec5d94afd60" title="简书"><img src="http://images.pingan8787.com/icon_jianshu.png" alt="简书"></a></li></ul><div style="text-align:center;"><wb:follow-button uid="1689651205" type="red_1" style="margin-top:10px;width:67px;height:24px;display: inline-block;"></wb:follow-button></div><ul class="social-links"></ul><div class="footer"><a target="_blank" href="/"><span>博客作者：</span></a><a href="https://github.com/pingan8787" target="_blank"> pingan8787（leo）</a><div class="by_farbox"> <a href="https://beian.miit.gov.cn/" target="_blank">备案编号：闽ICP备17012095号-1</a></div></div></div><s></s><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="/">首页</a></li><li><a href="/leo">关于Leo</a></li><li><a href="/production">作品</a></li><li><a href="/Catalog">目录</a></li><li><a href="http://js.pingan8787.com" target="_blank">Cute-JavaScript</a></li><li><a href="https://github.com/pingan8787" target="_blank">Github</a></li></div><!--.information//.back_btn
  //li
    //if is_post()
      //a.fa.fa-chevron-left(onclick="window.history.go(-1)") 
    //else
      //a.fa.fa-chevron-left(onclick="window.history.go(-1)",style="display:none;") 
//.avatar
//  img(src= url_for('images/logo@2x.png'))--></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>227-【总结】如何优雅的在微信小程序使用SVG字体图标</a></h3></div><div class="post-content"><blockquote>
<p>本文思路来自实际项目的重构总结，欢迎纠正和交流。如果对你有帮助，还请点赞👍收藏支持一下啦。</p>
</blockquote>
<p>最近在重构一个项目，主要是做 H5 端和小程序端，这次打算开始多做总结啦，之前已经总结一篇<a target="_blank" rel="noopener" href="https://juejin.cn/post/6986455896708612110">《如何优雅的管理 HTTP 请求和响应拦截器？》</a> 。</p>
<p>如果大家还有其他方案，欢迎一起探讨哈~ 喜欢本文的朋友给个赞👍鼓励一下哈~</p>
<h2 id="一、需求思考和方案设计"><a href="#一、需求思考和方案设计" class="headerlink" title="一、需求思考和方案设计"></a>一、需求思考和方案设计</h2><p>本文介绍的项目是使用 <a target="_blank" rel="noopener" href="https://taro-docs.jd.com/taro/docs/README">Taro</a>框架进行多端开发，目前主要适配 H5 端和微信小程序端。项目使用的字体图标库内部维护，目前托管在 <a target="_blank" rel="noopener" href="https://www.iconfont.cn/">iconfont</a> 上。</p>
<h3 id="1-问题分析"><a href="#1-问题分析" class="headerlink" title="1. 问题分析"></a>1. 问题分析</h3><p>最近在重构的项目比较古老（其实也就去年的），项目中使用到的图标早已更新 N 个迭代了，已经由<strong>单色图标</strong>更新到<strong>多色图标</strong>！<br><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/16cfaf7b06054a389ca1d4112c62c78c~tplv-k3u1fbpfcp-zoom-1.image"><br>很明显好看多了。</p>
<p>这里先按照 <a target="_blank" rel="noopener" href="https://www.iconfont.cn/help/detail?spm=a313x.7781069.1998910419.d8cf4382a&helptype=code">iconfont 的规则</a>看看单色图标和多色图标使用上的区别：</p>
<h4 id="单色图标的使用"><a href="#单色图标的使用" class="headerlink" title="单色图标的使用"></a>单色图标的使用</h4><p>单色图标使用起来比较简单（以 font-class 引用为例），只需要 2 个步骤：</p>
<ul>
<li><p>第一步：拷贝项目下面生成的fontclass代码：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//at<span class="selector-class">.alicdn</span><span class="selector-class">.com</span>/t/font_8d5l8fzk5b87iudi<span class="selector-class">.css</span></span><br></pre></td></tr></table></figure></li>
<li><p>第二步：挑选相应图标并获取类名，应用于页面：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;iconfont icon-xxx&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="多色图标的使用"><a href="#多色图标的使用" class="headerlink" title="多色图标的使用"></a>多色图标的使用</h4><p>多色图标使用起来也很简单（以 symbol 引用为例），只需要 3 个步骤：</p>
<ul>
<li><p>第一步：拷贝项目下面生成的symbol代码：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//at.alicdn.com/t/font_8d5l8fzk5b87iudi.js</span><br></pre></td></tr></table></figure></li>
<li><p>第二步：加入通用css代码（引入一次就行）：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.icon</span> &#123;</span></span><br><span class="line"><span class="css">       <span class="attribute">width</span>: <span class="number">1em</span>; <span class="attribute">height</span>: <span class="number">1em</span>;</span></span><br><span class="line"><span class="css">       <span class="attribute">vertical-align</span>: -<span class="number">0.15em</span>;</span></span><br><span class="line"><span class="css">       fill: currentColor;</span></span><br><span class="line"><span class="css">       <span class="attribute">overflow</span>: hidden;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>第三步：挑选相应图标并获取类名，应用于页面：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">class</span>=<span class="string">&quot;icon&quot;</span> <span class="attr">aria-hidden</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">use</span> <span class="attr">xlink:href</span>=<span class="string">&quot;#icon-xxx&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">use</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<p>这两种图标在使用上都非常方便，那大家是不是会好奇，我们写本文的目的？</p>
<p>原因是，<strong>微信小程序上不支持 SVG 字体图标！😔 而多色图标，是需要借助 SVG 标签来实现。</strong></p>
<p>于是我在<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/component/image.html">小程序文档</a>找了好久，也只看到了 <code>&lt;Image&gt;</code> 组件能够使用 SVG，介绍如下：</p>
<blockquote>
<p>image图片。支持 JPG、PNG、SVG、WEBP、GIF 等格式，2.3.0 起支持云文件ID。</p>
</blockquote>
<p>其属性 <code>src</code> 的值为图片资源地址，这就意味着，不能使用 SVG 字体图标了。因此我们需要想想变通的办法。</p>
<p>（这里不讨论将 iconfont 上图标下载为图片来引用的情况）</p>
<h3 id="2-方案设计"><a href="#2-方案设计" class="headerlink" title="2. 方案设计"></a>2. 方案设计</h3><p>既然我们了解了单色图标和多色图标的使用方式：</p>
<ul>
<li>单色图标：任意标签（如 <code>div</code> 标签） + 对应字体图标 class 名称</li>
<li>多色图标：使用 <code>svg</code> 标签 + <code>use</code> 标签设置 <code>xlink:href</code> 属性</li>
</ul>
<p>首先马上想到的是，能不能集合两者使用方式，实现任意标签通过 class 名称来使用多色图标？</p>
<p>答案是可以的，只需要对图标文件进行格式转换，即 <strong>将多色字体图标转换为能通过class名称来引用的字体图标文件</strong> 。</p>
<p>那接下来只要看看如何实现格式转换即可。</p>
<h2 id="二、重构后的效果"><a href="#二、重构后的效果" class="headerlink" title="二、重构后的效果"></a>二、重构后的效果</h2><p>这边我以其中一个页面进行重构，最后将单色图标全都换成新的多色 SVG 字体图标，效果如下：</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c102f716f07a4c489bac801c9ed71ebe~tplv-k3u1fbpfcp-zoom-1.image"></p>
<h2 id="三、方案一：手动转换图标文件"><a href="#三、方案一：手动转换图标文件" class="headerlink" title="三、方案一：手动转换图标文件"></a>三、方案一：手动转换图标文件</h2><p>目前我尝试了两套方案，并且都顺利实现效果，这边先分享一下这两种方案，然后再补充说明我选择哪个方案和原因：</p>
<p>该方案实现的是手动将字体图标库文件转换成能通过 class 名称来引用的图标库。<br>使用到的工具有：</p>
<ol>
<li>icomoon：<a target="_blank" rel="noopener" href="https://icomoon.io/">https://icomoon.io/</a> 用来打包图标。</li>
<li>transfonter： <a target="_blank" rel="noopener" href="https://transfonter.org/">https://transfonter.org/</a> 用来生成 base64 格式的图标。</li>
</ol>
<p>接下来开始试试：</p>
<h3 id="步骤一：通过-iconfont-下载需要的-SVG-格式的图标"><a href="#步骤一：通过-iconfont-下载需要的-SVG-格式的图标" class="headerlink" title="步骤一：通过 iconfont 下载需要的 SVG 格式的图标"></a>步骤一：通过 iconfont 下载需要的 SVG 格式的图标</h3><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d2f2ed0981774d3082f29812b7226cc8~tplv-k3u1fbpfcp-zoom-1.image"></p>
<p>这边多下载了几个，都是 svg 格式的文件，如下图：</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/61210334a3d148f4ac06c3b24c071663~tplv-k3u1fbpfcp-zoom-1.image"></p>
<h3 id="步骤二：打包字体图标"><a href="#步骤二：打包字体图标" class="headerlink" title="步骤二：打包字体图标"></a>步骤二：打包字体图标</h3><p>这一步是将零散个多个 SVG 多色图标打包成一个字体图标文件，这一步需要使用 <a target="_blank" rel="noopener" href="https://icomoon.io/">https://icomoon.io/</a>：</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0758d7a86d8046d99e0d3293c3ac44ba~tplv-k3u1fbpfcp-zoom-1.image"></p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2e710ef82d7b445b8503eeddd3616a4d~tplv-k3u1fbpfcp-zoom-1.image"></p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ac14cf323a0a4c30896528abd519e04a~tplv-k3u1fbpfcp-zoom-1.image"></p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/49d1b72417614cb4847b42d8a51c8b83~tplv-k3u1fbpfcp-zoom-1.image"></p>
<h3 id="步骤三：字体图标进行-Base64-编码"><a href="#步骤三：字体图标进行-Base64-编码" class="headerlink" title="步骤三：字体图标进行 Base64 编码"></a>步骤三：字体图标进行 Base64 编码</h3><p>接下来就需要将打好的字体图标进行 base64 压缩，这边使用<a target="_blank" rel="noopener" href="https://transfonter.org/">https://transfonter.org/</a>来操作。</p>
<p>第一步选择前面打好的包里面的 <code>.ttf</code> 文件：</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/52c375c7a20a4dcdb45b9b9b6aa76fe7~tplv-k3u1fbpfcp-zoom-1.image"></p>
<p>设置参数，并导出文件：</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b074d244eafd4efbb33ec0a339c7e41a~tplv-k3u1fbpfcp-zoom-1.image"></p>
<h3 id="步骤四：合并字体图标"><a href="#步骤四：合并字体图标" class="headerlink" title="步骤四：合并字体图标"></a>步骤四：合并字体图标</h3><p>经过前面几个步骤，我们现在已经有 2 个包：</p>
<ul>
<li>第一个包：icomoon 生成的包</li>
</ul>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2d8be45c189442f8bfa18d33c9325b0b~tplv-k3u1fbpfcp-zoom-1.image"></p>
<ul>
<li>第二个包：transfonter 生成的包</li>
</ul>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5f8f7d9414aa4e43b8ad21dd44747c64~tplv-k3u1fbpfcp-zoom-1.image"></p>
<p>接下来我们开始将两个包合并：<br>将第一个包 style.css 文件除 <code>@font-face</code> 的内容复制到第二个包 stylesheet.css 文件后面。</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/47f9996d991a4a7bb8af9a7fd84e8a23~tplv-k3u1fbpfcp-zoom-1.image"></p>
<p>这样就获得一份新的字体图标文件，其实也可以拷贝到一份新的 css 文件中。</p>
<h3 id="使用字体图标"><a href="#使用字体图标" class="headerlink" title="使用字体图标"></a>使用字体图标</h3><p>我们将前面修改后的文件改名为 <code>icon.scss</code> 并引入到项目：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// app<span class="selector-class">.scss</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@import</span> <span class="string">&quot;./style/icon.scss&quot;</span>;</span><br></pre></td></tr></table></figure>
<p>代码中使用图标：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;View className=<span class="string">&quot;icon-exe-knowledge-ppt&quot;</span>&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">View</span> <span class="attr">className</span>=<span class="string">&#x27;path1&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">View</span>&gt;</span></span></span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">View</span> <span class="attr">className</span>=<span class="string">&#x27;path2&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">View</span>&gt;</span></span></span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">View</span> <span class="attr">className</span>=<span class="string">&#x27;path3&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">View</span>&gt;</span></span></span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">View</span> <span class="attr">className</span>=<span class="string">&#x27;path4&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">View</span>&gt;</span></span></span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">View</span> <span class="attr">className</span>=<span class="string">&#x27;path5&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">View</span>&gt;</span></span></span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">View</span> <span class="attr">className</span>=<span class="string">&#x27;path6&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">View</span>&gt;</span></span></span><br><span class="line">&lt;/View&gt;</span><br></pre></td></tr></table></figure>
<p>最后效果如下：</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c48ca101e0d8458c970eaceb562c641c~tplv-k3u1fbpfcp-zoom-1.image"></p>
<h3 id="踩坑记录"><a href="#踩坑记录" class="headerlink" title="踩坑记录"></a>踩坑记录</h3><p>在使用方案一的时候，踩了好几个坑，这边挑两个来说：</p>
<ul>
<li>使用时，需要手动添加几个 <code>&lt;View classname=&quot;path*&quot;&gt;&lt;/View&gt;</code> 元素</li>
</ul>
<p>刚开始使用，图标一直没有出来，后面观察字体图标，它是在容器元素下很多个 <code>path1</code> 、 <code>path2</code> 等元素的伪类中去渲染图标内容：</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/35107552afc042f388757059de967143~tplv-k3u1fbpfcp-zoom-1.image"></p>
<p>所以使用时需要手动添加一下。</p>
<ul>
<li>默认图标会是一个大的块级元素，导致图标显示有问题</li>
</ul>
<p>这是因为手动加的 class 为 <code>path*</code> 的 <code>View</code> 标签本身是块级元素，所以这里只要简单加个 <code>display: flex</code> 即可。</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4f6cf5d1753b4221af6614ce964683cc~tplv-k3u1fbpfcp-zoom-1.image"></p>
<p>并且其字体大小，也是可以使用 <code>font-size</code> 来设置：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">display</span>: flex;</span><br><span class="line"><span class="attribute">font-size</span>: <span class="number">100px</span>;</span><br></pre></td></tr></table></figure>

<h3 id="抽取组件"><a href="#抽取组件" class="headerlink" title="抽取组件"></a>抽取组件</h3><p>考虑到复用性，我将这些抽成一个 <code>exe-svg-icon</code> 组件：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Taro <span class="keyword">from</span> <span class="string">&#x27;@tarojs/taro&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; View, Text &#125; <span class="keyword">from</span> <span class="string">&#x27;@tarojs/components&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> classNames <span class="keyword">from</span> <span class="string">&#x27;classnames&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">EXESvgIcon</span>(<span class="params">params</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; icon = <span class="string">&#x27;exe-none&#x27;</span> &#125; = params;</span><br><span class="line">  <span class="keyword">const</span> containerStyle = &#123;</span><br><span class="line">    <span class="attr">display</span>: <span class="string">&#x27;inline-block&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="xml"><span class="tag">&lt;<span class="name">View</span> <span class="attr">className</span>=<span class="string">&#123;classNames(</span>&#x27;<span class="attr">svg</span>&#x27;, <span class="attr">icon</span>)&#125; <span class="attr">style</span>=<span class="string">&#123;containerStyle&#125;</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">View</span> <span class="attr">className</span>=<span class="string">&#x27;path1&#x27;</span> <span class="attr">style</span>=<span class="string">&#123;containerStyle&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">View</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">View</span> <span class="attr">className</span>=<span class="string">&#x27;path2&#x27;</span> <span class="attr">style</span>=<span class="string">&#123;containerStyle&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">View</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">View</span> <span class="attr">className</span>=<span class="string">&#x27;path3&#x27;</span> <span class="attr">style</span>=<span class="string">&#123;containerStyle&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">View</span>&gt;</span></span></span><br><span class="line"><span class="xml">      &#123;/* 一般图标 3 层，这边多预留几层，防止不够用 */&#125;</span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">View</span> <span class="attr">className</span>=<span class="string">&#x27;path4&#x27;</span> <span class="attr">style</span>=<span class="string">&#123;containerStyle&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">View</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">View</span> <span class="attr">className</span>=<span class="string">&#x27;path5&#x27;</span> <span class="attr">style</span>=<span class="string">&#123;containerStyle&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">View</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">View</span> <span class="attr">className</span>=<span class="string">&#x27;path6&#x27;</span> <span class="attr">style</span>=<span class="string">&#123;containerStyle&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">View</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">View</span> <span class="attr">className</span>=<span class="string">&#x27;path7&#x27;</span> <span class="attr">style</span>=<span class="string">&#123;containerStyle&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">View</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">View</span> <span class="attr">className</span>=<span class="string">&#x27;path8&#x27;</span> <span class="attr">style</span>=<span class="string">&#123;containerStyle&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">View</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">View</span> <span class="attr">className</span>=<span class="string">&#x27;path9&#x27;</span> <span class="attr">style</span>=<span class="string">&#123;containerStyle&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">View</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">View</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> EXESvgIcon;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>到这边，方案一实现完成。</p>
<h2 id="四、方案二：借助第三方库实现"><a href="#四、方案二：借助第三方库实现" class="headerlink" title="四、方案二：借助第三方库实现"></a>四、方案二：借助第三方库实现</h2><p>由于第一个方案使用起来比较繁琐，于是我又再研究其他简单点的方案。</p>
<p>直到我看到 <a target="_blank" rel="noopener" href="https://gitee.com/mirrors/Taro-Iconfont">taro-iconfont-cli</a> 这个库。</p>
<blockquote>
<p>在Taro框架中使用iconfont图标，不依赖字体，支持多色彩。</p>
</blockquote>
<p>目前支持平台包括：</p>
<ul>
<li>微信小程序</li>
<li>支付宝小程序</li>
<li>百度小程序</li>
<li>头条小程序</li>
<li>QQ小程序</li>
<li>H5</li>
</ul>
<p>有以下特性：</p>
<ul>
<li>一键生成标准组件，多端支持</li>
<li>使用方便，import即可</li>
<li>支持多色彩</li>
<li>支持自定义颜色</li>
<li>支持 ES6 和 TypeScript 两种模式</li>
</ul>
<p>按照文档描述，只需要 3 个步骤，那么试试看：</p>
<h3 id="步骤一：安装-taro-iconfont-cli"><a href="#步骤一：安装-taro-iconfont-cli" class="headerlink" title="步骤一：安装 taro-iconfont-cli"></a>步骤一：安装 taro-iconfont-cli</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Yarn</span></span><br><span class="line">yarn add taro-iconfont-cli --dev</span><br><span class="line"></span><br><span class="line"><span class="comment"># Npm</span></span><br><span class="line">npm install taro-iconfont-cli --save-dev</span><br></pre></td></tr></table></figure>
<p>需要注意的是，如果使用的是 Taro 2.x，请安装 **<code>**taro-iconfont-cli@2.1.0**</code>**，并阅读旧版的<a target="_blank" rel="noopener" href="https://github.com/iconfont-cli/taro-iconfont-cli/blob/v2.1.0/README.md">README.md</a>。</p>
<h3 id="步骤二：生成配置文件"><a href="#步骤二：生成配置文件" class="headerlink" title="步骤二：生成配置文件"></a>步骤二：生成配置文件</h3><p>通过命令生成 iconfont.json 配置文件：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">npx iconfont-init</span><br><span class="line"></span><br><span class="line"><span class="comment"># 可传入配置输出路径</span></span><br><span class="line"><span class="comment"># npx iconfont-init --output iconfont.json</span></span><br></pre></td></tr></table></figure>
<p>此时项目根目录会生成一个<code>iconfont.json</code>的文件，内容如下：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;symbol_url&quot;</span>: <span class="string">&quot;请参考README.md，复制 http://iconfont.cn 官网提供的JS链接&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;save_dir&quot;</span>: <span class="string">&quot;./src/components/iconfont&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;use_typescript&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">&quot;platforms&quot;</span>: <span class="string">&quot;*&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;use_rpx&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">&quot;trim_icon_prefix&quot;</span>: <span class="string">&quot;icon&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;default_icon_size&quot;</span>: <span class="number">18</span>,</span><br><span class="line">  <span class="attr">&quot;design_width&quot;</span>: <span class="number">750</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>symbol_url</code> 值需要在 iconfont 中复制</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/246e746ed45d42afa5ae93a9b9cfe15b~tplv-k3u1fbpfcp-zoom-1.image"></p>
<h3 id="步骤三：生成-Taro-标准组件"><a href="#步骤三：生成-Taro-标准组件" class="headerlink" title="步骤三：生成 Taro 标准组件"></a>步骤三：生成 Taro 标准组件</h3><p>通过命令，生成 Taro 标准组件：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">npx iconfont-taro</span><br><span class="line"></span><br><span class="line"><span class="comment"># 可传入配置文件路径</span></span><br><span class="line"><span class="comment"># npx iconfont-taro --config iconfont.json</span></span><br></pre></td></tr></table></figure>
<p>通过控制台，我们可以看到 taro-iconfont-cli 为每个图标单独生成一个 Taro 组件：</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2ba58b7294c240f58a83b26f3d5bd1b6~tplv-k3u1fbpfcp-zoom-1.image"></p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/80ff739befa843469c5af0d0beeabec1~tplv-k3u1fbpfcp-zoom-1.image"></p>
<h3 id="使用字体图标-1"><a href="#使用字体图标-1" class="headerlink" title="使用字体图标"></a>使用字体图标</h3><p>按照文档使用方法，使用的时候，只需要引入 <code>IconFont</code> 组件，通过 <code>name</code> 名称来选择对应图标即可：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 省略其他代码</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> IconFont <span class="keyword">from</span> <span class="string">&#x27;@components/Iconfont/index&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">IconFont</span> <span class="attr">name</span>=<span class="string">&quot;exe-knowledge-ppt&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">IconFont</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>按照文档提示，还有更多使用方法：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 原色彩</span></span><br><span class="line">&lt;IconFont name=<span class="string">&quot;alipay&quot;</span> /&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 单色：红色</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">IconFont</span> <span class="attr">name</span>=<span class="string">&quot;alipay&quot;</span> <span class="attr">color</span>=<span class="string">&quot;red&quot;</span> /&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 多色：红色+橘色</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">IconFont</span> <span class="attr">name</span>=<span class="string">&quot;alipay&quot;</span> <span class="attr">color</span>=<span class="string">&#123;[</span>&#x27;<span class="attr">red</span>&#x27;, &#x27;<span class="attr">orange</span>&#x27;]&#125; <span class="attr">size</span>=<span class="string">&#123;300&#125;</span> /&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 不同格式的颜色写法</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">IconFont</span> <span class="attr">name</span>=<span class="string">&quot;alipay&quot;</span> <span class="attr">color</span>=<span class="string">&#123;[</span>&#x27;#<span class="attr">333</span>&#x27;, &#x27;<span class="attr">rgb</span>(<span class="attr">50</span>, <span class="attr">124</span>, <span class="attr">39</span>)&#x27;]&#125; /&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 与文字对齐</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">View</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">display:</span> &#x27;<span class="attr">flex</span>&#x27;, <span class="attr">alignItems:</span> &#x27;<span class="attr">center</span>&#x27; &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">Text</span>&gt;</span>Hello<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">IconFont</span> <span class="attr">name</span>=<span class="string">&quot;alipay&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">View</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<h3 id="踩坑记录-1"><a href="#踩坑记录-1" class="headerlink" title="踩坑记录"></a>踩坑记录</h3><ol>
<li>字体大小设置问题</li>
</ol>
<p>由于通过这种方式导出的图标，是个单独组件，使用时如果需要设置图标大小，需要通过设置其 <code>width</code>和<code>height</code>属性进行设置。</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e2a1543852b9471faf58996659570723~tplv-k3u1fbpfcp-zoom-1.image"></p>
<p>通过 <code>font-size</code>属性无法设置字体图标的大小。</p>
<h2 id="五、方案对比和选择"><a href="#五、方案对比和选择" class="headerlink" title="五、方案对比和选择"></a>五、方案对比和选择</h2><p>这次只尝试了这两种方案，都能顺利完成需求。如果大家有其他方案，欢迎一起评论区讨论~</p>
<p>接下来<strong>以生成下面相同 20 个多色图标为标准，分析这两种方案：</strong></p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3f78d0a522394926a71c0243988ca945~tplv-k3u1fbpfcp-zoom-1.image"></p>
<p>先看看对比结果：</p>
<table>
<thead>
<tr>
<th></th>
<th><strong>手动转换图标文件</strong></th>
<th><strong>借助 taro-iconfont-cli 库实现</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>生成难易程度</strong></td>
<td>复杂</td>
<td>简单</td>
</tr>
<tr>
<td><strong>使用难易程度</strong></td>
<td>简单</td>
<td>简单</td>
</tr>
<tr>
<td><strong>资源占用程度</strong></td>
<td>27kb</td>
<td>420kb（项目未打包前）</td>
</tr>
</tbody></table>
<p>分析每个项目：</p>
<h3 id="1-对比生成难易程度"><a href="#1-对比生成难易程度" class="headerlink" title="1. 对比生成难易程度"></a>1. 对比生成难易程度</h3><ul>
<li>「手动转换图标文件」需要每次将图标单独下载，再进行打包，当图标数量较多，其工作量就较大。</li>
<li>「taro-iconfont-cli」只需设置字体图标库地址，自动下载并生成组件，较为方便。</li>
</ul>
<h3 id="2-对比使用难易程度"><a href="#2-对比使用难易程度" class="headerlink" title="2. 对比使用难易程度"></a>2. 对比使用难易程度</h3><p>两者使用起来都比较简单：</p>
<ul>
<li><p>「手动转换图标文件」为元素添加 class 名称即可。</p>
</li>
<li><p>「taro-iconfont-cli」为元素添加 name 属性。</p>
<h3 id="3-对比资源占用情况"><a href="#3-对比资源占用情况" class="headerlink" title="3. 对比资源占用情况"></a>3. 对比资源占用情况</h3><p>资源占用差异就很大了，分析下原因：</p>
</li>
<li><p>「手动转换图标文件」是将图标重新打包，最后生成的都是 base64 编码的内容，相对较小。</p>
</li>
<li><p>「taro-iconfont-cli」是为每个图标生成一个组件，单独一个文件，还有附加各个平台的文件，因此较大。</p>
<h3 id="4-选择方案"><a href="#4-选择方案" class="headerlink" title="4. 选择方案"></a>4. 选择方案</h3><p>考虑到目前项目所使用的字体图标比较少（20 个以内），后续开发人员上手难度问题，我最终使用「taro-iconfont-cli」这套方案。<br>虽然这个方案生成的组件资源占用会稍大，但是目前使用图标较少，并且可以通过打包工具、CDN 等常用优化方式进行优化。</p>
</li>
</ul>
<h2 id="六、本文总结"><a href="#六、本文总结" class="headerlink" title="六、本文总结"></a>六、本文总结</h2><p>本文通过一次简单的项目重构，总结项目中小程序使用 SVG 多色图标的方案，目的是为了实现在小程序中能够正常使用 SVG 多色图标，并且也为内容越来越多独立站点的项目积累经验，毕竟各个项目具有相关性。</p>
<p>最后，「taro-iconfont-cli」方案目前已经在内部 npm 仓库维护，采用版本控制，方便不同项目使用时减少冲突。</p>
<p>当然，本文是基于我的经验总结，欢迎大家有更好的方案，一起讨论学习~~</p>
<h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><ul>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/Originally_M/article/details/106473475">微信小程序中使用svg字体图标教程 ——图解三步，很清晰</a> </li>
<li><a target="_blank" rel="noopener" href="https://gitee.com/mirrors/Taro-Iconfont">Taro-Iconfont</a> </li>
</ul>
</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2021-07-28</span><i class="fa fa-tag"></i><a class="tag" href="/tags/总结/" title="总结">总结 </a></div></div></div></div><div class="share"><div class="evernote"><a class="fa fa-bookmark" href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title);}})();" ref="nofollow" target="_blank"></a></div><div class="weibo"><a class="fa fa-weibo" href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));"></a></div><div class="twitter"><a class="fa fa-twitter" target="_blank" rel="noopener" href="http://twitter.com/home?status=,https://pingan8787.github.io/2021/07/28/227-【总结】如何优雅的在微信小程序使用SVG字体图标/,pingan8787,227-【总结】如何优雅的在微信小程序使用SVG字体图标,;"></a></div></div><div class="pagination"><ul class="clearfix"><li class="next pagbuttons"><a class="btn" role="navigation" href="/2021/07/28/226-%E3%80%90HTTP%E3%80%91%E5%A6%82%E4%BD%95%E4%BC%98%E9%9B%85%E7%9A%84%E7%AE%A1%E7%90%86HTTP%E8%AF%B7%E6%B1%82%E5%92%8C%E5%93%8D%E5%BA%94%E6%8B%A6%E6%88%AA%E5%99%A8%EF%BC%9F/" title="226-【HTTP】如何优雅的管理HTTP请求和响应拦截器？">下一篇</a></li></ul></div></div></div></div></div><script src="/js/jquery.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script></body></html>